{"version":3,"file":"sock.js","sources":["../src/js/polyfill.js","../src/js/foreign.js","../src/js/network/http.js","../src/js-generated/sock_c.js","../src/js/globals.js","../src/js/vm.js","../src/js/messaging.js","../src/js/vm-call-handles.js","../src/js/api/time.js","../src/js/format/unzipit.js","../src/js/html.js","../src/js/path.js","../src/js/asset-database.js","../src/js/api/promise.js","../src/js/api/asset.js","../src/js/api/audio.js","../src/js/api/buffer.js","../src/js/api/storage.js","../src/js/layout.js","../src/js/api/camera.js","../src/js/gl/gl.js","../src/js/gl/api.js","../src/js/gl/quad-index-buffer.js","../src/js/gl/shader.js","../src/js/math.js","../src/js/gl/texture.js","../src/js/gl/sprite-batcher.js","../src/js/api/sprite.js","../src/js/device.js","../src/js/gl/framebuffer.js","../src/js/system-font.js","../src/js/api/game.js","../src/js/api/screen.js","../src/js/gl/quad-batcher.js","../src/js/gl/primitive-batcher.js","../src/js/api/quad.js","../src/js/keyboard-layout.js","../src/js/api/input.js","../src/js/json.js","../src/js/api/javascript.js","../src/js/api/platform.js","../src/js/error.js","../src/js/debug/terminal.js","../src/js/main.js","../src/js/async.js"],"sourcesContent":["\r\nlet documentProto = Document.prototype;\r\nlet elementProto = Element.prototype;\r\n\r\nexport let fullscreenChangeEvent = \"fullscreenchange\";\r\n\r\nif (!elementProto.requestFullscreen) {\r\n\tif (elementProto[\"webkitRequestFullscreen\"]) {\r\n\t\t// Safari uses webkit prefix for fullscreen API.\r\n\r\n\t\tfullscreenChangeEvent = \"webkit\" + fullscreenChangeEvent;\r\n\r\n\t\tObject.defineProperty(documentProto, \"fullscreenElement\", {\r\n\t\t\tget() {\r\n\t\t\t\treturn this[\"webkitFullscreenElement\"];\r\n\t\t\t}\r\n\t\t});\r\n\t\t\r\n\t\tObject.defineProperty(documentProto, \"fullscreenEnabled\", {\r\n\t\t\tget() {\r\n\t\t\t\treturn this[\"webkitFullscreenEnabled\"];\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tdocumentProto[\"exitFullscreen\"] = function () {\r\n\t\t\tthis[\"webkitExitFullscreen\"]();\r\n\r\n\t\t\treturn Promise.resolve();\r\n\t\t};\r\n\r\n\t\telementProto[\"requestFullscreen\"] = function () {\r\n\t\t\treturn new Promise((resolve, reject) => {\r\n\t\t\t\tlet fullscreenChange = () => {\r\n\t\t\t\t\tfinalize();\r\n\t\t\t\t\tresolve();\r\n\t\t\t\t};\r\n\r\n\t\t\t\tlet fullscreenError = () => {\r\n\t\t\t\t\tfinalize();\r\n\t\t\t\t\treject(new TypeError(\"failed to get fullscreen\"));\r\n\t\t\t\t};\r\n\r\n\t\t\t\tlet finalize = () => {\r\n\t\t\t\t\tthis.removeEventListener(\"webkitfullscreenchange\", fullscreenChange);\r\n\t\t\t\t\tthis.removeEventListener(\"webkitfullscreenerror\", fullscreenError);\r\n\t\t\t\t};\r\n\r\n\t\t\t\tthis.addEventListener(\"webkitfullscreenchange\", fullscreenChange);\r\n\t\t\t\tthis.addEventListener(\"webkitfullscreenerror\", fullscreenError);\r\n\r\n\t\t\t\tthis[\"webkitRequestFullscreen\"]();\r\n\t\t\t});\r\n\t\t};\r\n\t}\r\n}\r\n","\r\n/**\r\n * @param {string} moduleName\r\n * @param {string} className\r\n * @param {boolean} isStatic\r\n * @param {string} signature\r\n * @param {() => void} callback\r\n */\r\nexport function addForeignMethod(moduleName, className, isStatic, signature, callback) {\r\n\tforeignMethods[methodID(moduleName || \"sock\", className, isStatic, signature)] = callback;\r\n}\r\n\r\n/**\r\n * @param {string} moduleName\r\n * @param {string} className\r\n * @param {Record<string, () => void>} methods\r\n */\r\nexport function addClassForeignStaticMethods(moduleName, className, methods) {\r\n\tfor (let signature in methods) {\r\n\t\taddForeignMethod(moduleName, className, true, signature, methods[signature]);\r\n\t}\r\n}\r\n\r\n/**\r\n * @param {string} moduleName\r\n * @param {string} className\r\n * @param {Record<string, () => void>} methods\r\n */\r\nexport function addClassForeignMethods(moduleName, className, methods) {\r\n\tfor (let signature in methods) {\r\n\t\taddForeignMethod(moduleName, className, false, signature, methods[signature]);\r\n\t}\r\n}\r\n\r\n/**\r\n * @param {string} moduleName\r\n * @param {string} className\r\n * @param {ForeignClassMethods} classMethods\r\n * @param {Record<string, () => void>} [methods]\r\n * @param {Record<string, () => void>} [staticMethods]\r\n */\r\nexport function addForeignClass(moduleName, className, classMethods, methods, staticMethods) {\r\n\tforeignClasses[classID(moduleName, className)] = classMethods;\r\n\r\n\tif (methods) {\r\n\t\taddClassForeignMethods(moduleName, className, methods);\r\n\t}\r\n\r\n\tif (staticMethods) {\r\n\t\taddClassForeignStaticMethods(moduleName, className, staticMethods);\r\n\t}\r\n}\r\n\r\n/**\r\n * @param {string} moduleName\r\n * @param {string} className\r\n * @param {boolean} isStatic\r\n * @param {string} signature\r\n * @returns {undefined | (() => void)}\r\n */\r\nexport function resolveForeignMethod(moduleName, className, isStatic, signature) {\r\n\treturn foreignMethods[methodID(moduleName, className, isStatic, signature)];\r\n}\r\n\r\n/**\r\n * @param {string} moduleName\r\n * @param {string} className\r\n * @returns {undefined | ForeignClassMethods}\r\n */\r\nexport function resolveForeignClass(moduleName, className) {\r\n\treturn foreignClasses[classID(moduleName, className)];\r\n}\r\n\r\n/**\r\n * @param {string} moduleName\r\n * @param {string} className\r\n * @param {boolean} isStatic\r\n * @param {string} signature\r\n */\r\nfunction methodID(moduleName, className, isStatic, signature) {\r\n\treturn `${moduleName}:${className}:${isStatic}:${signature}`;\r\n}\r\n\r\n/**\r\n * @param {string} moduleName\r\n * @param {string} className\r\n */\r\nfunction classID(moduleName, className) {\r\n\treturn `${moduleName}:${className}`;\r\n}\r\n\r\n/** @type {Record<string, () => void>} */\r\nlet foreignMethods = {};\r\n\r\n/** @type {Record<string, ForeignClassMethods>} */\r\nlet foreignClasses = {};\r\n\r\n/**\r\n * @typedef {[() => void, (ptr: number) => void]} ForeignClassMethods\r\n */\r\n","\r\n/**\r\n * @param {string} url\r\n * @param {XMLHttpRequestResponseType} type\r\n * @param {(progress: number, ok: boolean) => void} [progressCallback]\r\n * @returns {Promise<any>}\r\n */\r\nexport function httpGET(url, type, progressCallback) {\r\n\treturn new Promise((resolve, reject) => {\r\n\t\tlet xhr = new XMLHttpRequest();\r\n\r\n\t\txhr.responseType = type;\r\n\t\txhr.open(\"GET\", url);\r\n\r\n\t\tif (progressCallback) {\r\n\t\t\txhr.onprogress = (event) => {\r\n\t\t\t\tlet ok = xhr.status === 0 || xhr.status === 200;\r\n\r\n\t\t\t\tif (event.lengthComputable) {\r\n\t\t\t\t\tprogressCallback(event.loaded / event.total, ok);\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// Guestimate progress.\r\n\t\t\t\t\tprogressCallback(Math.min(0.95, event.loaded / 1000000), ok);\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\txhr.onerror = () => {\r\n\t\t\treject(\"Could not connect to server\");\r\n\t\t};\r\n\r\n\t\txhr.onload = () => {\r\n\t\t\tif (xhr.status === 200) {\r\n\t\t\t\tresolve(xhr.response);\r\n\t\t\t} else {\r\n\t\t\t\treject(new HTTPError(url, xhr.status, xhr.statusText));\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\txhr.send();\r\n\t});\r\n}\r\n\r\n/**\r\n * @param {string} url\r\n * @returns {Promise<HTMLImageElement|null>}\r\n */\r\nexport function httpGETImage(url) {\r\n\treturn new Promise((resolve, reject) => {\r\n\t\tlet el = new Image();\r\n\t\tel.onload = () => {\r\n\t\t\tresolve(el);\r\n\t\t};\r\n\t\tel.onerror = () => {\r\n\t\t\treject(`Could not load image ${url}`);\r\n\t\t};\r\n\t\tel.src = url;\r\n\t});\r\n}\r\n\r\n/**\r\n * @param {string} url\r\n * @returns {Promise<boolean>}\r\n */\r\nexport async function httpExists(url) {\r\n\ttry {\r\n\t\tlet response = await fetch(url, { method: \"HEAD\" });\r\n\r\n\t\treturn response.ok;\r\n\t} catch (error) {\r\n\t\tconsole.error(\"error for head request at \" + url, error);\r\n\r\n\t\treturn false;\r\n\t}\r\n}\r\n\r\n/**\r\n * @param {string} url\r\n * @returns {Promise<number>}\r\n */\r\nexport async function httpContentLength(url) {\r\n\ttry {\r\n\t\tlet response = await fetch(url, { method: \"HEAD\" });\r\n\t\tif (response.ok) {\r\n\t\t\tlet contentLength = response.headers.get(\"content-length\");\r\n\t\t\tif (contentLength) {\r\n\t\t\t\treturn Number(contentLength);\r\n\t\t\t}\r\n\t\t}\r\n\t} catch (error) {\r\n\t\tconsole.error(\"error for head request at \" + url, error);\r\n\t}\r\n\treturn 0;\r\n}\r\n\r\nexport class HTTPError extends Error {\r\n\t/**\r\n\t * @param {string} url\r\n\t * @param {number} status\r\n\t * @param {string} statusText\r\n\t */\r\n\tconstructor(url, status, statusText) {\r\n\t\tsuper(status + \": \" + statusText + \": \" + url)\r\n\r\n\t\tthis.url = url;\r\n\t\tthis.status = status;\r\n\t\tthis.statusText = statusText;\r\n\t}\r\n}\r\n","\r\nvar Module = (function() {\r\n  var _scriptDir = import.meta.url;\r\n  \r\n  return (\r\nfunction(Module) {\r\n  Module = Module || {};\r\n\r\n\r\n\r\n// The Module object: Our interface to the outside world. We import\r\n// and export values on it. There are various ways Module can be used:\r\n// 1. Not defined. We create it here\r\n// 2. A function parameter, function(Module) { ..generated code.. }\r\n// 3. pre-run appended it, var Module = {}; ..generated code..\r\n// 4. External script tag defines var Module.\r\n// We need to check if Module already exists (e.g. case 3 above).\r\n// Substitution will be replaced with actual code on later stage of the build,\r\n// this way Closure Compiler will not mangle it (e.g. case 4. above).\r\n// Note that if you want to run closure, and also to use Module\r\n// after the generated code, you will need to define   var Module = {};\r\n// before the code. Then that object will be used in the code, and you\r\n// can continue to use Module afterwards as well.\r\nvar Module = typeof Module !== 'undefined' ? Module : {};\r\n\r\n// Set up the promise that indicates the Module is initialized\r\nvar readyPromiseResolve, readyPromiseReject;\r\nModule['ready'] = new Promise(function(resolve, reject) {\r\n  readyPromiseResolve = resolve;\r\n  readyPromiseReject = reject;\r\n});\r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '_malloc')) {\r\n        Object.defineProperty(Module['ready'], '_malloc', { configurable: true, get: function() { abort('You are getting _malloc on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '_malloc', { configurable: true, set: function() { abort('You are setting _malloc on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '_realloc')) {\r\n        Object.defineProperty(Module['ready'], '_realloc', { configurable: true, get: function() { abort('You are getting _realloc on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '_realloc', { configurable: true, set: function() { abort('You are setting _realloc on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '_free')) {\r\n        Object.defineProperty(Module['ready'], '_free', { configurable: true, get: function() { abort('You are getting _free on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '_free', { configurable: true, set: function() { abort('You are setting _free on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '_sock_init')) {\r\n        Object.defineProperty(Module['ready'], '_sock_init', { configurable: true, get: function() { abort('You are getting _sock_init on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '_sock_init', { configurable: true, set: function() { abort('You are setting _sock_init on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '_sock_font')) {\r\n        Object.defineProperty(Module['ready'], '_sock_font', { configurable: true, get: function() { abort('You are getting _sock_font on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '_sock_font', { configurable: true, set: function() { abort('You are setting _sock_font on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '_sock_new_buffer')) {\r\n        Object.defineProperty(Module['ready'], '_sock_new_buffer', { configurable: true, get: function() { abort('You are getting _sock_new_buffer on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '_sock_new_buffer', { configurable: true, set: function() { abort('You are setting _sock_new_buffer on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '_sock_new_transform')) {\r\n        Object.defineProperty(Module['ready'], '_sock_new_transform', { configurable: true, get: function() { abort('You are getting _sock_new_transform on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '_sock_new_transform', { configurable: true, set: function() { abort('You are setting _sock_new_transform on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '_sock_get_transform')) {\r\n        Object.defineProperty(Module['ready'], '_sock_get_transform', { configurable: true, get: function() { abort('You are getting _sock_get_transform on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '_sock_get_transform', { configurable: true, set: function() { abort('You are setting _sock_get_transform on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '_wrenGetVersionNumber')) {\r\n        Object.defineProperty(Module['ready'], '_wrenGetVersionNumber', { configurable: true, get: function() { abort('You are getting _wrenGetVersionNumber on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '_wrenGetVersionNumber', { configurable: true, set: function() { abort('You are setting _wrenGetVersionNumber on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '_wrenInitConfiguration')) {\r\n        Object.defineProperty(Module['ready'], '_wrenInitConfiguration', { configurable: true, get: function() { abort('You are getting _wrenInitConfiguration on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '_wrenInitConfiguration', { configurable: true, set: function() { abort('You are setting _wrenInitConfiguration on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '_wrenNewVM')) {\r\n        Object.defineProperty(Module['ready'], '_wrenNewVM', { configurable: true, get: function() { abort('You are getting _wrenNewVM on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '_wrenNewVM', { configurable: true, set: function() { abort('You are setting _wrenNewVM on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '_wrenFreeVM')) {\r\n        Object.defineProperty(Module['ready'], '_wrenFreeVM', { configurable: true, get: function() { abort('You are getting _wrenFreeVM on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '_wrenFreeVM', { configurable: true, set: function() { abort('You are setting _wrenFreeVM on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '_wrenCollectGarbage')) {\r\n        Object.defineProperty(Module['ready'], '_wrenCollectGarbage', { configurable: true, get: function() { abort('You are getting _wrenCollectGarbage on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '_wrenCollectGarbage', { configurable: true, set: function() { abort('You are setting _wrenCollectGarbage on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '_wrenInterpret')) {\r\n        Object.defineProperty(Module['ready'], '_wrenInterpret', { configurable: true, get: function() { abort('You are getting _wrenInterpret on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '_wrenInterpret', { configurable: true, set: function() { abort('You are setting _wrenInterpret on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '_wrenMakeCallHandle')) {\r\n        Object.defineProperty(Module['ready'], '_wrenMakeCallHandle', { configurable: true, get: function() { abort('You are getting _wrenMakeCallHandle on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '_wrenMakeCallHandle', { configurable: true, set: function() { abort('You are setting _wrenMakeCallHandle on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '_wrenCall')) {\r\n        Object.defineProperty(Module['ready'], '_wrenCall', { configurable: true, get: function() { abort('You are getting _wrenCall on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '_wrenCall', { configurable: true, set: function() { abort('You are setting _wrenCall on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '_wrenReleaseHandle')) {\r\n        Object.defineProperty(Module['ready'], '_wrenReleaseHandle', { configurable: true, get: function() { abort('You are getting _wrenReleaseHandle on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '_wrenReleaseHandle', { configurable: true, set: function() { abort('You are setting _wrenReleaseHandle on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '_wrenGetSlotCount')) {\r\n        Object.defineProperty(Module['ready'], '_wrenGetSlotCount', { configurable: true, get: function() { abort('You are getting _wrenGetSlotCount on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '_wrenGetSlotCount', { configurable: true, set: function() { abort('You are setting _wrenGetSlotCount on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '_wrenEnsureSlots')) {\r\n        Object.defineProperty(Module['ready'], '_wrenEnsureSlots', { configurable: true, get: function() { abort('You are getting _wrenEnsureSlots on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '_wrenEnsureSlots', { configurable: true, set: function() { abort('You are setting _wrenEnsureSlots on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '_wrenGetSlotType')) {\r\n        Object.defineProperty(Module['ready'], '_wrenGetSlotType', { configurable: true, get: function() { abort('You are getting _wrenGetSlotType on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '_wrenGetSlotType', { configurable: true, set: function() { abort('You are setting _wrenGetSlotType on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '_wrenGetSlotBool')) {\r\n        Object.defineProperty(Module['ready'], '_wrenGetSlotBool', { configurable: true, get: function() { abort('You are getting _wrenGetSlotBool on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '_wrenGetSlotBool', { configurable: true, set: function() { abort('You are setting _wrenGetSlotBool on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '_wrenGetSlotBytes')) {\r\n        Object.defineProperty(Module['ready'], '_wrenGetSlotBytes', { configurable: true, get: function() { abort('You are getting _wrenGetSlotBytes on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '_wrenGetSlotBytes', { configurable: true, set: function() { abort('You are setting _wrenGetSlotBytes on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '_wrenGetSlotDouble')) {\r\n        Object.defineProperty(Module['ready'], '_wrenGetSlotDouble', { configurable: true, get: function() { abort('You are getting _wrenGetSlotDouble on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '_wrenGetSlotDouble', { configurable: true, set: function() { abort('You are setting _wrenGetSlotDouble on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '_wrenGetSlotForeign')) {\r\n        Object.defineProperty(Module['ready'], '_wrenGetSlotForeign', { configurable: true, get: function() { abort('You are getting _wrenGetSlotForeign on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '_wrenGetSlotForeign', { configurable: true, set: function() { abort('You are setting _wrenGetSlotForeign on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '_wrenGetSlotIsInstanceOf')) {\r\n        Object.defineProperty(Module['ready'], '_wrenGetSlotIsInstanceOf', { configurable: true, get: function() { abort('You are getting _wrenGetSlotIsInstanceOf on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '_wrenGetSlotIsInstanceOf', { configurable: true, set: function() { abort('You are setting _wrenGetSlotIsInstanceOf on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '_wrenGetSlotInstanceField')) {\r\n        Object.defineProperty(Module['ready'], '_wrenGetSlotInstanceField', { configurable: true, get: function() { abort('You are getting _wrenGetSlotInstanceField on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '_wrenGetSlotInstanceField', { configurable: true, set: function() { abort('You are setting _wrenGetSlotInstanceField on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '_wrenGetSlotString')) {\r\n        Object.defineProperty(Module['ready'], '_wrenGetSlotString', { configurable: true, get: function() { abort('You are getting _wrenGetSlotString on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '_wrenGetSlotString', { configurable: true, set: function() { abort('You are setting _wrenGetSlotString on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '_wrenGetSlotHandle')) {\r\n        Object.defineProperty(Module['ready'], '_wrenGetSlotHandle', { configurable: true, get: function() { abort('You are getting _wrenGetSlotHandle on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '_wrenGetSlotHandle', { configurable: true, set: function() { abort('You are setting _wrenGetSlotHandle on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '_wrenSetSlotBool')) {\r\n        Object.defineProperty(Module['ready'], '_wrenSetSlotBool', { configurable: true, get: function() { abort('You are getting _wrenSetSlotBool on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '_wrenSetSlotBool', { configurable: true, set: function() { abort('You are setting _wrenSetSlotBool on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '_wrenSetSlotBytes')) {\r\n        Object.defineProperty(Module['ready'], '_wrenSetSlotBytes', { configurable: true, get: function() { abort('You are getting _wrenSetSlotBytes on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '_wrenSetSlotBytes', { configurable: true, set: function() { abort('You are setting _wrenSetSlotBytes on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '_wrenSetSlotDouble')) {\r\n        Object.defineProperty(Module['ready'], '_wrenSetSlotDouble', { configurable: true, get: function() { abort('You are getting _wrenSetSlotDouble on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '_wrenSetSlotDouble', { configurable: true, set: function() { abort('You are setting _wrenSetSlotDouble on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '_wrenSetSlotRange')) {\r\n        Object.defineProperty(Module['ready'], '_wrenSetSlotRange', { configurable: true, get: function() { abort('You are getting _wrenSetSlotRange on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '_wrenSetSlotRange', { configurable: true, set: function() { abort('You are setting _wrenSetSlotRange on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '_wrenSetSlotNewForeign')) {\r\n        Object.defineProperty(Module['ready'], '_wrenSetSlotNewForeign', { configurable: true, get: function() { abort('You are getting _wrenSetSlotNewForeign on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '_wrenSetSlotNewForeign', { configurable: true, set: function() { abort('You are setting _wrenSetSlotNewForeign on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '_wrenSetSlotNewList')) {\r\n        Object.defineProperty(Module['ready'], '_wrenSetSlotNewList', { configurable: true, get: function() { abort('You are getting _wrenSetSlotNewList on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '_wrenSetSlotNewList', { configurable: true, set: function() { abort('You are setting _wrenSetSlotNewList on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '_wrenSetSlotNewMap')) {\r\n        Object.defineProperty(Module['ready'], '_wrenSetSlotNewMap', { configurable: true, get: function() { abort('You are getting _wrenSetSlotNewMap on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '_wrenSetSlotNewMap', { configurable: true, set: function() { abort('You are setting _wrenSetSlotNewMap on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '_wrenSetSlotNull')) {\r\n        Object.defineProperty(Module['ready'], '_wrenSetSlotNull', { configurable: true, get: function() { abort('You are getting _wrenSetSlotNull on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '_wrenSetSlotNull', { configurable: true, set: function() { abort('You are setting _wrenSetSlotNull on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '_wrenSetSlotString')) {\r\n        Object.defineProperty(Module['ready'], '_wrenSetSlotString', { configurable: true, get: function() { abort('You are getting _wrenSetSlotString on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '_wrenSetSlotString', { configurable: true, set: function() { abort('You are setting _wrenSetSlotString on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '_wrenSetSlotHandle')) {\r\n        Object.defineProperty(Module['ready'], '_wrenSetSlotHandle', { configurable: true, get: function() { abort('You are getting _wrenSetSlotHandle on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '_wrenSetSlotHandle', { configurable: true, set: function() { abort('You are setting _wrenSetSlotHandle on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '_wrenGetListCount')) {\r\n        Object.defineProperty(Module['ready'], '_wrenGetListCount', { configurable: true, get: function() { abort('You are getting _wrenGetListCount on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '_wrenGetListCount', { configurable: true, set: function() { abort('You are setting _wrenGetListCount on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '_wrenGetListElement')) {\r\n        Object.defineProperty(Module['ready'], '_wrenGetListElement', { configurable: true, get: function() { abort('You are getting _wrenGetListElement on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '_wrenGetListElement', { configurable: true, set: function() { abort('You are setting _wrenGetListElement on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '_wrenSetListElement')) {\r\n        Object.defineProperty(Module['ready'], '_wrenSetListElement', { configurable: true, get: function() { abort('You are getting _wrenSetListElement on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '_wrenSetListElement', { configurable: true, set: function() { abort('You are setting _wrenSetListElement on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '_wrenInsertInList')) {\r\n        Object.defineProperty(Module['ready'], '_wrenInsertInList', { configurable: true, get: function() { abort('You are getting _wrenInsertInList on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '_wrenInsertInList', { configurable: true, set: function() { abort('You are setting _wrenInsertInList on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '_wrenGetMapCount')) {\r\n        Object.defineProperty(Module['ready'], '_wrenGetMapCount', { configurable: true, get: function() { abort('You are getting _wrenGetMapCount on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '_wrenGetMapCount', { configurable: true, set: function() { abort('You are setting _wrenGetMapCount on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '_wrenGetMapContainsKey')) {\r\n        Object.defineProperty(Module['ready'], '_wrenGetMapContainsKey', { configurable: true, get: function() { abort('You are getting _wrenGetMapContainsKey on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '_wrenGetMapContainsKey', { configurable: true, set: function() { abort('You are setting _wrenGetMapContainsKey on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '_wrenGetMapValue')) {\r\n        Object.defineProperty(Module['ready'], '_wrenGetMapValue', { configurable: true, get: function() { abort('You are getting _wrenGetMapValue on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '_wrenGetMapValue', { configurable: true, set: function() { abort('You are setting _wrenGetMapValue on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '_wrenSetMapValue')) {\r\n        Object.defineProperty(Module['ready'], '_wrenSetMapValue', { configurable: true, get: function() { abort('You are getting _wrenSetMapValue on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '_wrenSetMapValue', { configurable: true, set: function() { abort('You are setting _wrenSetMapValue on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '_wrenRemoveMapValue')) {\r\n        Object.defineProperty(Module['ready'], '_wrenRemoveMapValue', { configurable: true, get: function() { abort('You are getting _wrenRemoveMapValue on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '_wrenRemoveMapValue', { configurable: true, set: function() { abort('You are setting _wrenRemoveMapValue on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '_wrenGetVariable')) {\r\n        Object.defineProperty(Module['ready'], '_wrenGetVariable', { configurable: true, get: function() { abort('You are getting _wrenGetVariable on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '_wrenGetVariable', { configurable: true, set: function() { abort('You are setting _wrenGetVariable on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '_wrenHasVariable')) {\r\n        Object.defineProperty(Module['ready'], '_wrenHasVariable', { configurable: true, get: function() { abort('You are getting _wrenHasVariable on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '_wrenHasVariable', { configurable: true, set: function() { abort('You are setting _wrenHasVariable on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '_wrenHasModule')) {\r\n        Object.defineProperty(Module['ready'], '_wrenHasModule', { configurable: true, get: function() { abort('You are getting _wrenHasModule on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '_wrenHasModule', { configurable: true, set: function() { abort('You are setting _wrenHasModule on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '_wrenAbortFiber')) {\r\n        Object.defineProperty(Module['ready'], '_wrenAbortFiber', { configurable: true, get: function() { abort('You are getting _wrenAbortFiber on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '_wrenAbortFiber', { configurable: true, set: function() { abort('You are setting _wrenAbortFiber on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '_wrenGetUserData')) {\r\n        Object.defineProperty(Module['ready'], '_wrenGetUserData', { configurable: true, get: function() { abort('You are getting _wrenGetUserData on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '_wrenGetUserData', { configurable: true, set: function() { abort('You are setting _wrenGetUserData on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '_wrenSetUserData')) {\r\n        Object.defineProperty(Module['ready'], '_wrenSetUserData', { configurable: true, get: function() { abort('You are getting _wrenSetUserData on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '_wrenSetUserData', { configurable: true, set: function() { abort('You are setting _wrenSetUserData on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '_wrenAddImplicitImportModule')) {\r\n        Object.defineProperty(Module['ready'], '_wrenAddImplicitImportModule', { configurable: true, get: function() { abort('You are getting _wrenAddImplicitImportModule on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '_wrenAddImplicitImportModule', { configurable: true, set: function() { abort('You are setting _wrenAddImplicitImportModule on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '_emscripten_stack_get_end')) {\r\n        Object.defineProperty(Module['ready'], '_emscripten_stack_get_end', { configurable: true, get: function() { abort('You are getting _emscripten_stack_get_end on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '_emscripten_stack_get_end', { configurable: true, set: function() { abort('You are setting _emscripten_stack_get_end on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '_emscripten_stack_get_free')) {\r\n        Object.defineProperty(Module['ready'], '_emscripten_stack_get_free', { configurable: true, get: function() { abort('You are getting _emscripten_stack_get_free on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '_emscripten_stack_get_free', { configurable: true, set: function() { abort('You are setting _emscripten_stack_get_free on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '_emscripten_stack_init')) {\r\n        Object.defineProperty(Module['ready'], '_emscripten_stack_init', { configurable: true, get: function() { abort('You are getting _emscripten_stack_init on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '_emscripten_stack_init', { configurable: true, set: function() { abort('You are setting _emscripten_stack_init on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '_stackSave')) {\r\n        Object.defineProperty(Module['ready'], '_stackSave', { configurable: true, get: function() { abort('You are getting _stackSave on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '_stackSave', { configurable: true, set: function() { abort('You are setting _stackSave on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '_stackRestore')) {\r\n        Object.defineProperty(Module['ready'], '_stackRestore', { configurable: true, get: function() { abort('You are getting _stackRestore on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '_stackRestore', { configurable: true, set: function() { abort('You are setting _stackRestore on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '_stackAlloc')) {\r\n        Object.defineProperty(Module['ready'], '_stackAlloc', { configurable: true, get: function() { abort('You are getting _stackAlloc on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '_stackAlloc', { configurable: true, set: function() { abort('You are setting _stackAlloc on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '___wasm_call_ctors')) {\r\n        Object.defineProperty(Module['ready'], '___wasm_call_ctors', { configurable: true, get: function() { abort('You are getting ___wasm_call_ctors on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '___wasm_call_ctors', { configurable: true, set: function() { abort('You are setting ___wasm_call_ctors on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '___errno_location')) {\r\n        Object.defineProperty(Module['ready'], '___errno_location', { configurable: true, get: function() { abort('You are getting ___errno_location on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '___errno_location', { configurable: true, set: function() { abort('You are setting ___errno_location on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], 'onRuntimeInitialized')) {\r\n        Object.defineProperty(Module['ready'], 'onRuntimeInitialized', { configurable: true, get: function() { abort('You are getting onRuntimeInitialized on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], 'onRuntimeInitialized', { configurable: true, set: function() { abort('You are setting onRuntimeInitialized on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n// --pre-jses are emitted after the Module integration code, so that they can\r\n// refer to Module (if they choose; they can also define Module)\r\n\r\n// This file provides utilities to the inline EM_ASM JavaScript found in [shim.c]. \r\n\r\n/**\r\n * @param {string|ArrayBuffer|Uint8Array|undefined|null} src\r\n * @returns {number} The string's pointer\r\n */\r\nfunction mallocString(src) {\r\n\tif (!src) return 0;\r\n\tif (typeof src === \"string\") {\r\n\t\tvar len = lengthBytesUTF8(src) + 1;\r\n\t\tvar heapString = _malloc(len);\r\n\t\tstringToUTF8(src, heapString, len);\r\n\t\treturn heapString;\r\n\t} else {\r\n\t\tif (src instanceof ArrayBuffer) {\r\n\t\t\tsrc = new Uint8Array(src);\r\n\t\t}\r\n\t\r\n\t\tvar nullTerminated = src[src.length - 1] === 0;\r\n\t\tvar len = nullTerminated ? src.length : src.length + 1;\r\n\t\tvar heapString = _malloc(len);\r\n\t\r\n\t\tHEAPU8.set(src, heapString);\r\n\t\r\n\t\tif (!nullTerminated) {\r\n\t\t\tHEAPU8[ptr + len - 1] = 0;\r\n\t\t}\r\n\r\n\t\treturn heapString;\r\n\t}\r\n}\r\n\r\n\r\n// Sometimes an existing Module object exists with properties\r\n// meant to overwrite the default module functionality. Here\r\n// we collect those properties and reapply _after_ we configure\r\n// the current environment's defaults to avoid having to be so\r\n// defensive during initialization.\r\nvar moduleOverrides = {};\r\nvar key;\r\nfor (key in Module) {\r\n  if (Module.hasOwnProperty(key)) {\r\n    moduleOverrides[key] = Module[key];\r\n  }\r\n}\r\n\r\nvar arguments_ = [];\r\nvar thisProgram = './this.program';\r\nvar quit_ = function(status, toThrow) {\r\n  throw toThrow;\r\n};\r\n\r\n// Determine the runtime environment we are in. You can customize this by\r\n// setting the ENVIRONMENT setting at compile time (see settings.js).\r\n\r\nvar ENVIRONMENT_IS_WEB = true;\r\nvar ENVIRONMENT_IS_WORKER = false;\r\nvar ENVIRONMENT_IS_NODE = false;\r\nvar ENVIRONMENT_IS_SHELL = false;\r\n\r\nif (Module['ENVIRONMENT']) {\r\n  throw new Error('Module.ENVIRONMENT has been deprecated. To force the environment, use the ENVIRONMENT compile-time option (for example, -s ENVIRONMENT=web or -s ENVIRONMENT=node)');\r\n}\r\n\r\n// `/` should be present at the end if `scriptDirectory` is not empty\r\nvar scriptDirectory = '';\r\nfunction locateFile(path) {\r\n  return scriptDirectory + path;\r\n}\r\n\r\n// Hooks that are implemented differently in different runtime environments.\r\nvar read_,\r\n    readAsync,\r\n    readBinary,\r\n    setWindowTitle;\r\n\r\n// Normally we don't log exceptions but instead let them bubble out the top\r\n// level where the embedding environment (e.g. the browser) can handle\r\n// them.\r\n// However under v8 and node we sometimes exit the process direcly in which case\r\n// its up to use us to log the exception before exiting.\r\n// If we fix https://github.com/emscripten-core/emscripten/issues/15080\r\n// this may no longer be needed under node.\r\nfunction logExceptionOnExit(e) {\r\n  if (e instanceof ExitStatus) return;\r\n  var toLog = e;\r\n  if (e && typeof e === 'object' && e.stack) {\r\n    toLog = [e, e.stack];\r\n  }\r\n  err('exiting due to exception: ' + toLog);\r\n}\r\n\r\nif (ENVIRONMENT_IS_SHELL) {\r\n\r\n  if ((typeof process === 'object' && typeof require === 'function') || typeof window === 'object' || typeof importScripts === 'function') throw new Error('not compiled for this environment (did you build to HTML and try to run it not on the web, or set ENVIRONMENT to something - like node - and run it someplace else - like on the web?)');\r\n\r\n  if (typeof read != 'undefined') {\r\n    read_ = function shell_read(f) {\r\n      return read(f);\r\n    };\r\n  }\r\n\r\n  readBinary = function readBinary(f) {\r\n    var data;\r\n    if (typeof readbuffer === 'function') {\r\n      return new Uint8Array(readbuffer(f));\r\n    }\r\n    data = read(f, 'binary');\r\n    assert(typeof data === 'object');\r\n    return data;\r\n  };\r\n\r\n  readAsync = function readAsync(f, onload, onerror) {\r\n    setTimeout(function() { onload(readBinary(f)); }, 0);\r\n  };\r\n\r\n  if (typeof scriptArgs != 'undefined') {\r\n    arguments_ = scriptArgs;\r\n  } else if (typeof arguments != 'undefined') {\r\n    arguments_ = arguments;\r\n  }\r\n\r\n  if (typeof quit === 'function') {\r\n    quit_ = function(status, toThrow) {\r\n      logExceptionOnExit(toThrow);\r\n      quit(status);\r\n    };\r\n  }\r\n\r\n  if (typeof print !== 'undefined') {\r\n    // Prefer to use print/printErr where they exist, as they usually work better.\r\n    if (typeof console === 'undefined') console = /** @type{!Console} */({});\r\n    console.log = /** @type{!function(this:Console, ...*): undefined} */ (print);\r\n    console.warn = console.error = /** @type{!function(this:Console, ...*): undefined} */ (typeof printErr !== 'undefined' ? printErr : print);\r\n  }\r\n\r\n} else\r\n\r\n// Note that this includes Node.js workers when relevant (pthreads is enabled).\r\n// Node.js workers are detected as a combination of ENVIRONMENT_IS_WORKER and\r\n// ENVIRONMENT_IS_NODE.\r\nif (ENVIRONMENT_IS_WEB || ENVIRONMENT_IS_WORKER) {\r\n  if (ENVIRONMENT_IS_WORKER) { // Check worker, not web, since window could be polyfilled\r\n    scriptDirectory = self.location.href;\r\n  } else if (typeof document !== 'undefined' && document.currentScript) { // web\r\n    scriptDirectory = document.currentScript.src;\r\n  }\r\n  // When MODULARIZE, this JS may be executed later, after document.currentScript\r\n  // is gone, so we saved it, and we use it here instead of any other info.\r\n  if (_scriptDir) {\r\n    scriptDirectory = _scriptDir;\r\n  }\r\n  // blob urls look like blob:http://site.com/etc/etc and we cannot infer anything from them.\r\n  // otherwise, slice off the final part of the url to find the script directory.\r\n  // if scriptDirectory does not contain a slash, lastIndexOf will return -1,\r\n  // and scriptDirectory will correctly be replaced with an empty string.\r\n  // If scriptDirectory contains a query (starting with ?) or a fragment (starting with #),\r\n  // they are removed because they could contain a slash.\r\n  if (scriptDirectory.indexOf('blob:') !== 0) {\r\n    scriptDirectory = scriptDirectory.substr(0, scriptDirectory.replace(/[?#].*/, \"\").lastIndexOf('/')+1);\r\n  } else {\r\n    scriptDirectory = '';\r\n  }\r\n\r\n  if (!(typeof window === 'object' || typeof importScripts === 'function')) throw new Error('not compiled for this environment (did you build to HTML and try to run it not on the web, or set ENVIRONMENT to something - like node - and run it someplace else - like on the web?)');\r\n\r\n  // Differentiate the Web Worker from the Node Worker case, as reading must\r\n  // be done differently.\r\n  {\r\n\r\n// include: web_or_worker_shell_read.js\r\n\r\n\r\n  read_ = function(url) {\r\n      var xhr = new XMLHttpRequest();\r\n      xhr.open('GET', url, false);\r\n      xhr.send(null);\r\n      return xhr.responseText;\r\n  };\r\n\r\n  if (ENVIRONMENT_IS_WORKER) {\r\n    readBinary = function(url) {\r\n        var xhr = new XMLHttpRequest();\r\n        xhr.open('GET', url, false);\r\n        xhr.responseType = 'arraybuffer';\r\n        xhr.send(null);\r\n        return new Uint8Array(/** @type{!ArrayBuffer} */(xhr.response));\r\n    };\r\n  }\r\n\r\n  readAsync = function(url, onload, onerror) {\r\n    var xhr = new XMLHttpRequest();\r\n    xhr.open('GET', url, true);\r\n    xhr.responseType = 'arraybuffer';\r\n    xhr.onload = function() {\r\n      if (xhr.status == 200 || (xhr.status == 0 && xhr.response)) { // file URLs can return 0\r\n        onload(xhr.response);\r\n        return;\r\n      }\r\n      onerror();\r\n    };\r\n    xhr.onerror = onerror;\r\n    xhr.send(null);\r\n  };\r\n\r\n// end include: web_or_worker_shell_read.js\r\n  }\r\n\r\n  setWindowTitle = function(title) { document.title = title };\r\n} else\r\n{\r\n  throw new Error('environment detection error');\r\n}\r\n\r\nvar out = console.log.bind(console);\r\nvar err = console.warn.bind(console);\r\n\r\n// Merge back in the overrides\r\nfor (key in moduleOverrides) {\r\n  if (moduleOverrides.hasOwnProperty(key)) {\r\n    Module[key] = moduleOverrides[key];\r\n  }\r\n}\r\n// Free the object hierarchy contained in the overrides, this lets the GC\r\n// reclaim data used e.g. in memoryInitializerRequest, which is a large typed array.\r\nmoduleOverrides = null;\r\n\r\n// Emit code to handle expected values on the Module object. This applies Module.x\r\n// to the proper local x. This has two benefits: first, we only emit it if it is\r\n// expected to arrive, and second, by using a local everywhere else that can be\r\n// minified.\r\n\r\nif (!Object.getOwnPropertyDescriptor(Module, 'arguments')) {\r\n  Object.defineProperty(Module, 'arguments', {\r\n    configurable: true,\r\n    get: function() {\r\n      abort('Module.arguments has been replaced with plain arguments_ (the initial value can be provided on Module, but after startup the value is only looked for on a local variable of that name)')\r\n    }\r\n  });\r\n}\r\n\r\nif (!Object.getOwnPropertyDescriptor(Module, 'thisProgram')) {\r\n  Object.defineProperty(Module, 'thisProgram', {\r\n    configurable: true,\r\n    get: function() {\r\n      abort('Module.thisProgram has been replaced with plain thisProgram (the initial value can be provided on Module, but after startup the value is only looked for on a local variable of that name)')\r\n    }\r\n  });\r\n}\r\n\r\nif (!Object.getOwnPropertyDescriptor(Module, 'quit')) {\r\n  Object.defineProperty(Module, 'quit', {\r\n    configurable: true,\r\n    get: function() {\r\n      abort('Module.quit has been replaced with plain quit_ (the initial value can be provided on Module, but after startup the value is only looked for on a local variable of that name)')\r\n    }\r\n  });\r\n}\r\n\r\n// perform assertions in shell.js after we set up out() and err(), as otherwise if an assertion fails it cannot print the message\r\n// Assertions on removed incoming Module JS APIs.\r\nassert(typeof Module['memoryInitializerPrefixURL'] === 'undefined', 'Module.memoryInitializerPrefixURL option was removed, use Module.locateFile instead');\r\nassert(typeof Module['pthreadMainPrefixURL'] === 'undefined', 'Module.pthreadMainPrefixURL option was removed, use Module.locateFile instead');\r\nassert(typeof Module['cdInitializerPrefixURL'] === 'undefined', 'Module.cdInitializerPrefixURL option was removed, use Module.locateFile instead');\r\nassert(typeof Module['filePackagePrefixURL'] === 'undefined', 'Module.filePackagePrefixURL option was removed, use Module.locateFile instead');\r\nassert(typeof Module['read'] === 'undefined', 'Module.read option was removed (modify read_ in JS)');\r\nassert(typeof Module['readAsync'] === 'undefined', 'Module.readAsync option was removed (modify readAsync in JS)');\r\nassert(typeof Module['readBinary'] === 'undefined', 'Module.readBinary option was removed (modify readBinary in JS)');\r\nassert(typeof Module['setWindowTitle'] === 'undefined', 'Module.setWindowTitle option was removed (modify setWindowTitle in JS)');\r\nassert(typeof Module['TOTAL_MEMORY'] === 'undefined', 'Module.TOTAL_MEMORY has been renamed Module.INITIAL_MEMORY');\r\n\r\nif (!Object.getOwnPropertyDescriptor(Module, 'read')) {\r\n  Object.defineProperty(Module, 'read', {\r\n    configurable: true,\r\n    get: function() {\r\n      abort('Module.read has been replaced with plain read_ (the initial value can be provided on Module, but after startup the value is only looked for on a local variable of that name)')\r\n    }\r\n  });\r\n}\r\n\r\nif (!Object.getOwnPropertyDescriptor(Module, 'readAsync')) {\r\n  Object.defineProperty(Module, 'readAsync', {\r\n    configurable: true,\r\n    get: function() {\r\n      abort('Module.readAsync has been replaced with plain readAsync (the initial value can be provided on Module, but after startup the value is only looked for on a local variable of that name)')\r\n    }\r\n  });\r\n}\r\n\r\nif (!Object.getOwnPropertyDescriptor(Module, 'readBinary')) {\r\n  Object.defineProperty(Module, 'readBinary', {\r\n    configurable: true,\r\n    get: function() {\r\n      abort('Module.readBinary has been replaced with plain readBinary (the initial value can be provided on Module, but after startup the value is only looked for on a local variable of that name)')\r\n    }\r\n  });\r\n}\r\n\r\nif (!Object.getOwnPropertyDescriptor(Module, 'setWindowTitle')) {\r\n  Object.defineProperty(Module, 'setWindowTitle', {\r\n    configurable: true,\r\n    get: function() {\r\n      abort('Module.setWindowTitle has been replaced with plain setWindowTitle (the initial value can be provided on Module, but after startup the value is only looked for on a local variable of that name)')\r\n    }\r\n  });\r\n}\r\nvar IDBFS = 'IDBFS is no longer included by default; build with -lidbfs.js';\r\nvar PROXYFS = 'PROXYFS is no longer included by default; build with -lproxyfs.js';\r\nvar WORKERFS = 'WORKERFS is no longer included by default; build with -lworkerfs.js';\r\nvar NODEFS = 'NODEFS is no longer included by default; build with -lnodefs.js';\r\nfunction alignMemory() { abort('`alignMemory` is now a library function and not included by default; add it to your library.js __deps or to DEFAULT_LIBRARY_FUNCS_TO_INCLUDE on the command line'); }\r\n\r\nassert(!ENVIRONMENT_IS_WORKER, \"worker environment detected but not enabled at build time.  Add 'worker' to `-s ENVIRONMENT` to enable.\");\r\n\r\nassert(!ENVIRONMENT_IS_NODE, \"node environment detected but not enabled at build time.  Add 'node' to `-s ENVIRONMENT` to enable.\");\r\n\r\nassert(!ENVIRONMENT_IS_SHELL, \"shell environment detected but not enabled at build time.  Add 'shell' to `-s ENVIRONMENT` to enable.\");\r\n\r\n\r\n\r\n\r\nvar STACK_ALIGN = 16;\r\nvar POINTER_SIZE = 4;\r\n\r\nfunction getNativeTypeSize(type) {\r\n  switch (type) {\r\n    case 'i1': case 'i8': return 1;\r\n    case 'i16': return 2;\r\n    case 'i32': return 4;\r\n    case 'i64': return 8;\r\n    case 'float': return 4;\r\n    case 'double': return 8;\r\n    default: {\r\n      if (type[type.length-1] === '*') {\r\n        return POINTER_SIZE;\r\n      } else if (type[0] === 'i') {\r\n        var bits = Number(type.substr(1));\r\n        assert(bits % 8 === 0, 'getNativeTypeSize invalid bits ' + bits + ', type ' + type);\r\n        return bits / 8;\r\n      } else {\r\n        return 0;\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nfunction warnOnce(text) {\r\n  if (!warnOnce.shown) warnOnce.shown = {};\r\n  if (!warnOnce.shown[text]) {\r\n    warnOnce.shown[text] = 1;\r\n    err(text);\r\n  }\r\n}\r\n\r\n// include: runtime_functions.js\r\n\r\n\r\n// Wraps a JS function as a wasm function with a given signature.\r\nfunction convertJsFunctionToWasm(func, sig) {\r\n\r\n  // If the type reflection proposal is available, use the new\r\n  // \"WebAssembly.Function\" constructor.\r\n  // Otherwise, construct a minimal wasm module importing the JS function and\r\n  // re-exporting it.\r\n  if (typeof WebAssembly.Function === \"function\") {\r\n    var typeNames = {\r\n      'i': 'i32',\r\n      'j': 'i64',\r\n      'f': 'f32',\r\n      'd': 'f64'\r\n    };\r\n    var type = {\r\n      parameters: [],\r\n      results: sig[0] == 'v' ? [] : [typeNames[sig[0]]]\r\n    };\r\n    for (var i = 1; i < sig.length; ++i) {\r\n      type.parameters.push(typeNames[sig[i]]);\r\n    }\r\n    return new WebAssembly.Function(type, func);\r\n  }\r\n\r\n  // The module is static, with the exception of the type section, which is\r\n  // generated based on the signature passed in.\r\n  var typeSection = [\r\n    0x01, // id: section,\r\n    0x00, // length: 0 (placeholder)\r\n    0x01, // count: 1\r\n    0x60, // form: func\r\n  ];\r\n  var sigRet = sig.slice(0, 1);\r\n  var sigParam = sig.slice(1);\r\n  var typeCodes = {\r\n    'i': 0x7f, // i32\r\n    'j': 0x7e, // i64\r\n    'f': 0x7d, // f32\r\n    'd': 0x7c, // f64\r\n  };\r\n\r\n  // Parameters, length + signatures\r\n  typeSection.push(sigParam.length);\r\n  for (var i = 0; i < sigParam.length; ++i) {\r\n    typeSection.push(typeCodes[sigParam[i]]);\r\n  }\r\n\r\n  // Return values, length + signatures\r\n  // With no multi-return in MVP, either 0 (void) or 1 (anything else)\r\n  if (sigRet == 'v') {\r\n    typeSection.push(0x00);\r\n  } else {\r\n    typeSection = typeSection.concat([0x01, typeCodes[sigRet]]);\r\n  }\r\n\r\n  // Write the overall length of the type section back into the section header\r\n  // (excepting the 2 bytes for the section id and length)\r\n  typeSection[1] = typeSection.length - 2;\r\n\r\n  // Rest of the module is static\r\n  var bytes = new Uint8Array([\r\n    0x00, 0x61, 0x73, 0x6d, // magic (\"\\0asm\")\r\n    0x01, 0x00, 0x00, 0x00, // version: 1\r\n  ].concat(typeSection, [\r\n    0x02, 0x07, // import section\r\n      // (import \"e\" \"f\" (func 0 (type 0)))\r\n      0x01, 0x01, 0x65, 0x01, 0x66, 0x00, 0x00,\r\n    0x07, 0x05, // export section\r\n      // (export \"f\" (func 0 (type 0)))\r\n      0x01, 0x01, 0x66, 0x00, 0x00,\r\n  ]));\r\n\r\n   // We can compile this wasm module synchronously because it is very small.\r\n  // This accepts an import (at \"e.f\"), that it reroutes to an export (at \"f\")\r\n  var module = new WebAssembly.Module(bytes);\r\n  var instance = new WebAssembly.Instance(module, {\r\n    'e': {\r\n      'f': func\r\n    }\r\n  });\r\n  var wrappedFunc = instance.exports['f'];\r\n  return wrappedFunc;\r\n}\r\n\r\nvar freeTableIndexes = [];\r\n\r\n// Weak map of functions in the table to their indexes, created on first use.\r\nvar functionsInTableMap;\r\n\r\nfunction getEmptyTableSlot() {\r\n  // Reuse a free index if there is one, otherwise grow.\r\n  if (freeTableIndexes.length) {\r\n    return freeTableIndexes.pop();\r\n  }\r\n  // Grow the table\r\n  try {\r\n    wasmTable.grow(1);\r\n  } catch (err) {\r\n    if (!(err instanceof RangeError)) {\r\n      throw err;\r\n    }\r\n    throw 'Unable to grow wasm table. Set ALLOW_TABLE_GROWTH.';\r\n  }\r\n  return wasmTable.length - 1;\r\n}\r\n\r\nfunction updateTableMap(offset, count) {\r\n  for (var i = offset; i < offset + count; i++) {\r\n    var item = getWasmTableEntry(i);\r\n    // Ignore null values.\r\n    if (item) {\r\n      functionsInTableMap.set(item, i);\r\n    }\r\n  }\r\n}\r\n\r\n// Add a function to the table.\r\n// 'sig' parameter is required if the function being added is a JS function.\r\nfunction addFunction(func, sig) {\r\n  assert(typeof func !== 'undefined');\r\n\r\n  // Check if the function is already in the table, to ensure each function\r\n  // gets a unique index. First, create the map if this is the first use.\r\n  if (!functionsInTableMap) {\r\n    functionsInTableMap = new WeakMap();\r\n    updateTableMap(0, wasmTable.length);\r\n  }\r\n  if (functionsInTableMap.has(func)) {\r\n    return functionsInTableMap.get(func);\r\n  }\r\n\r\n  // It's not in the table, add it now.\r\n\r\n  var ret = getEmptyTableSlot();\r\n\r\n  // Set the new value.\r\n  try {\r\n    // Attempting to call this with JS function will cause of table.set() to fail\r\n    setWasmTableEntry(ret, func);\r\n  } catch (err) {\r\n    if (!(err instanceof TypeError)) {\r\n      throw err;\r\n    }\r\n    assert(typeof sig !== 'undefined', 'Missing signature argument to addFunction: ' + func);\r\n    var wrapped = convertJsFunctionToWasm(func, sig);\r\n    setWasmTableEntry(ret, wrapped);\r\n  }\r\n\r\n  functionsInTableMap.set(func, ret);\r\n\r\n  return ret;\r\n}\r\n\r\nfunction removeFunction(index) {\r\n  functionsInTableMap.delete(getWasmTableEntry(index));\r\n  freeTableIndexes.push(index);\r\n}\r\n\r\n// end include: runtime_functions.js\r\n// include: runtime_debug.js\r\n\r\n\r\n// end include: runtime_debug.js\r\nvar tempRet0 = 0;\r\n\r\nvar setTempRet0 = function(value) {\r\n  tempRet0 = value;\r\n};\r\n\r\nvar getTempRet0 = function() {\r\n  return tempRet0;\r\n};\r\n\r\n\r\n\r\n// === Preamble library stuff ===\r\n\r\n// Documentation for the public APIs defined in this file must be updated in:\r\n//    site/source/docs/api_reference/preamble.js.rst\r\n// A prebuilt local version of the documentation is available at:\r\n//    site/build/text/docs/api_reference/preamble.js.txt\r\n// You can also build docs locally as HTML or other formats in site/\r\n// An online HTML version (which may be of a different version of Emscripten)\r\n//    is up at http://kripken.github.io/emscripten-site/docs/api_reference/preamble.js.html\r\n\r\nvar wasmBinary;\r\nif (!Object.getOwnPropertyDescriptor(Module, 'wasmBinary')) {\r\n  Object.defineProperty(Module, 'wasmBinary', {\r\n    configurable: true,\r\n    get: function() {\r\n      abort('Module.wasmBinary has been replaced with plain wasmBinary (the initial value can be provided on Module, but after startup the value is only looked for on a local variable of that name)')\r\n    }\r\n  });\r\n}\r\nvar noExitRuntime = true;\r\nif (!Object.getOwnPropertyDescriptor(Module, 'noExitRuntime')) {\r\n  Object.defineProperty(Module, 'noExitRuntime', {\r\n    configurable: true,\r\n    get: function() {\r\n      abort('Module.noExitRuntime has been replaced with plain noExitRuntime (the initial value can be provided on Module, but after startup the value is only looked for on a local variable of that name)')\r\n    }\r\n  });\r\n}\r\n\r\nif (typeof WebAssembly !== 'object') {\r\n  abort('no native wasm support detected');\r\n}\r\n\r\n// include: runtime_safe_heap.js\r\n\r\n\r\n// In MINIMAL_RUNTIME, setValue() and getValue() are only available when building with safe heap enabled, for heap safety checking.\r\n// In traditional runtime, setValue() and getValue() are always available (although their use is highly discouraged due to perf penalties)\r\n\r\n/** @param {number} ptr\r\n    @param {number} value\r\n    @param {string} type\r\n    @param {number|boolean=} noSafe */\r\nfunction setValue(ptr, value, type, noSafe) {\r\n  type = type || 'i8';\r\n  if (type.charAt(type.length-1) === '*') type = 'i32';\r\n    switch (type) {\r\n      case 'i1': HEAP8[((ptr)>>0)] = value; break;\r\n      case 'i8': HEAP8[((ptr)>>0)] = value; break;\r\n      case 'i16': HEAP16[((ptr)>>1)] = value; break;\r\n      case 'i32': HEAP32[((ptr)>>2)] = value; break;\r\n      case 'i64': (tempI64 = [value>>>0,(tempDouble=value,(+(Math.abs(tempDouble))) >= 1.0 ? (tempDouble > 0.0 ? ((Math.min((+(Math.floor((tempDouble)/4294967296.0))), 4294967295.0))|0)>>>0 : (~~((+(Math.ceil((tempDouble - +(((~~(tempDouble)))>>>0))/4294967296.0)))))>>>0) : 0)],HEAP32[((ptr)>>2)] = tempI64[0],HEAP32[(((ptr)+(4))>>2)] = tempI64[1]); break;\r\n      case 'float': HEAPF32[((ptr)>>2)] = value; break;\r\n      case 'double': HEAPF64[((ptr)>>3)] = value; break;\r\n      default: abort('invalid type for setValue: ' + type);\r\n    }\r\n}\r\n\r\n/** @param {number} ptr\r\n    @param {string} type\r\n    @param {number|boolean=} noSafe */\r\nfunction getValue(ptr, type, noSafe) {\r\n  type = type || 'i8';\r\n  if (type.charAt(type.length-1) === '*') type = 'i32';\r\n    switch (type) {\r\n      case 'i1': return HEAP8[((ptr)>>0)];\r\n      case 'i8': return HEAP8[((ptr)>>0)];\r\n      case 'i16': return HEAP16[((ptr)>>1)];\r\n      case 'i32': return HEAP32[((ptr)>>2)];\r\n      case 'i64': return HEAP32[((ptr)>>2)];\r\n      case 'float': return HEAPF32[((ptr)>>2)];\r\n      case 'double': return Number(HEAPF64[((ptr)>>3)]);\r\n      default: abort('invalid type for getValue: ' + type);\r\n    }\r\n  return null;\r\n}\r\n\r\n// end include: runtime_safe_heap.js\r\n// Wasm globals\r\n\r\nvar wasmMemory;\r\n\r\n//========================================\r\n// Runtime essentials\r\n//========================================\r\n\r\n// whether we are quitting the application. no code should run after this.\r\n// set in exit() and abort()\r\nvar ABORT = false;\r\n\r\n// set by exit() and abort().  Passed to 'onExit' handler.\r\n// NOTE: This is also used as the process return code code in shell environments\r\n// but only when noExitRuntime is false.\r\nvar EXITSTATUS;\r\n\r\n/** @type {function(*, string=)} */\r\nfunction assert(condition, text) {\r\n  if (!condition) {\r\n    abort('Assertion failed: ' + text);\r\n  }\r\n}\r\n\r\n// Returns the C function with a specified identifier (for C++, you need to do manual name mangling)\r\nfunction getCFunc(ident) {\r\n  var func = Module['_' + ident]; // closure exported function\r\n  assert(func, 'Cannot call unknown function ' + ident + ', make sure it is exported');\r\n  return func;\r\n}\r\n\r\n// C calling interface.\r\n/** @param {string|null=} returnType\r\n    @param {Array=} argTypes\r\n    @param {Arguments|Array=} args\r\n    @param {Object=} opts */\r\nfunction ccall(ident, returnType, argTypes, args, opts) {\r\n  // For fast lookup of conversion functions\r\n  var toC = {\r\n    'string': function(str) {\r\n      var ret = 0;\r\n      if (str !== null && str !== undefined && str !== 0) { // null string\r\n        // at most 4 bytes per UTF-8 code point, +1 for the trailing '\\0'\r\n        var len = (str.length << 2) + 1;\r\n        ret = stackAlloc(len);\r\n        stringToUTF8(str, ret, len);\r\n      }\r\n      return ret;\r\n    },\r\n    'array': function(arr) {\r\n      var ret = stackAlloc(arr.length);\r\n      writeArrayToMemory(arr, ret);\r\n      return ret;\r\n    }\r\n  };\r\n\r\n  function convertReturnValue(ret) {\r\n    if (returnType === 'string') return UTF8ToString(ret);\r\n    if (returnType === 'boolean') return Boolean(ret);\r\n    return ret;\r\n  }\r\n\r\n  var func = getCFunc(ident);\r\n  var cArgs = [];\r\n  var stack = 0;\r\n  assert(returnType !== 'array', 'Return type should not be \"array\".');\r\n  if (args) {\r\n    for (var i = 0; i < args.length; i++) {\r\n      var converter = toC[argTypes[i]];\r\n      if (converter) {\r\n        if (stack === 0) stack = stackSave();\r\n        cArgs[i] = converter(args[i]);\r\n      } else {\r\n        cArgs[i] = args[i];\r\n      }\r\n    }\r\n  }\r\n  var ret = func.apply(null, cArgs);\r\n  function onDone(ret) {\r\n    if (stack !== 0) stackRestore(stack);\r\n    return convertReturnValue(ret);\r\n  }\r\n\r\n  ret = onDone(ret);\r\n  return ret;\r\n}\r\n\r\n/** @param {string=} returnType\r\n    @param {Array=} argTypes\r\n    @param {Object=} opts */\r\nfunction cwrap(ident, returnType, argTypes, opts) {\r\n  return function() {\r\n    return ccall(ident, returnType, argTypes, arguments, opts);\r\n  }\r\n}\r\n\r\n// We used to include malloc/free by default in the past. Show a helpful error in\r\n// builds with assertions.\r\n\r\nvar ALLOC_NORMAL = 0; // Tries to use _malloc()\r\nvar ALLOC_STACK = 1; // Lives for the duration of the current function call\r\n\r\n// allocate(): This is for internal use. You can use it yourself as well, but the interface\r\n//             is a little tricky (see docs right below). The reason is that it is optimized\r\n//             for multiple syntaxes to save space in generated code. So you should\r\n//             normally not use allocate(), and instead allocate memory using _malloc(),\r\n//             initialize it with setValue(), and so forth.\r\n// @slab: An array of data.\r\n// @allocator: How to allocate memory, see ALLOC_*\r\n/** @type {function((Uint8Array|Array<number>), number)} */\r\nfunction allocate(slab, allocator) {\r\n  var ret;\r\n  assert(typeof allocator === 'number', 'allocate no longer takes a type argument')\r\n  assert(typeof slab !== 'number', 'allocate no longer takes a number as arg0')\r\n\r\n  if (allocator == ALLOC_STACK) {\r\n    ret = stackAlloc(slab.length);\r\n  } else {\r\n    ret = _malloc(slab.length);\r\n  }\r\n\r\n  if (slab.subarray || slab.slice) {\r\n    HEAPU8.set(/** @type {!Uint8Array} */(slab), ret);\r\n  } else {\r\n    HEAPU8.set(new Uint8Array(slab), ret);\r\n  }\r\n  return ret;\r\n}\r\n\r\n// include: runtime_strings.js\r\n\r\n\r\n// runtime_strings.js: Strings related runtime functions that are part of both MINIMAL_RUNTIME and regular runtime.\r\n\r\n// Given a pointer 'ptr' to a null-terminated UTF8-encoded string in the given array that contains uint8 values, returns\r\n// a copy of that string as a Javascript String object.\r\n\r\nvar UTF8Decoder = typeof TextDecoder !== 'undefined' ? new TextDecoder('utf8') : undefined;\r\n\r\n/**\r\n * @param {number} idx\r\n * @param {number=} maxBytesToRead\r\n * @return {string}\r\n */\r\nfunction UTF8ArrayToString(heap, idx, maxBytesToRead) {\r\n  var endIdx = idx + maxBytesToRead;\r\n  var endPtr = idx;\r\n  // TextDecoder needs to know the byte length in advance, it doesn't stop on null terminator by itself.\r\n  // Also, use the length info to avoid running tiny strings through TextDecoder, since .subarray() allocates garbage.\r\n  // (As a tiny code save trick, compare endPtr against endIdx using a negation, so that undefined means Infinity)\r\n  while (heap[endPtr] && !(endPtr >= endIdx)) ++endPtr;\r\n\r\n  if (endPtr - idx > 16 && heap.subarray && UTF8Decoder) {\r\n    return UTF8Decoder.decode(heap.subarray(idx, endPtr));\r\n  } else {\r\n    var str = '';\r\n    // If building with TextDecoder, we have already computed the string length above, so test loop end condition against that\r\n    while (idx < endPtr) {\r\n      // For UTF8 byte structure, see:\r\n      // http://en.wikipedia.org/wiki/UTF-8#Description\r\n      // https://www.ietf.org/rfc/rfc2279.txt\r\n      // https://tools.ietf.org/html/rfc3629\r\n      var u0 = heap[idx++];\r\n      if (!(u0 & 0x80)) { str += String.fromCharCode(u0); continue; }\r\n      var u1 = heap[idx++] & 63;\r\n      if ((u0 & 0xE0) == 0xC0) { str += String.fromCharCode(((u0 & 31) << 6) | u1); continue; }\r\n      var u2 = heap[idx++] & 63;\r\n      if ((u0 & 0xF0) == 0xE0) {\r\n        u0 = ((u0 & 15) << 12) | (u1 << 6) | u2;\r\n      } else {\r\n        if ((u0 & 0xF8) != 0xF0) warnOnce('Invalid UTF-8 leading byte 0x' + u0.toString(16) + ' encountered when deserializing a UTF-8 string in wasm memory to a JS string!');\r\n        u0 = ((u0 & 7) << 18) | (u1 << 12) | (u2 << 6) | (heap[idx++] & 63);\r\n      }\r\n\r\n      if (u0 < 0x10000) {\r\n        str += String.fromCharCode(u0);\r\n      } else {\r\n        var ch = u0 - 0x10000;\r\n        str += String.fromCharCode(0xD800 | (ch >> 10), 0xDC00 | (ch & 0x3FF));\r\n      }\r\n    }\r\n  }\r\n  return str;\r\n}\r\n\r\n// Given a pointer 'ptr' to a null-terminated UTF8-encoded string in the emscripten HEAP, returns a\r\n// copy of that string as a Javascript String object.\r\n// maxBytesToRead: an optional length that specifies the maximum number of bytes to read. You can omit\r\n//                 this parameter to scan the string until the first \\0 byte. If maxBytesToRead is\r\n//                 passed, and the string at [ptr, ptr+maxBytesToReadr[ contains a null byte in the\r\n//                 middle, then the string will cut short at that byte index (i.e. maxBytesToRead will\r\n//                 not produce a string of exact length [ptr, ptr+maxBytesToRead[)\r\n//                 N.B. mixing frequent uses of UTF8ToString() with and without maxBytesToRead may\r\n//                 throw JS JIT optimizations off, so it is worth to consider consistently using one\r\n//                 style or the other.\r\n/**\r\n * @param {number} ptr\r\n * @param {number=} maxBytesToRead\r\n * @return {string}\r\n */\r\nfunction UTF8ToString(ptr, maxBytesToRead) {\r\n  ;\r\n  return ptr ? UTF8ArrayToString(HEAPU8, ptr, maxBytesToRead) : '';\r\n}\r\n\r\n// Copies the given Javascript String object 'str' to the given byte array at address 'outIdx',\r\n// encoded in UTF8 form and null-terminated. The copy will require at most str.length*4+1 bytes of space in the HEAP.\r\n// Use the function lengthBytesUTF8 to compute the exact number of bytes (excluding null terminator) that this function will write.\r\n// Parameters:\r\n//   str: the Javascript string to copy.\r\n//   heap: the array to copy to. Each index in this array is assumed to be one 8-byte element.\r\n//   outIdx: The starting offset in the array to begin the copying.\r\n//   maxBytesToWrite: The maximum number of bytes this function can write to the array.\r\n//                    This count should include the null terminator,\r\n//                    i.e. if maxBytesToWrite=1, only the null terminator will be written and nothing else.\r\n//                    maxBytesToWrite=0 does not write any bytes to the output, not even the null terminator.\r\n// Returns the number of bytes written, EXCLUDING the null terminator.\r\n\r\nfunction stringToUTF8Array(str, heap, outIdx, maxBytesToWrite) {\r\n  if (!(maxBytesToWrite > 0)) // Parameter maxBytesToWrite is not optional. Negative values, 0, null, undefined and false each don't write out any bytes.\r\n    return 0;\r\n\r\n  var startIdx = outIdx;\r\n  var endIdx = outIdx + maxBytesToWrite - 1; // -1 for string null terminator.\r\n  for (var i = 0; i < str.length; ++i) {\r\n    // Gotcha: charCodeAt returns a 16-bit word that is a UTF-16 encoded code unit, not a Unicode code point of the character! So decode UTF16->UTF32->UTF8.\r\n    // See http://unicode.org/faq/utf_bom.html#utf16-3\r\n    // For UTF8 byte structure, see http://en.wikipedia.org/wiki/UTF-8#Description and https://www.ietf.org/rfc/rfc2279.txt and https://tools.ietf.org/html/rfc3629\r\n    var u = str.charCodeAt(i); // possibly a lead surrogate\r\n    if (u >= 0xD800 && u <= 0xDFFF) {\r\n      var u1 = str.charCodeAt(++i);\r\n      u = 0x10000 + ((u & 0x3FF) << 10) | (u1 & 0x3FF);\r\n    }\r\n    if (u <= 0x7F) {\r\n      if (outIdx >= endIdx) break;\r\n      heap[outIdx++] = u;\r\n    } else if (u <= 0x7FF) {\r\n      if (outIdx + 1 >= endIdx) break;\r\n      heap[outIdx++] = 0xC0 | (u >> 6);\r\n      heap[outIdx++] = 0x80 | (u & 63);\r\n    } else if (u <= 0xFFFF) {\r\n      if (outIdx + 2 >= endIdx) break;\r\n      heap[outIdx++] = 0xE0 | (u >> 12);\r\n      heap[outIdx++] = 0x80 | ((u >> 6) & 63);\r\n      heap[outIdx++] = 0x80 | (u & 63);\r\n    } else {\r\n      if (outIdx + 3 >= endIdx) break;\r\n      if (u > 0x10FFFF) warnOnce('Invalid Unicode code point 0x' + u.toString(16) + ' encountered when serializing a JS string to a UTF-8 string in wasm memory! (Valid unicode code points should be in range 0-0x10FFFF).');\r\n      heap[outIdx++] = 0xF0 | (u >> 18);\r\n      heap[outIdx++] = 0x80 | ((u >> 12) & 63);\r\n      heap[outIdx++] = 0x80 | ((u >> 6) & 63);\r\n      heap[outIdx++] = 0x80 | (u & 63);\r\n    }\r\n  }\r\n  // Null-terminate the pointer to the buffer.\r\n  heap[outIdx] = 0;\r\n  return outIdx - startIdx;\r\n}\r\n\r\n// Copies the given Javascript String object 'str' to the emscripten HEAP at address 'outPtr',\r\n// null-terminated and encoded in UTF8 form. The copy will require at most str.length*4+1 bytes of space in the HEAP.\r\n// Use the function lengthBytesUTF8 to compute the exact number of bytes (excluding null terminator) that this function will write.\r\n// Returns the number of bytes written, EXCLUDING the null terminator.\r\n\r\nfunction stringToUTF8(str, outPtr, maxBytesToWrite) {\r\n  assert(typeof maxBytesToWrite == 'number', 'stringToUTF8(str, outPtr, maxBytesToWrite) is missing the third parameter that specifies the length of the output buffer!');\r\n  return stringToUTF8Array(str, HEAPU8,outPtr, maxBytesToWrite);\r\n}\r\n\r\n// Returns the number of bytes the given Javascript string takes if encoded as a UTF8 byte array, EXCLUDING the null terminator byte.\r\nfunction lengthBytesUTF8(str) {\r\n  var len = 0;\r\n  for (var i = 0; i < str.length; ++i) {\r\n    // Gotcha: charCodeAt returns a 16-bit word that is a UTF-16 encoded code unit, not a Unicode code point of the character! So decode UTF16->UTF32->UTF8.\r\n    // See http://unicode.org/faq/utf_bom.html#utf16-3\r\n    var u = str.charCodeAt(i); // possibly a lead surrogate\r\n    if (u >= 0xD800 && u <= 0xDFFF) u = 0x10000 + ((u & 0x3FF) << 10) | (str.charCodeAt(++i) & 0x3FF);\r\n    if (u <= 0x7F) ++len;\r\n    else if (u <= 0x7FF) len += 2;\r\n    else if (u <= 0xFFFF) len += 3;\r\n    else len += 4;\r\n  }\r\n  return len;\r\n}\r\n\r\n// end include: runtime_strings.js\r\n// include: runtime_strings_extra.js\r\n\r\n\r\n// runtime_strings_extra.js: Strings related runtime functions that are available only in regular runtime.\r\n\r\n// Given a pointer 'ptr' to a null-terminated ASCII-encoded string in the emscripten HEAP, returns\r\n// a copy of that string as a Javascript String object.\r\n\r\nfunction AsciiToString(ptr) {\r\n  var str = '';\r\n  while (1) {\r\n    var ch = HEAPU8[((ptr++)>>0)];\r\n    if (!ch) return str;\r\n    str += String.fromCharCode(ch);\r\n  }\r\n}\r\n\r\n// Copies the given Javascript String object 'str' to the emscripten HEAP at address 'outPtr',\r\n// null-terminated and encoded in ASCII form. The copy will require at most str.length+1 bytes of space in the HEAP.\r\n\r\nfunction stringToAscii(str, outPtr) {\r\n  return writeAsciiToMemory(str, outPtr, false);\r\n}\r\n\r\n// Given a pointer 'ptr' to a null-terminated UTF16LE-encoded string in the emscripten HEAP, returns\r\n// a copy of that string as a Javascript String object.\r\n\r\nvar UTF16Decoder = typeof TextDecoder !== 'undefined' ? new TextDecoder('utf-16le') : undefined;\r\n\r\nfunction UTF16ToString(ptr, maxBytesToRead) {\r\n  assert(ptr % 2 == 0, 'Pointer passed to UTF16ToString must be aligned to two bytes!');\r\n  var endPtr = ptr;\r\n  // TextDecoder needs to know the byte length in advance, it doesn't stop on null terminator by itself.\r\n  // Also, use the length info to avoid running tiny strings through TextDecoder, since .subarray() allocates garbage.\r\n  var idx = endPtr >> 1;\r\n  var maxIdx = idx + maxBytesToRead / 2;\r\n  // If maxBytesToRead is not passed explicitly, it will be undefined, and this\r\n  // will always evaluate to true. This saves on code size.\r\n  while (!(idx >= maxIdx) && HEAPU16[idx]) ++idx;\r\n  endPtr = idx << 1;\r\n\r\n  if (endPtr - ptr > 32 && UTF16Decoder) {\r\n    return UTF16Decoder.decode(HEAPU8.subarray(ptr, endPtr));\r\n  } else {\r\n    var str = '';\r\n\r\n    // If maxBytesToRead is not passed explicitly, it will be undefined, and the for-loop's condition\r\n    // will always evaluate to true. The loop is then terminated on the first null char.\r\n    for (var i = 0; !(i >= maxBytesToRead / 2); ++i) {\r\n      var codeUnit = HEAP16[(((ptr)+(i*2))>>1)];\r\n      if (codeUnit == 0) break;\r\n      // fromCharCode constructs a character from a UTF-16 code unit, so we can pass the UTF16 string right through.\r\n      str += String.fromCharCode(codeUnit);\r\n    }\r\n\r\n    return str;\r\n  }\r\n}\r\n\r\n// Copies the given Javascript String object 'str' to the emscripten HEAP at address 'outPtr',\r\n// null-terminated and encoded in UTF16 form. The copy will require at most str.length*4+2 bytes of space in the HEAP.\r\n// Use the function lengthBytesUTF16() to compute the exact number of bytes (excluding null terminator) that this function will write.\r\n// Parameters:\r\n//   str: the Javascript string to copy.\r\n//   outPtr: Byte address in Emscripten HEAP where to write the string to.\r\n//   maxBytesToWrite: The maximum number of bytes this function can write to the array. This count should include the null\r\n//                    terminator, i.e. if maxBytesToWrite=2, only the null terminator will be written and nothing else.\r\n//                    maxBytesToWrite<2 does not write any bytes to the output, not even the null terminator.\r\n// Returns the number of bytes written, EXCLUDING the null terminator.\r\n\r\nfunction stringToUTF16(str, outPtr, maxBytesToWrite) {\r\n  assert(outPtr % 2 == 0, 'Pointer passed to stringToUTF16 must be aligned to two bytes!');\r\n  assert(typeof maxBytesToWrite == 'number', 'stringToUTF16(str, outPtr, maxBytesToWrite) is missing the third parameter that specifies the length of the output buffer!');\r\n  // Backwards compatibility: if max bytes is not specified, assume unsafe unbounded write is allowed.\r\n  if (maxBytesToWrite === undefined) {\r\n    maxBytesToWrite = 0x7FFFFFFF;\r\n  }\r\n  if (maxBytesToWrite < 2) return 0;\r\n  maxBytesToWrite -= 2; // Null terminator.\r\n  var startPtr = outPtr;\r\n  var numCharsToWrite = (maxBytesToWrite < str.length*2) ? (maxBytesToWrite / 2) : str.length;\r\n  for (var i = 0; i < numCharsToWrite; ++i) {\r\n    // charCodeAt returns a UTF-16 encoded code unit, so it can be directly written to the HEAP.\r\n    var codeUnit = str.charCodeAt(i); // possibly a lead surrogate\r\n    HEAP16[((outPtr)>>1)] = codeUnit;\r\n    outPtr += 2;\r\n  }\r\n  // Null-terminate the pointer to the HEAP.\r\n  HEAP16[((outPtr)>>1)] = 0;\r\n  return outPtr - startPtr;\r\n}\r\n\r\n// Returns the number of bytes the given Javascript string takes if encoded as a UTF16 byte array, EXCLUDING the null terminator byte.\r\n\r\nfunction lengthBytesUTF16(str) {\r\n  return str.length*2;\r\n}\r\n\r\nfunction UTF32ToString(ptr, maxBytesToRead) {\r\n  assert(ptr % 4 == 0, 'Pointer passed to UTF32ToString must be aligned to four bytes!');\r\n  var i = 0;\r\n\r\n  var str = '';\r\n  // If maxBytesToRead is not passed explicitly, it will be undefined, and this\r\n  // will always evaluate to true. This saves on code size.\r\n  while (!(i >= maxBytesToRead / 4)) {\r\n    var utf32 = HEAP32[(((ptr)+(i*4))>>2)];\r\n    if (utf32 == 0) break;\r\n    ++i;\r\n    // Gotcha: fromCharCode constructs a character from a UTF-16 encoded code (pair), not from a Unicode code point! So encode the code point to UTF-16 for constructing.\r\n    // See http://unicode.org/faq/utf_bom.html#utf16-3\r\n    if (utf32 >= 0x10000) {\r\n      var ch = utf32 - 0x10000;\r\n      str += String.fromCharCode(0xD800 | (ch >> 10), 0xDC00 | (ch & 0x3FF));\r\n    } else {\r\n      str += String.fromCharCode(utf32);\r\n    }\r\n  }\r\n  return str;\r\n}\r\n\r\n// Copies the given Javascript String object 'str' to the emscripten HEAP at address 'outPtr',\r\n// null-terminated and encoded in UTF32 form. The copy will require at most str.length*4+4 bytes of space in the HEAP.\r\n// Use the function lengthBytesUTF32() to compute the exact number of bytes (excluding null terminator) that this function will write.\r\n// Parameters:\r\n//   str: the Javascript string to copy.\r\n//   outPtr: Byte address in Emscripten HEAP where to write the string to.\r\n//   maxBytesToWrite: The maximum number of bytes this function can write to the array. This count should include the null\r\n//                    terminator, i.e. if maxBytesToWrite=4, only the null terminator will be written and nothing else.\r\n//                    maxBytesToWrite<4 does not write any bytes to the output, not even the null terminator.\r\n// Returns the number of bytes written, EXCLUDING the null terminator.\r\n\r\nfunction stringToUTF32(str, outPtr, maxBytesToWrite) {\r\n  assert(outPtr % 4 == 0, 'Pointer passed to stringToUTF32 must be aligned to four bytes!');\r\n  assert(typeof maxBytesToWrite == 'number', 'stringToUTF32(str, outPtr, maxBytesToWrite) is missing the third parameter that specifies the length of the output buffer!');\r\n  // Backwards compatibility: if max bytes is not specified, assume unsafe unbounded write is allowed.\r\n  if (maxBytesToWrite === undefined) {\r\n    maxBytesToWrite = 0x7FFFFFFF;\r\n  }\r\n  if (maxBytesToWrite < 4) return 0;\r\n  var startPtr = outPtr;\r\n  var endPtr = startPtr + maxBytesToWrite - 4;\r\n  for (var i = 0; i < str.length; ++i) {\r\n    // Gotcha: charCodeAt returns a 16-bit word that is a UTF-16 encoded code unit, not a Unicode code point of the character! We must decode the string to UTF-32 to the heap.\r\n    // See http://unicode.org/faq/utf_bom.html#utf16-3\r\n    var codeUnit = str.charCodeAt(i); // possibly a lead surrogate\r\n    if (codeUnit >= 0xD800 && codeUnit <= 0xDFFF) {\r\n      var trailSurrogate = str.charCodeAt(++i);\r\n      codeUnit = 0x10000 + ((codeUnit & 0x3FF) << 10) | (trailSurrogate & 0x3FF);\r\n    }\r\n    HEAP32[((outPtr)>>2)] = codeUnit;\r\n    outPtr += 4;\r\n    if (outPtr + 4 > endPtr) break;\r\n  }\r\n  // Null-terminate the pointer to the HEAP.\r\n  HEAP32[((outPtr)>>2)] = 0;\r\n  return outPtr - startPtr;\r\n}\r\n\r\n// Returns the number of bytes the given Javascript string takes if encoded as a UTF16 byte array, EXCLUDING the null terminator byte.\r\n\r\nfunction lengthBytesUTF32(str) {\r\n  var len = 0;\r\n  for (var i = 0; i < str.length; ++i) {\r\n    // Gotcha: charCodeAt returns a 16-bit word that is a UTF-16 encoded code unit, not a Unicode code point of the character! We must decode the string to UTF-32 to the heap.\r\n    // See http://unicode.org/faq/utf_bom.html#utf16-3\r\n    var codeUnit = str.charCodeAt(i);\r\n    if (codeUnit >= 0xD800 && codeUnit <= 0xDFFF) ++i; // possibly a lead surrogate, so skip over the tail surrogate.\r\n    len += 4;\r\n  }\r\n\r\n  return len;\r\n}\r\n\r\n// Allocate heap space for a JS string, and write it there.\r\n// It is the responsibility of the caller to free() that memory.\r\nfunction allocateUTF8(str) {\r\n  var size = lengthBytesUTF8(str) + 1;\r\n  var ret = _malloc(size);\r\n  if (ret) stringToUTF8Array(str, HEAP8, ret, size);\r\n  return ret;\r\n}\r\n\r\n// Allocate stack space for a JS string, and write it there.\r\nfunction allocateUTF8OnStack(str) {\r\n  var size = lengthBytesUTF8(str) + 1;\r\n  var ret = stackAlloc(size);\r\n  stringToUTF8Array(str, HEAP8, ret, size);\r\n  return ret;\r\n}\r\n\r\n// Deprecated: This function should not be called because it is unsafe and does not provide\r\n// a maximum length limit of how many bytes it is allowed to write. Prefer calling the\r\n// function stringToUTF8Array() instead, which takes in a maximum length that can be used\r\n// to be secure from out of bounds writes.\r\n/** @deprecated\r\n    @param {boolean=} dontAddNull */\r\nfunction writeStringToMemory(string, buffer, dontAddNull) {\r\n  warnOnce('writeStringToMemory is deprecated and should not be called! Use stringToUTF8() instead!');\r\n\r\n  var /** @type {number} */ lastChar, /** @type {number} */ end;\r\n  if (dontAddNull) {\r\n    // stringToUTF8Array always appends null. If we don't want to do that, remember the\r\n    // character that existed at the location where the null will be placed, and restore\r\n    // that after the write (below).\r\n    end = buffer + lengthBytesUTF8(string);\r\n    lastChar = HEAP8[end];\r\n  }\r\n  stringToUTF8(string, buffer, Infinity);\r\n  if (dontAddNull) HEAP8[end] = lastChar; // Restore the value under the null character.\r\n}\r\n\r\nfunction writeArrayToMemory(array, buffer) {\r\n  assert(array.length >= 0, 'writeArrayToMemory array must have a length (should be an array or typed array)')\r\n  HEAP8.set(array, buffer);\r\n}\r\n\r\n/** @param {boolean=} dontAddNull */\r\nfunction writeAsciiToMemory(str, buffer, dontAddNull) {\r\n  for (var i = 0; i < str.length; ++i) {\r\n    assert(str.charCodeAt(i) === (str.charCodeAt(i) & 0xff));\r\n    HEAP8[((buffer++)>>0)] = str.charCodeAt(i);\r\n  }\r\n  // Null-terminate the pointer to the HEAP.\r\n  if (!dontAddNull) HEAP8[((buffer)>>0)] = 0;\r\n}\r\n\r\n// end include: runtime_strings_extra.js\r\n// Memory management\r\n\r\nfunction alignUp(x, multiple) {\r\n  if (x % multiple > 0) {\r\n    x += multiple - (x % multiple);\r\n  }\r\n  return x;\r\n}\r\n\r\nvar HEAP,\r\n/** @type {ArrayBuffer} */\r\n  buffer,\r\n/** @type {Int8Array} */\r\n  HEAP8,\r\n/** @type {Uint8Array} */\r\n  HEAPU8,\r\n/** @type {Int16Array} */\r\n  HEAP16,\r\n/** @type {Uint16Array} */\r\n  HEAPU16,\r\n/** @type {Int32Array} */\r\n  HEAP32,\r\n/** @type {Uint32Array} */\r\n  HEAPU32,\r\n/** @type {Float32Array} */\r\n  HEAPF32,\r\n/** @type {Float64Array} */\r\n  HEAPF64;\r\n\r\nfunction updateGlobalBufferAndViews(buf) {\r\n  buffer = buf;\r\n  Module['HEAP8'] = HEAP8 = new Int8Array(buf);\r\n  Module['HEAP16'] = HEAP16 = new Int16Array(buf);\r\n  Module['HEAP32'] = HEAP32 = new Int32Array(buf);\r\n  Module['HEAPU8'] = HEAPU8 = new Uint8Array(buf);\r\n  Module['HEAPU16'] = HEAPU16 = new Uint16Array(buf);\r\n  Module['HEAPU32'] = HEAPU32 = new Uint32Array(buf);\r\n  Module['HEAPF32'] = HEAPF32 = new Float32Array(buf);\r\n  Module['HEAPF64'] = HEAPF64 = new Float64Array(buf);\r\n}\r\n\r\nvar TOTAL_STACK = 5242880;\r\nif (Module['TOTAL_STACK']) assert(TOTAL_STACK === Module['TOTAL_STACK'], 'the stack size can no longer be determined at runtime')\r\n\r\nvar INITIAL_MEMORY = 16777216;\r\nif (!Object.getOwnPropertyDescriptor(Module, 'INITIAL_MEMORY')) {\r\n  Object.defineProperty(Module, 'INITIAL_MEMORY', {\r\n    configurable: true,\r\n    get: function() {\r\n      abort('Module.INITIAL_MEMORY has been replaced with plain INITIAL_MEMORY (the initial value can be provided on Module, but after startup the value is only looked for on a local variable of that name)')\r\n    }\r\n  });\r\n}\r\n\r\nassert(INITIAL_MEMORY >= TOTAL_STACK, 'INITIAL_MEMORY should be larger than TOTAL_STACK, was ' + INITIAL_MEMORY + '! (TOTAL_STACK=' + TOTAL_STACK + ')');\r\n\r\n// check for full engine support (use string 'subarray' to avoid closure compiler confusion)\r\nassert(typeof Int32Array !== 'undefined' && typeof Float64Array !== 'undefined' && Int32Array.prototype.subarray !== undefined && Int32Array.prototype.set !== undefined,\r\n       'JS engine does not provide full typed array support');\r\n\r\n// If memory is defined in wasm, the user can't provide it.\r\nassert(!Module['wasmMemory'], 'Use of `wasmMemory` detected.  Use -s IMPORTED_MEMORY to define wasmMemory externally');\r\nassert(INITIAL_MEMORY == 16777216, 'Detected runtime INITIAL_MEMORY setting.  Use -s IMPORTED_MEMORY to define wasmMemory dynamically');\r\n\r\n// include: runtime_init_table.js\r\n// In regular non-RELOCATABLE mode the table is exported\r\n// from the wasm module and this will be assigned once\r\n// the exports are available.\r\nvar wasmTable;\r\n\r\n// end include: runtime_init_table.js\r\n// include: runtime_stack_check.js\r\n\r\n\r\n// Initializes the stack cookie. Called at the startup of main and at the startup of each thread in pthreads mode.\r\nfunction writeStackCookie() {\r\n  var max = _emscripten_stack_get_end();\r\n  assert((max & 3) == 0);\r\n  // The stack grows downwards\r\n  HEAP32[((max + 4)>>2)] = 0x2135467;\r\n  HEAP32[((max + 8)>>2)] = 0x89BACDFE;\r\n  // Also test the global address 0 for integrity.\r\n  HEAP32[0] = 0x63736d65; /* 'emsc' */\r\n}\r\n\r\nfunction checkStackCookie() {\r\n  if (ABORT) return;\r\n  var max = _emscripten_stack_get_end();\r\n  var cookie1 = HEAPU32[((max + 4)>>2)];\r\n  var cookie2 = HEAPU32[((max + 8)>>2)];\r\n  if (cookie1 != 0x2135467 || cookie2 != 0x89BACDFE) {\r\n    abort('Stack overflow! Stack cookie has been overwritten, expected hex dwords 0x89BACDFE and 0x2135467, but received 0x' + cookie2.toString(16) + ' 0x' + cookie1.toString(16));\r\n  }\r\n  // Also test the global address 0 for integrity.\r\n  if (HEAP32[0] !== 0x63736d65 /* 'emsc' */) abort('Runtime error: The application has corrupted its heap memory area (address zero)!');\r\n}\r\n\r\n// end include: runtime_stack_check.js\r\n// include: runtime_assertions.js\r\n\r\n\r\n// Endianness check\r\n(function() {\r\n  var h16 = new Int16Array(1);\r\n  var h8 = new Int8Array(h16.buffer);\r\n  h16[0] = 0x6373;\r\n  if (h8[0] !== 0x73 || h8[1] !== 0x63) throw 'Runtime error: expected the system to be little-endian! (Run with -s SUPPORT_BIG_ENDIAN=1 to bypass)';\r\n})();\r\n\r\n// end include: runtime_assertions.js\r\nvar __ATPRERUN__  = []; // functions called before the runtime is initialized\r\nvar __ATINIT__    = []; // functions called during startup\r\nvar __ATEXIT__    = []; // functions called during shutdown\r\nvar __ATPOSTRUN__ = []; // functions called after the main() is called\r\n\r\nvar runtimeInitialized = false;\r\nvar runtimeExited = false;\r\nvar runtimeKeepaliveCounter = 0;\r\n\r\nfunction keepRuntimeAlive() {\r\n  return noExitRuntime || runtimeKeepaliveCounter > 0;\r\n}\r\n\r\nfunction preRun() {\r\n\r\n  callRuntimeCallbacks(__ATPRERUN__);\r\n}\r\n\r\nfunction initRuntime() {\r\n  checkStackCookie();\r\n  assert(!runtimeInitialized);\r\n  runtimeInitialized = true;\r\n\r\n  \r\n  callRuntimeCallbacks(__ATINIT__);\r\n}\r\n\r\nfunction exitRuntime() {\r\n  checkStackCookie();\r\n  runtimeExited = true;\r\n}\r\n\r\nfunction postRun() {\r\n  checkStackCookie();\r\n\r\n  callRuntimeCallbacks(__ATPOSTRUN__);\r\n}\r\n\r\nfunction addOnPreRun(cb) {\r\n  __ATPRERUN__.unshift(cb);\r\n}\r\n\r\nfunction addOnInit(cb) {\r\n  __ATINIT__.unshift(cb);\r\n}\r\n\r\nfunction addOnExit(cb) {\r\n}\r\n\r\nfunction addOnPostRun(cb) {\r\n  __ATPOSTRUN__.unshift(cb);\r\n}\r\n\r\n// include: runtime_math.js\r\n\r\n\r\n// https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Math/imul\r\n\r\n// https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Math/fround\r\n\r\n// https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Math/clz32\r\n\r\n// https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Math/trunc\r\n\r\nassert(Math.imul, 'This browser does not support Math.imul(), build with LEGACY_VM_SUPPORT or POLYFILL_OLD_MATH_FUNCTIONS to add in a polyfill');\r\nassert(Math.fround, 'This browser does not support Math.fround(), build with LEGACY_VM_SUPPORT or POLYFILL_OLD_MATH_FUNCTIONS to add in a polyfill');\r\nassert(Math.clz32, 'This browser does not support Math.clz32(), build with LEGACY_VM_SUPPORT or POLYFILL_OLD_MATH_FUNCTIONS to add in a polyfill');\r\nassert(Math.trunc, 'This browser does not support Math.trunc(), build with LEGACY_VM_SUPPORT or POLYFILL_OLD_MATH_FUNCTIONS to add in a polyfill');\r\n\r\n// end include: runtime_math.js\r\n// A counter of dependencies for calling run(). If we need to\r\n// do asynchronous work before running, increment this and\r\n// decrement it. Incrementing must happen in a place like\r\n// Module.preRun (used by emcc to add file preloading).\r\n// Note that you can add dependencies in preRun, even though\r\n// it happens right before run - run will be postponed until\r\n// the dependencies are met.\r\nvar runDependencies = 0;\r\nvar runDependencyWatcher = null;\r\nvar dependenciesFulfilled = null; // overridden to take different actions when all run dependencies are fulfilled\r\nvar runDependencyTracking = {};\r\n\r\nfunction getUniqueRunDependency(id) {\r\n  var orig = id;\r\n  while (1) {\r\n    if (!runDependencyTracking[id]) return id;\r\n    id = orig + Math.random();\r\n  }\r\n}\r\n\r\nfunction addRunDependency(id) {\r\n  runDependencies++;\r\n\r\n  if (id) {\r\n    assert(!runDependencyTracking[id]);\r\n    runDependencyTracking[id] = 1;\r\n    if (runDependencyWatcher === null && typeof setInterval !== 'undefined') {\r\n      // Check for missing dependencies every few seconds\r\n      runDependencyWatcher = setInterval(function() {\r\n        if (ABORT) {\r\n          clearInterval(runDependencyWatcher);\r\n          runDependencyWatcher = null;\r\n          return;\r\n        }\r\n        var shown = false;\r\n        for (var dep in runDependencyTracking) {\r\n          if (!shown) {\r\n            shown = true;\r\n            err('still waiting on run dependencies:');\r\n          }\r\n          err('dependency: ' + dep);\r\n        }\r\n        if (shown) {\r\n          err('(end of list)');\r\n        }\r\n      }, 10000);\r\n    }\r\n  } else {\r\n    err('warning: run dependency added without ID');\r\n  }\r\n}\r\n\r\nfunction removeRunDependency(id) {\r\n  runDependencies--;\r\n\r\n  if (id) {\r\n    assert(runDependencyTracking[id]);\r\n    delete runDependencyTracking[id];\r\n  } else {\r\n    err('warning: run dependency removed without ID');\r\n  }\r\n  if (runDependencies == 0) {\r\n    if (runDependencyWatcher !== null) {\r\n      clearInterval(runDependencyWatcher);\r\n      runDependencyWatcher = null;\r\n    }\r\n    if (dependenciesFulfilled) {\r\n      var callback = dependenciesFulfilled;\r\n      dependenciesFulfilled = null;\r\n      callback(); // can add another dependenciesFulfilled\r\n    }\r\n  }\r\n}\r\n\r\nModule[\"preloadedImages\"] = {}; // maps url to image data\r\nModule[\"preloadedAudios\"] = {}; // maps url to audio data\r\n\r\n/** @param {string|number=} what */\r\nfunction abort(what) {\r\n\r\n  what = 'Aborted(' + what + ')';\r\n  // TODO(sbc): Should we remove printing and leave it up to whoever\r\n  // catches the exception?\r\n  err(what);\r\n\r\n  ABORT = true;\r\n  EXITSTATUS = 1;\r\n\r\n  // Use a wasm runtime error, because a JS error might be seen as a foreign\r\n  // exception, which means we'd run destructors on it. We need the error to\r\n  // simply make the program stop.\r\n  var e = new WebAssembly.RuntimeError(what);\r\n\r\n  readyPromiseReject(e);\r\n  // Throw the error whether or not MODULARIZE is set because abort is used\r\n  // in code paths apart from instantiation where an exception is expected\r\n  // to be thrown when abort is called.\r\n  throw e;\r\n}\r\n\r\n// {{MEM_INITIALIZER}}\r\n\r\n// include: memoryprofiler.js\r\n\r\n\r\n// end include: memoryprofiler.js\r\n// show errors on likely calls to FS when it was not included\r\nvar FS = {\r\n  error: function() {\r\n    abort('Filesystem support (FS) was not included. The problem is that you are using files from JS, but files were not used from C/C++, so filesystem support was not auto-included. You can force-include filesystem support with  -s FORCE_FILESYSTEM=1');\r\n  },\r\n  init: function() { FS.error() },\r\n  createDataFile: function() { FS.error() },\r\n  createPreloadedFile: function() { FS.error() },\r\n  createLazyFile: function() { FS.error() },\r\n  open: function() { FS.error() },\r\n  mkdev: function() { FS.error() },\r\n  registerDevice: function() { FS.error() },\r\n  analyzePath: function() { FS.error() },\r\n  loadFilesFromDB: function() { FS.error() },\r\n\r\n  ErrnoError: function ErrnoError() { FS.error() },\r\n};\r\nModule['FS_createDataFile'] = FS.createDataFile;\r\nModule['FS_createPreloadedFile'] = FS.createPreloadedFile;\r\n\r\n// include: URIUtils.js\r\n\r\n\r\n// Prefix of data URIs emitted by SINGLE_FILE and related options.\r\nvar dataURIPrefix = 'data:application/octet-stream;base64,';\r\n\r\n// Indicates whether filename is a base64 data URI.\r\nfunction isDataURI(filename) {\r\n  // Prefix of data URIs emitted by SINGLE_FILE and related options.\r\n  return filename.startsWith(dataURIPrefix);\r\n}\r\n\r\n// Indicates whether filename is delivered via file protocol (as opposed to http/https)\r\nfunction isFileURI(filename) {\r\n  return filename.startsWith('file://');\r\n}\r\n\r\n// end include: URIUtils.js\r\nfunction createExportWrapper(name, fixedasm) {\r\n  return function() {\r\n    var displayName = name;\r\n    var asm = fixedasm;\r\n    if (!fixedasm) {\r\n      asm = Module['asm'];\r\n    }\r\n    assert(runtimeInitialized, 'native function `' + displayName + '` called before runtime initialization');\r\n    assert(!runtimeExited, 'native function `' + displayName + '` called after runtime exit (use NO_EXIT_RUNTIME to keep it alive after main() exits)');\r\n    if (!asm[name]) {\r\n      assert(asm[name], 'exported native function `' + displayName + '` not found');\r\n    }\r\n    return asm[name].apply(null, arguments);\r\n  };\r\n}\r\n\r\nvar wasmBinaryFile;\r\nif (Module['locateFile']) {\r\n  wasmBinaryFile = 'sock_c.wasm';\r\n  if (!isDataURI(wasmBinaryFile)) {\r\n    wasmBinaryFile = locateFile(wasmBinaryFile);\r\n  }\r\n} else {\r\n  // Use bundler-friendly `new URL(..., import.meta.url)` pattern; works in browsers too.\r\n  wasmBinaryFile = new URL('sock_c.wasm', import.meta.url).toString();\r\n}\r\n\r\nfunction getBinary(file) {\r\n  try {\r\n    if (file == wasmBinaryFile && wasmBinary) {\r\n      return new Uint8Array(wasmBinary);\r\n    }\r\n    if (readBinary) {\r\n      return readBinary(file);\r\n    } else {\r\n      throw \"both async and sync fetching of the wasm failed\";\r\n    }\r\n  }\r\n  catch (err) {\r\n    abort(err);\r\n  }\r\n}\r\n\r\nfunction getBinaryPromise() {\r\n  // If we don't have the binary yet, try to to load it asynchronously.\r\n  // Fetch has some additional restrictions over XHR, like it can't be used on a file:// url.\r\n  // See https://github.com/github/fetch/pull/92#issuecomment-140665932\r\n  // Cordova or Electron apps are typically loaded from a file:// url.\r\n  // So use fetch if it is available and the url is not a file, otherwise fall back to XHR.\r\n  if (!wasmBinary && (ENVIRONMENT_IS_WEB || ENVIRONMENT_IS_WORKER)) {\r\n    if (typeof fetch === 'function'\r\n    ) {\r\n      return fetch(wasmBinaryFile, { credentials: 'same-origin' }).then(function(response) {\r\n        if (!response['ok']) {\r\n          throw \"failed to load wasm binary file at '\" + wasmBinaryFile + \"'\";\r\n        }\r\n        return response['arrayBuffer']();\r\n      }).catch(function () {\r\n          return getBinary(wasmBinaryFile);\r\n      });\r\n    }\r\n  }\r\n\r\n  // Otherwise, getBinary should be able to get it synchronously\r\n  return Promise.resolve().then(function() { return getBinary(wasmBinaryFile); });\r\n}\r\n\r\n// Create the wasm instance.\r\n// Receives the wasm imports, returns the exports.\r\nfunction createWasm() {\r\n  // prepare imports\r\n  var info = {\r\n    'env': asmLibraryArg,\r\n    'wasi_snapshot_preview1': asmLibraryArg,\r\n  };\r\n  // Load the wasm module and create an instance of using native support in the JS engine.\r\n  // handle a generated wasm instance, receiving its exports and\r\n  // performing other necessary setup\r\n  /** @param {WebAssembly.Module=} module*/\r\n  function receiveInstance(instance, module) {\r\n    var exports = instance.exports;\r\n\r\n    Module['asm'] = exports;\r\n\r\n    wasmMemory = Module['asm']['memory'];\r\n    assert(wasmMemory, \"memory not found in wasm exports\");\r\n    // This assertion doesn't hold when emscripten is run in --post-link\r\n    // mode.\r\n    // TODO(sbc): Read INITIAL_MEMORY out of the wasm file in post-link mode.\r\n    //assert(wasmMemory.buffer.byteLength === 16777216);\r\n    updateGlobalBufferAndViews(wasmMemory.buffer);\r\n\r\n    wasmTable = Module['asm']['__indirect_function_table'];\r\n    assert(wasmTable, \"table not found in wasm exports\");\r\n\r\n    addOnInit(Module['asm']['__wasm_call_ctors']);\r\n\r\n    removeRunDependency('wasm-instantiate');\r\n  }\r\n  // we can't run yet (except in a pthread, where we have a custom sync instantiator)\r\n  addRunDependency('wasm-instantiate');\r\n\r\n  // Prefer streaming instantiation if available.\r\n  // Async compilation can be confusing when an error on the page overwrites Module\r\n  // (for example, if the order of elements is wrong, and the one defining Module is\r\n  // later), so we save Module and check it later.\r\n  var trueModule = Module;\r\n  function receiveInstantiationResult(result) {\r\n    // 'result' is a ResultObject object which has both the module and instance.\r\n    // receiveInstance() will swap in the exports (to Module.asm) so they can be called\r\n    assert(Module === trueModule, 'the Module object should not be replaced during async compilation - perhaps the order of HTML elements is wrong?');\r\n    trueModule = null;\r\n    // TODO: Due to Closure regression https://github.com/google/closure-compiler/issues/3193, the above line no longer optimizes out down to the following line.\r\n    // When the regression is fixed, can restore the above USE_PTHREADS-enabled path.\r\n    receiveInstance(result['instance']);\r\n  }\r\n\r\n  function instantiateArrayBuffer(receiver) {\r\n    return getBinaryPromise().then(function(binary) {\r\n      return WebAssembly.instantiate(binary, info);\r\n    }).then(function (instance) {\r\n      return instance;\r\n    }).then(receiver, function(reason) {\r\n      err('failed to asynchronously prepare wasm: ' + reason);\r\n\r\n      // Warn on some common problems.\r\n      if (isFileURI(wasmBinaryFile)) {\r\n        err('warning: Loading from a file URI (' + wasmBinaryFile + ') is not supported in most browsers. See https://emscripten.org/docs/getting_started/FAQ.html#how-do-i-run-a-local-webserver-for-testing-why-does-my-program-stall-in-downloading-or-preparing');\r\n      }\r\n      abort(reason);\r\n    });\r\n  }\r\n\r\n  function instantiateAsync() {\r\n    if (!wasmBinary &&\r\n        typeof WebAssembly.instantiateStreaming === 'function' &&\r\n        !isDataURI(wasmBinaryFile) &&\r\n        typeof fetch === 'function') {\r\n      return fetch(wasmBinaryFile, { credentials: 'same-origin' }).then(function (response) {\r\n        var result = WebAssembly.instantiateStreaming(response, info);\r\n\r\n        return result.then(\r\n          receiveInstantiationResult,\r\n          function(reason) {\r\n            // We expect the most common failure cause to be a bad MIME type for the binary,\r\n            // in which case falling back to ArrayBuffer instantiation should work.\r\n            err('wasm streaming compile failed: ' + reason);\r\n            err('falling back to ArrayBuffer instantiation');\r\n            return instantiateArrayBuffer(receiveInstantiationResult);\r\n          });\r\n      });\r\n    } else {\r\n      return instantiateArrayBuffer(receiveInstantiationResult);\r\n    }\r\n  }\r\n\r\n  // User shell pages can write their own Module.instantiateWasm = function(imports, successCallback) callback\r\n  // to manually instantiate the Wasm module themselves. This allows pages to run the instantiation parallel\r\n  // to any other async startup actions they are performing.\r\n  if (Module['instantiateWasm']) {\r\n    try {\r\n      var exports = Module['instantiateWasm'](info, receiveInstance);\r\n      return exports;\r\n    } catch(e) {\r\n      err('Module.instantiateWasm callback failed with error: ' + e);\r\n      return false;\r\n    }\r\n  }\r\n\r\n  // If instantiation fails, reject the module ready promise.\r\n  instantiateAsync().catch(readyPromiseReject);\r\n  return {}; // no exports yet; we'll fill them in later\r\n}\r\n\r\n// Globals used by JS i64 conversions (see makeSetValue)\r\nvar tempDouble;\r\nvar tempI64;\r\n\r\n// === Body ===\r\n\r\nvar ASM_CONSTS = {\r\n  \r\n};\r\n\r\n\r\n\r\n\r\n\r\n\r\n  function callRuntimeCallbacks(callbacks) {\r\n      while (callbacks.length > 0) {\r\n        var callback = callbacks.shift();\r\n        if (typeof callback == 'function') {\r\n          callback(Module); // Pass the module as the first argument.\r\n          continue;\r\n        }\r\n        var func = callback.func;\r\n        if (typeof func === 'number') {\r\n          if (callback.arg === undefined) {\r\n            getWasmTableEntry(func)();\r\n          } else {\r\n            getWasmTableEntry(func)(callback.arg);\r\n          }\r\n        } else {\r\n          func(callback.arg === undefined ? null : callback.arg);\r\n        }\r\n      }\r\n    }\r\n\r\n  function withStackSave(f) {\r\n      var stack = stackSave();\r\n      var ret = f();\r\n      stackRestore(stack);\r\n      return ret;\r\n    }\r\n  function demangle(func) {\r\n      warnOnce('warning: build with  -s DEMANGLE_SUPPORT=1  to link in libcxxabi demangling');\r\n      return func;\r\n    }\r\n\r\n  function demangleAll(text) {\r\n      var regex =\r\n        /\\b_Z[\\w\\d_]+/g;\r\n      return text.replace(regex,\r\n        function(x) {\r\n          var y = demangle(x);\r\n          return x === y ? x : (y + ' [' + x + ']');\r\n        });\r\n    }\r\n\r\n  var wasmTableMirror = [];\r\n  function getWasmTableEntry(funcPtr) {\r\n      var func = wasmTableMirror[funcPtr];\r\n      if (!func) {\r\n        if (funcPtr >= wasmTableMirror.length) wasmTableMirror.length = funcPtr + 1;\r\n        wasmTableMirror[funcPtr] = func = wasmTable.get(funcPtr);\r\n      }\r\n      assert(wasmTable.get(funcPtr) == func, \"JavaScript-side Wasm function table mirror is out of date!\");\r\n      return func;\r\n    }\r\n\r\n  function handleException(e) {\r\n      // Certain exception types we do not treat as errors since they are used for\r\n      // internal control flow.\r\n      // 1. ExitStatus, which is thrown by exit()\r\n      // 2. \"unwind\", which is thrown by emscripten_unwind_to_js_event_loop() and others\r\n      //    that wish to return to JS event loop.\r\n      if (e instanceof ExitStatus || e == 'unwind') {\r\n        return EXITSTATUS;\r\n      }\r\n      quit_(1, e);\r\n    }\r\n\r\n  function jsStackTrace() {\r\n      var error = new Error();\r\n      if (!error.stack) {\r\n        // IE10+ special cases: It does have callstack info, but it is only populated if an Error object is thrown,\r\n        // so try that as a special-case.\r\n        try {\r\n          throw new Error();\r\n        } catch(e) {\r\n          error = e;\r\n        }\r\n        if (!error.stack) {\r\n          return '(no stack trace available)';\r\n        }\r\n      }\r\n      return error.stack.toString();\r\n    }\r\n\r\n  function setWasmTableEntry(idx, func) {\r\n      wasmTable.set(idx, func);\r\n      wasmTableMirror[idx] = func;\r\n    }\r\n\r\n  function stackTrace() {\r\n      var js = jsStackTrace();\r\n      if (Module['extraStackTrace']) js += '\\n' + Module['extraStackTrace']();\r\n      return demangleAll(js);\r\n    }\r\n\r\n  function _abort() {\r\n      abort('native code called abort()');\r\n    }\r\n\r\n  function _clock() {\r\n      if (_clock.start === undefined) _clock.start = Date.now();\r\n      return ((Date.now() - _clock.start) * (1000000 / 1000))|0;\r\n    }\r\n\r\n  function _emscripten_memcpy_big(dest, src, num) {\r\n      HEAPU8.copyWithin(dest, src, src + num);\r\n    }\r\n\r\n  function emscripten_realloc_buffer(size) {\r\n      try {\r\n        // round size grow request up to wasm page size (fixed 64KB per spec)\r\n        wasmMemory.grow((size - buffer.byteLength + 65535) >>> 16); // .grow() takes a delta compared to the previous size\r\n        updateGlobalBufferAndViews(wasmMemory.buffer);\r\n        return 1 /*success*/;\r\n      } catch(e) {\r\n        err('emscripten_realloc_buffer: Attempted to grow heap from ' + buffer.byteLength  + ' bytes to ' + size + ' bytes, but got error: ' + e);\r\n      }\r\n      // implicit 0 return to save code size (caller will cast \"undefined\" into 0\r\n      // anyhow)\r\n    }\r\n  function _emscripten_resize_heap(requestedSize) {\r\n      var oldSize = HEAPU8.length;\r\n      requestedSize = requestedSize >>> 0;\r\n      // With pthreads, races can happen (another thread might increase the size in between), so return a failure, and let the caller retry.\r\n      assert(requestedSize > oldSize);\r\n  \r\n      // Memory resize rules:\r\n      // 1. Always increase heap size to at least the requested size, rounded up to next page multiple.\r\n      // 2a. If MEMORY_GROWTH_LINEAR_STEP == -1, excessively resize the heap geometrically: increase the heap size according to\r\n      //                                         MEMORY_GROWTH_GEOMETRIC_STEP factor (default +20%),\r\n      //                                         At most overreserve by MEMORY_GROWTH_GEOMETRIC_CAP bytes (default 96MB).\r\n      // 2b. If MEMORY_GROWTH_LINEAR_STEP != -1, excessively resize the heap linearly: increase the heap size by at least MEMORY_GROWTH_LINEAR_STEP bytes.\r\n      // 3. Max size for the heap is capped at 2048MB-WASM_PAGE_SIZE, or by MAXIMUM_MEMORY, or by ASAN limit, depending on which is smallest\r\n      // 4. If we were unable to allocate as much memory, it may be due to over-eager decision to excessively reserve due to (3) above.\r\n      //    Hence if an allocation fails, cut down on the amount of excess growth, in an attempt to succeed to perform a smaller allocation.\r\n  \r\n      // A limit is set for how much we can grow. We should not exceed that\r\n      // (the wasm binary specifies it, so if we tried, we'd fail anyhow).\r\n      // In CAN_ADDRESS_2GB mode, stay one Wasm page short of 4GB: while e.g. Chrome is able to allocate full 4GB Wasm memories, the size will wrap\r\n      // back to 0 bytes in Wasm side for any code that deals with heap sizes, which would require special casing all heap size related code to treat\r\n      // 0 specially.\r\n      var maxHeapSize = 2147483648;\r\n      if (requestedSize > maxHeapSize) {\r\n        err('Cannot enlarge memory, asked to go up to ' + requestedSize + ' bytes, but the limit is ' + maxHeapSize + ' bytes!');\r\n        return false;\r\n      }\r\n  \r\n      // Loop through potential heap size increases. If we attempt a too eager reservation that fails, cut down on the\r\n      // attempted size and reserve a smaller bump instead. (max 3 times, chosen somewhat arbitrarily)\r\n      for (var cutDown = 1; cutDown <= 4; cutDown *= 2) {\r\n        var overGrownHeapSize = oldSize * (1 + 0.2 / cutDown); // ensure geometric growth\r\n        // but limit overreserving (default to capping at +96MB overgrowth at most)\r\n        overGrownHeapSize = Math.min(overGrownHeapSize, requestedSize + 100663296 );\r\n  \r\n        var newSize = Math.min(maxHeapSize, alignUp(Math.max(requestedSize, overGrownHeapSize), 65536));\r\n  \r\n        var replacement = emscripten_realloc_buffer(newSize);\r\n        if (replacement) {\r\n  \r\n          return true;\r\n        }\r\n      }\r\n      err('Failed to grow the heap from ' + oldSize + ' bytes to ' + newSize + ' bytes, not enough memory!');\r\n      return false;\r\n    }\r\n\r\n  var SYSCALLS = {mappings:{},buffers:[null,[],[]],printChar:function(stream, curr) {\r\n        var buffer = SYSCALLS.buffers[stream];\r\n        assert(buffer);\r\n        if (curr === 0 || curr === 10) {\r\n          (stream === 1 ? out : err)(UTF8ArrayToString(buffer, 0));\r\n          buffer.length = 0;\r\n        } else {\r\n          buffer.push(curr);\r\n        }\r\n      },varargs:undefined,get:function() {\r\n        assert(SYSCALLS.varargs != undefined);\r\n        SYSCALLS.varargs += 4;\r\n        var ret = HEAP32[(((SYSCALLS.varargs)-(4))>>2)];\r\n        return ret;\r\n      },getStr:function(ptr) {\r\n        var ret = UTF8ToString(ptr);\r\n        return ret;\r\n      },get64:function(low, high) {\r\n        if (low >= 0) assert(high === 0);\r\n        else assert(high === -1);\r\n        return low;\r\n      }};\r\n  function _fd_close(fd) {\r\n      abort('it should not be possible to operate on streams when !SYSCALLS_REQUIRE_FILESYSTEM');\r\n      return 0;\r\n    }\r\n\r\n  function _fd_seek(fd, offset_low, offset_high, whence, newOffset) {\r\n  abort('it should not be possible to operate on streams when !SYSCALLS_REQUIRE_FILESYSTEM');\r\n  }\r\n\r\n  function flush_NO_FILESYSTEM() {\r\n      // flush anything remaining in the buffers during shutdown\r\n      if (typeof _fflush !== 'undefined') _fflush(0);\r\n      var buffers = SYSCALLS.buffers;\r\n      if (buffers[1].length) SYSCALLS.printChar(1, 10);\r\n      if (buffers[2].length) SYSCALLS.printChar(2, 10);\r\n    }\r\n  function _fd_write(fd, iov, iovcnt, pnum) {\r\n      ;\r\n      // hack to support printf in SYSCALLS_REQUIRE_FILESYSTEM=0\r\n      var num = 0;\r\n      for (var i = 0; i < iovcnt; i++) {\r\n        var ptr = HEAP32[((iov)>>2)];\r\n        var len = HEAP32[(((iov)+(4))>>2)];\r\n        iov += 8;\r\n        for (var j = 0; j < len; j++) {\r\n          SYSCALLS.printChar(fd, HEAPU8[ptr+j]);\r\n        }\r\n        num += len;\r\n      }\r\n      HEAP32[((pnum)>>2)] = num;\r\n      return 0;\r\n    }\r\n\r\n  function _js_bindClass(vm, module, className, methods) {\r\n  \t\tlet fns = Module.sock.bindClass(UTF8ToString(module), UTF8ToString(className));\r\n  \t\tif (fns) {\r\n  \t\t\tlet allocate = fns[0];\r\n  \t\t\tlet finalize = fns[1];\r\n  \r\n  \t\t\tif (allocate) {\r\n  \t\t\t\tlet u32 = new Uint32Array(Module.HEAP8.buffer, methods);\r\n  \r\n  \t\t\t\tu32[0] = Module.addFunction(allocate, \"vi\");\r\n  \r\n  \t\t\t\tif (finalize) {\r\n  \t\t\t\t\tu32[1] = Module.addFunction(finalize, \"vi\");\r\n  \t\t\t\t}\r\n  \t\t\t}\r\n  \t\t}\r\n  \t}\r\n\r\n  function _js_bindMethod(vm, module, className, isStatic, signature) {\r\n  \t\tlet fn = Module.sock.bindMethod(UTF8ToString(module), UTF8ToString(className), !!isStatic, UTF8ToString(signature));\r\n  \t\treturn fn ? Module.addFunction(fn, \"vi\") : 0;\r\n  \t}\r\n\r\n  function _js_error(vm, type, module, line, message) {\r\n  \t\tModule.sock.error(type, UTF8ToString(module), line, UTF8ToString(message));\r\n  \t}\r\n\r\n  function _js_loadModule(vm, name) {\r\n  \t\treturn mallocString(Module.sock.loadModule(UTF8ToString(name)));\r\n  \t}\r\n\r\n  function _js_write(vm, text) {\r\n  \t\tModule.sock.write(UTF8ToString(text));\r\n  \t}\r\n\r\n  function _setTempRet0(val) {\r\n      setTempRet0(val);\r\n    }\r\nvar ASSERTIONS = true;\r\n\r\n\r\n\r\n/** @type {function(string, boolean=, number=)} */\r\nfunction intArrayFromString(stringy, dontAddNull, length) {\r\n  var len = length > 0 ? length : lengthBytesUTF8(stringy)+1;\r\n  var u8array = new Array(len);\r\n  var numBytesWritten = stringToUTF8Array(stringy, u8array, 0, u8array.length);\r\n  if (dontAddNull) u8array.length = numBytesWritten;\r\n  return u8array;\r\n}\r\n\r\nfunction intArrayToString(array) {\r\n  var ret = [];\r\n  for (var i = 0; i < array.length; i++) {\r\n    var chr = array[i];\r\n    if (chr > 0xFF) {\r\n      if (ASSERTIONS) {\r\n        assert(false, 'Character code ' + chr + ' (' + String.fromCharCode(chr) + ')  at offset ' + i + ' not in 0x00-0xFF.');\r\n      }\r\n      chr &= 0xFF;\r\n    }\r\n    ret.push(String.fromCharCode(chr));\r\n  }\r\n  return ret.join('');\r\n}\r\n\r\n\r\nvar asmLibraryArg = {\r\n  \"abort\": _abort,\r\n  \"clock\": _clock,\r\n  \"emscripten_memcpy_big\": _emscripten_memcpy_big,\r\n  \"emscripten_resize_heap\": _emscripten_resize_heap,\r\n  \"fd_close\": _fd_close,\r\n  \"fd_seek\": _fd_seek,\r\n  \"fd_write\": _fd_write,\r\n  \"js_bindClass\": _js_bindClass,\r\n  \"js_bindMethod\": _js_bindMethod,\r\n  \"js_error\": _js_error,\r\n  \"js_loadModule\": _js_loadModule,\r\n  \"js_write\": _js_write,\r\n  \"setTempRet0\": _setTempRet0\r\n};\r\nvar asm = createWasm();\r\n/** @type {function(...*):?} */\r\nvar ___wasm_call_ctors = Module[\"___wasm_call_ctors\"] = createExportWrapper(\"__wasm_call_ctors\");\r\n\r\n/** @type {function(...*):?} */\r\nvar _wrenInterpret = Module[\"_wrenInterpret\"] = createExportWrapper(\"wrenInterpret\");\r\n\r\n/** @type {function(...*):?} */\r\nvar ___errno_location = Module[\"___errno_location\"] = createExportWrapper(\"__errno_location\");\r\n\r\n/** @type {function(...*):?} */\r\nvar _wrenCollectGarbage = Module[\"_wrenCollectGarbage\"] = createExportWrapper(\"wrenCollectGarbage\");\r\n\r\n/** @type {function(...*):?} */\r\nvar _wrenGetVersionNumber = Module[\"_wrenGetVersionNumber\"] = createExportWrapper(\"wrenGetVersionNumber\");\r\n\r\n/** @type {function(...*):?} */\r\nvar _wrenInitConfiguration = Module[\"_wrenInitConfiguration\"] = createExportWrapper(\"wrenInitConfiguration\");\r\n\r\n/** @type {function(...*):?} */\r\nvar _free = Module[\"_free\"] = createExportWrapper(\"free\");\r\n\r\n/** @type {function(...*):?} */\r\nvar _realloc = Module[\"_realloc\"] = createExportWrapper(\"realloc\");\r\n\r\n/** @type {function(...*):?} */\r\nvar _wrenNewVM = Module[\"_wrenNewVM\"] = createExportWrapper(\"wrenNewVM\");\r\n\r\n/** @type {function(...*):?} */\r\nvar _wrenFreeVM = Module[\"_wrenFreeVM\"] = createExportWrapper(\"wrenFreeVM\");\r\n\r\n/** @type {function(...*):?} */\r\nvar _wrenMakeCallHandle = Module[\"_wrenMakeCallHandle\"] = createExportWrapper(\"wrenMakeCallHandle\");\r\n\r\n/** @type {function(...*):?} */\r\nvar _wrenCall = Module[\"_wrenCall\"] = createExportWrapper(\"wrenCall\");\r\n\r\n/** @type {function(...*):?} */\r\nvar _wrenReleaseHandle = Module[\"_wrenReleaseHandle\"] = createExportWrapper(\"wrenReleaseHandle\");\r\n\r\n/** @type {function(...*):?} */\r\nvar _wrenGetSlotCount = Module[\"_wrenGetSlotCount\"] = createExportWrapper(\"wrenGetSlotCount\");\r\n\r\n/** @type {function(...*):?} */\r\nvar _wrenEnsureSlots = Module[\"_wrenEnsureSlots\"] = createExportWrapper(\"wrenEnsureSlots\");\r\n\r\n/** @type {function(...*):?} */\r\nvar _wrenGetSlotType = Module[\"_wrenGetSlotType\"] = createExportWrapper(\"wrenGetSlotType\");\r\n\r\n/** @type {function(...*):?} */\r\nvar _wrenGetSlotBool = Module[\"_wrenGetSlotBool\"] = createExportWrapper(\"wrenGetSlotBool\");\r\n\r\n/** @type {function(...*):?} */\r\nvar _wrenGetSlotBytes = Module[\"_wrenGetSlotBytes\"] = createExportWrapper(\"wrenGetSlotBytes\");\r\n\r\n/** @type {function(...*):?} */\r\nvar _wrenGetSlotDouble = Module[\"_wrenGetSlotDouble\"] = createExportWrapper(\"wrenGetSlotDouble\");\r\n\r\n/** @type {function(...*):?} */\r\nvar _wrenGetSlotForeign = Module[\"_wrenGetSlotForeign\"] = createExportWrapper(\"wrenGetSlotForeign\");\r\n\r\n/** @type {function(...*):?} */\r\nvar _wrenGetSlotIsInstanceOf = Module[\"_wrenGetSlotIsInstanceOf\"] = createExportWrapper(\"wrenGetSlotIsInstanceOf\");\r\n\r\n/** @type {function(...*):?} */\r\nvar _wrenGetSlotInstanceField = Module[\"_wrenGetSlotInstanceField\"] = createExportWrapper(\"wrenGetSlotInstanceField\");\r\n\r\n/** @type {function(...*):?} */\r\nvar _wrenGetSlotString = Module[\"_wrenGetSlotString\"] = createExportWrapper(\"wrenGetSlotString\");\r\n\r\n/** @type {function(...*):?} */\r\nvar _wrenGetSlotHandle = Module[\"_wrenGetSlotHandle\"] = createExportWrapper(\"wrenGetSlotHandle\");\r\n\r\n/** @type {function(...*):?} */\r\nvar _wrenSetSlotBool = Module[\"_wrenSetSlotBool\"] = createExportWrapper(\"wrenSetSlotBool\");\r\n\r\n/** @type {function(...*):?} */\r\nvar _wrenSetSlotBytes = Module[\"_wrenSetSlotBytes\"] = createExportWrapper(\"wrenSetSlotBytes\");\r\n\r\n/** @type {function(...*):?} */\r\nvar _wrenSetSlotDouble = Module[\"_wrenSetSlotDouble\"] = createExportWrapper(\"wrenSetSlotDouble\");\r\n\r\n/** @type {function(...*):?} */\r\nvar _wrenSetSlotRange = Module[\"_wrenSetSlotRange\"] = createExportWrapper(\"wrenSetSlotRange\");\r\n\r\n/** @type {function(...*):?} */\r\nvar _wrenSetSlotNewForeign = Module[\"_wrenSetSlotNewForeign\"] = createExportWrapper(\"wrenSetSlotNewForeign\");\r\n\r\n/** @type {function(...*):?} */\r\nvar _wrenSetSlotNewList = Module[\"_wrenSetSlotNewList\"] = createExportWrapper(\"wrenSetSlotNewList\");\r\n\r\n/** @type {function(...*):?} */\r\nvar _wrenSetSlotNewMap = Module[\"_wrenSetSlotNewMap\"] = createExportWrapper(\"wrenSetSlotNewMap\");\r\n\r\n/** @type {function(...*):?} */\r\nvar _wrenSetSlotNull = Module[\"_wrenSetSlotNull\"] = createExportWrapper(\"wrenSetSlotNull\");\r\n\r\n/** @type {function(...*):?} */\r\nvar _wrenSetSlotString = Module[\"_wrenSetSlotString\"] = createExportWrapper(\"wrenSetSlotString\");\r\n\r\n/** @type {function(...*):?} */\r\nvar _wrenSetSlotHandle = Module[\"_wrenSetSlotHandle\"] = createExportWrapper(\"wrenSetSlotHandle\");\r\n\r\n/** @type {function(...*):?} */\r\nvar _wrenGetListCount = Module[\"_wrenGetListCount\"] = createExportWrapper(\"wrenGetListCount\");\r\n\r\n/** @type {function(...*):?} */\r\nvar _wrenGetListElement = Module[\"_wrenGetListElement\"] = createExportWrapper(\"wrenGetListElement\");\r\n\r\n/** @type {function(...*):?} */\r\nvar _wrenSetListElement = Module[\"_wrenSetListElement\"] = createExportWrapper(\"wrenSetListElement\");\r\n\r\n/** @type {function(...*):?} */\r\nvar _wrenInsertInList = Module[\"_wrenInsertInList\"] = createExportWrapper(\"wrenInsertInList\");\r\n\r\n/** @type {function(...*):?} */\r\nvar _wrenGetMapCount = Module[\"_wrenGetMapCount\"] = createExportWrapper(\"wrenGetMapCount\");\r\n\r\n/** @type {function(...*):?} */\r\nvar _wrenGetMapContainsKey = Module[\"_wrenGetMapContainsKey\"] = createExportWrapper(\"wrenGetMapContainsKey\");\r\n\r\n/** @type {function(...*):?} */\r\nvar _wrenGetMapValue = Module[\"_wrenGetMapValue\"] = createExportWrapper(\"wrenGetMapValue\");\r\n\r\n/** @type {function(...*):?} */\r\nvar _wrenSetMapValue = Module[\"_wrenSetMapValue\"] = createExportWrapper(\"wrenSetMapValue\");\r\n\r\n/** @type {function(...*):?} */\r\nvar _wrenRemoveMapValue = Module[\"_wrenRemoveMapValue\"] = createExportWrapper(\"wrenRemoveMapValue\");\r\n\r\n/** @type {function(...*):?} */\r\nvar _wrenGetVariable = Module[\"_wrenGetVariable\"] = createExportWrapper(\"wrenGetVariable\");\r\n\r\n/** @type {function(...*):?} */\r\nvar _wrenHasVariable = Module[\"_wrenHasVariable\"] = createExportWrapper(\"wrenHasVariable\");\r\n\r\n/** @type {function(...*):?} */\r\nvar _wrenHasModule = Module[\"_wrenHasModule\"] = createExportWrapper(\"wrenHasModule\");\r\n\r\n/** @type {function(...*):?} */\r\nvar _wrenAbortFiber = Module[\"_wrenAbortFiber\"] = createExportWrapper(\"wrenAbortFiber\");\r\n\r\n/** @type {function(...*):?} */\r\nvar _wrenGetUserData = Module[\"_wrenGetUserData\"] = createExportWrapper(\"wrenGetUserData\");\r\n\r\n/** @type {function(...*):?} */\r\nvar _wrenSetUserData = Module[\"_wrenSetUserData\"] = createExportWrapper(\"wrenSetUserData\");\r\n\r\n/** @type {function(...*):?} */\r\nvar _wrenAddImplicitImportModule = Module[\"_wrenAddImplicitImportModule\"] = createExportWrapper(\"wrenAddImplicitImportModule\");\r\n\r\n/** @type {function(...*):?} */\r\nvar _malloc = Module[\"_malloc\"] = createExportWrapper(\"malloc\");\r\n\r\n/** @type {function(...*):?} */\r\nvar _sock_font = Module[\"_sock_font\"] = createExportWrapper(\"sock_font\");\r\n\r\n/** @type {function(...*):?} */\r\nvar _sock_init = Module[\"_sock_init\"] = createExportWrapper(\"sock_init\");\r\n\r\n/** @type {function(...*):?} */\r\nvar _sock_new_buffer = Module[\"_sock_new_buffer\"] = createExportWrapper(\"sock_new_buffer\");\r\n\r\n/** @type {function(...*):?} */\r\nvar _sock_new_transform = Module[\"_sock_new_transform\"] = createExportWrapper(\"sock_new_transform\");\r\n\r\n/** @type {function(...*):?} */\r\nvar _sock_get_transform = Module[\"_sock_get_transform\"] = createExportWrapper(\"sock_get_transform\");\r\n\r\n/** @type {function(...*):?} */\r\nvar stackSave = Module[\"stackSave\"] = createExportWrapper(\"stackSave\");\r\n\r\n/** @type {function(...*):?} */\r\nvar stackRestore = Module[\"stackRestore\"] = createExportWrapper(\"stackRestore\");\r\n\r\n/** @type {function(...*):?} */\r\nvar stackAlloc = Module[\"stackAlloc\"] = createExportWrapper(\"stackAlloc\");\r\n\r\n/** @type {function(...*):?} */\r\nvar _emscripten_stack_init = Module[\"_emscripten_stack_init\"] = function() {\r\n  return (_emscripten_stack_init = Module[\"_emscripten_stack_init\"] = Module[\"asm\"][\"emscripten_stack_init\"]).apply(null, arguments);\r\n};\r\n\r\n/** @type {function(...*):?} */\r\nvar _emscripten_stack_get_free = Module[\"_emscripten_stack_get_free\"] = function() {\r\n  return (_emscripten_stack_get_free = Module[\"_emscripten_stack_get_free\"] = Module[\"asm\"][\"emscripten_stack_get_free\"]).apply(null, arguments);\r\n};\r\n\r\n/** @type {function(...*):?} */\r\nvar _emscripten_stack_get_end = Module[\"_emscripten_stack_get_end\"] = function() {\r\n  return (_emscripten_stack_get_end = Module[\"_emscripten_stack_get_end\"] = Module[\"asm\"][\"emscripten_stack_get_end\"]).apply(null, arguments);\r\n};\r\n\r\n/** @type {function(...*):?} */\r\nvar dynCall_jiji = Module[\"dynCall_jiji\"] = createExportWrapper(\"dynCall_jiji\");\r\n\r\n\r\n\r\n\r\n\r\n// === Auto-generated postamble setup entry stuff ===\r\n\r\nif (!Object.getOwnPropertyDescriptor(Module, \"intArrayFromString\")) Module[\"intArrayFromString\"] = function() { abort(\"'intArrayFromString' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"intArrayToString\")) Module[\"intArrayToString\"] = function() { abort(\"'intArrayToString' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nModule[\"ccall\"] = ccall;\r\nif (!Object.getOwnPropertyDescriptor(Module, \"cwrap\")) Module[\"cwrap\"] = function() { abort(\"'cwrap' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"setValue\")) Module[\"setValue\"] = function() { abort(\"'setValue' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"getValue\")) Module[\"getValue\"] = function() { abort(\"'getValue' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"allocate\")) Module[\"allocate\"] = function() { abort(\"'allocate' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"UTF8ArrayToString\")) Module[\"UTF8ArrayToString\"] = function() { abort(\"'UTF8ArrayToString' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"UTF8ToString\")) Module[\"UTF8ToString\"] = function() { abort(\"'UTF8ToString' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"stringToUTF8Array\")) Module[\"stringToUTF8Array\"] = function() { abort(\"'stringToUTF8Array' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"stringToUTF8\")) Module[\"stringToUTF8\"] = function() { abort(\"'stringToUTF8' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"lengthBytesUTF8\")) Module[\"lengthBytesUTF8\"] = function() { abort(\"'lengthBytesUTF8' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"stackTrace\")) Module[\"stackTrace\"] = function() { abort(\"'stackTrace' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"addOnPreRun\")) Module[\"addOnPreRun\"] = function() { abort(\"'addOnPreRun' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"addOnInit\")) Module[\"addOnInit\"] = function() { abort(\"'addOnInit' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"addOnPreMain\")) Module[\"addOnPreMain\"] = function() { abort(\"'addOnPreMain' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"addOnExit\")) Module[\"addOnExit\"] = function() { abort(\"'addOnExit' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"addOnPostRun\")) Module[\"addOnPostRun\"] = function() { abort(\"'addOnPostRun' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"writeStringToMemory\")) Module[\"writeStringToMemory\"] = function() { abort(\"'writeStringToMemory' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"writeArrayToMemory\")) Module[\"writeArrayToMemory\"] = function() { abort(\"'writeArrayToMemory' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"writeAsciiToMemory\")) Module[\"writeAsciiToMemory\"] = function() { abort(\"'writeAsciiToMemory' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"addRunDependency\")) Module[\"addRunDependency\"] = function() { abort(\"'addRunDependency' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ). Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"removeRunDependency\")) Module[\"removeRunDependency\"] = function() { abort(\"'removeRunDependency' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ). Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"FS_createFolder\")) Module[\"FS_createFolder\"] = function() { abort(\"'FS_createFolder' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"FS_createPath\")) Module[\"FS_createPath\"] = function() { abort(\"'FS_createPath' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ). Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"FS_createDataFile\")) Module[\"FS_createDataFile\"] = function() { abort(\"'FS_createDataFile' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ). Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"FS_createPreloadedFile\")) Module[\"FS_createPreloadedFile\"] = function() { abort(\"'FS_createPreloadedFile' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ). Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"FS_createLazyFile\")) Module[\"FS_createLazyFile\"] = function() { abort(\"'FS_createLazyFile' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ). Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"FS_createLink\")) Module[\"FS_createLink\"] = function() { abort(\"'FS_createLink' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"FS_createDevice\")) Module[\"FS_createDevice\"] = function() { abort(\"'FS_createDevice' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ). Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"FS_unlink\")) Module[\"FS_unlink\"] = function() { abort(\"'FS_unlink' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ). Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"getLEB\")) Module[\"getLEB\"] = function() { abort(\"'getLEB' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"getFunctionTables\")) Module[\"getFunctionTables\"] = function() { abort(\"'getFunctionTables' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"alignFunctionTables\")) Module[\"alignFunctionTables\"] = function() { abort(\"'alignFunctionTables' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"registerFunctions\")) Module[\"registerFunctions\"] = function() { abort(\"'registerFunctions' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nModule[\"addFunction\"] = addFunction;\r\nif (!Object.getOwnPropertyDescriptor(Module, \"removeFunction\")) Module[\"removeFunction\"] = function() { abort(\"'removeFunction' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"getFuncWrapper\")) Module[\"getFuncWrapper\"] = function() { abort(\"'getFuncWrapper' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"prettyPrint\")) Module[\"prettyPrint\"] = function() { abort(\"'prettyPrint' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"dynCall\")) Module[\"dynCall\"] = function() { abort(\"'dynCall' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"getCompilerSetting\")) Module[\"getCompilerSetting\"] = function() { abort(\"'getCompilerSetting' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"print\")) Module[\"print\"] = function() { abort(\"'print' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"printErr\")) Module[\"printErr\"] = function() { abort(\"'printErr' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"getTempRet0\")) Module[\"getTempRet0\"] = function() { abort(\"'getTempRet0' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"setTempRet0\")) Module[\"setTempRet0\"] = function() { abort(\"'setTempRet0' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"callMain\")) Module[\"callMain\"] = function() { abort(\"'callMain' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"abort\")) Module[\"abort\"] = function() { abort(\"'abort' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"keepRuntimeAlive\")) Module[\"keepRuntimeAlive\"] = function() { abort(\"'keepRuntimeAlive' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"zeroMemory\")) Module[\"zeroMemory\"] = function() { abort(\"'zeroMemory' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"stringToNewUTF8\")) Module[\"stringToNewUTF8\"] = function() { abort(\"'stringToNewUTF8' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"setFileTime\")) Module[\"setFileTime\"] = function() { abort(\"'setFileTime' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"emscripten_realloc_buffer\")) Module[\"emscripten_realloc_buffer\"] = function() { abort(\"'emscripten_realloc_buffer' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"ENV\")) Module[\"ENV\"] = function() { abort(\"'ENV' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"withStackSave\")) Module[\"withStackSave\"] = function() { abort(\"'withStackSave' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"ERRNO_CODES\")) Module[\"ERRNO_CODES\"] = function() { abort(\"'ERRNO_CODES' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"ERRNO_MESSAGES\")) Module[\"ERRNO_MESSAGES\"] = function() { abort(\"'ERRNO_MESSAGES' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"setErrNo\")) Module[\"setErrNo\"] = function() { abort(\"'setErrNo' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"inetPton4\")) Module[\"inetPton4\"] = function() { abort(\"'inetPton4' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"inetNtop4\")) Module[\"inetNtop4\"] = function() { abort(\"'inetNtop4' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"inetPton6\")) Module[\"inetPton6\"] = function() { abort(\"'inetPton6' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"inetNtop6\")) Module[\"inetNtop6\"] = function() { abort(\"'inetNtop6' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"readSockaddr\")) Module[\"readSockaddr\"] = function() { abort(\"'readSockaddr' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"writeSockaddr\")) Module[\"writeSockaddr\"] = function() { abort(\"'writeSockaddr' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"DNS\")) Module[\"DNS\"] = function() { abort(\"'DNS' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"getHostByName\")) Module[\"getHostByName\"] = function() { abort(\"'getHostByName' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"GAI_ERRNO_MESSAGES\")) Module[\"GAI_ERRNO_MESSAGES\"] = function() { abort(\"'GAI_ERRNO_MESSAGES' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"Protocols\")) Module[\"Protocols\"] = function() { abort(\"'Protocols' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"Sockets\")) Module[\"Sockets\"] = function() { abort(\"'Sockets' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"getRandomDevice\")) Module[\"getRandomDevice\"] = function() { abort(\"'getRandomDevice' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"traverseStack\")) Module[\"traverseStack\"] = function() { abort(\"'traverseStack' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"UNWIND_CACHE\")) Module[\"UNWIND_CACHE\"] = function() { abort(\"'UNWIND_CACHE' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"readAsmConstArgsArray\")) Module[\"readAsmConstArgsArray\"] = function() { abort(\"'readAsmConstArgsArray' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"readAsmConstArgs\")) Module[\"readAsmConstArgs\"] = function() { abort(\"'readAsmConstArgs' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"mainThreadEM_ASM\")) Module[\"mainThreadEM_ASM\"] = function() { abort(\"'mainThreadEM_ASM' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"jstoi_q\")) Module[\"jstoi_q\"] = function() { abort(\"'jstoi_q' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"jstoi_s\")) Module[\"jstoi_s\"] = function() { abort(\"'jstoi_s' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"getExecutableName\")) Module[\"getExecutableName\"] = function() { abort(\"'getExecutableName' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"listenOnce\")) Module[\"listenOnce\"] = function() { abort(\"'listenOnce' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"autoResumeAudioContext\")) Module[\"autoResumeAudioContext\"] = function() { abort(\"'autoResumeAudioContext' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"dynCallLegacy\")) Module[\"dynCallLegacy\"] = function() { abort(\"'dynCallLegacy' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"getDynCaller\")) Module[\"getDynCaller\"] = function() { abort(\"'getDynCaller' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"dynCall\")) Module[\"dynCall\"] = function() { abort(\"'dynCall' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"callRuntimeCallbacks\")) Module[\"callRuntimeCallbacks\"] = function() { abort(\"'callRuntimeCallbacks' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"wasmTableMirror\")) Module[\"wasmTableMirror\"] = function() { abort(\"'wasmTableMirror' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"setWasmTableEntry\")) Module[\"setWasmTableEntry\"] = function() { abort(\"'setWasmTableEntry' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"getWasmTableEntry\")) Module[\"getWasmTableEntry\"] = function() { abort(\"'getWasmTableEntry' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"handleException\")) Module[\"handleException\"] = function() { abort(\"'handleException' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"runtimeKeepalivePush\")) Module[\"runtimeKeepalivePush\"] = function() { abort(\"'runtimeKeepalivePush' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"runtimeKeepalivePop\")) Module[\"runtimeKeepalivePop\"] = function() { abort(\"'runtimeKeepalivePop' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"callUserCallback\")) Module[\"callUserCallback\"] = function() { abort(\"'callUserCallback' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"maybeExit\")) Module[\"maybeExit\"] = function() { abort(\"'maybeExit' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"safeSetTimeout\")) Module[\"safeSetTimeout\"] = function() { abort(\"'safeSetTimeout' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"asmjsMangle\")) Module[\"asmjsMangle\"] = function() { abort(\"'asmjsMangle' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"asyncLoad\")) Module[\"asyncLoad\"] = function() { abort(\"'asyncLoad' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"alignMemory\")) Module[\"alignMemory\"] = function() { abort(\"'alignMemory' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"mmapAlloc\")) Module[\"mmapAlloc\"] = function() { abort(\"'mmapAlloc' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"reallyNegative\")) Module[\"reallyNegative\"] = function() { abort(\"'reallyNegative' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"unSign\")) Module[\"unSign\"] = function() { abort(\"'unSign' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"reSign\")) Module[\"reSign\"] = function() { abort(\"'reSign' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"formatString\")) Module[\"formatString\"] = function() { abort(\"'formatString' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"PATH\")) Module[\"PATH\"] = function() { abort(\"'PATH' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"PATH_FS\")) Module[\"PATH_FS\"] = function() { abort(\"'PATH_FS' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"SYSCALLS\")) Module[\"SYSCALLS\"] = function() { abort(\"'SYSCALLS' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"syscallMmap2\")) Module[\"syscallMmap2\"] = function() { abort(\"'syscallMmap2' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"syscallMunmap\")) Module[\"syscallMunmap\"] = function() { abort(\"'syscallMunmap' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"getSocketFromFD\")) Module[\"getSocketFromFD\"] = function() { abort(\"'getSocketFromFD' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"getSocketAddress\")) Module[\"getSocketAddress\"] = function() { abort(\"'getSocketAddress' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"JSEvents\")) Module[\"JSEvents\"] = function() { abort(\"'JSEvents' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"registerKeyEventCallback\")) Module[\"registerKeyEventCallback\"] = function() { abort(\"'registerKeyEventCallback' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"specialHTMLTargets\")) Module[\"specialHTMLTargets\"] = function() { abort(\"'specialHTMLTargets' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"maybeCStringToJsString\")) Module[\"maybeCStringToJsString\"] = function() { abort(\"'maybeCStringToJsString' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"findEventTarget\")) Module[\"findEventTarget\"] = function() { abort(\"'findEventTarget' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"findCanvasEventTarget\")) Module[\"findCanvasEventTarget\"] = function() { abort(\"'findCanvasEventTarget' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"getBoundingClientRect\")) Module[\"getBoundingClientRect\"] = function() { abort(\"'getBoundingClientRect' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"fillMouseEventData\")) Module[\"fillMouseEventData\"] = function() { abort(\"'fillMouseEventData' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"registerMouseEventCallback\")) Module[\"registerMouseEventCallback\"] = function() { abort(\"'registerMouseEventCallback' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"registerWheelEventCallback\")) Module[\"registerWheelEventCallback\"] = function() { abort(\"'registerWheelEventCallback' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"registerUiEventCallback\")) Module[\"registerUiEventCallback\"] = function() { abort(\"'registerUiEventCallback' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"registerFocusEventCallback\")) Module[\"registerFocusEventCallback\"] = function() { abort(\"'registerFocusEventCallback' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"fillDeviceOrientationEventData\")) Module[\"fillDeviceOrientationEventData\"] = function() { abort(\"'fillDeviceOrientationEventData' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"registerDeviceOrientationEventCallback\")) Module[\"registerDeviceOrientationEventCallback\"] = function() { abort(\"'registerDeviceOrientationEventCallback' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"fillDeviceMotionEventData\")) Module[\"fillDeviceMotionEventData\"] = function() { abort(\"'fillDeviceMotionEventData' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"registerDeviceMotionEventCallback\")) Module[\"registerDeviceMotionEventCallback\"] = function() { abort(\"'registerDeviceMotionEventCallback' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"screenOrientation\")) Module[\"screenOrientation\"] = function() { abort(\"'screenOrientation' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"fillOrientationChangeEventData\")) Module[\"fillOrientationChangeEventData\"] = function() { abort(\"'fillOrientationChangeEventData' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"registerOrientationChangeEventCallback\")) Module[\"registerOrientationChangeEventCallback\"] = function() { abort(\"'registerOrientationChangeEventCallback' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"fillFullscreenChangeEventData\")) Module[\"fillFullscreenChangeEventData\"] = function() { abort(\"'fillFullscreenChangeEventData' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"registerFullscreenChangeEventCallback\")) Module[\"registerFullscreenChangeEventCallback\"] = function() { abort(\"'registerFullscreenChangeEventCallback' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"registerRestoreOldStyle\")) Module[\"registerRestoreOldStyle\"] = function() { abort(\"'registerRestoreOldStyle' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"hideEverythingExceptGivenElement\")) Module[\"hideEverythingExceptGivenElement\"] = function() { abort(\"'hideEverythingExceptGivenElement' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"restoreHiddenElements\")) Module[\"restoreHiddenElements\"] = function() { abort(\"'restoreHiddenElements' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"setLetterbox\")) Module[\"setLetterbox\"] = function() { abort(\"'setLetterbox' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"currentFullscreenStrategy\")) Module[\"currentFullscreenStrategy\"] = function() { abort(\"'currentFullscreenStrategy' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"restoreOldWindowedStyle\")) Module[\"restoreOldWindowedStyle\"] = function() { abort(\"'restoreOldWindowedStyle' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"softFullscreenResizeWebGLRenderTarget\")) Module[\"softFullscreenResizeWebGLRenderTarget\"] = function() { abort(\"'softFullscreenResizeWebGLRenderTarget' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"doRequestFullscreen\")) Module[\"doRequestFullscreen\"] = function() { abort(\"'doRequestFullscreen' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"fillPointerlockChangeEventData\")) Module[\"fillPointerlockChangeEventData\"] = function() { abort(\"'fillPointerlockChangeEventData' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"registerPointerlockChangeEventCallback\")) Module[\"registerPointerlockChangeEventCallback\"] = function() { abort(\"'registerPointerlockChangeEventCallback' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"registerPointerlockErrorEventCallback\")) Module[\"registerPointerlockErrorEventCallback\"] = function() { abort(\"'registerPointerlockErrorEventCallback' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"requestPointerLock\")) Module[\"requestPointerLock\"] = function() { abort(\"'requestPointerLock' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"fillVisibilityChangeEventData\")) Module[\"fillVisibilityChangeEventData\"] = function() { abort(\"'fillVisibilityChangeEventData' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"registerVisibilityChangeEventCallback\")) Module[\"registerVisibilityChangeEventCallback\"] = function() { abort(\"'registerVisibilityChangeEventCallback' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"registerTouchEventCallback\")) Module[\"registerTouchEventCallback\"] = function() { abort(\"'registerTouchEventCallback' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"fillGamepadEventData\")) Module[\"fillGamepadEventData\"] = function() { abort(\"'fillGamepadEventData' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"registerGamepadEventCallback\")) Module[\"registerGamepadEventCallback\"] = function() { abort(\"'registerGamepadEventCallback' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"registerBeforeUnloadEventCallback\")) Module[\"registerBeforeUnloadEventCallback\"] = function() { abort(\"'registerBeforeUnloadEventCallback' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"fillBatteryEventData\")) Module[\"fillBatteryEventData\"] = function() { abort(\"'fillBatteryEventData' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"battery\")) Module[\"battery\"] = function() { abort(\"'battery' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"registerBatteryEventCallback\")) Module[\"registerBatteryEventCallback\"] = function() { abort(\"'registerBatteryEventCallback' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"setCanvasElementSize\")) Module[\"setCanvasElementSize\"] = function() { abort(\"'setCanvasElementSize' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"getCanvasElementSize\")) Module[\"getCanvasElementSize\"] = function() { abort(\"'getCanvasElementSize' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"demangle\")) Module[\"demangle\"] = function() { abort(\"'demangle' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"demangleAll\")) Module[\"demangleAll\"] = function() { abort(\"'demangleAll' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"jsStackTrace\")) Module[\"jsStackTrace\"] = function() { abort(\"'jsStackTrace' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"stackTrace\")) Module[\"stackTrace\"] = function() { abort(\"'stackTrace' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"getEnvStrings\")) Module[\"getEnvStrings\"] = function() { abort(\"'getEnvStrings' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"checkWasiClock\")) Module[\"checkWasiClock\"] = function() { abort(\"'checkWasiClock' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"flush_NO_FILESYSTEM\")) Module[\"flush_NO_FILESYSTEM\"] = function() { abort(\"'flush_NO_FILESYSTEM' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"writeI53ToI64\")) Module[\"writeI53ToI64\"] = function() { abort(\"'writeI53ToI64' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"writeI53ToI64Clamped\")) Module[\"writeI53ToI64Clamped\"] = function() { abort(\"'writeI53ToI64Clamped' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"writeI53ToI64Signaling\")) Module[\"writeI53ToI64Signaling\"] = function() { abort(\"'writeI53ToI64Signaling' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"writeI53ToU64Clamped\")) Module[\"writeI53ToU64Clamped\"] = function() { abort(\"'writeI53ToU64Clamped' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"writeI53ToU64Signaling\")) Module[\"writeI53ToU64Signaling\"] = function() { abort(\"'writeI53ToU64Signaling' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"readI53FromI64\")) Module[\"readI53FromI64\"] = function() { abort(\"'readI53FromI64' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"readI53FromU64\")) Module[\"readI53FromU64\"] = function() { abort(\"'readI53FromU64' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"convertI32PairToI53\")) Module[\"convertI32PairToI53\"] = function() { abort(\"'convertI32PairToI53' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"convertU32PairToI53\")) Module[\"convertU32PairToI53\"] = function() { abort(\"'convertU32PairToI53' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"setImmediateWrapped\")) Module[\"setImmediateWrapped\"] = function() { abort(\"'setImmediateWrapped' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"clearImmediateWrapped\")) Module[\"clearImmediateWrapped\"] = function() { abort(\"'clearImmediateWrapped' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"polyfillSetImmediate\")) Module[\"polyfillSetImmediate\"] = function() { abort(\"'polyfillSetImmediate' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"uncaughtExceptionCount\")) Module[\"uncaughtExceptionCount\"] = function() { abort(\"'uncaughtExceptionCount' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"exceptionLast\")) Module[\"exceptionLast\"] = function() { abort(\"'exceptionLast' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"exceptionCaught\")) Module[\"exceptionCaught\"] = function() { abort(\"'exceptionCaught' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"ExceptionInfo\")) Module[\"ExceptionInfo\"] = function() { abort(\"'ExceptionInfo' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"CatchInfo\")) Module[\"CatchInfo\"] = function() { abort(\"'CatchInfo' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"exception_addRef\")) Module[\"exception_addRef\"] = function() { abort(\"'exception_addRef' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"exception_decRef\")) Module[\"exception_decRef\"] = function() { abort(\"'exception_decRef' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"Browser\")) Module[\"Browser\"] = function() { abort(\"'Browser' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"funcWrappers\")) Module[\"funcWrappers\"] = function() { abort(\"'funcWrappers' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"getFuncWrapper\")) Module[\"getFuncWrapper\"] = function() { abort(\"'getFuncWrapper' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"setMainLoop\")) Module[\"setMainLoop\"] = function() { abort(\"'setMainLoop' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"wget\")) Module[\"wget\"] = function() { abort(\"'wget' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"tempFixedLengthArray\")) Module[\"tempFixedLengthArray\"] = function() { abort(\"'tempFixedLengthArray' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"miniTempWebGLFloatBuffers\")) Module[\"miniTempWebGLFloatBuffers\"] = function() { abort(\"'miniTempWebGLFloatBuffers' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"heapObjectForWebGLType\")) Module[\"heapObjectForWebGLType\"] = function() { abort(\"'heapObjectForWebGLType' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"heapAccessShiftForWebGLHeap\")) Module[\"heapAccessShiftForWebGLHeap\"] = function() { abort(\"'heapAccessShiftForWebGLHeap' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"GL\")) Module[\"GL\"] = function() { abort(\"'GL' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"emscriptenWebGLGet\")) Module[\"emscriptenWebGLGet\"] = function() { abort(\"'emscriptenWebGLGet' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"computeUnpackAlignedImageSize\")) Module[\"computeUnpackAlignedImageSize\"] = function() { abort(\"'computeUnpackAlignedImageSize' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"emscriptenWebGLGetTexPixelData\")) Module[\"emscriptenWebGLGetTexPixelData\"] = function() { abort(\"'emscriptenWebGLGetTexPixelData' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"emscriptenWebGLGetUniform\")) Module[\"emscriptenWebGLGetUniform\"] = function() { abort(\"'emscriptenWebGLGetUniform' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"webglGetUniformLocation\")) Module[\"webglGetUniformLocation\"] = function() { abort(\"'webglGetUniformLocation' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"webglPrepareUniformLocationsBeforeFirstUse\")) Module[\"webglPrepareUniformLocationsBeforeFirstUse\"] = function() { abort(\"'webglPrepareUniformLocationsBeforeFirstUse' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"webglGetLeftBracePos\")) Module[\"webglGetLeftBracePos\"] = function() { abort(\"'webglGetLeftBracePos' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"emscriptenWebGLGetVertexAttrib\")) Module[\"emscriptenWebGLGetVertexAttrib\"] = function() { abort(\"'emscriptenWebGLGetVertexAttrib' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"writeGLArray\")) Module[\"writeGLArray\"] = function() { abort(\"'writeGLArray' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"AL\")) Module[\"AL\"] = function() { abort(\"'AL' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"SDL_unicode\")) Module[\"SDL_unicode\"] = function() { abort(\"'SDL_unicode' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"SDL_ttfContext\")) Module[\"SDL_ttfContext\"] = function() { abort(\"'SDL_ttfContext' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"SDL_audio\")) Module[\"SDL_audio\"] = function() { abort(\"'SDL_audio' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"SDL\")) Module[\"SDL\"] = function() { abort(\"'SDL' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"SDL_gfx\")) Module[\"SDL_gfx\"] = function() { abort(\"'SDL_gfx' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"GLUT\")) Module[\"GLUT\"] = function() { abort(\"'GLUT' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"EGL\")) Module[\"EGL\"] = function() { abort(\"'EGL' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"GLFW_Window\")) Module[\"GLFW_Window\"] = function() { abort(\"'GLFW_Window' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"GLFW\")) Module[\"GLFW\"] = function() { abort(\"'GLFW' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"GLEW\")) Module[\"GLEW\"] = function() { abort(\"'GLEW' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"IDBStore\")) Module[\"IDBStore\"] = function() { abort(\"'IDBStore' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"runAndAbortIfError\")) Module[\"runAndAbortIfError\"] = function() { abort(\"'runAndAbortIfError' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"warnOnce\")) Module[\"warnOnce\"] = function() { abort(\"'warnOnce' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"stackSave\")) Module[\"stackSave\"] = function() { abort(\"'stackSave' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"stackRestore\")) Module[\"stackRestore\"] = function() { abort(\"'stackRestore' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"stackAlloc\")) Module[\"stackAlloc\"] = function() { abort(\"'stackAlloc' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"AsciiToString\")) Module[\"AsciiToString\"] = function() { abort(\"'AsciiToString' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"stringToAscii\")) Module[\"stringToAscii\"] = function() { abort(\"'stringToAscii' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"UTF16ToString\")) Module[\"UTF16ToString\"] = function() { abort(\"'UTF16ToString' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"stringToUTF16\")) Module[\"stringToUTF16\"] = function() { abort(\"'stringToUTF16' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"lengthBytesUTF16\")) Module[\"lengthBytesUTF16\"] = function() { abort(\"'lengthBytesUTF16' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"UTF32ToString\")) Module[\"UTF32ToString\"] = function() { abort(\"'UTF32ToString' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"stringToUTF32\")) Module[\"stringToUTF32\"] = function() { abort(\"'stringToUTF32' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"lengthBytesUTF32\")) Module[\"lengthBytesUTF32\"] = function() { abort(\"'lengthBytesUTF32' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"allocateUTF8\")) Module[\"allocateUTF8\"] = function() { abort(\"'allocateUTF8' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"allocateUTF8OnStack\")) Module[\"allocateUTF8OnStack\"] = function() { abort(\"'allocateUTF8OnStack' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nModule[\"writeStackCookie\"] = writeStackCookie;\r\nModule[\"checkStackCookie\"] = checkStackCookie;\r\nif (!Object.getOwnPropertyDescriptor(Module, \"ALLOC_NORMAL\")) Object.defineProperty(Module, \"ALLOC_NORMAL\", { configurable: true, get: function() { abort(\"'ALLOC_NORMAL' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") } });\r\nif (!Object.getOwnPropertyDescriptor(Module, \"ALLOC_STACK\")) Object.defineProperty(Module, \"ALLOC_STACK\", { configurable: true, get: function() { abort(\"'ALLOC_STACK' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") } });\r\n\r\nvar calledRun;\r\n\r\n/**\r\n * @constructor\r\n * @this {ExitStatus}\r\n */\r\nfunction ExitStatus(status) {\r\n  this.name = \"ExitStatus\";\r\n  this.message = \"Program terminated with exit(\" + status + \")\";\r\n  this.status = status;\r\n}\r\n\r\nvar calledMain = false;\r\n\r\ndependenciesFulfilled = function runCaller() {\r\n  // If run has never been called, and we should call run (INVOKE_RUN is true, and Module.noInitialRun is not false)\r\n  if (!calledRun) run();\r\n  if (!calledRun) dependenciesFulfilled = runCaller; // try this again later, after new deps are fulfilled\r\n};\r\n\r\nfunction stackCheckInit() {\r\n  // This is normally called automatically during __wasm_call_ctors but need to\r\n  // get these values before even running any of the ctors so we call it redundantly\r\n  // here.\r\n  // TODO(sbc): Move writeStackCookie to native to to avoid this.\r\n  _emscripten_stack_init();\r\n  writeStackCookie();\r\n}\r\n\r\n/** @type {function(Array=)} */\r\nfunction run(args) {\r\n  args = args || arguments_;\r\n\r\n  if (runDependencies > 0) {\r\n    return;\r\n  }\r\n\r\n  stackCheckInit();\r\n\r\n  preRun();\r\n\r\n  // a preRun added a dependency, run will be called later\r\n  if (runDependencies > 0) {\r\n    return;\r\n  }\r\n\r\n  function doRun() {\r\n    // run may have just been called through dependencies being fulfilled just in this very frame,\r\n    // or while the async setStatus time below was happening\r\n    if (calledRun) return;\r\n    calledRun = true;\r\n    Module['calledRun'] = true;\r\n\r\n    if (ABORT) return;\r\n\r\n    initRuntime();\r\n\r\n    readyPromiseResolve(Module);\r\n\r\n    assert(!Module['_main'], 'compiled without a main, but one is present. if you added it from JS, use Module[\"onRuntimeInitialized\"]');\r\n\r\n    postRun();\r\n  }\r\n\r\n  {\r\n    doRun();\r\n  }\r\n  checkStackCookie();\r\n}\r\nModule['run'] = run;\r\n\r\nfunction checkUnflushedContent() {\r\n  // Compiler settings do not allow exiting the runtime, so flushing\r\n  // the streams is not possible. but in ASSERTIONS mode we check\r\n  // if there was something to flush, and if so tell the user they\r\n  // should request that the runtime be exitable.\r\n  // Normally we would not even include flush() at all, but in ASSERTIONS\r\n  // builds we do so just for this check, and here we see if there is any\r\n  // content to flush, that is, we check if there would have been\r\n  // something a non-ASSERTIONS build would have not seen.\r\n  // How we flush the streams depends on whether we are in SYSCALLS_REQUIRE_FILESYSTEM=0\r\n  // mode (which has its own special function for this; otherwise, all\r\n  // the code is inside libc)\r\n  var oldOut = out;\r\n  var oldErr = err;\r\n  var has = false;\r\n  out = err = function(x) {\r\n    has = true;\r\n  }\r\n  try { // it doesn't matter if it fails\r\n    var flush = flush_NO_FILESYSTEM;\r\n    if (flush) flush();\r\n  } catch(e) {}\r\n  out = oldOut;\r\n  err = oldErr;\r\n  if (has) {\r\n    warnOnce('stdio streams had content in them that was not flushed. you should set EXIT_RUNTIME to 1 (see the FAQ), or make sure to emit a newline when you printf etc.');\r\n    warnOnce('(this may also be due to not including full filesystem support - try building with -s FORCE_FILESYSTEM=1)');\r\n  }\r\n}\r\n\r\n/** @param {boolean|number=} implicit */\r\nfunction exit(status, implicit) {\r\n  EXITSTATUS = status;\r\n\r\n  checkUnflushedContent();\r\n\r\n  if (keepRuntimeAlive()) {\r\n    // if exit() was called, we may warn the user if the runtime isn't actually being shut down\r\n    if (!implicit) {\r\n      var msg = 'program exited (with status: ' + status + '), but EXIT_RUNTIME is not set, so halting execution but not exiting the runtime or preventing further async execution (build with EXIT_RUNTIME=1, if you want a true shutdown)';\r\n      readyPromiseReject(msg);\r\n      err(msg);\r\n    }\r\n  } else {\r\n    exitRuntime();\r\n  }\r\n\r\n  procExit(status);\r\n}\r\n\r\nfunction procExit(code) {\r\n  EXITSTATUS = code;\r\n  if (!keepRuntimeAlive()) {\r\n    ABORT = true;\r\n  }\r\n  quit_(code, new ExitStatus(code));\r\n}\r\n\r\nrun();\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n  return Module.ready\r\n}\r\n);\r\n})();\r\nexport default Module;","import { canvas } from \"./canvas.js\";\r\n\r\n/**\r\n * A global JavaScript object \"sock\".\r\n * Provides utils for globally executing code, e.g. from the Wren `JavaScript` class.\r\n * @type {any}\r\n */\r\nexport let sockJsGlobal = Object.assign(self[\"sock\"] || (self[\"sock\"] = {}), {\r\n\t\r\n\tcanvas: canvas,\r\n\t\r\n\tasync toggleFullscreen() {\r\n\t\tif (document.fullscreenEnabled) {\r\n\t\t\tif (document.fullscreenElement) {\r\n\t\t\t\tawait document.exitFullscreen();\r\n\t\t\t\treturn true;\r\n\t\t\t} else {\r\n\t\t\t\ttry {\r\n\t\t\t\t\tawait document.body.requestFullscreen();\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t} catch (error) {\r\n\t\t\t\t\tconsole.warn(error);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tconsole.warn(\"fullscreen is blocked by the browser\");\r\n\t\t}\r\n\t\treturn false;\r\n\t},\r\n\r\n\ttogglePointerLock() {\r\n\t\tif (document.pointerLockElement) {\r\n\t\t\tdocument.exitPointerLock();\r\n\t\t} else {\r\n\t\t\tcanvas.requestPointerLock();\r\n\t\t}\r\n\t},\r\n\r\n});\r\n","import { resolveForeignMethod, resolveForeignClass } from \"./foreign.js\";\r\nimport { httpGET } from \"./network/http.js\";\r\nimport sockEmscriptenFactory from \"../js-generated/sock_c.js\";\r\nimport { messagingEnabled, sendMessage } from \"./messaging.js\";\r\nimport { sockJsGlobal } from \"./globals.js\";\r\n\r\n/**\r\n * The Emscripten module. Loaded asyncronusly.\r\n * @type {import(\"../js-generated/sock_c.js\").SockEmscriptenModule}\r\n */\r\nexport let Module;\r\n\r\nexport function HEAP() {\r\n\treturn Module.HEAPU8.buffer;\r\n}\r\n\r\nexport function HEAPU8() {\r\n\treturn Module.HEAPU8;\r\n}\r\n\r\nexport function HEAPF64() {\r\n\treturn Module.HEAPF64;\r\n}\r\n\r\n/**\r\n * Used to accumlate Wren writes.\r\n */\r\nlet writeBuffer = \"\";\r\n\r\n/**\r\n * Holds a setTimeout() ID. Used for automatic `writeBuffer` flushing.\r\n * @type {number}\r\n */\r\nlet writeBufferTimeoutID;\r\n\r\n/**\r\n * Pointer to Wren VM.\r\n * @type {number}\r\n */\r\nexport let vm;\r\n\r\nexport async function loadEmscripten() {\r\n\t// Load the Emscripten module.\r\n\tModule = await sockEmscriptenFactory();\r\n\t\r\n\tsockJsGlobal.Module = Module;\r\n\r\n\t// Setup [Module.sock] object.\r\n\t// This is used by [src/js-esm/library.js] to enable C->JS communication.\r\n\tModule.sock = {\r\n\t\t/**\r\n\t\t * @param {string} line\r\n\t\t */\r\n\t\twrite(line) {\r\n\t\t\tconsole.log(line);\r\n\r\n\t\t\tif (messagingEnabled) {\r\n\t\t\t\tsendMessage(\"print\", line);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * @param {number} type\r\n\t\t * @param {string} moduleName\r\n\t\t * @param {number} lineNumber\r\n\t\t * @param {string} message\r\n\t\t */\r\n\t\terror(type, moduleName, lineNumber, message) {\r\n\t\t\twrenHasError = true;\r\n\r\n\t\t\tlet s;\r\n\t\t\tif (type === 0) {\r\n\t\t\t\t// Compile error.\r\n\t\t\t\twrenErrorMessage = message;\r\n\r\n\t\t\t\ts = `[WREN COMPILE ERROR]\\n${message}\\n  at ${formatModuleLineTrace(moduleName, lineNumber)}`;\r\n\r\n\t\t\t\twrenErrorStack = [];\r\n\t\t\t\twrenErrorStack.push([ moduleName, lineNumber, null ]);\r\n\t\t\t} else if (type === 1) {\r\n\t\t\t\t// Runtime error.\r\n\t\t\t\twrenErrorMessage = message;\r\n\r\n\t\t\t\ts = \"[WREN RUNTIME ERROR]\\n\" + message;\r\n\r\n\t\t\t\twrenErrorStack = [];\r\n\t\t\t} else if (type === 2) {\r\n\t\t\t\t// Stack trace\r\n\t\t\t\ts = `  at ${message} ${formatModuleLineTrace(moduleName, lineNumber)}`;\r\n\r\n\t\t\t\twrenErrorStack.push([ moduleName, lineNumber, message ]);\r\n\t\t\t}\r\n\r\n\t\t\t// Always log errors to console.\r\n\t\t\tconsole.error(s);\r\n\t\t\t\r\n\t\t\t// Join with newlines.\r\n\t\t\twrenErrorString = wrenErrorString ? wrenErrorString + \"\\n\" + s : s;\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * @param {string} moduleName\r\n\t\t */\r\n\t\tloadModule(moduleName) {\r\n\t\t\t// Use fiber hack to do async load.\r\n\t\t\thttpGET(\"assets\" + moduleName + \".wren\", \"arraybuffer\").then(\r\n\t\t\t\t(buffer) => {\r\n\t\t\t\t\tlet result = wrenInterpret(moduleName, buffer);\r\n\r\n\t\t\t\t\tif (result === 0) {\r\n\t\t\t\t\t\twrenInterpret(moduleName, \"self__.transfer()\");\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\t(error) => {\r\n\t\t\t\t\tconsole.warn(`Error loading module source \"${moduleName}\"`, error);\r\n\r\n\t\t\t\t\twrenInterpret(moduleName, \"self__.transferError(\" + stringToWrenString(String(error)) + \")\");\r\n\t\t\t\t}\r\n\t\t\t);\r\n\r\n\t\t\treturn \"var self__=Fiber.current\\nFiber.suspend()\\nself__=null\";\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * @param {string} module\r\n\t\t * @param {string} className\r\n\t\t * @param {boolean} isStatic\r\n\t\t * @param {string} signature\r\n\t\t * @returns {(vm: number) => void}\r\n\t\t */\r\n\t\tbindMethod(module, className, isStatic, signature) {\r\n\t\t\treturn resolveForeignMethod(module, className, isStatic, signature)\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * @param {string} module\r\n\t\t * @param {string} className\r\n\t\t * @returns {[(vm: number) => void, (vm: number) => void]}\r\n\t\t */\r\n\t\tbindClass(module, className) {\r\n\t\t\treturn resolveForeignClass(module, className);\r\n\t\t},\r\n\t};\r\n\r\n\t// Init C sock.\r\n\tvm = Module.ccall(\"sock_init\", \"number\");\r\n\tif (vm === 0) throw Error(\"error loading VM\");\r\n}\r\n\r\n/**\r\n * Interpret a Wren script in the given module.\r\n * @param {string} moduleName\r\n * @param {CStringSource} moduleSource \r\n * @returns {WrenInterpretResult}\r\n */\r\nexport function wrenInterpret(moduleName, moduleSource) {\r\n\tlet stack = 0;\r\n\r\n\tlet src, srcType;\r\n\tif (typeof moduleSource === \"string\") {\r\n\t\tsrc = moduleSource;\r\n\t\tsrcType = \"string\";\r\n\t} else {\r\n\t\tstack = Module.stackSave();\r\n\t\tsrc = stackAllocUTF8ArrayAsCString(moduleSource);\r\n\t\tsrcType = \"number\";\r\n\t}\r\n\r\n\tlet result = Module.ccall(\"wrenInterpret\",\r\n\t\t\"number\",\r\n\t\t[\"number\", \"string\", srcType],\r\n\t\t[vm, moduleName, src]\r\n\t);\r\n\r\n\tif (stack) {\r\n\t\tModule.stackRestore(stack);\r\n\t}\r\n\r\n\treturn result;\r\n}\r\n\r\n/**\r\n * Check if a module has a variable of the given name.\r\n * @param {string} moduleName\r\n * @param {string} name \r\n * @returns {boolean}\r\n */\r\nexport function wrenHasVariable(moduleName, name) {\r\n\treturn Module.ccall(\"wrenHasVariable\",\r\n\t\t\"boolean\",\r\n\t\t[\"number\", \"string\", \"string\"],\r\n\t\t[vm, moduleName, name]\r\n\t);\r\n}\r\n\r\n/**\r\n * Check if a module has a variable of the given name.\r\n * @param {number} numSlots\r\n */\r\nexport function wrenEnsureSlots(numSlots) {\r\n\tModule.ccall(\"wrenEnsureSlots\",\r\n\t\tnull,\r\n\t\t[\"number\", \"number\"],\r\n\t\t[vm, numSlots]\r\n\t);\r\n}\r\n\r\n/**\r\n * @param {number} slot\r\n * @returns {number}\r\n */\r\nexport function wrenGetSlotType(slot) {\r\n\treturn Module.ccall(\"wrenGetSlotType\",\r\n\t\t\"number\",\r\n\t\t[\"number\", \"number\"],\r\n\t\t[vm, slot]\r\n\t);\r\n}\r\n\r\n/**\r\n * @param {number} slot\r\n * @returns {boolean}\r\n */\r\nexport function wrenGetSlotBool(slot) {\r\n\treturn Module.ccall(\"wrenGetSlotBool\",\r\n\t\t\"boolean\",\r\n\t\t[\"number\", \"number\"],\r\n\t\t[vm, slot]\r\n\t);\r\n}\r\n\r\n/**\r\n * @param {number} slot\r\n * @returns {string}\r\n */\r\nexport function wrenGetSlotString(slot) {\r\n\treturn Module.ccall(\"wrenGetSlotString\",\r\n\t\t\"string\",\r\n\t\t[\"number\", \"number\"],\r\n\t\t[vm, slot]\r\n\t);\r\n}\r\n\r\n/**\r\n * @param {number} slot\r\n * @returns {Uint8Array}\r\n */\r\nexport function getSlotBytes(slot) {\r\n\tlet stack = Module.stackSave();\r\n\r\n\tlet lenPtr = Module.stackAlloc(4);\r\n\r\n\tlet ptr = Module.ccall(\"wrenGetSlotBytes\",\r\n\t\t\"number\",\r\n\t\t[\"number\", \"number\", \"number\"],\r\n\t\t[vm, slot, lenPtr]\r\n\t);\r\n\r\n\tlet heap = HEAP();\r\n\r\n\tlet length = new Int32Array(heap, lenPtr)[0];\r\n\r\n\tModule.stackRestore(stack);\r\n\r\n\treturn new Uint8Array(heap, ptr, length);\r\n}\r\n\r\n/**\r\n * @param {number} slot\r\n * @returns {number}\r\n */\r\nexport function wrenGetSlotDouble(slot) {\r\n\treturn Module.ccall(\"wrenGetSlotDouble\",\r\n\t\t\"number\",\r\n\t\t[\"number\", \"number\"],\r\n\t\t[vm, slot]\r\n\t);\r\n}\r\n\r\n/**\r\n * @param {number} slot\r\n * @returns {number}\r\n */\r\nexport function wrenGetListCount(slot) {\r\n\treturn Module.ccall(\"wrenGetListCount\",\r\n\t\t\"number\",\r\n\t\t[\"number\", \"number\"],\r\n\t\t[vm, slot]\r\n\t);\r\n}\r\n\r\n/**\r\n * @param {number} listSlot\r\n * @param {number} index\r\n * @param {number} elementSlot\r\n */\r\nexport function wrenGetListElement(listSlot, index, elementSlot) {\r\n\tModule.ccall(\"wrenGetListElement\",\r\n\t\tnull,\r\n\t\t[\"number\", \"number\", \"number\", \"number\"],\r\n\t\t[vm, listSlot, index, elementSlot]\r\n\t);\r\n}\r\n\r\n/**\r\n * @param {number} listSlot\r\n * @param {number} index\r\n * @param {number} elementSlot\r\n */\r\nexport function wrenSetListElement(listSlot, index, elementSlot) {\r\n\tModule.ccall(\"wrenSetListElement\",\r\n\t\tnull,\r\n\t\t[\"number\", \"number\", \"number\", \"number\"],\r\n\t\t[vm, listSlot, index, elementSlot]\r\n\t);\r\n}\r\n\r\n/**\r\n * @param {number} listSlot\r\n * @param {number} index\r\n * @param {number} elementSlot\r\n */\r\nexport function wrenInsertInList(listSlot, index, elementSlot) {\r\n\tModule.ccall(\"wrenInsertInList\",\r\n\t\tnull,\r\n\t\t[\"number\", \"number\", \"number\", \"number\"],\r\n\t\t[vm, listSlot, index, elementSlot]\r\n\t);\r\n}\r\n\r\n/**\r\n * @param {number} mapSlot\r\n */\r\nexport function wrenSetSlotNewMap(mapSlot) {\r\n\tModule.ccall(\"wrenSetSlotNewMap\",\r\n\t\tnull,\r\n\t\t[\"number\", \"number\"],\r\n\t\t[vm, mapSlot]\r\n\t);\r\n}\r\n\r\n/**\r\n * @param {number} mapSlot\r\n * @param {number} keySlot\r\n * @param {number} valueSlot\r\n */\r\nexport function wrenSetMapValue(mapSlot, keySlot, valueSlot) {\r\n\tModule.ccall(\"wrenSetMapValue\",\r\n\t\tnull,\r\n\t\t[\"number\", \"number\", \"number\", \"number\"],\r\n\t\t[vm, mapSlot, keySlot, valueSlot]\r\n\t);\r\n}\r\n\r\n/**\r\n * @param {number} slot\r\n * @returns {number}\r\n */\r\nexport function wrenGetSlotForeign(slot) {\r\n\treturn Module.ccall(\"wrenGetSlotForeign\",\r\n\t\t\"number\",\r\n\t\t[\"number\", \"number\"],\r\n\t\t[vm, slot]\r\n\t);\r\n}\r\n\r\n/**\r\n * @param {number} slot\r\n * @param {number} classSlot\r\n * @returns {boolean}\r\n */\r\nexport function wrenGetSlotIsInstanceOf(slot, classSlot) {\r\n\treturn Module.ccall(\"wrenGetSlotIsInstanceOf\",\r\n\t\t\"boolean\",\r\n\t\t[\"number\", \"number\", \"number\"],\r\n\t\t[vm, slot, classSlot]\r\n\t);\r\n}\r\n\r\n/**\r\n * @param {number} slot\r\n * @returns {number}\r\n */\r\nexport function wrenGetSlotHandle(slot) {\r\n\treturn Module.ccall(\"wrenGetSlotHandle\",\r\n\t\t\"number\",\r\n\t\t[\"number\", \"number\"],\r\n\t\t[vm, slot]\r\n\t);\r\n}\r\n\r\n/**\r\n * @param {string} moduleName\r\n * @param {string} name\r\n * @param {number} slot\r\n */\r\nexport function wrenGetVariable(moduleName, name, slot) {\r\n\tModule.ccall(\"wrenGetVariable\",\r\n\t\tnull,\r\n\t\t[\"number\", \"string\", \"string\", \"number\"],\r\n\t\t[vm, moduleName, name, slot]\r\n\t);\r\n}\r\n\r\n/**\r\n * @param {number} slot\r\n */\r\nexport function wrenSetSlotNull(slot) {\r\n\tModule.ccall(\"wrenSetSlotNull\",\r\n\t\tnull,\r\n\t\t[\"number\", \"number\"],\r\n\t\t[vm, slot]\r\n\t);\r\n}\r\n\r\n/**\r\n * @param {number} slot\r\n * @param {boolean} value\r\n */\r\nexport function wrenSetSlotBool(slot, value) {\r\n\tModule.ccall(\"wrenSetSlotBool\",\r\n\t\tnull,\r\n\t\t[\"number\", \"number\", \"boolean\"],\r\n\t\t[vm, slot, value]\r\n\t);\r\n}\r\n\r\n/**\r\n * @param {number} slot\r\n * @param {number} value\r\n */\r\nexport function wrenSetSlotDouble(slot, value) {\r\n\tModule.ccall(\"wrenSetSlotDouble\",\r\n\t\tnull,\r\n\t\t[\"number\", \"number\", \"number\"],\r\n\t\t[vm, slot, value]\r\n\t);\r\n}\r\n\r\n/**\r\n * @param {number} slot\r\n * @param {number} from\r\n * @param {number} to\r\n * @param {number} step\r\n * @param {boolean} isInclusive\r\n */\r\nexport function wrenSetSlotRange(slot, from, to, step, isInclusive) {\r\n\tModule.ccall(\"wrenSetSlotRange\",\r\n\t\tnull,\r\n\t\t[\"number\", \"number\", \"number\", \"number\", \"number\", \"boolean\"],\r\n\t\t[vm, slot, from, to, step, isInclusive]\r\n\t);\r\n}\r\n\r\n/**\r\n * @param {number} slot\r\n * @param {CStringSource} text\r\n */\r\nexport function wrenSetSlotString(slot, text) {\r\n\tlet stack = 0;\r\n\r\n\tlet textRaw, textType;\r\n\tif (typeof text === \"string\") {\r\n\t\ttextRaw = text;\r\n\t\ttextType = \"string\";\r\n\t} else {\r\n\t\tstack = Module.stackSave();\r\n\t\ttextRaw = stackAllocUTF8ArrayAsCString(text);\r\n\t\ttextType = \"number\";\r\n\t}\r\n\r\n\tModule.ccall('wrenSetSlotString',\r\n\t\tnull,\r\n\t\t['number', 'number', textType],\r\n\t\t[vm, slot, textRaw]\r\n\t);\r\n\r\n\tif (stack) {\r\n\t\tModule.stackRestore(stack);\r\n\t}\r\n}\r\n\r\n/**\r\n * @param {number} slot\r\n * @param {number} handle\r\n */\r\nexport function wrenSetSlotHandle(slot, handle) {\r\n\tModule.ccall(\"wrenSetSlotHandle\",\r\n\t\tnull,\r\n\t\t[\"number\", \"number\", \"number\"],\r\n\t\t[vm, slot, handle]\r\n\t);\r\n}\r\n\r\n/**\r\n * @param {number} slot\r\n * @param {number} classSlot\r\n * @param {number} size\r\n * @returns {number}\r\n */\r\nexport function wrenSetSlotNewForeign(slot, classSlot, size) {\r\n\treturn Module.ccall(\"wrenSetSlotNewForeign\",\r\n\t\t\"number\",\r\n\t\t[\"number\", \"number\", \"number\", \"number\"],\r\n\t\t[vm, slot, classSlot, size]\r\n\t);\r\n}\r\n\r\n/**\r\n * @param {number} slot\r\n */\r\nexport function wrenSetSlotNewList(slot) {\r\n\tModule.ccall(\"wrenSetSlotNewList\",\r\n\t\t\"number\",\r\n\t\t[\"number\", \"number\"],\r\n\t\t[vm, slot]\r\n\t);\r\n}\r\n\r\n/**\r\n * @param {number} callHandle\r\n * @returns {WrenInterpretResult}\r\n */\r\nexport function wrenCall(callHandle) {\r\n\treturn Module.ccall(\"wrenCall\",\r\n\t\t\"number\",\r\n\t\t[\"number\", \"number\"],\r\n\t\t[vm, callHandle]\r\n\t);\r\n}\r\n\r\n/**\r\n * @param {string} moduleName\r\n */\r\nexport function wrenAddImplicitImportModule(moduleName) {\r\n\tModule.ccall(\"wrenAddImplicitImportModule\",\r\n\t\tnull,\r\n\t\t[\"number\", \"string\"],\r\n\t\t[vm, moduleName]\r\n\t);\r\n}\r\n\r\n/**\r\n * @param {number} handle\r\n */\r\nexport function wrenReleaseHandle(handle) {\r\n\tModule.ccall(\"wrenReleaseHandle\",\r\n\t\tnull,\r\n\t\t[\"number\", \"number\"],\r\n\t\t[vm, handle]\r\n\t);\r\n}\r\n\r\n/**\r\n * @param {number} slot\r\n */\r\nexport function wrenAbortFiber(slot) {\r\n\tModule.ccall(\"wrenAbortFiber\",\r\n\t\tnull,\r\n\t\t[\"number\", \"number\"],\r\n\t\t[vm, slot]\r\n\t);\r\n}\r\n\r\n/**\r\n * @param {string} message\r\n */\r\nexport function wrenAbort(message) {\r\n\twrenEnsureSlots(1);\r\n\twrenSetSlotString(0, message);\r\n\twrenAbortFiber(0);\r\n}\r\n\r\n/**\r\n * Format a JS string as a Wren string literal.\r\n * @param {string} s\r\n * @returns {string}\r\n */\r\nfunction stringToWrenString(s) {\r\n\tlet r = '\"';\r\n\r\n\tfor (let i = 0; i < s.length; i++) {\r\n\t\tlet c = s[i];\r\n\t\tif (c === \"\\\\\") {\r\n\t\t\tr += \"\\\\\\\\\";\r\n\t\t} else if (c === \"%\" || c === '\"') {\r\n\t\t\tr += \"\\\\\" + c;\r\n\t\t} else {\r\n\t\t\tr += c;\r\n\t\t}\r\n\t}\r\n\r\n\treturn r + '\"';\r\n}\r\n\r\nexport let wrenHasError = false;\r\n\r\n/**\r\n * null if no error.\r\n * @type {string|null}\r\n */\r\nexport let wrenErrorMessage = null;\r\n\r\n/**\r\n * A string that accumulates Wren error information.\r\n * \r\n * null if no error.\r\n * @type {string|null}\r\n */\r\nexport let wrenErrorString = null;\r\n\r\n/**\r\n * Provides the module name, line number, location to the wren file at the top of the error stack.\r\n * @type {[string, number, string|null][]}\r\n */\r\nexport let wrenErrorStack;\r\n\r\n/**\r\n * @param {string} name\r\n * @param {number} lineNumber\r\n * @returns {string}\r\n */\r\nfunction formatModuleLineTrace(name, lineNumber) {\r\n\tif (name[0] === \"/\") {\r\n\t\tname = name.slice(1);\r\n\t}\r\n\r\n\treturn name + \":\" + lineNumber;\r\n}\r\n\r\n/**\r\n * @param {number} type\r\n * @returns {string}\r\n */\r\nexport function wrenTypeToName(type) {\r\n\tswitch (type) {\r\n\t\tcase 0: return \"Bool\";\r\n\t\tcase 1: return \"Num\";\r\n\t\tcase 2: return \"foreign\";\r\n\t\tcase 3: return \"List\";\r\n\t\tcase 4: return \"Map\";\r\n\t\tcase 5: return \"Null\";\r\n\t\tcase 6: return \"String\";\r\n\t\tcase 7: return \"Unknown\";\r\n\t}\r\n\treturn \"?\";\r\n}\r\n\r\n/**\r\n * @param {ArrayBuffer | Uint8Array | Uint8ClampedArray} arraySource \r\n * @returns {number}\r\n */\r\nfunction stackAllocUTF8ArrayAsCString(arraySource) {\r\n\tlet src = arraySource instanceof ArrayBuffer ? new Uint8Array(arraySource) : arraySource;\r\n\r\n\tlet nullTerminated = src[src.length - 1] === 0;\r\n\tlet len = nullTerminated ? src.length : src.length + 1;\r\n\t\r\n\tlet ptr = Module.stackAlloc(len);\r\n\r\n\tlet u8 = HEAPU8();\r\n\r\n\tu8.set(src, ptr);\r\n\r\n\tif (!nullTerminated) {\r\n\t\tu8[ptr + len - 1] = 0;\r\n\t}\r\n\r\n\treturn ptr;\r\n}\r\n\r\n/**\r\n * @param {number} slot\r\n * @returns {number}\r\n */\r\nexport function wren_sock_get_transform(slot) {\r\n\treturn Module.ccall(\"sock_get_transform\", \"number\", [ \"number\" ], [ slot ]);\r\n}\r\n\r\n/**\r\n * A string that is passed to C/Wasm.\r\n * \r\n * If provided as an array, it is interpreted as a UTF-8 byte array, which is copied directly into Wasm memory.\r\n * This avoids the overhead of converting a JavaScript string to UTF-8.\r\n * @typedef {string | ArrayBuffer | Uint8Array | Uint8ClampedArray} CStringSource\r\n */\r\n\r\n/**\r\n * The result of a VM interpreting wren source.\r\n * - 0: The VM interpreted the source without error.\r\n * - 1: The VM experienced a compile error.\r\n * - 2: The VM experienced a runtime error.\r\n * @typedef {0 | 1 | 2} WrenInterpretResult\r\n */\r\n\r\n\r\n","import { sockJsGlobal } from \"./globals.js\";\r\n\r\n/**\r\n * If messaging was flagged via HTML page.\r\n */\r\nexport let messagingEnabled = !!sockJsGlobal.messaging;\r\n\r\n/** @type {(((arg: any) => void) & { type: string })[]} */\r\nlet waitingMessages  = [];\r\n\r\n/**\r\n * @param {string} type\r\n * @returns {Promise<any>}\r\n */\r\nexport function waitForMessage(type) {\r\n\treturn new Promise(/** @param {((arg: any) => void) & { type: string }} resolve */(resolve) => {\r\n\t\tresolve.type = type;\r\n\t\twaitingMessages.push(resolve);\r\n\t});\r\n}\r\n\r\n/**\r\n * @param {string} type\r\n * @param {string} [data]\r\n */\r\nexport function sendMessage(type, data) {\r\n\tif (parent !== window) parent.postMessage({ type: type, data: data });\r\n}\r\n\r\nif (messagingEnabled) {\r\n\taddEventListener(\"message\", (event) => {\r\n\t\tlet data = event.data;\r\n\t\tif (data && typeof data === \"object\") {\r\n\t\t\tlet msgType = data.type;\r\n\t\t\tif (msgType) {\r\n\t\t\t\tlet arg = data.data;\r\n\r\n\t\t\t\t// Pull out functions with the corresponding type.\r\n\t\t\t\tlet stillWaiting = [];\r\n\t\t\t\tlet callNow = [];\r\n\t\t\t\tfor (let f of waitingMessages) {\r\n\t\t\t\t\tif (f.type === msgType) {\r\n\t\t\t\t\t\tcallNow.push(f);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tstillWaiting.push(f);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\twaitingMessages = stillWaiting;\r\n\r\n\t\t\t\t// Call matching functions.\r\n\t\t\t\tfor (let f of callNow) {\r\n\t\t\t\t\tf(arg);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t});\r\n}\r\n","import { Module, vm } from \"./vm.js\";\r\n\r\n// Single repository for Wren call-handles.\r\n// Help's us re-use common call-handles.\r\n\r\nexport let callHandle_call_0 = 0;\r\nexport let callHandle_transfer_1 = 0;\r\nexport let callHandle_path_get = 0;\r\nexport let callHandle_init_0 = 0;\r\nexport let callHandle_init_2 = 0;\r\nexport let callHandle_load_0 = 0;\r\nexport let callHandle_load_1 = 0;\r\nexport let callHandle_loaded_3 = 0;\r\nexport let callHandle_update_0 = 0;\r\nexport let callHandle_update_1 = 0;\r\nexport let callHandle_update_2 = 0;\r\nexport let callHandle_update_3 = 0;\r\nexport let callHandle_resolve_2 = 0;\r\nexport let callHandle_toString = 0;\r\nexport let callHandle_updateMouse_3 = 0;\r\nexport let callHandle_updateTouch_5 = 0;\r\n\r\n\r\nexport function makeCallHandles() {\r\n\tcallHandle_call_0 = wrenMakeCallHandle(\"call()\");\r\n\tcallHandle_transfer_1 = wrenMakeCallHandle(\"transfer(_)\");\r\n\tcallHandle_path_get = wrenMakeCallHandle(\"path\");\r\n\tcallHandle_init_0 = wrenMakeCallHandle(\"init_()\");\r\n\tcallHandle_init_2 = wrenMakeCallHandle(\"init_(_,_)\");\r\n\tcallHandle_load_0 = wrenMakeCallHandle(\"load_()\");\r\n\tcallHandle_load_1 = wrenMakeCallHandle(\"load_(_)\");\r\n\tcallHandle_loaded_3 = wrenMakeCallHandle(\"loaded_(_,_,_)\");\r\n\tcallHandle_update_0 = wrenMakeCallHandle(\"update_()\");\r\n\tcallHandle_update_1 = wrenMakeCallHandle(\"update_(_)\");\r\n\tcallHandle_update_2 = wrenMakeCallHandle(\"update_(_,_)\");\r\n\tcallHandle_update_3 = wrenMakeCallHandle(\"update_(_,_,_)\");\r\n\tcallHandle_resolve_2 = wrenMakeCallHandle(\"resolve_(_,_)\");\r\n\tcallHandle_toString = wrenMakeCallHandle(\"toString\");\r\n\tcallHandle_updateMouse_3 = wrenMakeCallHandle(\"updateMouse_(_,_,_)\")\r\n\tcallHandle_updateTouch_5 = wrenMakeCallHandle(\"updateTouch_(_,_,_,_,_)\")\r\n}\r\n\r\n/**\r\n * @param {string} signature\r\n * @returns {number}\r\n */\r\nfunction wrenMakeCallHandle(signature) {\r\n\treturn Module.ccall(\"wrenMakeCallHandle\",\r\n\t\t\"number\",\r\n\t\t[\"number\", \"string\"],\r\n\t\t[vm, signature]\r\n\t);\r\n}\r\n","import { wrenCall, wrenEnsureSlots, wrenGetSlotHandle, wrenGetVariable, wrenSetSlotDouble, wrenSetSlotHandle } from \"../vm.js\";\r\nimport { callHandle_update_2 } from \"../vm-call-handles.js\";\r\nimport { addClassForeignStaticMethods } from \"../foreign.js\";\r\n\r\nlet handle_Time = 0;\r\n\r\nexport function initTimeModule() {\r\n\twrenEnsureSlots(1);\r\n\twrenGetVariable(\"sock\", \"Time\", 0);\r\n\thandle_Time = wrenGetSlotHandle(0);\r\n}\r\n\r\naddClassForeignStaticMethods(\"sock\", \"Time\", {\r\n\t\"epoch\"() {\r\n\t\twrenSetSlotDouble(0, Date.now() / 1000);\r\n\t},\r\n});\r\n\r\n/**\r\n * @param {number} time\r\n * @param {number} deltaTime\r\n */\r\nexport function updateTimeModule(time, deltaTime) {\r\n\twrenEnsureSlots(3);\r\n\twrenSetSlotHandle(0, handle_Time);\r\n\twrenSetSlotDouble(1, time);\r\n\twrenSetSlotDouble(2, deltaTime);\r\n\twrenCall(callHandle_update_2);\r\n}\r\n","/* unzipit@1.4.0, license MIT */\n/* global SharedArrayBuffer, process */\n\nfunction readBlobAsArrayBuffer(blob) {\n  if (blob.arrayBuffer) {\n    return blob.arrayBuffer();\n  }\n  return new Promise((resolve, reject) => {\n    const reader = new FileReader();\n    reader.addEventListener('loadend', () => {\n      resolve(reader.result);\n    });\n    reader.addEventListener('error', reject);\n    reader.readAsArrayBuffer(blob);\n  });\n}\n\nasync function readBlobAsUint8Array(blob) {\n  const arrayBuffer = await readBlobAsArrayBuffer(blob);\n  return new Uint8Array(arrayBuffer);\n}\n\nfunction isBlob(v) {\n  return typeof Blob !== 'undefined' && v instanceof Blob;\n}\n\nfunction isSharedArrayBuffer(b) {\n  return typeof SharedArrayBuffer !== 'undefined' && b instanceof SharedArrayBuffer;\n}\n\nfunction isTypedArraySameAsArrayBuffer(typedArray) {\n  return typedArray.byteOffset === 0 && typedArray.byteLength === typedArray.buffer.byteLength;\n}\n\nclass ArrayBufferReader {\n  constructor(arrayBufferOrView) {\n    this.typedArray = (arrayBufferOrView instanceof ArrayBuffer || isSharedArrayBuffer(arrayBufferOrView))\n       ? new Uint8Array(arrayBufferOrView)\n       : new Uint8Array(arrayBufferOrView.buffer, arrayBufferOrView.byteOffset, arrayBufferOrView.byteLength);\n  }\n  async getLength() {\n    return this.typedArray.byteLength;\n  }\n  async read(offset, length) {\n    return new Uint8Array(this.typedArray.buffer, this.typedArray.byteOffset + offset, length);\n  }\n}\n\nclass BlobReader {\n  constructor(blob) {\n    this.blob = blob;\n  }\n  async getLength() {\n    return this.blob.size;\n  }\n  async read(offset, length) {\n    const blob = this.blob.slice(offset, offset + length);\n    const arrayBuffer = await readBlobAsArrayBuffer(blob);\n    return new Uint8Array(arrayBuffer);\n  }\n  async sliceAsBlob(offset, length, type = '') {\n    return this.blob.slice(offset, offset + length, type);\n  }\n}\n\nclass HTTPRangeReader {\n  constructor(url) {\n    this.url = url;\n  }\n  async getLength() {\n    if (this.length === undefined) {\n      const req = await fetch(this.url, { method: 'HEAD' });\n      if (!req.ok) {\n        throw new Error(`failed http request ${this.url}, status: ${req.status}: ${req.statusText}`);\n      }\n      this.length = parseInt(req.headers.get('content-length'));\n      if (Number.isNaN(this.length)) {\n        throw Error('could not get length');\n      }\n    }\n    return this.length;\n  }\n  async read(offset, size) {\n    if (size === 0) {\n      return new Uint8Array(0);\n    }\n    const req = await fetch(this.url, {\n      headers: {\n        Range: `bytes=${offset}-${offset + size - 1}`,\n      },\n    });\n    if (!req.ok) {\n      throw new Error(`failed http request ${this.url}, status: ${req.status} offset: ${offset} size: ${size}: ${req.statusText}`);\n    }\n    const buffer = await req.arrayBuffer();\n    return new Uint8Array(buffer);\n  }\n}\n\nfunction inflate(data, buf) {\n\tvar u8=Uint8Array;\n\tif(data[0]==3 && data[1]==0) return (buf ? buf : new u8(0));\n\tvar bitsF = _bitsF, bitsE = _bitsE, decodeTiny = _decodeTiny, get17 = _get17;\n\t\n\tvar noBuf = (buf==null);\n\tif(noBuf) buf = new u8((data.length>>>2)<<3);\n\t\n\tvar BFINAL=0, BTYPE=0, HLIT=0, HDIST=0, HCLEN=0, ML=0, MD=0; \t\n\tvar off = 0, pos = 0;\n\tvar lmap, dmap;\n\t\n\twhile(BFINAL==0) {\t\t\n\t\tBFINAL = bitsF(data, pos  , 1);\n\t\tBTYPE  = bitsF(data, pos+1, 2);  pos+=3;\n\t\t//console.log(BFINAL, BTYPE);\n\t\t\n\t\tif(BTYPE==0) {\n\t\t\tif((pos&7)!=0) pos+=8-(pos&7);\n\t\t\tvar p8 = (pos>>>3)+4, len = data[p8-4]|(data[p8-3]<<8);  //console.log(len);//bitsF(data, pos, 16), \n\t\t\tif(noBuf) buf=_check(buf, off+len);\n\t\t\tbuf.set(new u8(data.buffer, data.byteOffset+p8, len), off);\n\t\t\t//for(var i=0; i<len; i++) buf[off+i] = data[p8+i];\n\t\t\t//for(var i=0; i<len; i++) if(buf[off+i] != data[p8+i]) throw \"e\";\n\t\t\tpos = ((p8+len)<<3);  off+=len;  continue;\n\t\t}\n\t\tif(noBuf) buf=_check(buf, off+(1<<17));  // really not enough in many cases (but PNG and ZIP provide buffer in advance)\n\t\tif(BTYPE==1) {  lmap = U.flmap;  dmap = U.fdmap;  ML = (1<<9)-1;  MD = (1<<5)-1;   }\n\t\tif(BTYPE==2) {\n\t\t\tHLIT  = bitsE(data, pos   , 5)+257;  \n\t\t\tHDIST = bitsE(data, pos+ 5, 5)+  1;  \n\t\t\tHCLEN = bitsE(data, pos+10, 4)+  4;  pos+=14;\n\t\t\tfor(var i=0; i<38; i+=2) {  U.itree[i]=0;  U.itree[i+1]=0;  }\n\t\t\tvar tl = 1;\n\t\t\tfor(var i=0; i<HCLEN; i++) {  var l=bitsE(data, pos+i*3, 3);  U.itree[(U.ordr[i]<<1)+1] = l;  if(l>tl)tl=l;  }     pos+=3*HCLEN;  //console.log(itree);\n\t\t\tmakeCodes(U.itree, tl);\n\t\t\tcodes2map(U.itree, tl, U.imap);\n\t\t\t\n\t\t\tlmap = U.lmap;  dmap = U.dmap;\n\t\t\t\n\t\t\tpos = decodeTiny(U.imap, (1<<tl)-1, HLIT+HDIST, data, pos, U.ttree);\n\t\t\tvar mx0 = _copyOut(U.ttree,    0, HLIT , U.ltree);  ML = (1<<mx0)-1;\n\t\t\tvar mx1 = _copyOut(U.ttree, HLIT, HDIST, U.dtree);  MD = (1<<mx1)-1;\n\t\t\t\n\t\t\t//var ml = decodeTiny(U.imap, (1<<tl)-1, HLIT , data, pos, U.ltree); ML = (1<<(ml>>>24))-1;  pos+=(ml&0xffffff);\n\t\t\tmakeCodes(U.ltree, mx0);\n\t\t\tcodes2map(U.ltree, mx0, lmap);\n\t\t\t\n\t\t\t//var md = decodeTiny(U.imap, (1<<tl)-1, HDIST, data, pos, U.dtree); MD = (1<<(md>>>24))-1;  pos+=(md&0xffffff);\n\t\t\tmakeCodes(U.dtree, mx1);\n\t\t\tcodes2map(U.dtree, mx1, dmap);\n\t\t}\n\t\t//var ooff=off, opos=pos;\n\t\twhile(true) {\n\t\t\tvar code = lmap[get17(data, pos) & ML];  pos += code&15;\n\t\t\tvar lit = code>>>4;  //U.lhst[lit]++;  \n\t\t\tif((lit>>>8)==0) {  buf[off++] = lit;  }\n\t\t\telse if(lit==256) {  break;  }\n\t\t\telse {\n\t\t\t\tvar end = off+lit-254;\n\t\t\t\tif(lit>264) { var ebs = U.ldef[lit-257];  end = off + (ebs>>>3) + bitsE(data, pos, ebs&7);  pos += ebs&7;  }\n\t\t\t\t//dst[end-off]++;\n\t\t\t\t\n\t\t\t\tvar dcode = dmap[get17(data, pos) & MD];  pos += dcode&15;\n\t\t\t\tvar dlit = dcode>>>4;\n\t\t\t\tvar dbs = U.ddef[dlit], dst = (dbs>>>4) + bitsF(data, pos, dbs&15);  pos += dbs&15;\n\t\t\t\t\n\t\t\t\t//var o0 = off-dst, stp = Math.min(end-off, dst);\n\t\t\t\t//if(stp>20) while(off<end) {  buf.copyWithin(off, o0, o0+stp);  off+=stp;  }  else\n\t\t\t\t//if(end-dst<=off) buf.copyWithin(off, off-dst, end-dst);  else\n\t\t\t\t//if(dst==1) buf.fill(buf[off-1], off, end);  else\n\t\t\t\tif(noBuf) buf=_check(buf, off+(1<<17));\n\t\t\t\twhile(off<end) {  buf[off]=buf[off++-dst];    buf[off]=buf[off++-dst];  buf[off]=buf[off++-dst];  buf[off]=buf[off++-dst];  }   \n\t\t\t\toff=end;\n\t\t\t\t//while(off!=end) {  buf[off]=buf[off++-dst];  }\n\t\t\t}\n\t\t}\n\t\t//console.log(off-ooff, (pos-opos)>>>3);\n\t}\n\t//console.log(dst);\n\t//console.log(tlen, dlen, off-tlen+tcnt);\n\treturn buf.length==off ? buf : buf.slice(0,off);\n}\nfunction _check(buf, len) {\n\tvar bl=buf.length;  if(len<=bl) return buf;\n\tvar nbuf = new Uint8Array(Math.max(bl<<1,len));  nbuf.set(buf,0);\n\t//for(var i=0; i<bl; i+=4) {  nbuf[i]=buf[i];  nbuf[i+1]=buf[i+1];  nbuf[i+2]=buf[i+2];  nbuf[i+3]=buf[i+3];  }\n\treturn nbuf;\n}\n\nfunction _decodeTiny(lmap, LL, len, data, pos, tree) {\n\tvar bitsE = _bitsE, get17 = _get17;\n\tvar i = 0;\n\twhile(i<len) {\n\t\tvar code = lmap[get17(data, pos)&LL];  pos+=code&15;\n\t\tvar lit = code>>>4; \n\t\tif(lit<=15) {  tree[i]=lit;  i++;  }\n\t\telse {\n\t\t\tvar ll = 0, n = 0;\n\t\t\tif(lit==16) {\n\t\t\t\tn = (3  + bitsE(data, pos, 2));  pos += 2;  ll = tree[i-1];\n\t\t\t}\n\t\t\telse if(lit==17) {\n\t\t\t\tn = (3  + bitsE(data, pos, 3));  pos += 3;\n\t\t\t}\n\t\t\telse if(lit==18) {\n\t\t\t\tn = (11 + bitsE(data, pos, 7));  pos += 7;\n\t\t\t}\n\t\t\tvar ni = i+n;\n\t\t\twhile(i<ni) {  tree[i]=ll;  i++; }\n\t\t}\n\t}\n\treturn pos;\n}\nfunction _copyOut(src, off, len, tree) {\n\tvar mx=0, i=0, tl=tree.length>>>1;\n\twhile(i<len) {  var v=src[i+off];  tree[(i<<1)]=0;  tree[(i<<1)+1]=v;  if(v>mx)mx=v;  i++;  }\n\twhile(i<tl ) {  tree[(i<<1)]=0;  tree[(i<<1)+1]=0;  i++;  }\n\treturn mx;\n}\n\nfunction makeCodes(tree, MAX_BITS) {  // code, length\n\tvar max_code = tree.length;\n\tvar code, bits, n, i, len;\n\t\n\tvar bl_count = U.bl_count;  for(var i=0; i<=MAX_BITS; i++) bl_count[i]=0;\n\tfor(i=1; i<max_code; i+=2) bl_count[tree[i]]++;\n\t\n\tvar next_code = U.next_code;\t// smallest code for each length\n\t\n\tcode = 0;\n\tbl_count[0] = 0;\n\tfor (bits = 1; bits <= MAX_BITS; bits++) {\n\t\tcode = (code + bl_count[bits-1]) << 1;\n\t\tnext_code[bits] = code;\n\t}\n\t\n\tfor (n = 0; n < max_code; n+=2) {\n\t\tlen = tree[n+1];\n\t\tif (len != 0) {\n\t\t\ttree[n] = next_code[len];\n\t\t\tnext_code[len]++;\n\t\t}\n\t}\n}\nfunction codes2map(tree, MAX_BITS, map) {\n\tvar max_code = tree.length;\n\tvar r15 = U.rev15;\n\tfor(var i=0; i<max_code; i+=2) if(tree[i+1]!=0)  {\n\t\tvar lit = i>>1;\n\t\tvar cl = tree[i+1], val = (lit<<4)|cl; // :  (0x8000 | (U.of0[lit-257]<<7) | (U.exb[lit-257]<<4) | cl);\n\t\tvar rest = (MAX_BITS-cl), i0 = tree[i]<<rest, i1 = i0 + (1<<rest);\n\t\t//tree[i]=r15[i0]>>>(15-MAX_BITS);\n\t\twhile(i0!=i1) {\n\t\t\tvar p0 = r15[i0]>>>(15-MAX_BITS);\n\t\t\tmap[p0]=val;  i0++;\n\t\t}\n\t}\n}\nfunction revCodes(tree, MAX_BITS) {\n\tvar r15 = U.rev15, imb = 15-MAX_BITS;\n\tfor(var i=0; i<tree.length; i+=2) {  var i0 = (tree[i]<<(MAX_BITS-tree[i+1]));  tree[i] = r15[i0]>>>imb;  }\n}\n\nfunction _bitsE(dt, pos, length) {  return ((dt[pos>>>3] | (dt[(pos>>>3)+1]<<8)                        )>>>(pos&7))&((1<<length)-1);  }\nfunction _bitsF(dt, pos, length) {  return ((dt[pos>>>3] | (dt[(pos>>>3)+1]<<8) | (dt[(pos>>>3)+2]<<16))>>>(pos&7))&((1<<length)-1);  }\n/*\nfunction _get9(dt, pos) {\n\treturn ((dt[pos>>>3] | (dt[(pos>>>3)+1]<<8))>>>(pos&7))&511;\n} */\nfunction _get17(dt, pos) {\t// return at least 17 meaningful bytes\n\treturn (dt[pos>>>3] | (dt[(pos>>>3)+1]<<8) | (dt[(pos>>>3)+2]<<16) )>>>(pos&7);\n}\nconst U = function(){\n\tvar u16=Uint16Array, u32=Uint32Array;\n\treturn {\n\t\tnext_code : new u16(16),\n\t\tbl_count  : new u16(16),\n\t\tordr : [ 16, 17, 18, 0, 8, 7, 9, 6, 10, 5, 11, 4, 12, 3, 13, 2, 14, 1, 15 ],\n\t\tof0  : [3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,999,999,999],\n\t\texb  : [0,0,0,0,0,0,0, 0, 1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3, 4, 4, 4,  4,  5,  5,  5,  5,  0,  0,  0,  0],\n\t\tldef : new u16(32),\n\t\tdf0  : [1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577, 65535, 65535],\n\t\tdxb  : [0,0,0,0,1,1,2, 2, 3, 3, 4, 4, 5, 5,  6,  6,  7,  7,  8,  8,   9,   9,  10,  10,  11,  11,  12,   12,   13,   13,     0,     0],\n\t\tddef : new u32(32),\n\t\tflmap: new u16(  512),  fltree: [],\n\t\tfdmap: new u16(   32),  fdtree: [],\n\t\tlmap : new u16(32768),  ltree : [],  ttree:[],\n\t\tdmap : new u16(32768),  dtree : [],\n\t\timap : new u16(  512),  itree : [],\n\t\t//rev9 : new u16(  512)\n\t\trev15: new u16(1<<15),\n\t\tlhst : new u32(286), dhst : new u32( 30), ihst : new u32(19),\n\t\tlits : new u32(15000),\n\t\tstrt : new u16(1<<16),\n\t\tprev : new u16(1<<15)\n\t};  \n} ();\n\n(function(){\t\n\tvar len = 1<<15;\n\tfor(var i=0; i<len; i++) {\n\t\tvar x = i;\n\t\tx = (((x & 0xaaaaaaaa) >>> 1) | ((x & 0x55555555) << 1));\n\t\tx = (((x & 0xcccccccc) >>> 2) | ((x & 0x33333333) << 2));\n\t\tx = (((x & 0xf0f0f0f0) >>> 4) | ((x & 0x0f0f0f0f) << 4));\n\t\tx = (((x & 0xff00ff00) >>> 8) | ((x & 0x00ff00ff) << 8));\n\t\tU.rev15[i] = (((x >>> 16) | (x << 16)))>>>17;\n\t}\n\t\n\tfunction pushV(tgt, n, sv) {  while(n--!=0) tgt.push(0,sv);  }\n\t\n\tfor(var i=0; i<32; i++) {  U.ldef[i]=(U.of0[i]<<3)|U.exb[i];  U.ddef[i]=(U.df0[i]<<4)|U.dxb[i];  }\n\t\n\tpushV(U.fltree, 144, 8);  pushV(U.fltree, 255-143, 9);  pushV(U.fltree, 279-255, 7);  pushV(U.fltree,287-279,8);\n\t/*\n\tvar i = 0;\n\tfor(; i<=143; i++) U.fltree.push(0,8);\n\tfor(; i<=255; i++) U.fltree.push(0,9);\n\tfor(; i<=279; i++) U.fltree.push(0,7);\n\tfor(; i<=287; i++) U.fltree.push(0,8);\n\t*/\n\tmakeCodes(U.fltree, 9);\n\tcodes2map(U.fltree, 9, U.flmap);\n\trevCodes (U.fltree, 9);\n\t\n\tpushV(U.fdtree,32,5);\n\t//for(i=0;i<32; i++) U.fdtree.push(0,5);\n\tmakeCodes(U.fdtree, 5);\n\tcodes2map(U.fdtree, 5, U.fdmap);\n\trevCodes (U.fdtree, 5);\n\t\n\tpushV(U.itree,19,0);  pushV(U.ltree,286,0);  pushV(U.dtree,30,0);  pushV(U.ttree,320,0);\n\t/*\n\tfor(var i=0; i< 19; i++) U.itree.push(0,0);\n\tfor(var i=0; i<286; i++) U.ltree.push(0,0);\n\tfor(var i=0; i< 30; i++) U.dtree.push(0,0);\n\tfor(var i=0; i<320; i++) U.ttree.push(0,0);\n\t*/\n})();\n\nconst crc = {\n\ttable : ( function() {\n\t   var tab = new Uint32Array(256);\n\t   for (var n=0; n<256; n++) {\n\t\t\tvar c = n;\n\t\t\tfor (var k=0; k<8; k++) {\n\t\t\t\tif (c & 1)  c = 0xedb88320 ^ (c >>> 1);\n\t\t\t\telse        c = c >>> 1;\n\t\t\t}\n\t\t\ttab[n] = c;  }    \n\t\treturn tab;  })(),\n\tupdate : function(c, buf, off, len) {\n\t\tfor (var i=0; i<len; i++)  c = crc.table[(c ^ buf[off+i]) & 0xff] ^ (c >>> 8);\n\t\treturn c;\n\t},\n\tcrc : function(b,o,l)  {  return crc.update(0xffffffff,b,o,l) ^ 0xffffffff;  }\n};\n\nfunction inflateRaw(file, buf) {  return inflate(file, buf);  }\n\n/* global module */\n\nconst config = {\n  numWorkers: 1,\n  workerURL: '',\n  useWorkers: false,\n};\n\nlet nextId = 0;\n\n// Requests are put on a queue.\n// We don't send the request to the worker until the worker\n// is finished. This probably adds a small amount of latency\n// but the issue is imagine you have 2 workers. You give worker\n// A x seconds of work to do and worker B y seconds of work to\n// do. You don't know which will finish first. If you give\n// the worker with more work to do the request then you'll\n// waste time.\n\n// note: we can't check `workers.length` for deciding if\n// we've reached `config.numWorkers` because creation the worker\n// is async which means other requests to make workers might\n// come in before a worker gets added to `workers`\nlet numWorkers = 0;\nlet canUseWorkers = true;   // gets set to false if we can't start a worker\nconst workers = [];\nconst availableWorkers = [];\nconst waitingForWorkerQueue = [];\nconst currentlyProcessingIdToRequestMap = new Map();\n\nfunction handleResult(e) {\n  makeWorkerAvailable(e.target);\n  const {id, error, data} = e.data;\n  const request = currentlyProcessingIdToRequestMap.get(id);\n  currentlyProcessingIdToRequestMap.delete(id);\n  if (error) {\n    request.reject(error);\n  } else {\n    request.resolve(data);\n  }\n}\n\n// Because Firefox uses non-standard onerror to signal an error.\nfunction startWorker(url) {\n  return new Promise((resolve, reject) => {\n    const worker = new Worker(url);\n    worker.onmessage = (e) => {\n      if (e.data === 'start') {\n        worker.onerror = undefined;\n        worker.onmessage = undefined;\n        resolve(worker);\n      } else {\n        reject(new Error(`unexpected message: ${e.data}`));\n      }\n    };\n    worker.onerror = reject;\n  });\n}\n\nfunction dynamicRequire(mod, request) {\n  return mod.require(request);\n}\n\nconst workerHelper = (function() {\n  return {\n    async createWorker(url) {\n      // I don't understand this security issue\n      // Apparently there is some iframe setting or http header\n      // that prevents cross domain workers. But, I can manually\n      // download the text and do it. I reported this to Chrome\n      // and they said it was fine so ¯\\_(ツ)_/¯\n      try {\n        const worker = await startWorker(url);\n        return worker;\n      } catch (e) {\n        console.warn('could not load worker:', url);\n      }\n\n      let text;\n      try {\n        const req = await fetch(url, {mode: 'cors'});\n        if (!req.ok) {\n          throw new Error(`could not load: ${url}`);\n        }\n        text = await req.text();\n        url = URL.createObjectURL(new Blob([text], {type: 'application/javascript'}));\n        const worker = await startWorker(url);\n        config.workerURL = url;  // this is a hack. What's a better way to structure this code?\n        return worker;\n      } catch (e) {\n        console.warn('could not load worker via fetch:', url);\n      }\n\n      if (text !== undefined) {\n        try {\n          url = `data:application/javascript;base64,${btoa(text)}`;\n          const worker = await startWorker(url);\n          config.workerURL = url;\n          return worker;\n        } catch (e) {\n          console.warn('could not load worker via dataURI');\n        }\n      }\n\n      console.warn('workers will not be used');\n      throw new Error('can not start workers');\n    },\n    addEventListener(worker, fn) {\n      worker.addEventListener('message', fn);\n    },\n    async terminate(worker) {\n      worker.terminate();\n    },\n  };\n}());\n\nfunction makeWorkerAvailable(worker) {\n  availableWorkers.push(worker);\n  processWaitingForWorkerQueue();\n}\n\nasync function getAvailableWorker() {\n  if (availableWorkers.length === 0 && numWorkers < config.numWorkers) {\n    ++numWorkers;  // see comment at numWorkers declaration\n    try {\n      const worker = await workerHelper.createWorker(config.workerURL);\n      workers.push(worker);\n      availableWorkers.push(worker);\n      workerHelper.addEventListener(worker, handleResult);\n    } catch (e) {\n      // set this global out-of-band (needs refactor)\n      canUseWorkers = false;\n    }\n  }\n  return availableWorkers.pop();\n}\n\n// @param {Uint8Array} src\n// @param {number} uncompressedSize\n// @param {string} [type] mime-type\n// @returns {ArrayBuffer|Blob} ArrayBuffer if type is falsy or Blob otherwise.\nfunction inflateRawLocal(src, uncompressedSize, type, resolve) {\n  const dst = new Uint8Array(uncompressedSize);\n  inflateRaw(src, dst);\n  resolve(type\n     ? new Blob([dst], {type})\n     : dst.buffer);\n}\n\nasync function processWaitingForWorkerQueue() {\n  if (waitingForWorkerQueue.length === 0) {\n    return;\n  }\n\n  if (config.useWorkers && canUseWorkers) {\n    const worker = await getAvailableWorker();\n    // canUseWorkers might have been set out-of-band (need refactor)\n    if (canUseWorkers) {\n      if (worker) {\n        if (waitingForWorkerQueue.length === 0) {\n          // the queue might be empty while we awaited for a worker.\n          makeWorkerAvailable(worker);\n          return;\n        }\n        const {id, src, uncompressedSize, type, resolve, reject} = waitingForWorkerQueue.shift();\n        currentlyProcessingIdToRequestMap.set(id, {id, resolve, reject});\n        const transferables = [];\n        // NOTE: Originally I thought you could transfer an ArrayBuffer.\n        // The code on this side is often using views into the entire file\n        // which means if we transferred we'd lose the entire file. That sucks\n        // because it means there's an expensive copy to send the uncompressed\n        // data to the worker.\n        //\n        // Also originally I thought we could send a Blob but we'd need to refactor\n        // the code in unzipit/readEntryData as currently it reads the uncompressed\n        // bytes.\n        //\n        //if (!isBlob(src) && !isSharedArrayBuffer(src)) {\n        //  transferables.push(src);\n        //}\n        worker.postMessage({\n          type: 'inflate',\n          data: {\n            id,\n            type,\n            src,\n            uncompressedSize,\n          },\n        }, transferables);\n      }\n      return;\n    }\n  }\n\n  // inflate locally\n  // We loop here because what happens if many requests happen at once\n  // the first N requests will try to async make a worker. Other requests\n  // will then be on the queue. But if we fail to make workers then there\n  // are pending requests.\n  while (waitingForWorkerQueue.length) {\n    const {src, uncompressedSize, type, resolve} = waitingForWorkerQueue.shift();\n    let data = src;\n    if (isBlob(src)) {\n      data = await readBlobAsUint8Array(src);\n    }\n    inflateRawLocal(data, uncompressedSize, type, resolve);\n  }\n}\n\nfunction setOptions(options) {\n  config.workerURL = options.workerURL || config.workerURL;\n  // there's no reason to set the workerURL if you're not going to use workers\n  if (options.workerURL) {\n    config.useWorkers = true;\n  }\n  config.useWorkers = options.useWorkers !== undefined ? options.useWorkers : config.useWorkers;\n  config.numWorkers = options.numWorkers || config.numWorkers;\n}\n\n// It has to take non-zero time to put a large typed array in a Blob since the very\n// next instruction you could change the contents of the array. So, if you're reading\n// the zip file for images/video/audio then all you want is a Blob on which to get a URL.\n// so that operation of putting the data in a Blob should happen in the worker.\n//\n// Conversely if you want the data itself then you want an ArrayBuffer immediately\n// since the worker can transfer its ArrayBuffer zero copy.\n//\n// @param {Uint8Array|Blob} src\n// @param {number} uncompressedSize\n// @param {string} [type] falsy or mimeType string (eg: 'image/png')\n// @returns {ArrayBuffer|Blob} ArrayBuffer if type is falsy or Blob otherwise.\nfunction inflateRawAsync(src, uncompressedSize, type) {\n  return new Promise((resolve, reject) => {\n    // note: there is potential an expensive copy here. In order for the data\n    // to make it into the worker we need to copy the data to the worker unless\n    // it's a Blob or a SharedArrayBuffer.\n    //\n    // Solutions:\n    //\n    // 1. A minor enhancement, if `uncompressedSize` is small don't call the worker.\n    //\n    //    might be a win period as their is overhead calling the worker\n    //\n    // 2. Move the entire library to the worker\n    //\n    //    Good, Maybe faster if you pass a URL, Blob, or SharedArrayBuffer? Not sure about that\n    //    as those are also easy to transfer. Still slow if you pass an ArrayBuffer\n    //    as the ArrayBuffer has to be copied to the worker.\n    //\n    // I guess benchmarking is really the only thing to try.\n    waitingForWorkerQueue.push({src, uncompressedSize, type, resolve, reject, id: nextId++});\n    processWaitingForWorkerQueue();\n  });\n}\n\nfunction clearArray(arr) {\n  arr.splice(0, arr.length);\n}\n\nasync function cleanup() {\n  for (const worker of workers) {\n    await workerHelper.terminate(worker);\n  }\n  clearArray(workers);\n  clearArray(availableWorkers);\n  clearArray(waitingForWorkerQueue);\n  currentlyProcessingIdToRequestMap.clear();\n  numWorkers = 0;\n  canUseWorkers = true;\n}\n\n/*\nclass Zip {\n  constructor(reader) {\n    comment,  // the comment for this entry\n    commentBytes, // the raw comment for this entry\n  }\n}\n*/\n\nfunction dosDateTimeToDate(date, time) {\n  const day = date & 0x1f; // 1-31\n  const month = (date >> 5 & 0xf) - 1; // 1-12, 0-11\n  const year = (date >> 9 & 0x7f) + 1980; // 0-128, 1980-2108\n\n  const millisecond = 0;\n  const second = (time & 0x1f) * 2; // 0-29, 0-58 (even numbers)\n  const minute = time >> 5 & 0x3f; // 0-59\n  const hour = time >> 11 & 0x1f; // 0-23\n\n  return new Date(year, month, day, hour, minute, second, millisecond);\n}\n\nclass ZipEntry {\n  constructor(reader, rawEntry) {\n    this._reader = reader;\n    this._rawEntry = rawEntry;\n    this.name = rawEntry.name;\n    this.nameBytes = rawEntry.nameBytes;\n    this.size = rawEntry.uncompressedSize;\n    this.compressedSize = rawEntry.compressedSize;\n    this.comment = rawEntry.comment;\n    this.commentBytes = rawEntry.commentBytes;\n    this.compressionMethod = rawEntry.compressionMethod;\n    this.lastModDate = dosDateTimeToDate(rawEntry.lastModFileDate, rawEntry.lastModFileTime);\n    this.isDirectory = rawEntry.uncompressedSize === 0 && rawEntry.name.endsWith('/');\n    this.encrypted = !!(rawEntry.generalPurposeBitFlag & 0x1);\n    this.externalFileAttributes = rawEntry.externalFileAttributes;\n    this.versionMadeBy = rawEntry.versionMadeBy;\n  }\n  // returns a promise that returns a Blob for this entry\n  async blob(type = 'application/octet-stream') {\n    return await readEntryDataAsBlob(this._reader, this._rawEntry, type);\n  }\n  // returns a promise that returns an ArrayBuffer for this entry\n  async arrayBuffer() {\n    return await readEntryDataAsArrayBuffer(this._reader, this._rawEntry);\n  }\n  // returns text, assumes the text is valid utf8. If you want more options decode arrayBuffer yourself\n  async text() {\n    const buffer = await this.arrayBuffer();\n    return decodeBuffer(new Uint8Array(buffer));\n  }\n  // returns text with JSON.parse called on it. If you want more options decode arrayBuffer yourself\n  async json() {\n    const text = await this.text();\n    return JSON.parse(text);\n  }\n}\n\nconst EOCDR_WITHOUT_COMMENT_SIZE = 22;\nconst MAX_COMMENT_SIZE = 0xffff; // 2-byte size\nconst EOCDR_SIGNATURE = 0x06054b50;\nconst ZIP64_EOCDR_SIGNATURE = 0x06064b50;\n\nasync function readAs(reader, offset, length) {\n  return await reader.read(offset, length);\n}\n\n// The point of this function is we want to be able to pass the data\n// to a worker as fast as possible so when decompressing if the data\n// is already a blob and we can get a blob then get a blob.\n//\n// I'm not sure what a better way to refactor this is. We've got examples\n// of multiple readers. Ideally, for every type of reader we could ask\n// it, \"give me a type that is zero copy both locally and when sent to a worker\".\n//\n// The problem is the worker would also have to know the how to handle this\n// opaque type. I suppose the correct solution is to register different\n// reader handlers in the worker so BlobReader would register some\n// `handleZeroCopyType<BlobReader>`. At the moment I don't feel like\n// refactoring. As it is you just pass in an instance of the reader\n// but instead you'd have to register the reader and some how get the\n// source for the `handleZeroCopyType` handler function into the worker.\n// That sounds like a huge PITA, requiring you to put the implementation\n// in a separate file so the worker can load it or some other workaround\n// hack.\n//\n// For now this hack works even if it's not generic.\nasync function readAsBlobOrTypedArray(reader, offset, length, type) {\n  if (reader.sliceAsBlob) {\n    return await reader.sliceAsBlob(offset, length, type);\n  }\n  return await reader.read(offset, length);\n}\n\nconst crc$1 = {\n  unsigned() {\n    return 0;\n  },\n};\n\nfunction getUint16LE(uint8View, offset) {\n  return uint8View[offset    ] +\n         uint8View[offset + 1] * 0x100;\n}\n\nfunction getUint32LE(uint8View, offset) {\n  return uint8View[offset    ] +\n         uint8View[offset + 1] * 0x100 +\n         uint8View[offset + 2] * 0x10000 +\n         uint8View[offset + 3] * 0x1000000;\n}\n\nfunction getUint64LE(uint8View, offset) {\n  return getUint32LE(uint8View, offset) +\n         getUint32LE(uint8View, offset + 4) * 0x100000000;\n}\n\n/* eslint-disable no-irregular-whitespace */\n// const decodeCP437 = (function() {\n//   const cp437 = '\\u0000☺☻♥♦♣♠•◘○◙♂♀♪♫☼►◄↕‼¶§▬↨↑↓→←∟↔▲▼ !\"#$%&\\'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\\\]^_`abcdefghijklmnopqrstuvwxyz{|}~⌂ÇüéâäàåçêëèïîìÄÅÉæÆôöòûùÿÖÜ¢£¥₧ƒáíóúñÑªº¿⌐¬½¼¡«»░▒▓│┤╡╢╖╕╣║╗╝╜╛┐└┴┬├─┼╞╟╚╔╩╦╠═╬╧╨╤╥╙╘╒╓╫╪┘┌█▄▌▐▀αßΓπΣσµτΦΘΩδ∞φε∩≡±≥≤⌠⌡÷≈°∙·√ⁿ²■ ';\n//\n//   return function(uint8view) {\n//     return Array.from(uint8view).map(v => cp437[v]).join('');\n//   };\n// }());\n/* eslint-enable no-irregular-whitespace */\n\nconst utf8Decoder = new TextDecoder();\nfunction decodeBuffer(uint8View, isUTF8) {  /* eslint-disable-line no-unused-vars */ /* lgtm [js/superfluous-trailing-arguments] */\n  if (isSharedArrayBuffer(uint8View.buffer)) {\n    uint8View = new Uint8Array(uint8View);\n  }\n  return utf8Decoder.decode(uint8View);\n  /*\n  AFAICT the UTF8 flat is not set so it's 100% up to the user\n  to self decode if their file is not utf8 filenames\n  return isUTF8\n      ? utf8Decoder.decode(uint8View)\n      : decodeCP437(uint8View);\n  */\n}\n\nasync function findEndOfCentralDirector(reader, totalLength) {\n  const size = Math.min(EOCDR_WITHOUT_COMMENT_SIZE + MAX_COMMENT_SIZE, totalLength);\n  const readStart = totalLength - size;\n  const data = await readAs(reader, readStart, size);\n  for (let i = size - EOCDR_WITHOUT_COMMENT_SIZE; i >= 0; --i) {\n    if (getUint32LE(data, i) !== EOCDR_SIGNATURE) {\n      continue;\n    }\n\n    // 0 - End of central directory signature\n    const eocdr = new Uint8Array(data.buffer, data.byteOffset + i, data.byteLength - i);\n    // 4 - Number of this disk\n    const diskNumber = getUint16LE(eocdr, 4);\n    if (diskNumber !== 0) {\n      throw new Error(`multi-volume zip files are not supported. This is volume: ${diskNumber}`);\n    }\n\n    // 6 - Disk where central directory starts\n    // 8 - Number of central directory records on this disk\n    // 10 - Total number of central directory records\n    const entryCount = getUint16LE(eocdr, 10);\n    // 12 - Size of central directory (bytes)\n    const centralDirectorySize = getUint32LE(eocdr, 12);\n    // 16 - Offset of start of central directory, relative to start of archive\n    const centralDirectoryOffset = getUint32LE(eocdr, 16);\n    // 20 - Comment length\n    const commentLength = getUint16LE(eocdr, 20);\n    const expectedCommentLength = eocdr.length - EOCDR_WITHOUT_COMMENT_SIZE;\n    if (commentLength !== expectedCommentLength) {\n      throw new Error(`invalid comment length. expected: ${expectedCommentLength}, actual: ${commentLength}`);\n    }\n\n    // 22 - Comment\n    // the encoding is always cp437.\n    const commentBytes = new Uint8Array(eocdr.buffer, eocdr.byteOffset + 22, commentLength);\n    const comment = decodeBuffer(commentBytes);\n\n    if (entryCount === 0xffff || centralDirectoryOffset === 0xffffffff) {\n      return await readZip64CentralDirectory(reader, readStart + i, comment, commentBytes);\n    } else {\n      return await readEntries(reader, centralDirectoryOffset, centralDirectorySize, entryCount, comment, commentBytes);\n    }\n  }\n\n  throw new Error('could not find end of central directory. maybe not zip file');\n}\n\nconst END_OF_CENTRAL_DIRECTORY_LOCATOR_SIGNATURE = 0x07064b50;\n\nasync function readZip64CentralDirectory(reader, offset, comment, commentBytes) {\n  // ZIP64 Zip64 end of central directory locator\n  const zip64EocdlOffset = offset - 20;\n  const eocdl = await readAs(reader, zip64EocdlOffset, 20);\n\n  // 0 - zip64 end of central dir locator signature\n  if (getUint32LE(eocdl, 0) !== END_OF_CENTRAL_DIRECTORY_LOCATOR_SIGNATURE) {\n    throw new Error('invalid zip64 end of central directory locator signature');\n  }\n\n  // 4 - number of the disk with the start of the zip64 end of central directory\n  // 8 - relative offset of the zip64 end of central directory record\n  const zip64EocdrOffset = getUint64LE(eocdl, 8);\n  // 16 - total number of disks\n\n  // ZIP64 end of central directory record\n  const zip64Eocdr = await readAs(reader, zip64EocdrOffset, 56);\n\n  // 0 - zip64 end of central dir signature                           4 bytes  (0x06064b50)\n  if (getUint32LE(zip64Eocdr, 0) !== ZIP64_EOCDR_SIGNATURE) {\n    throw new Error('invalid zip64 end of central directory record signature');\n  }\n  // 4 - size of zip64 end of central directory record                8 bytes\n  // 12 - version made by                                             2 bytes\n  // 14 - version needed to extract                                   2 bytes\n  // 16 - number of this disk                                         4 bytes\n  // 20 - number of the disk with the start of the central directory  4 bytes\n  // 24 - total number of entries in the central directory on this disk         8 bytes\n  // 32 - total number of entries in the central directory            8 bytes\n  const entryCount = getUint64LE(zip64Eocdr, 32);\n  // 40 - size of the central directory                               8 bytes\n  const centralDirectorySize = getUint64LE(zip64Eocdr, 40);\n  // 48 - offset of start of central directory with respect to the starting disk number     8 bytes\n  const centralDirectoryOffset = getUint64LE(zip64Eocdr, 48);\n  // 56 - zip64 extensible data sector                                (variable size)\n  return readEntries(reader, centralDirectoryOffset, centralDirectorySize, entryCount, comment, commentBytes);\n}\n\nconst CENTRAL_DIRECTORY_FILE_HEADER_SIGNATURE = 0x02014b50;\n\nasync function readEntries(reader, centralDirectoryOffset, centralDirectorySize, rawEntryCount, comment, commentBytes) {\n  let readEntryCursor = 0;\n  const allEntriesBuffer = await readAs(reader, centralDirectoryOffset, centralDirectorySize);\n  const rawEntries = [];\n\n  for (let e = 0; e < rawEntryCount; ++e) {\n    const buffer = allEntriesBuffer.subarray(readEntryCursor, readEntryCursor + 46);\n    // 0 - Central directory file header signature\n    const signature = getUint32LE(buffer, 0);\n    if (signature !== CENTRAL_DIRECTORY_FILE_HEADER_SIGNATURE) {\n      throw new Error(`invalid central directory file header signature: 0x${signature.toString(16)}`);\n    }\n    const rawEntry = {\n      // 4 - Version made by\n      versionMadeBy: getUint16LE(buffer, 4),\n      // 6 - Version needed to extract (minimum)\n      versionNeededToExtract: getUint16LE(buffer, 6),\n      // 8 - General purpose bit flag\n      generalPurposeBitFlag: getUint16LE(buffer, 8),\n      // 10 - Compression method\n      compressionMethod: getUint16LE(buffer, 10),\n      // 12 - File last modification time\n      lastModFileTime: getUint16LE(buffer, 12),\n      // 14 - File last modification date\n      lastModFileDate: getUint16LE(buffer, 14),\n      // 16 - CRC-32\n      crc32: getUint32LE(buffer, 16),\n      // 20 - Compressed size\n      compressedSize: getUint32LE(buffer, 20),\n      // 24 - Uncompressed size\n      uncompressedSize: getUint32LE(buffer, 24),\n      // 28 - File name length (n)\n      fileNameLength: getUint16LE(buffer, 28),\n      // 30 - Extra field length (m)\n      extraFieldLength: getUint16LE(buffer, 30),\n      // 32 - File comment length (k)\n      fileCommentLength: getUint16LE(buffer, 32),\n      // 34 - Disk number where file starts\n      // 36 - Internal file attributes\n      internalFileAttributes: getUint16LE(buffer, 36),\n      // 38 - External file attributes\n      externalFileAttributes: getUint32LE(buffer, 38),\n      // 42 - Relative offset of local file header\n      relativeOffsetOfLocalHeader: getUint32LE(buffer, 42),\n    };\n\n    if (rawEntry.generalPurposeBitFlag & 0x40) {\n      throw new Error('strong encryption is not supported');\n    }\n\n    readEntryCursor += 46;\n\n    const data = allEntriesBuffer.subarray(readEntryCursor, readEntryCursor + rawEntry.fileNameLength + rawEntry.extraFieldLength + rawEntry.fileCommentLength);\n    rawEntry.nameBytes = data.slice(0, rawEntry.fileNameLength);\n    rawEntry.name = decodeBuffer(rawEntry.nameBytes);\n\n    // 46+n - Extra field\n    const fileCommentStart = rawEntry.fileNameLength + rawEntry.extraFieldLength;\n    const extraFieldBuffer = data.slice(rawEntry.fileNameLength, fileCommentStart);\n    rawEntry.extraFields = [];\n    let i = 0;\n    while (i < extraFieldBuffer.length - 3) {\n      const headerId = getUint16LE(extraFieldBuffer, i + 0);\n      const dataSize = getUint16LE(extraFieldBuffer, i + 2);\n      const dataStart = i + 4;\n      const dataEnd = dataStart + dataSize;\n      if (dataEnd > extraFieldBuffer.length) {\n        throw new Error('extra field length exceeds extra field buffer size');\n      }\n      rawEntry.extraFields.push({\n        id: headerId,\n        data: extraFieldBuffer.slice(dataStart, dataEnd),\n      });\n      i = dataEnd;\n    }\n\n    // 46+n+m - File comment\n    rawEntry.commentBytes = data.slice(fileCommentStart, fileCommentStart + rawEntry.fileCommentLength);\n    rawEntry.comment = decodeBuffer(rawEntry.commentBytes);\n\n    readEntryCursor += data.length;\n\n    if (rawEntry.uncompressedSize            === 0xffffffff ||\n        rawEntry.compressedSize              === 0xffffffff ||\n        rawEntry.relativeOffsetOfLocalHeader === 0xffffffff) {\n      // ZIP64 format\n      // find the Zip64 Extended Information Extra Field\n      const zip64ExtraField = rawEntry.extraFields.find(e => e.id === 0x0001);\n      if (!zip64ExtraField) {\n        throw new Error('expected zip64 extended information extra field');\n      }\n      const zip64EiefBuffer = zip64ExtraField.data;\n      let index = 0;\n      // 0 - Original Size          8 bytes\n      if (rawEntry.uncompressedSize === 0xffffffff) {\n        if (index + 8 > zip64EiefBuffer.length) {\n          throw new Error('zip64 extended information extra field does not include uncompressed size');\n        }\n        rawEntry.uncompressedSize = getUint64LE(zip64EiefBuffer, index);\n        index += 8;\n      }\n      // 8 - Compressed Size        8 bytes\n      if (rawEntry.compressedSize === 0xffffffff) {\n        if (index + 8 > zip64EiefBuffer.length) {\n          throw new Error('zip64 extended information extra field does not include compressed size');\n        }\n        rawEntry.compressedSize = getUint64LE(zip64EiefBuffer, index);\n        index += 8;\n      }\n      // 16 - Relative Header Offset 8 bytes\n      if (rawEntry.relativeOffsetOfLocalHeader === 0xffffffff) {\n        if (index + 8 > zip64EiefBuffer.length) {\n          throw new Error('zip64 extended information extra field does not include relative header offset');\n        }\n        rawEntry.relativeOffsetOfLocalHeader = getUint64LE(zip64EiefBuffer, index);\n        index += 8;\n      }\n      // 24 - Disk Start Number      4 bytes\n    }\n\n    // check for Info-ZIP Unicode Path Extra Field (0x7075)\n    // see https://github.com/thejoshwolfe/yauzl/issues/33\n    const nameField = rawEntry.extraFields.find(e =>\n        e.id === 0x7075 &&\n        e.data.length >= 6 && // too short to be meaningful\n        e.data[0] === 1 &&    // Version       1 byte      version of this extra field, currently 1\n        getUint32LE(e.data, 1), crc$1.unsigned(rawEntry.nameBytes)); // NameCRC32     4 bytes     File Name Field CRC32 Checksum\n                                                                   // > If the CRC check fails, this UTF-8 Path Extra Field should be\n                                                                   // > ignored and the File Name field in the header should be used instead.\n    if (nameField) {\n        // UnicodeName Variable UTF-8 version of the entry File Name\n        rawEntry.fileName = decodeBuffer(nameField.data.slice(5));\n    }\n\n    // validate file size\n    if (rawEntry.compressionMethod === 0) {\n      let expectedCompressedSize = rawEntry.uncompressedSize;\n      if ((rawEntry.generalPurposeBitFlag & 0x1) !== 0) {\n        // traditional encryption prefixes the file data with a header\n        expectedCompressedSize += 12;\n      }\n      if (rawEntry.compressedSize !== expectedCompressedSize) {\n        throw new Error(`compressed size mismatch for stored file: ${rawEntry.compressedSize} != ${expectedCompressedSize}`);\n      }\n    }\n    rawEntries.push(rawEntry);\n  }\n  const zip = {\n    comment,\n    commentBytes,\n  };\n  return {\n    zip,\n    entries: rawEntries.map(e => new ZipEntry(reader, e)),\n  };\n}\n\nasync function readEntryDataHeader(reader, rawEntry) {\n  if (rawEntry.generalPurposeBitFlag & 0x1) {\n    throw new Error('encrypted entries not supported');\n  }\n  const buffer = await readAs(reader, rawEntry.relativeOffsetOfLocalHeader, 30);\n  // note: maybe this should be passed in or cached on entry\n  // as it's async so there will be at least one tick (not sure about that)\n  const totalLength = await reader.getLength();\n\n  // 0 - Local file header signature = 0x04034b50\n  const signature = getUint32LE(buffer, 0);\n  if (signature !== 0x04034b50) {\n    throw new Error(`invalid local file header signature: 0x${signature.toString(16)}`);\n  }\n\n  // all this should be redundant\n  // 4 - Version needed to extract (minimum)\n  // 6 - General purpose bit flag\n  // 8 - Compression method\n  // 10 - File last modification time\n  // 12 - File last modification date\n  // 14 - CRC-32\n  // 18 - Compressed size\n  // 22 - Uncompressed size\n  // 26 - File name length (n)\n  const fileNameLength = getUint16LE(buffer, 26);\n  // 28 - Extra field length (m)\n  const extraFieldLength = getUint16LE(buffer, 28);\n  // 30 - File name\n  // 30+n - Extra field\n  const localFileHeaderEnd = rawEntry.relativeOffsetOfLocalHeader + buffer.length + fileNameLength + extraFieldLength;\n  let decompress;\n  if (rawEntry.compressionMethod === 0) {\n    // 0 - The file is stored (no compression)\n    decompress = false;\n  } else if (rawEntry.compressionMethod === 8) {\n    // 8 - The file is Deflated\n    decompress = true;\n  } else {\n    throw new Error(`unsupported compression method: ${rawEntry.compressionMethod}`);\n  }\n  const fileDataStart = localFileHeaderEnd;\n  const fileDataEnd = fileDataStart + rawEntry.compressedSize;\n  if (rawEntry.compressedSize !== 0) {\n    // bounds check now, because the read streams will probably not complain loud enough.\n    // since we're dealing with an unsigned offset plus an unsigned size,\n    // we only have 1 thing to check for.\n    if (fileDataEnd > totalLength) {\n      throw new Error(`file data overflows file bounds: ${fileDataStart} +  ${rawEntry.compressedSize}  > ${totalLength}`);\n    }\n  }\n  return {\n    decompress,\n    fileDataStart,\n  };\n}\n\nasync function readEntryDataAsArrayBuffer(reader, rawEntry) {\n  const {decompress, fileDataStart} = await readEntryDataHeader(reader, rawEntry);\n  if (!decompress) {\n    const dataView = await readAs(reader, fileDataStart, rawEntry.compressedSize);\n    // make copy?\n    //\n    // 1. The source is a Blob/file. In this case we'll get back TypedArray we can just hand to the user\n    // 2. The source is a TypedArray. In this case we'll get back TypedArray that is a view into a larger buffer\n    //    but because ultimately this is used to return an ArrayBuffer to `someEntry.arrayBuffer()`\n    //    we need to return copy since we need the `ArrayBuffer`, not the TypedArray to exactly match the data.\n    //    Note: We could add another API function `bytes()` or something that returned a `Uint8Array`\n    //    instead of an `ArrayBuffer`. This would let us skip a copy here. But this case only happens for uncompressed\n    //    data. That seems like a rare enough case that adding a new API is not worth it? Or is it? A zip of jpegs or mp3s\n    //    might not be compressed. For now that's a TBD.\n    return isTypedArraySameAsArrayBuffer(dataView) ? dataView.buffer : dataView.slice().buffer;\n  }\n  // see comment in readEntryDateAsBlob\n  const typedArrayOrBlob = await readAsBlobOrTypedArray(reader, fileDataStart, rawEntry.compressedSize);\n  const result = await inflateRawAsync(typedArrayOrBlob, rawEntry.uncompressedSize);\n  return result;\n}\n\nasync function readEntryDataAsBlob(reader, rawEntry, type) {\n  const {decompress, fileDataStart} = await readEntryDataHeader(reader, rawEntry);\n  if (!decompress) {\n    const typedArrayOrBlob = await readAsBlobOrTypedArray(reader, fileDataStart, rawEntry.compressedSize, type);\n    if (isBlob(typedArrayOrBlob)) {\n      return typedArrayOrBlob;\n    }\n    return new Blob([isSharedArrayBuffer(typedArrayOrBlob.buffer) ? new Uint8Array(typedArrayOrBlob) : typedArrayOrBlob], {type});\n  }\n  // Here's the issue with this mess (should refactor?)\n  // if the source is a blob then we really want to pass a blob to inflateRawAsync to avoid a large\n  // copy if we're going to a worker.\n  const typedArrayOrBlob = await readAsBlobOrTypedArray(reader, fileDataStart, rawEntry.compressedSize);\n  const result = await inflateRawAsync(typedArrayOrBlob, rawEntry.uncompressedSize, type);\n  return result;\n}\n\nfunction setOptions$1(options) {\n  setOptions(options);\n}\n\nasync function unzipRaw(source) {\n  let reader;\n  if (typeof Blob !== 'undefined' && source instanceof Blob) {\n    reader = new BlobReader(source);\n  } else if (source instanceof ArrayBuffer || (source && source.buffer && source.buffer instanceof ArrayBuffer)) {\n    reader = new ArrayBufferReader(source);\n  } else if (isSharedArrayBuffer(source) || isSharedArrayBuffer(source.buffer)) {\n    reader = new ArrayBufferReader(source);\n  } else if (typeof source === 'string') {\n    const req = await fetch(source);\n    if (!req.ok) {\n      throw new Error(`failed http request ${source}, status: ${req.status}: ${req.statusText}`);\n    }\n    const blob = await req.blob();\n    reader = new BlobReader(blob);\n  } else if (typeof source.getLength === 'function' && typeof source.read === 'function') {\n    reader = source;\n  } else {\n    throw new Error('unsupported source type');\n  }\n\n  const totalLength = await reader.getLength();\n\n  if (totalLength > Number.MAX_SAFE_INTEGER) {\n    throw new Error(`file too large. size: ${totalLength}. Only file sizes up 4503599627370496 bytes are supported`);\n  }\n\n  return await findEndOfCentralDirector(reader, totalLength);\n}\n\n// If the names are not utf8 you should use unzipitRaw\nasync function unzip(source) {\n  const {zip, entries} = await unzipRaw(source);\n  return {\n    zip,\n    entries: Object.fromEntries(entries.map(v => [v.name, v])),\n  };\n}\n\nfunction cleanup$1() {\n  cleanup();\n}\n\nexport { HTTPRangeReader, cleanup$1 as cleanup, setOptions$1 as setOptions, unzip, unzipRaw };\n","\r\n/**\r\n * @param {K} tag \r\n * @param {Record<string, any>} [attributes] \r\n * @param {any} [nodes]\r\n * @returns {HTMLElementTagNameMap[K]}\r\n * @template {keyof HTMLElementTagNameMap} K\r\n */\r\nexport function createElement(tag, attributes, nodes) {\r\n\tlet element = document.createElement(tag);\r\n\r\n\tif (attributes) {\r\n\t\tfor (let name in attributes) {\r\n\t\t\tlet value = attributes[name];\r\n\t\r\n\t\t\tif (name.startsWith(\"on\")) {\r\n\t\t\t\telement[name] = value;\r\n\t\t\t} else {\r\n\t\t\t\tif (value === true) {\r\n\t\t\t\t\telement.setAttribute(name, \"\");\r\n\t\t\t\t} else if (value == null || value === false) {\r\n\t\t\t\t\t// Ignore.\r\n\t\t\t\t} else {\r\n\t\t\t\t\telement.setAttribute(name, value);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tif (nodes) {\r\n\t\tif (Array.isArray(nodes)) {\r\n\t\t\tfor (let node of nodes) {\r\n\t\t\t\telement.append(node);\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\telement.append(nodes);\r\n\t\t}\r\n\t}\r\n\r\n\treturn element;\r\n}\r\n","\r\n/**\r\n * @param {string} path\r\n */\r\nexport function getExtension(path) {\r\n\tlet dot = path.lastIndexOf(\".\");\r\n\treturn dot < 0 ? \"\" : path.slice(dot + 1).toLowerCase();\r\n}\r\n\r\n/**\r\n * @param {string} path\r\n * @returns {string}\r\n */\r\nexport function resolveAssetURL(path) {\r\n\treturn \"assets\" + resolveAbsoluteAssetPath(path);\r\n}\r\n\r\n/**\r\n * @param {string} path\r\n * @returns {string}\r\n */\r\n export function resolveAbsoluteAssetPath(path) {\r\n\tif (path[0] !== \"/\") {\r\n\t\tpath = \"/\" + path;\r\n\t}\r\n\treturn path;\r\n}\r\n","import * as unzipit from \"./format/unzipit.js\";\r\nimport { createElement } from \"./html.js\";\r\nimport { httpGET, httpGETImage } from \"./network/http.js\";\r\nimport { getExtension, resolveAbsoluteAssetPath, resolveAssetURL } from \"./path.js\";\r\n\r\n/**\r\n * @type {Record<string, Blob | ArrayBuffer>}\r\n */\r\nlet assets = Object.create(null);\r\n\r\n/**\r\n * @param {string} path\r\n * @param {(progress: number) => void} [onprogress]\r\n * @returns {ArrayBuffer|Promise<ArrayBuffer>}\r\n */\r\nexport function getAssetAsArrayBuffer(path, onprogress) {\r\n\tpath = resolveAbsoluteAssetPath(path);\r\n\r\n\t// Try to read from cache.\r\n\tlet data = assets[path];\r\n\r\n\tif (data) {\r\n\t\tif (onprogress) onprogress(1);\r\n\t\treturn data instanceof Blob ? data.arrayBuffer() : data;\r\n\t}\r\n\r\n\t// Get via HTTP, and then cache.\r\n\treturn httpGET(resolveAssetURL(path), \"arraybuffer\", onprogress).then(data => assets[path] = data);\r\n}\r\n\r\n/**\r\n * @param {string} path\r\n * @param {string} type\r\n * @returns {Blob|Promise<Blob>}\r\n */\r\nexport function getAssetAsBlob(path, type) {\r\n\tpath = resolveAbsoluteAssetPath(path);\r\n\r\n\t// Try to read from cache.\r\n\tlet data = assets[path];\r\n\r\n\tif (data) {\r\n\t\treturn data instanceof Blob ? data : new Blob([ data ], { type: type });\r\n\t}\r\n\r\n\t// Get via HTTP, and then cache.\t\r\n\treturn httpGET(resolveAssetURL(path), \"blob\").then(data => assets[path] = data);\r\n}\r\n\r\n/**\r\n * @param {string} path\r\n * @returns {Promise<HTMLImageElement>}\r\n */\r\nexport function getAssetAsIMG(path) {\r\n\tpath = resolveAbsoluteAssetPath(path);\r\n\r\n\t// Try to read from cache.\r\n\tlet data = assets[path];\r\n\r\n\tif (data) {\r\n\t\tif (data instanceof ArrayBuffer) {\r\n\t\t\tdata = new Blob([ data ]);\r\n\t\t}\r\n\r\n\t\tlet url = URL.createObjectURL(data);\r\n\t\t\r\n\t\t// This is very lazy, but it should do the trick to prevent leaks.\r\n\t\tsetTimeout(() => {\r\n\t\t\tURL.revokeObjectURL(url);\r\n\t\t}, 5000);\r\n\t\t\r\n\t\treturn httpGETImage(url);\r\n\t}\r\n\r\n\t// Get via HTTP.\t\r\n\treturn httpGETImage(resolveAssetURL(path));\r\n}\r\n\r\n\r\nunzipit.setOptions({\r\n\tworkerURL: \"unzipit.js\",\r\n});\r\n\r\n/**\r\n * @param {string} url\r\n * @returns {Promise<boolean>}\r\n */\r\nexport async function loadBundle(url) {\r\n\tlet r = await loadBundleEx(url);\r\n\tif (r) {\r\n\t\tconsole.error(r[0]);\r\n\t\tconsole.error(r[1]);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\n/**\r\n * @param {string} url\r\n * @param {(progress: number) => void} [onprogress]\r\n * @returns {Promise<boolean>} true if a bundle was loaded\r\n */\r\nexport async function loadOptionalBundle(url, onprogress) {\r\n\tlet r = await loadBundleEx(url, onprogress);\r\n\treturn !r;\r\n}\r\n\r\n/**\r\n * @param {string} url\r\n * @param {(progress: number) => void} [onprogress]\r\n * @returns {Promise<undefined | [ string, any ]>} if an error, returns human readable message and original error\r\n */\r\nasync function loadBundleEx(url, onprogress) {\r\n\t// A note on progress, since there are many disparate progress related steps\r\n\t// we have to arbitarily combine these priorities.\r\n\t// Since network is often the slowest part, we assign 80% of the progres\r\n\t// to the HTTP get.\r\n\tconst PROGRESS_HTTP_GET = 0.8;\r\n\tconst PROGRESS_UNZIP_TOP = 0.9;\r\n\r\n\tlet blob;\r\n\ttry {\r\n\t\tblob = await httpGET(url, \"blob\", (loadProgress, ok) => {\r\n\t\t\tif (ok && onprogress) onprogress(loadProgress * PROGRESS_HTTP_GET);\r\n\t\t});\r\n\t} catch (error) {\r\n\t\treturn [ \"Error loading bundle '\" + url + \"'\", error ];\r\n\t}\r\n\tif (onprogress) onprogress(PROGRESS_HTTP_GET);\r\n\r\n\tif (blob) {\r\n\t\tlet zip;\r\n\t\ttry {\r\n\t\t\tzip = await unzipit.unzipRaw(blob);\r\n\t\t} catch (error) {\r\n\t\t\treturn [ \"Error decoding bundle '\" + url + \"'\", error ];\r\n\t\t}\r\n\t\tif (onprogress) onprogress(PROGRESS_UNZIP_TOP);\r\n\r\n\t\tif (zip) {\r\n\t\t\tlet root = getCommonRootDirectory(zip);\r\n\t\r\n\t\t\t/** @type {Promise[]} */\r\n\t\t\tlet filePromises = [];\r\n\r\n\t\t\tlet files = zip.entries.filter(entry => !entry.isDirectory);\r\n\t\t\tlet loadCount = 0;\r\n\t\r\n\t\t\tfor (let file of files) {\r\n\t\t\t\tlet name = file.name;\r\n\t\t\t\tif (root) name = name.slice(root.length);\r\n\t\t\t\tname = \"/\" + name;\r\n\r\n\t\t\t\tlet ext = getExtension(name);\r\n\r\n\t\t\t\t// We have the choice of decoding entry as Blob or ArrayBuffer.\r\n\t\t\t\t// Since there may be overhead later converting to/from blob/arraybuffer, choose an appropriate type\r\n\t\t\t\t// based on the file extension. (even if we guess wrong, we can convert later)\r\n\r\n\t\t\t\t/** @type {Promise<Blob | ArrayBuffer>} */\r\n\t\t\t\tlet dataPromise;\r\n\t\t\t\tif (ext === \"png\") {\r\n\t\t\t\t\tdataPromise = file.blob(\"image/png\");\r\n\t\t\t\t} else if (ext === \"jpg\" || ext === \"jpeg\") {\r\n\t\t\t\t\tdataPromise = file.blob(\"image/jpeg\");\r\n\t\t\t\t} else if (ext === \"gif\") {\r\n\t\t\t\t\tdataPromise = file.blob(\"image/gif\");\r\n\t\t\t\t} else if (ext === \"bmp\") {\r\n\t\t\t\t\tdataPromise = file.blob(\"image/bmp\");\r\n\t\t\t\t} else {\r\n\t\t\t\t\tdataPromise = file.arrayBuffer();\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfilePromises.push(\r\n\t\t\t\t\tdataPromise.then((data) => {\r\n\t\t\t\t\t\tassets[name] = data;\r\n\t\t\t\t\t\tloadCount++;\r\n\r\n\t\t\t\t\t\tif (onprogress) onprogress(PROGRESS_UNZIP_TOP + (loadCount / files.length) * (1 - PROGRESS_UNZIP_TOP));\r\n\t\t\t\t\t}, (error) => {\r\n\t\t\t\t\t\tthrow [ `Error getting file '${name}' from bundle '${url}'`, error ];\r\n\t\t\t\t\t})\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\r\n\t\t\ttry {\r\n\t\t\t\tawait Promise.all(filePromises);\r\n\t\t\t} catch (error) {\r\n\t\t\t\treturn error;\r\n\t\t\t}\r\n\r\n\t\t\tconsole.info(`[SOCK] loaded ${loadCount} assets from bundle '${url}'`);\r\n\t\t}\r\n\t}\r\n}\r\n\r\n/**\r\n * @param {unzipit.ZipInfoRaw} zip\r\n * @returns {string|null}\r\n */\r\nfunction getCommonRootDirectory(zip) {\r\n\tlet commonRoot = null;\r\n\r\n\tfor (let entry of zip.entries) {\r\n\t\tif (!entry.isDirectory) {\r\n\t\t\tlet name = entry.name;\r\n\t\t\t\r\n\t\t\tlet i = name.indexOf(\"/\");\r\n\t\t\tif (i <= 0) return null;\r\n\t\t\t\r\n\t\t\tlet root = name.slice(0, i + 1);\r\n\r\n\t\t\tif (!commonRoot) {\r\n\t\t\t\tcommonRoot = root;\r\n\t\t\t} else if (commonRoot !== root) {\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\treturn commonRoot;\r\n}\r\n","import { callHandle_resolve_2 } from \"../vm-call-handles.js\";\r\nimport { wrenCall, wrenEnsureSlots, wrenGetSlotHandle, wrenGetSlotType, wrenGetVariable, wrenReleaseHandle, wrenSetSlotBool, wrenSetSlotDouble, wrenSetSlotHandle, wrenSetSlotNull, wrenSetSlotString } from \"../vm.js\";\r\n\r\nexport let handle_Promise = 0;\r\n\r\nexport function initPromiseModule() {\r\n\twrenEnsureSlots(1);\r\n\twrenGetVariable(\"sock\", \"Promise\", 0);\r\n\thandle_Promise = wrenGetSlotHandle(0);\r\n}\r\n\r\n/**\r\n * @param {number} promiseHandle\r\n * @param {WrenPromiseResult|Promise<WrenPromiseResult>} pvalue\r\n */\r\nexport function resolveWrenPromise(promiseHandle, pvalue) {\r\n\tif (pvalue instanceof Promise) {\r\n\t\tPromise.resolve(pvalue).then(result => {\r\n\t\t\tresolve(promiseHandle, true, result);\r\n\t\t}, error => {\r\n\t\t\tresolve(promiseHandle, false, String(error));\r\n\t\t});\r\n\t} else {\r\n\t\tresolveSync(promiseHandle, pvalue);\r\n\t}\r\n}\r\n\r\n/**\r\n * @param {number} promiseHandle \r\n * @param {boolean} success \r\n * @param {WrenPromiseResult} result \r\n */\r\nfunction resolve(promiseHandle, success, result) {\r\n\twrenEnsureSlots(3);\r\n\twrenSetSlotHandle(0, promiseHandle);\r\n\twrenSetSlotBool(1, success);\r\n\r\n\tputResultInSlot(result, 2);\r\n\r\n\twhile (true) {\r\n\t\tif (wrenCall(callHandle_resolve_2) !== 0) {\r\n\t\t\tbreak;\r\n\t\t}\r\n\t\t\r\n\t\twrenEnsureSlots(3);\r\n\t\t\r\n\t\tif (wrenGetSlotType(0) === 0) {\r\n\t\t\tbreak;\r\n\t\t}\r\n\r\n\t\twrenSetSlotHandle(0, promiseHandle);\r\n\t\twrenSetSlotNull(1);\r\n\t\twrenSetSlotNull(2);\r\n\t}\r\n\r\n\twrenReleaseHandle(promiseHandle);\r\n}\r\n\r\n/**\r\n * @param {number} promiseHandle\r\n * @param {WrenPromiseResult} result\r\n */\r\nfunction resolveSync(promiseHandle, result) {\r\n\twrenReleaseHandle(promiseHandle);\r\n\tputResultInSlot(result, 0);\r\n}\r\n\r\n/**\r\n * @param {WrenPromiseResult} result\r\n * @param {number} slot\r\n */\r\nfunction putResultInSlot(result, slot) {\r\n\tif (result instanceof ArrayBuffer || typeof result === \"string\") {\r\n\t\twrenSetSlotString(slot, result);\r\n\t} else if (result instanceof WrenHandle) {\r\n\t\twrenSetSlotHandle(slot, result.handle);\r\n\t\twrenReleaseHandle(result.handle);\r\n\t} else if (typeof result === \"number\") {\r\n\t\twrenSetSlotDouble(slot, result);\r\n\t} else if (typeof result === \"boolean\") {\r\n\t\twrenSetSlotBool(slot, result);\r\n\t} else {\r\n\t\twrenSetSlotNull(slot);\r\n\t}\r\n}\r\n\r\nexport class WrenHandle {\r\n\t/**\r\n\t * @param {number} handle \r\n\t */\r\n\tconstructor(handle) {\r\n\t\tthis.handle = handle;\r\n\t}\r\n}\r\n\r\n/**\r\n * To provide a value that is already in VM slot 2, pass the `IN_SLOT_2` object.\r\n * @typedef {string | number | boolean | ArrayBuffer | WrenHandle | void} WrenPromiseResult\r\n */\r\n","import { getAssetAsArrayBuffer, loadBundle } from \"../asset-database.js\";\r\nimport { addClassForeignStaticMethods } from \"../foreign.js\";\r\nimport { httpExists } from \"../network/http.js\";\r\nimport { resolveAssetURL } from \"../path.js\";\r\nimport { wrenAbort, wrenEnsureSlots, wrenGetSlotHandle, wrenGetSlotIsInstanceOf, wrenGetSlotString, wrenGetSlotType, wrenGetVariable, wrenSetSlotDouble, wrenSetSlotHandle, wrenSetSlotNull } from \"../vm.js\";\r\nimport { handle_Promise, resolveWrenPromise } from \"./promise.js\";\r\n\r\nlet handle_Asset = 0;\r\n\r\nexport function initAssetModule() {\r\n\twrenEnsureSlots(1);\r\n\twrenGetVariable(\"sock\", \"Asset\", 0);\r\n\thandle_Asset = wrenGetSlotHandle(0);\r\n}\r\n\r\naddClassForeignStaticMethods(\"sock\", \"Asset\", {\r\n\t\"loadString_(_,_)\"() {\r\n\t\tloadAsset(path => getAssetAsArrayBuffer(path));\r\n\t},\r\n\t\"exists_(_,_)\"() {\r\n\t\tloadAsset(path => httpExists(resolveAssetURL(path)));\r\n\t},\r\n\t\"loadBundle_(_,_)\"() {\r\n\t\tloadAsset(path => loadBundle(resolveAssetURL(path)));\r\n\t},\r\n});\r\n\r\n/**\r\n * Loads asset from (path, promise) call.\r\n * @param {(path: string) => (import(\"./promise.js\").WrenPromiseResult | Promise<import(\"./promise.js\").WrenPromiseResult>)} loader\r\n */\r\nexport function loadAsset(loader) {\r\n\twrenEnsureSlots(4);\r\n\twrenSetSlotHandle(3, handle_Promise);\r\n\r\n\tif (wrenGetSlotType(1) !== 6 || !wrenGetSlotIsInstanceOf(2, 3)) {\r\n\t\twrenAbort(\"args must be (string, Promise)\");\r\n\t\treturn;\r\n\t}\r\n\r\n\tlet path = wrenGetSlotString(1);\r\n\tlet promise = wrenGetSlotHandle(2);\r\n\r\n\twrenSetSlotHandle(0, promise);\r\n\r\n\tresolveWrenPromise(promise, loader(path));\r\n}\r\n","import { getAssetAsArrayBuffer } from \"../asset-database.js\";\r\nimport { addForeignClass } from \"../foreign.js\";\r\nimport { sockJsGlobal } from \"../globals.js\";\r\nimport * as Path from \"../path.js\";\r\nimport { wrenAbort, wrenEnsureSlots, wrenGetSlotBool, wrenGetSlotDouble, wrenGetSlotForeign, wrenGetSlotHandle, wrenGetSlotIsInstanceOf, wrenGetSlotString, wrenGetSlotType, wrenGetVariable, wrenReleaseHandle, wrenSetSlotBool, wrenSetSlotDouble, wrenSetSlotHandle, wrenSetSlotNewForeign } from \"../vm.js\";\r\nimport { loadAsset } from \"./asset.js\";\r\nimport { WrenHandle } from \"./promise.js\";\r\n\r\nconst MAX_EFFECT_PER_AUDIO = 8;\r\n\r\nconst EFFECT_TYPE_NONE = 0;\r\nconst EFFECT_TYPE_FILTER = 1;\r\nconst EFFECT_TYPE_ECHO = 2;\r\nconst EFFECT_TYPE_REVERB = 3;\r\nconst EFFECT_TYPE_DISTORTION = 4;\r\nconst EFFECT_TYPE_MIN = 1;\r\nconst EFFECT_TYPE_MAX = 4;\r\n\r\nconst EFFECT_TYPE_NAMES = [\r\n\t\"none\",\r\n\t\"filter\",\r\n\t\"echo\",\r\n\t\"reverb\",\r\n\t\"distortion\",\r\n];\r\n\r\nconst PARAM_FILTER_TYPE = 0;\r\nconst PARAM_FILTER_FREQUENCY = 1;\r\nconst PARAM_FILTER_RESONANCE = 2;\r\n\r\nconst PARAM_ECHO_DELAY = 0;\r\nconst PARAM_ECHO_DECAY = 1;\r\nconst PARAM_ECHO_VOLUME = 2;\r\n\r\nconst PARAM_REVERB_VOLUME = 0;\r\n\r\nconst FILTER_TYPE_LOWPASS = 0;\r\nconst FILTER_TYPE_HIGHPASS = 1;\r\nconst FILTER_TYPE_BANDPASS = 2;\r\nconst FILTER_TYPE_MIN = 0;\r\nconst FILTER_TYPE_MAX = 2;\r\n\r\nconst BASE_MASTER_GAIN = 0.5;\r\n\r\n/**\r\n * Used to decode audio if `audioctx` is not created yet.\r\n * @type {OfflineAudioContext}\r\n */\r\nlet offlineContext = null;\r\n\r\n/**\r\n * @type {AudioContext}\r\n */\r\nlet audioctx;\r\n\r\n/**\r\n * @type {GainNode}\r\n */\r\nlet masterGain;\r\n\r\n/**\r\n * @type {number}\r\n */\r\nlet handle_Audio = 0;\r\n\r\n/**\r\n * @type {number}\r\n */\r\nlet handle_AudioBus = 0;\r\n\r\n/**\r\n * @type {number}\r\n */\r\nlet handle_Voice = 0;\r\n\r\n/**\r\n * @param {number} duration\r\n * @returns {AudioBuffer}\r\n */\r\nfunction generateImpulse(duration) {\r\n\tlet frameCount = Math.floor(duration * audioctx.sampleRate);\r\n\tlet buffer = new AudioBuffer({\r\n\t\tlength: frameCount,\r\n\t\tsampleRate: audioctx.sampleRate,\r\n\t\tnumberOfChannels: 2,\r\n\t});\r\n\r\n\tlet ch1 = buffer.getChannelData(0);\r\n\tlet ch2 = buffer.getChannelData(1);\r\n\tlet baseVolume = 0.022;\r\n\r\n\tfor (let i = 0; i < frameCount; i++) {\r\n\t\tlet volume = baseVolume * Math.exp(-5 * (i / frameCount));\r\n\t\tch1[i] = (Math.random() * 2 - 1) * volume;\r\n\t\tch2[i] = (Math.random() * 2 - 1) * volume;\r\n\t}\r\n\r\n\treturn buffer;\r\n}\r\n\r\n/**\r\n * @type {AudioBuffer}\r\n */\r\nlet implulseChurch;\r\n\r\nexport function initAudioModule() {\r\n\t// Init audio graph.\r\n\t// Ideally the audiocontext is created from the HTML, but we have a fallback here as well.\r\n\taudioctx = sockJsGlobal.audio ?? new AudioContext();\r\n\r\n\tif (audioctx.state === \"suspended\") {\r\n\t\tconsole.warn(\"AudioContext is suspended\");\r\n\t}\r\n\t\r\n\tmasterGain = new GainNode(audioctx, {\r\n\t\tgain: BASE_MASTER_GAIN,\r\n\t});\r\n\tmasterGain.connect(audioctx.destination);\r\n\r\n\t// Get handles.\r\n\twrenEnsureSlots(1);\r\n\r\n\twrenGetVariable(\"sock\", \"Audio\", 0);\r\n\thandle_Audio = wrenGetSlotHandle(0);\r\n\r\n\twrenGetVariable(\"sock\", \"Voice\", 0);\r\n\thandle_Voice = wrenGetSlotHandle(0);\r\n\t\r\n\twrenGetVariable(\"sock\", \"AudioBus\", 0);\r\n\thandle_AudioBus = wrenGetSlotHandle(0);\r\n}\r\n\r\nexport function stopAllAudio() {\r\n\tif (audioctx) {\r\n\t\taudioctx.close();\r\n\t\taudioctx = null;\r\n\t\tmasterGain = null;\r\n\t}\r\n}\r\n\r\n/**\r\n * @param {GainNode} gainNode\r\n * @param {number} volume\r\n * @param {number} fade\r\n */\r\nfunction fadeVolume(gainNode, volume, fade) {\r\n\tvolume = Math.max(0, volume);\r\n\tfade = Math.max(0.002, fade);\r\n\r\n\tlet gain = gainNode.gain;\r\n\tgain.cancelScheduledValues(audioctx.currentTime);\r\n\tgain.value = gain.value;\r\n\tgain.linearRampToValueAtTime(volume, audioctx.currentTime + fade);\r\n}\r\n\r\nclass AudioControls {\r\n\t/**\r\n\t * @param {AudioControls|null} [destination] \r\n\t */\r\n\tconstructor(destination) {\r\n\t\t/**\r\n\t\t * @type {Effect[]}\r\n\t\t */\r\n\t\tthis.effects = Array(MAX_EFFECT_PER_AUDIO).fill(null);\r\n\r\n\t\tthis.gain = audioctx.createGain();\r\n\r\n\t\t/**\r\n\t\t * Used to pipe this graph into another graph.\r\n\t\t * @type {AudioControls|null|undefined}\r\n\t\t */\r\n\t\tthis.destination = destination;\r\n\r\n\t\tthis.updateGraph();\r\n\t}\r\n\r\n\t/**\r\n\t * @returns {AudioNode}\r\n\t */\r\n\tgetInput() {\r\n\t\tfor (let i = 0; i < MAX_EFFECT_PER_AUDIO; i++) {\r\n\t\t\tlet effect = this.effects[i];\r\n\r\n\t\t\tif (effect) {\r\n\t\t\t\treturn effect.input;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn this.gain;\r\n\t}\r\n\r\n\t/**\r\n\t * @param {number} index\r\n\t * @returns {number}\r\n\t */\r\n\tgetEffectType(index) {\r\n\t\tlet effect = this.effects[index];\r\n\t\treturn effect ? effect.type : EFFECT_TYPE_NONE;\r\n\t}\r\n\r\n\tupdateGraph() {\r\n\t\t/** @type {AudioNode[]} */\r\n\t\tlet nodes = [];\r\n\r\n\t\tfor (let i = 0; i < MAX_EFFECT_PER_AUDIO; i++) {\r\n\t\t\tlet effect = this.effects[i];\r\n\t\t\tif (effect) {\r\n\t\t\t\t// Connect from prev into this effect input.\r\n\t\t\t\tfor (let node of nodes) {\r\n\t\t\t\t\tnode.connect(effect.input);\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t// Setup current effect outputs.\r\n\t\t\t\tnodes = effect.outputs;\r\n\t\t\t\t\r\n\t\t\t\t// Disconnect this effect's old output connections.\r\n\t\t\t\t// This may break this effect's internal connections, so call\r\n\t\t\t\t// [setupGraph] on effect to return these to normal.\r\n\t\t\t\tfor (let node of nodes) {\r\n\t\t\t\t\tnode.disconnect();\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (effect.setupGraph) {\r\n\t\t\t\t\teffect.setupGraph();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tfor (let node of nodes) {\r\n\t\t\tnode.connect(this.gain);\r\n\t\t}\r\n\r\n\t\tthis.gain.disconnect();\r\n\r\n\t\tthis.gain.connect(this.destination ? this.destination.getInput() : masterGain);\r\n\t}\r\n}\r\n\r\nclass AudioBus extends AudioControls {\r\n\t/**\r\n\t * @param {number} ptr\r\n\t */\r\n\tconstructor(ptr) {\r\n\t\tsuper();\r\n\r\n\t\tthis.ptr = ptr;\r\n\t}\r\n}\r\n\r\nclass Audio {\r\n\t/**\r\n\t * @param {number} ptr\r\n\t */\r\n\tconstructor(ptr) {\r\n\t\tthis.ptr = ptr;\r\n\t}\r\n\r\n\t/**\r\n\t * @param {AudioBuffer} buffer\r\n\t */\r\n\tsetBuffer(buffer) {\r\n\t\tthis.buffer = buffer;\r\n\t}\r\n}\r\n\r\n/**\r\n * @param {AudioParam} param\r\n * @param {number} value\r\n * @param {number} [fade]\r\n */\r\nfunction effectSetAudioParam(param, value, fade) {\r\n\tvalue = Math.max(param.minValue, Math.min(param.maxValue, value));\r\n\r\n\tif (fade) {\r\n\t\tparam.linearRampToValueAtTime(value, audioctx.currentTime + fade);\r\n\t} else {\r\n\t\tparam.value = value;\r\n\t}\r\n}\r\n\r\n\r\n// === EFFECTS ===\r\n\r\nclass FilterEffect {\r\n\tconstructor() {\r\n\t\tthis.filter = audioctx.createBiquadFilter();\r\n\t}\r\n\r\n\t/**\r\n\t * @param {number} index\r\n\t * @returns {number}\r\n\t */\r\n\tgetParam(index) {\r\n\t\tif (index === PARAM_FILTER_TYPE) {\r\n\t\t\tswitch (this.filter.type) {\r\n\t\t\t\tcase \"lowpass\": return FILTER_TYPE_LOWPASS;\r\n\t\t\t\tcase \"highpass\": return FILTER_TYPE_HIGHPASS;\r\n\t\t\t\tcase \"bandpass\": return FILTER_TYPE_BANDPASS;\r\n\t\t\t}\r\n\t\t} else if (index === PARAM_FILTER_FREQUENCY) {\r\n\t\t\treturn this.filter.frequency.value;\r\n\t\t} else if (index === PARAM_FILTER_RESONANCE) {\r\n\t\t\treturn this.filter.Q.value;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @param {number} index\r\n\t * @param {number} value\r\n\t */\r\n\tcheckParam(index, value) {\r\n\t\tif (index === PARAM_FILTER_TYPE) {\r\n\t\t\tvalue = Math.floor(value);\r\n\t\t\tif (value < FILTER_TYPE_MIN || value > FILTER_TYPE_MAX) {\r\n\t\t\t\treturn \"invalid filter type\";\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * @param {number} index\r\n\t * @param {number} value\r\n\t * @param {number} [fade]\r\n\t */\r\n\tsetParam(index, value, fade) {\r\n\t\tif (index === PARAM_FILTER_TYPE) {\r\n\t\t\tvalue = Math.floor(value);\r\n\t\t\tswitch (value) {\r\n\t\t\t\tcase FILTER_TYPE_LOWPASS:\r\n\t\t\t\t\tthis.filter.type = \"lowpass\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase FILTER_TYPE_HIGHPASS:\r\n\t\t\t\t\tthis.filter.type = \"highpass\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase FILTER_TYPE_BANDPASS:\r\n\t\t\t\t\tthis.filter.type = \"bandpass\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t} else if (index === PARAM_FILTER_FREQUENCY) {\r\n\t\t\teffectSetAudioParam(this.filter.frequency, value, fade);\r\n\t\t} else if (index === PARAM_FILTER_RESONANCE) {\r\n\t\t\teffectSetAudioParam(this.filter.Q, value, fade);\r\n\t\t}\r\n\t}\r\n\r\n\tget type() { return EFFECT_TYPE_FILTER }\r\n\tget input() { return this.filter }\r\n\tget outputs() { return [ this.filter ] }\r\n}\r\n\r\nclass EchoEffect {\r\n\tconstructor() {\r\n\t\tthis.maxDelay = -1;\r\n\t\tthis.node = new GainNode(audioctx);\r\n\t\tthis.decay = new GainNode(audioctx);\r\n\t\tthis.mix = new GainNode(audioctx);\r\n\t}\r\n\r\n\tcreate() {\r\n\t\tthis.delay = new DelayNode(audioctx, {\r\n\t\t\tdelayTime: this.maxDelay,\r\n\t\t\tmaxDelayTime: this.maxDelay,\r\n\t\t});\r\n\t\tthis.delay.connect(this.mix);\r\n\t\tthis.delay.connect(this.decay);\r\n\t\tthis.decay.connect(this.delay);\r\n\t}\r\n\r\n\tsetupGraph() {\r\n\t\tthis.node.connect(this.delay);\r\n\t}\r\n\r\n\t/**\r\n\t * @param {number} index\r\n\t * @returns {number}\r\n\t */\r\n\tgetParam(index) {\r\n\t\tif (index === PARAM_ECHO_DELAY) {\r\n\t\t\treturn this.delay ? this.delay.delayTime.value : this.maxDelay;\r\n\t\t} else if (index === PARAM_ECHO_DECAY) {\r\n\t\t\treturn this.decay.gain.value;\r\n\t\t} else if (index === PARAM_ECHO_VOLUME) {\r\n\t\t\treturn this.mix.gain.value;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @param {number} index\r\n\t * @param {number} value\r\n\t */\r\n\tcheckParam(index, value) {\r\n\t\tif (index === PARAM_ECHO_DELAY) {\r\n\t\t\tif (value < 0.001) {\r\n\t\t\t\treturn \"decay not be less than 1ms\";\r\n\t\t\t}\r\n\t\t} else if (index === PARAM_ECHO_DECAY) {\r\n\t\t\tif (value < 0) {\r\n\t\t\t\treturn \"decay must not be negative\";\r\n\t\t\t}\r\n\t\t\tif (value >= 1) {\r\n\t\t\t\treturn \"decay must less than 1\";\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * @param {number} index\r\n\t * @param {number} value\r\n\t * @param {number} [fade]\r\n\t */\r\n\tsetParam(index, value, fade) {\r\n\t\tif (index === PARAM_ECHO_VOLUME) {\r\n\t\t\teffectSetAudioParam(this.mix.gain, value, fade);\r\n\t\t} else if (index === PARAM_ECHO_DELAY) {\r\n\t\t\tif (this.maxDelay < 0) {\r\n\t\t\t\tthis.maxDelay = value;\r\n\t\t\t}\r\n\t\t\tif (this.delay) {\r\n\t\t\t\teffectSetAudioParam(this.delay.delayTime, value, fade);\r\n\t\t\t}\r\n\t\t} else if (index === PARAM_ECHO_DECAY) {\r\n\t\t\teffectSetAudioParam(this.decay.gain, value, fade);\r\n\t\t}\r\n\t}\r\n\r\n\tfree() {\r\n\t\tthis.delay.disconnect();\r\n\t\tthis.decay.disconnect();\r\n\t\tthis.delay = null;\r\n\t\tthis.decay = null;\r\n\t}\r\n\r\n\tget type() { return EFFECT_TYPE_ECHO }\r\n\tget input() { return this.node }\r\n\tget outputs() { return [ this.node, this.mix ] }\r\n}\r\n\r\nclass ReverbEffect {\r\n\tconstructor() {\r\n\t\tthis.gain = new GainNode(audioctx);\r\n\t\tthis.wetGain = new GainNode(audioctx, { gain: 1 });\r\n\t}\r\n\r\n\tcreate() {\r\n\t\tif (!implulseChurch) {\r\n\t\t\timplulseChurch = generateImpulse(3);\r\n\t\t}\r\n\r\n\t\tthis.convolver = new ConvolverNode(audioctx, {\r\n\t\t\tbuffer: implulseChurch,\r\n\t\t\tdisableNormalization: true,\r\n\t\t});\r\n\r\n\t\tthis.convolver.connect(this.wetGain);\r\n\t}\r\n\r\n\tsetupGraph() {\r\n\t\tthis.gain.connect(this.convolver);\r\n\t}\r\n\r\n\t/**\r\n\t * @param {number} index\r\n\t * @returns {number}\r\n\t */\r\n\tgetParam(index) {\r\n\t\tif (index == PARAM_REVERB_VOLUME) {\r\n\t\t\treturn this.wetGain.gain.value;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @param {number} index\r\n\t * @param {number} value\r\n\t */\r\n\tcheckParam(index, value) {\r\n\t}\r\n\t\r\n\t/**\r\n\t * @param {number} index\r\n\t * @param {number} value\r\n\t * @param {number} [fade]\r\n\t */\r\n\tsetParam(index, value, fade) {\r\n\t\tif (index === PARAM_REVERB_VOLUME) {\r\n\t\t\teffectSetAudioParam(this.wetGain.gain, value, fade);\r\n\t\t}\r\n\t}\r\n\r\n\tget type() { return EFFECT_TYPE_REVERB }\r\n\tget input() { return this.gain }\r\n\tget outputs() { return [ this.gain, this.wetGain ] }\r\n}\r\n\r\n// === VOICE ===\r\n\r\nclass Voice extends AudioControls {\r\n\t/**\r\n\t * @param {number} ptr\r\n\t * @param {Audio} audio\r\n\t * @param {number} audioHandle\r\n\t * @param {AudioControls} [destination]\r\n\t */\r\n\tconstructor(ptr, audio, audioHandle, destination) {\r\n\t\tsuper(destination);\r\n\r\n\t\tthis.ptr = ptr;\r\n\t\tthis.audio = audio;\r\n\t\tthis.audioHandle = audioHandle;\r\n\r\n\t\tthis._initSource();\r\n\r\n\t\t/**\r\n\t\t * 0: not yet started  \r\n\t\t * 1: playing  \r\n\t\t * 2: paused  \r\n\t\t * 3: stopped  \r\n\t\t */\r\n\t\tthis.state = 0;\r\n\t\tthis.time = 0;\r\n\t}\r\n\r\n\t/**\r\n\t * @private\r\n\t */\r\n\t_initSource() {\r\n\t\tthis.source = audioctx.createBufferSource();\r\n\t\tthis.source.buffer = this.audio.buffer;\r\n\t\tthis.source.onended = () => {\r\n\t\t\tthis.state = 3;\r\n\t\t\tthis.time = this.audio.buffer.duration;\r\n\t\t};\r\n\t}\r\n\t\r\n\tplay() {\r\n\t\tif (this.state === 0 || this.state === 2) {\r\n\t\t\tif (this.state === 2) {\r\n\t\t\t\tlet old = this.source;\r\n\r\n\t\t\t\tthis._initSource();\r\n\r\n\t\t\t\tthis.source.loop = old.loop;\r\n\t\t\t\tthis.source.loopStart = old.loopStart;\r\n\t\t\t\tthis.source.playbackRate.value = old.playbackRate.value;\r\n\t\t\t}\r\n\r\n\t\t\tthis.source.connect(this.getInput());\r\n\t\t\tthis.source.start(0, this.time);\r\n\t\t\tthis.startTime = audioctx.currentTime;\r\n\t\t\tthis.state = 1;\r\n\t\t}\r\n\t}\r\n\r\n\tsaveTime() {\r\n\t\tthis.time += (audioctx.currentTime - this.startTime) * this.source.playbackRate.value;\r\n\t\tthis.startTime = audioctx.currentTime;\r\n\t}\r\n\r\n\tpause() {\r\n\t\tif (this.state === 1) {\r\n\t\t\tthis.saveTime();\r\n\t\t\tthis.stopSource();\r\n\t\t\tthis.state = 2;\r\n\t\t}\r\n\t}\r\n \r\n\tstopSource() { \r\n\t\tthis.source.onended = null;\r\n\t\tthis.source.stop();\r\n\t\tthis.source.disconnect();\r\n\t}\r\n\r\n\tupdateGraph() {\r\n\t\tsuper.updateGraph();\r\n\r\n\t\tif (this.source) {\r\n\t\t\tthis.source.disconnect();\r\n\t\t\tthis.source.connect(this.getInput());\r\n\t\t}\r\n\t}\r\n}\r\n\r\n/**\r\n * @type {Map<number, AudioBus>}\r\n */\r\nlet buses = new Map();\r\n\r\n/**\r\n * @type {Map<number, Audio>}\r\n */\r\nlet audios = new Map();\r\n\r\n/**\r\n * @type {Map<number, Voice>}\r\n */\r\nlet voices = new Map();\r\n\r\n/**\r\n * Gets the current Audio in slot 0.\r\n * @returns {AudioBus}\r\n */\r\nfunction getAudioBus() {\r\n\treturn buses.get(wrenGetSlotForeign(0));\r\n}\r\n\r\n/**\r\n * Gets the current Audio in slot 0.\r\n * @returns {Audio}\r\n */\r\nfunction getAudio() {\r\n\treturn audios.get(wrenGetSlotForeign(0));\r\n}\r\n\r\n/**\r\n * Gets the current Voice in slot 0.\r\n * @returns {Voice}\r\n */\r\nfunction getVoice() {\r\n\treturn voices.get(wrenGetSlotForeign(0));\r\n}\r\n\r\nlet canDecodeOGG = true;\r\n\r\n/**\r\n * @param {string} path\r\n * @returns {Promise<AudioBuffer>}\r\n */\r\nasync function loadAudioBuffer(path) {\r\n\tlet buffer = await getAssetAsArrayBuffer(path);\r\n\r\n\tlet ext = Path.getExtension(path);\r\n\tlet isOGG = ext === \"ogg\";\r\n\r\n\ttry {\r\n\t\tif (isOGG && !canDecodeOGG) {\r\n\t\t\treturn await decodeOGG(buffer);\r\n\t\t} else {\r\n\t\t\tif (offlineContext == null) {\r\n\t\t\t\tofflineContext = new OfflineAudioContext(1, 1, 44100);\r\n\t\t\t}\r\n\t\t\r\n\t\t\ttry {\r\n\t\t\t\treturn await offlineContext.decodeAudioData(buffer);\r\n\t\t\t} catch (error) {\r\n\t\t\t\t// Handle OGG failure.\r\n\t\t\t\tif (isOGG) {\r\n\t\t\t\t\tconsole.info(`Failed to natively decode ${path}, switching to JavaScript OGG decoder`, error);\r\n\t\t\t\t\tcanDecodeOGG = false;\r\n\t\t\t\t\treturn await decodeOGG(buffer);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthrow error;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t} catch (error) {\r\n\t\tconsole.error(error);\r\n\t\tthrow Error(`failed to decode audio ${path}`);\r\n\t}\r\n}\r\n\r\n/** @type {Promise<STBVorbis>} */\r\nlet stbvorbisPromise;\r\n\r\n/**\r\n * Decode an OGG using stbvorbis.\r\n * (Only needed on Safari.)\r\n * @param {ArrayBuffer} buffer\r\n * @returns {Promise<AudioBuffer>}\r\n */\r\nasync function decodeOGG(buffer) {\r\n\tif (stbvorbisPromise == null) {\r\n\t\tstbvorbisPromise = new Promise((resolve) => {\r\n\t\t\tlet callback = () => {\r\n\t\t\t\tremoveEventListener(\"stbvorbis\", callback);\r\n\t\t\t\tresolve(self[\"stbvorbis\"]);\r\n\t\t\t}\r\n\t\t\taddEventListener(\"stbvorbis\", callback);\r\n\t\t});\r\n\r\n\t\tlet script = document.createElement(\"script\");\r\n\t\tscript.src = \"stbvorbis.js\";\r\n\t\tdocument.head.append(script);\r\n\t}\r\n\r\n\tlet stbvorbis = await stbvorbisPromise;\r\n\r\n\treturn new Promise((resolve, reject) => {\r\n\t\t/** @type {Float32Array[][]} */\r\n\t\tlet data = [];\r\n\t\tlet sampleRate;\r\n\r\n\t\tstbvorbis.decode(buffer, (result) => {\r\n\t\t\tif (result.error) {\r\n\t\t\t\treject(result.error);\r\n\t\t\t} else if (result.eof) {\r\n\t\t\t\tlet totalLength = data.reduce((acc, chunk) => acc + chunk[0].length, 0);\r\n\t\t\t\tlet channelCount = data[0].length;\r\n\r\n\t\t\t\tlet audio = new AudioBuffer({\r\n\t\t\t\t\tsampleRate: sampleRate,\r\n\t\t\t\t\tnumberOfChannels: channelCount,\r\n\t\t\t\t\tlength: totalLength,\r\n\t\t\t\t});\r\n\t\t\t\t\r\n\t\t\t\tlet writeOffset = 0;\r\n\t\t\t\tfor (let chunk of data) {\r\n\t\t\t\t\tfor (let channelIndex = 0; channelIndex < channelCount; channelIndex++) {\r\n\t\t\t\t\t\taudio.copyToChannel(chunk[channelIndex], channelIndex, writeOffset);\r\n\t\t\t\t\t\twriteOffset += chunk[channelIndex].length;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tresolve(audio);\r\n\t\t\t} else {\r\n\t\t\t\tdata.push(result.data);\r\n\t\t\t\tsampleRate = result.sampleRate;\r\n\t\t\t}\r\n\t\t});\r\n\t});\r\n}\r\n\r\n/**\r\n * @param {AudioControls} audio\r\n */\r\nfunction wrenAudioSetEffect(audio) {\r\n\tfor (let i = 1; i <= 6; i++) {\r\n\t\tif (wrenGetSlotType(i) !== 1) {\r\n\t\t\twrenAbort(\"args must be Nums\");\r\n\t\t\treturn;\r\n\t\t}\r\n\t}\r\n\r\n\tlet index = wrenGetSlotDouble(1);\r\n\tlet type = wrenGetSlotDouble(2);\r\n\r\n\t/** @type {number[]} */\r\n\tlet params = Array(4);\r\n\tparams[0] = wrenGetSlotDouble(3);\r\n\tparams[1] = wrenGetSlotDouble(4);\r\n\tparams[2] = wrenGetSlotDouble(5);\r\n\tparams[3] = wrenGetSlotDouble(6);\r\n\r\n\t// Validate type/index indices.\r\n\tif (index < 0 || index >= MAX_EFFECT_PER_AUDIO) {\r\n\t\twrenAbort(\"invalid effect index\");\r\n\t\treturn;\r\n\t}\r\n\t\r\n\tif (type < EFFECT_TYPE_MIN || type > EFFECT_TYPE_MAX) {\r\n\t\twrenAbort(\"invalid effect type\");\r\n\t\treturn;\r\n\t}\r\n\r\n\t/** @type {Effect} */\r\n\tlet effect;\r\n\tif (type === EFFECT_TYPE_FILTER) {\r\n\t\teffect = new FilterEffect();\r\n\t} else if (type === EFFECT_TYPE_ECHO) {\r\n\t\teffect = new EchoEffect();\r\n\t} else if (type === EFFECT_TYPE_REVERB) {\r\n\t\teffect = new ReverbEffect();\r\n\t} else {\r\n\t\teffect = null;\r\n\t}\r\n\r\n\tif (effect) {\r\n\t\tif (effect.checkParam) {\r\n\t\t\tfor (let i = 0; i < 4; i++) {\r\n\t\t\t\tlet error = effect.checkParam(i, params[i]);\r\n\t\t\t\tif (error) {\r\n\t\t\t\t\tif (effect.free) {\r\n\t\t\t\t\t\teffect.free();\r\n\t\t\t\t\t}\r\n\t\t\t\t\twrenAbort(error);\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tfor (let i = 0; i < 4; i++) {\r\n\t\t\teffect.setParam(i, params[i]);\r\n\t\t}\r\n\t}\r\n\r\n\tif (effect.create) {\r\n\t\teffect.create();\r\n\t}\r\n\r\n\tlet oldEffect = audio.effects[index];\r\n\tif (oldEffect) {\r\n\t\tfor (let output of oldEffect.outputs) {\r\n\t\t\toutput.disconnect();\r\n\t\t}\r\n\t\tif (oldEffect.free) {\r\n\t\t\toldEffect.free();\r\n\t\t}\r\n\t}\r\n\r\n\taudio.effects[index] = effect;\r\n\r\n\taudio.updateGraph();\r\n}\r\n\r\n/**\r\n * @param {AudioControls} audio\r\n */\r\nfunction wrenAudioGetEffect(audio) {\r\n\tif (wrenGetSlotType(1) !== 1) {\r\n\t\twrenAbort(\"index must be a Num\");\r\n\t\treturn;\r\n\t}\r\n\t\r\n\tlet index = Math.trunc(wrenGetSlotDouble(1));\r\n\tif (index < 0 || index >= MAX_EFFECT_PER_AUDIO) {\r\n\t\twrenAbort(\"invalid effect index\");\r\n\t\treturn;\r\n\t}\r\n\r\n\twrenSetSlotDouble(0, audio.getEffectType(index));\r\n}\r\n\r\n/**\r\n * @param {AudioControls} audio\r\n */\r\nfunction wrenAudioGetParam(audio) {\r\n\tfor (let i = 1; i <= 3; i++) {\r\n\t\tif (wrenGetSlotType(i) !== 1) {\r\n\t\t\twrenAbort(\"args must be Nums\");\r\n\t\t\treturn;\r\n\t\t}\r\n\t}\r\n\r\n\tlet index = Math.trunc(wrenGetSlotDouble(1));\r\n\tlet type = Math.trunc(wrenGetSlotDouble(2));\r\n\tlet paramIndex = Math.trunc(wrenGetSlotDouble(3));\r\n\r\n\tif (index < 0 || index >= MAX_EFFECT_PER_AUDIO) {\r\n\t\twrenAbort(\"invalid effect index\");\r\n\t\treturn;\r\n\t}\r\n\r\n\tif (type < EFFECT_TYPE_MIN || type > EFFECT_TYPE_MAX) {\r\n\t\twrenAbort(\"invalid effect type\");\r\n\t\treturn;\r\n\t}\r\n\r\n\tif (audio.getEffectType(index) != type) {\r\n\t\twrenAbort(`effect at ${index} is not a ${EFFECT_TYPE_NAMES[type]}`);\r\n\t\treturn;\r\n\t}\r\n\r\n\tif (paramIndex < 0 || paramIndex >= 4) {\r\n\t\twrenAbort(\"invalid param index\");\r\n\t\treturn;\r\n\t}\r\n\r\n\twrenSetSlotDouble(0, audio.effects[index].getParam(paramIndex) ?? 0);\r\n}\r\n\r\n/**\r\n * @param {AudioControls} audio\r\n */\r\nfunction wrenAudioSetParam(audio) {\r\n\tfor (let i = 1; i <= 5; i++) {\r\n\t\tif (wrenGetSlotType(i) !== 1) {\r\n\t\t\twrenAbort(\"args must be Nums\");\r\n\t\t\treturn;\r\n\t\t}\r\n\t}\r\n\r\n\tlet index = Math.trunc(wrenGetSlotDouble(1));\r\n\tlet type = Math.trunc(wrenGetSlotDouble(2));\r\n\tlet paramIndex = Math.trunc(wrenGetSlotDouble(3));\r\n\tlet paramValue = wrenGetSlotDouble(4);\r\n\tlet fadeTime = wrenGetSlotDouble(5);\r\n\r\n\t// Validate type/index indices.\r\n\tif (index < 0 || index >= MAX_EFFECT_PER_AUDIO) {\r\n\t\twrenAbort(\"invalid effect index\");\r\n\t\treturn;\r\n\t}\r\n\r\n\tif (type < EFFECT_TYPE_MIN || type > EFFECT_TYPE_MAX) {\r\n\t\twrenAbort(\"invalid effect type\");\r\n\t\treturn;\r\n\t}\r\n\r\n\tif (audio.getEffectType(index) != type) {\r\n\t\twrenAbort(`effect at ${index} is not a ${EFFECT_TYPE_NAMES[type]}`);\r\n\t\treturn;\r\n\t}\r\n\r\n\tif (paramIndex < 0 || paramIndex >= 4) {\r\n\t\twrenAbort(\"invalid param index\");\r\n\t\treturn;\r\n\t}\r\n\t\r\n\tif (fadeTime < 0) {\r\n\t\twrenAbort(\"fade time must be positive\");\r\n\t\treturn;\r\n\t}\r\n\r\n\tlet effect = audio.effects[index];\r\n\r\n\tif (effect.checkParam) {\r\n\t\tlet error = effect.checkParam(paramIndex, paramValue);\r\n\t\tif (error) {\r\n\t\t\twrenAbort(error);\r\n\t\t\treturn;\r\n\t\t}\r\n\t}\r\n\r\n\teffect.setParam(paramIndex, paramValue, fadeTime);\r\n}\r\n\r\n/**\r\n * @param {GainNode} gainNode\r\n */\r\nfunction wrenFadeVolume(gainNode) {\r\n\tfor (let i = 1; i <= 2; i++) {\r\n\t\tif (wrenGetSlotType(i) !== 1) {\r\n\t\t\twrenAbort(\"volume and fade must be Nums\");\r\n\t\t\treturn;\r\n\t\t}\r\n\t}\r\n\r\n\tlet volume = wrenGetSlotDouble(1);\r\n\tlet fade = wrenGetSlotDouble(2);\r\n\r\n\tfadeVolume(gainNode, volume, fade);\r\n}\r\n\r\n\r\naddForeignClass(\"sock\", \"AudioBus\", [\r\n\t() => {\r\n\t\tlet ptr = wrenSetSlotNewForeign(0, 0, 0);\r\n\r\n\t\tlet bus = new AudioBus(ptr);\r\n\r\n\t\tbuses.set(ptr, bus);\r\n\t},\r\n\t(ptr) => {\r\n\t\tbuses.delete(ptr);\r\n\t},\r\n], {\r\n\t\"volume\"() {\r\n\t\tlet bus = getAudioBus();\r\n\t\twrenSetSlotDouble(0, bus.gain.gain.value);\r\n\t},\r\n\t\"fadeVolume(_,_)\"() {\r\n\t\twrenFadeVolume(getAudioBus().gain);\r\n\t},\r\n\t\"setEffect_(_,_,_,_,_,_)\"() {\r\n\t\twrenAudioSetEffect(getAudioBus());\r\n\t},\r\n\t\"getEffect_(_)\"() {\r\n\t\twrenAudioGetEffect(getAudioBus());\r\n\t},\r\n\t\"getParam_(_,_,_)\"() {\r\n\t\twrenAudioGetParam(getAudioBus());\r\n\t},\r\n\t\"setParam_(_,_,_,_,_)\"() {\r\n\t\twrenAudioSetParam(getAudioBus());\r\n\t},\r\n});\r\n\r\naddForeignClass(\"sock\", \"Audio\", [\r\n\t() => {\r\n\t\tlet ptr = wrenSetSlotNewForeign(0, 0, 0);\r\n\r\n\t\tlet audio = new Audio(ptr);\r\n\r\n\t\taudios.set(ptr, audio);\r\n\t},\r\n\t(ptr) => {\r\n\t\taudios.delete(ptr);\r\n\t},\r\n], {\r\n\t\"duration\"() {\r\n\t\tlet audio = getAudio();\r\n\t\twrenSetSlotDouble(0, audio.buffer ? audio.buffer.duration : 0);\r\n\t},\r\n\t\"voice()\"() {\r\n\t\tlet audioHandle = wrenGetSlotHandle(0);\r\n\r\n\t\tlet audio = getAudio();\r\n\t\tif (!audio.buffer) {\r\n\t\t\twrenAbort(\"audio not loaded\");\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\twrenEnsureSlots(2);\r\n\t\twrenSetSlotHandle(1, handle_Voice);\r\n\t\tlet ptr = wrenSetSlotNewForeign(0, 1, 0);\r\n\r\n\t\tlet voice = new Voice(ptr, audio, audioHandle);\r\n\t\tvoices.set(ptr, voice);\r\n\t},\r\n\t\"voice(_)\"() {\r\n\t\tlet audioHandle = wrenGetSlotHandle(0);\r\n\r\n\t\tlet audio = getAudio();\r\n\t\tif (!audio.buffer) {\r\n\t\t\twrenAbort(\"audio not loaded\");\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t// Check slot 1 is an AudioBus.\r\n\t\twrenSetSlotHandle(0, handle_AudioBus);\r\n\t\tif (!wrenGetSlotIsInstanceOf(1, 0)) {\r\n\t\t\twrenAbort(\"bus must be an AudioBus\");\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tlet bus = buses.get(wrenGetSlotForeign(1));\r\n\r\n\t\twrenSetSlotHandle(1, handle_Voice);\r\n\t\tlet ptr = wrenSetSlotNewForeign(0, 1, 0);\r\n\r\n\t\tlet voice = new Voice(ptr, audio, audioHandle, bus);\r\n\t\tvoices.set(ptr, voice);\r\n\t},\r\n}, {\r\n\t\"load_(_,_)\"() {\r\n\t\tloadAsset(async (path) => {\r\n\t\t\tlet buffer = await loadAudioBuffer(path);\r\n\r\n\t\t\twrenEnsureSlots(1);\r\n\t\t\twrenSetSlotHandle(0, handle_Audio);\r\n\t\t\tlet ptr = wrenSetSlotNewForeign(0, 0, 0);\r\n\r\n\t\t\tlet audio = new Audio(ptr);\r\n\t\t\taudios.set(ptr, audio);\r\n\r\n\t\t\taudio.setBuffer(buffer);\r\n\r\n\t\t\treturn new WrenHandle(wrenGetSlotHandle(0));\r\n\t\t});\r\n\t},\r\n\t\"volume\"() {\r\n\t\twrenSetSlotDouble(0, masterGain.gain.value / BASE_MASTER_GAIN);\r\n\t},\r\n\t\"fadeVolume(_,_)\"() {\r\n\t\tfor (let i = 1; i <= 2; i++) {\r\n\t\t\tif (wrenGetSlotType(i) !== 1) {\r\n\t\t\t\twrenAbort(\"args must be Nums\");\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tlet volume = wrenGetSlotDouble(1) * BASE_MASTER_GAIN;\r\n\t\tlet fade = wrenGetSlotDouble(2);\r\n\r\n\t\tfadeVolume(masterGain, volume, fade);\r\n\t},\r\n});\r\n\r\naddForeignClass(\"sock\", \"Voice\", [\r\n\t() => {\r\n\t\t// abortFiber(\"voice should not be constructed directly\");\r\n\t},\r\n\t(ptr) => {\r\n\t\tlet voice = voices.get(ptr);\r\n\t\twrenReleaseHandle(voice.audioHandle);\r\n\t\tvoices.delete(ptr);\r\n\t},\r\n], {\r\n\t\"play()\"() {\r\n\t\tlet voice = getVoice();\r\n\t\t\r\n\t\tvoice.play();\r\n\t},\r\n\t\"pause()\"() {\r\n\t\tlet voice = getVoice();\r\n\r\n\t\tvoice.pause();\r\n\t},\r\n\t\"isPaused\"() {\r\n\t\tlet voice = getVoice();\r\n\t\twrenSetSlotBool(0, voice.state !== 1);\r\n\t},\r\n\t\"stop()\"() {\r\n\t\tlet voice = getVoice();\r\n\t\tvoice.stopSource();\r\n\t\tvoice.state = 3;\r\n\t},\r\n\t\"time\"() {\r\n\t\tlet voice = getVoice();\r\n\t\tif (voice.state === 1) {\r\n\t\t\tvoice.saveTime();\r\n\t\t}\r\n\t\twrenSetSlotDouble(0, voice.time);\r\n\t},\r\n\t\"time=(_)\"() {\r\n\t\tif (wrenGetSlotType(1) !== 1) {\r\n\t\t\twrenAbort(\"time must be Num\");\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tlet time = wrenGetSlotDouble(1);\r\n\r\n\t\tlet voice = getVoice();\r\n\t\tvoice.pause();\r\n\t\tvoice.time = time;\r\n\t\tvoice.play();\r\n\t},\r\n\t\"volume\"() {\r\n\t\tlet voice = getVoice();\r\n\t\twrenSetSlotDouble(0, voice.gain.gain.value);\r\n\t},\r\n\t\"fadeVolume(_,_)\"() {\r\n\t\twrenFadeVolume(getVoice().gain);\r\n\t},\r\n\t\"rate\"() {\r\n\t\tlet voice = getVoice();\r\n\t\twrenSetSlotDouble(0, voice.source.playbackRate.value);\r\n\t},\r\n\t\"fadeRate(_,_)\"() {\r\n\t\tfor (let i = 1; i <= 2; i++) {\r\n\t\t\tif (wrenGetSlotType(i) !== 1) {\r\n\t\t\t\twrenAbort(\"args must be Nums\");\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tlet rate = wrenGetSlotDouble(1);\r\n\t\tlet fade = wrenGetSlotDouble(2);\r\n\r\n\t\tlet voice = getVoice();\r\n\r\n\t\teffectSetAudioParam(voice.source.playbackRate, rate, fade);\r\n\t},\r\n\t\"loop\"() {\r\n\t\tlet voice = getVoice();\r\n\t\twrenSetSlotBool(0, voice.source.loop);\r\n\t},\r\n\t\"loop=(_)\"() {\r\n\t\tif (wrenGetSlotType(1) !== 0) {\r\n\t\t\twrenAbort(\"loop must be a Bool\");\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tlet voice = getVoice();\r\n\t\tlet loop = wrenGetSlotBool(1);\r\n\r\n\t\tvoice.source.loop = loop;\r\n\t\t\r\n\t\t// Ensure we have a loop end point set (needed for loop start).\r\n\t\tif (loop) {\r\n\t\t\tvoice.source.loopEnd = voice.audio.buffer.duration;\r\n\t\t}\r\n\t},\r\n\t\"loopStart\"() {\r\n\t\tlet voice = getVoice();\r\n\t\twrenSetSlotDouble(0, voice.source.loopStart);\r\n\t},\r\n\t\"loopStart=(_)\"() {\r\n\t\tif (wrenGetSlotType(1) !== 1) {\r\n\t\t\twrenAbort(\"loopStart must be a Num\");\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tlet voice = getVoice();\r\n\t\tlet loopStart = wrenGetSlotDouble(1);\r\n\r\n\t\tvoice.source.loopStart = loopStart;\r\n\t},\r\n\t\"setEffect_(_,_,_,_,_,_)\"() {\r\n\t\twrenAudioSetEffect(getVoice());\r\n\t},\r\n\t\"getEffect_(_)\"() {\r\n\t\twrenAudioGetEffect(getVoice());\r\n\t},\r\n\t\"getParam_(_,_,_)\"() {\r\n\t\twrenAudioGetParam(getVoice());\r\n\t},\r\n\t\"setParam_(_,_,_,_,_)\"() {\r\n\t\twrenAudioSetParam(getVoice());\r\n\t},\r\n});\r\n\r\n/**\r\n * @typedef {object} Effect\r\n * @property {number} type\r\n * @property {AudioNode} input\r\n * @property {AudioNode[]} outputs if null, then \r\n * @property {() => void} [create]\r\n * @property {() => void} [setupGraph]\r\n * @property {(index: number) => number} getParam\r\n * @property {(index: number, value: number, fade?: number) => void} setParam\r\n * @property {(index: number, value: number) => (string|null|undefined|void)} [checkParam]\r\n * @property {() => void} [free]\r\n */\r\n\r\n/**\r\n * @typedef {object} STBVorbis\r\n * @property {(buffer: ArrayBuffer|Uint8Array, callback: (event: { data: Float32Array[], sampleRate: number, eof: boolean, error: string | null }) => void) => void} decode\r\n */\r\n","import { getAssetAsArrayBuffer } from \"../asset-database.js\";\r\nimport { addClassForeignStaticMethods } from \"../foreign.js\";\r\nimport { Module, wrenGetSlotHandle } from \"../vm.js\";\r\nimport { loadAsset } from \"./asset.js\";\r\nimport { WrenHandle } from \"./promise.js\";\r\n\r\naddClassForeignStaticMethods(\"sock\", \"Buffer\", {\r\n\t\"load_(_,_)\"() {\r\n\t\tloadAsset(async (path) => {\r\n\t\t\tlet buffer = await getAssetAsArrayBuffer(path);\r\n\r\n\t\t\t// Copy ArrayBuffer to C.\r\n\t\t\tlet len = buffer.byteLength;\r\n\r\n\t\t\tlet ptr = 0;\r\n\t\t\tif (len > 0) {\r\n\t\t\t\tptr = Module._malloc(len);\r\n\t\t\t\tif (!ptr) throw `could not allocate ${len} bytes`;\r\n\r\n\t\t\t\tModule.HEAPU8.set(new Uint8Array(buffer), ptr);\r\n\t\t\t}\r\n\t\r\n\t\t\t// Load bytes in C memory into new Buffer.\r\n\t\t\tModule.ccall(\"sock_new_buffer\", null, [ \"number\", \"number\" ], [ ptr, len ]);\r\n\r\n\t\t\treturn new WrenHandle(wrenGetSlotHandle(0));\r\n\t\t});\r\n\t}\r\n});\r\n","import { addClassForeignStaticMethods } from \"../foreign.js\";\r\nimport { wrenAbort, wrenEnsureSlots, wrenGetSlotString, wrenGetSlotType, wrenInsertInList, wrenSetSlotBool, wrenSetSlotNewList, wrenSetSlotNull, wrenSetSlotString } from \"../vm.js\";\r\n\r\n/**\r\n * @type {string}\r\n */\r\nlet storageID = null;\r\n\r\n/**\r\n * @param {number} slot\r\n */\r\nfunction validateKey(slot) {\r\n\tif (storageID == null) {\r\n\t\twrenAbort(\"id must be set before using other Storage methods\");\r\n\t\treturn null;\r\n\t}\r\n\r\n\tif (wrenGetSlotType(slot) !== 6) {\r\n\t\twrenAbort(\"key must be a string\");\r\n\t\treturn null;\r\n\t}\r\n\r\n\tlet key = wrenGetSlotString(slot);\r\n\tif (!validateKeyIdentifier(key)) {\r\n\t\twrenAbort(\"key may only contain letters, numbers, underscores and dashes\");\r\n\t\treturn;\r\n\t}\r\n\r\n\treturn storageID + \"/\" + key;\r\n}\r\n\r\n/**\r\n * @param {string} s\r\n */\r\nfunction validateKeyIdentifier(s) {\r\n\treturn /^[a-zA-Z0-9_\\-]+$/.test(s);\r\n}\r\n\r\n\r\naddClassForeignStaticMethods(\"sock\", \"Storage\", {\r\n\t\"id\"() {\r\n\t\tif (storageID) {\r\n\t\t\twrenSetSlotString(0, storageID);\r\n\t\t} else {\r\n\t\t\twrenSetSlotNull(0);\r\n\t\t}\r\n\t},\r\n\t\"id=(_)\"() {\r\n\t\tif (wrenGetSlotType(1) !== 6) {\r\n\t\t\twrenAbort(\"id must be a String\");\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tlet s = wrenGetSlotString(1);\r\n\r\n\t\tif (validateKeyIdentifier(s)) {\r\n\t\t\tstorageID = s;\r\n\t\t} else {\r\n\t\t\twrenAbort(\"id may only contain letters, numbers, underscores and dashes\");\r\n\t\t}\r\n\t},\r\n\t\"contains(_)\"() {\r\n\t\tlet key = validateKey(1);\r\n\t\tif (key) {\r\n\t\t\twrenSetSlotBool(0, localStorage.getItem(key) !== null);\r\n\t\t}\r\n\t},\r\n\t\"load_(_)\"() {\r\n\t\tlet key = validateKey(1);\r\n\t\tif (key) {\r\n\t\t\tlet item = localStorage.getItem(key);\r\n\t\r\n\t\t\tif (item == null) {\r\n\t\t\t\twrenSetSlotNull(0);\r\n\t\t\t} else {\r\n\t\t\t\twrenSetSlotString(0, item);\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\t\"save_(_,_)\"() {\r\n\t\tif (wrenGetSlotType(2) !== 6) {\r\n\t\t\twrenAbort(\"value must be a String\");\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t\r\n\t\tlet key = validateKey(1);\r\n\t\tif (key) {\r\n\t\t\tlet value = wrenGetSlotString(2);\r\n\t\r\n\t\t\tlocalStorage.setItem(key, value);\r\n\t\t}\r\n\t},\r\n\t\"delete(_)\"() {\r\n\t\tlet key = validateKey(1);\r\n\t\tif (key) {\r\n\t\t\tlocalStorage.removeItem(key);\r\n\t\t\twrenSetSlotNull(0);\r\n\t\t}\r\n\t},\r\n// \t\"keys\"() {\r\n// \t\twrenEnsureSlots(2);\r\n// \t\twrenSetSlotNewList(0);\r\n// \r\n// \t\tfor (let i = 0; i < localStorage.length; i++) {\r\n// \t\t\tlet key = localStorage.key(i);\r\n// \t\t\tif (key.startsWith(keyPrefix)) {\r\n// \t\t\t\twrenSetSlotString(1, key.slice(keyPrefix.length));\r\n// \t\t\t\twrenInsertInList(0, -1, 1);\r\n// \t\t\t}\r\n// \t\t}\r\n// \t}\r\n});\r\n","import { canvas } from \"./canvas.js\";\r\nimport { createElement } from \"./html.js\";\r\n\r\n/**\r\n * Total window/screen width.\r\n */\r\nexport let screenWidth = 0;\r\n\r\n/**\r\n * Total window/screen height.\r\n */\r\nexport let screenHeight = 0;\r\n\r\n/**\r\n * The game's internal resolution width, may be smaller than screen width.\r\n */\r\nexport let internalResolutionWidth = 0;\r\n\r\n/**\r\n * The game's internal resolution height, may be smaller than screen height.\r\n */\r\nexport let internalResolutionHeight = 0;\r\n\r\n/**\r\n * Left offset of viewport, in logical pixels.  \r\n * May be non-zero due to fixed resolution.\r\n */\r\nexport let viewportOffsetX = 0;\r\n\r\n/**\r\n * Top offset of viewport, in logical pixels.  \r\n * May be non-zero due to fixed resolution.\r\n */\r\nexport let viewportOffsetY = 0;\r\n\r\n/**\r\n * Width of viewport in screen pixels, in logical pixels.  \r\n * May be smaller than screen size due to fixed resolution.  \r\n * May be larger than internal resolution to fixed resolution scaling.\r\n */\r\nexport let viewportWidth = 1;\r\n\r\n/**\r\n * Height of viewport in screen pixels, in logical pixels.  \r\n * May be smaller than screen size due to fixed resolution.  \r\n * May be larger than internal resolution to fixed resolution scaling.\r\n */\r\nexport let viewportHeight = 1;\r\n\r\n/**\r\n * Scale factor of viewport (0, Infinite), using logical pixels.\r\n */\r\nexport let viewportScale = 1;\r\n\r\n/**\r\n * Used by client to configure internal resolution and computed layout.\r\n */\r\nexport let layoutOptions = {\r\n\tpixelScaling: false,\r\n\t/**\r\n\t * @type {null|[number, number]}\r\n\t */\r\n\tresolution: null,\r\n\tmaxScale: Infinity,\r\n};\r\n\r\nlet layoutContainer = createElement(\"div\", { style: \"position: fixed; pointer-events: none;\" });\r\nlet layoutContainerRefCount = 0;\r\n\r\nexport function useLayoutContainer() {\r\n\tif (layoutContainerRefCount === 0) {\r\n\t\tdocument.body.append(layoutContainer);\r\n\t}\r\n\r\n\tlayoutContainerRefCount++\r\n\r\n\treturn layoutContainer;\r\n}\r\n\r\nexport function releaseLayoutContainer() {\r\n\tlayoutContainerRefCount--;\r\n\r\n\tif (layoutContainerRefCount === 0) {\r\n\t\tlayoutContainer.remove();\r\n\t}\r\n}\r\n\r\n\r\nlet isLayoutQueued = false;\r\n\r\nexport function queueLayout() {\r\n\tisLayoutQueued = true;\r\n}\r\n\r\nexport function finalizeLayout() {\r\n\tif (isLayoutQueued) {\r\n\t\tisLayoutQueued = false;\r\n\t\tredoLayout();\r\n\t\treturn true;\r\n\t}\r\n}\r\n\r\nexport function redoLayout() {\r\n\tscreenWidth = innerWidth;\r\n\tscreenHeight = innerHeight;\r\n\r\n\tlet pixeRatio = devicePixelRatio;\r\n\tcanvas.width = screenWidth * pixeRatio;\r\n\tcanvas.height = screenHeight * pixeRatio;\r\n\r\n\tcanvas.style.width = screenWidth + \"px\";\r\n\tcanvas.style.height = screenHeight + \"px\";\r\n\t\r\n\tlet resx, resy, scale;\r\n\tlet res = layoutOptions.resolution;\r\n\tif (res) {\r\n\t\tresx = res[0];\r\n\t\tresy = res[1];\r\n\r\n\t\t// Determine scale factor.\r\n\t\tlet scaleX = screenWidth / resx;\r\n\t\tlet scaleY = screenHeight / resy;\r\n\r\n\t\tscale = Math.min(scaleX, scaleY, layoutOptions.maxScale);\r\n\r\n\t\tif (layoutOptions.pixelScaling && scale > 1) {\r\n\t\t\tscale = Math.floor(scale);\r\n\t\t}\r\n\t} else {\r\n\t\tresx = screenWidth;\r\n\t\tresy = screenHeight;\r\n\t\tscale = 1;\r\n\t}\r\n\r\n\tinternalResolutionWidth = resx;\r\n\tinternalResolutionHeight = resy;\r\n\tviewportScale = scale;\r\n\t\r\n\tviewportWidth = Math.floor(scale * resx);\r\n\tviewportHeight = Math.floor(scale * resy);\r\n\tviewportOffsetX = Math.floor((screenWidth - viewportWidth) / 2);\r\n\tviewportOffsetY = Math.floor((screenHeight - viewportHeight) / 2);\r\n\r\n\tlet style = layoutContainer.style;\r\n\tstyle.left = viewportOffsetX + \"px\"\r\n\tstyle.top = viewportOffsetY + \"px\";\r\n\tstyle.width = viewportWidth + \"px\";\r\n\tstyle.height = viewportHeight + \"px\";\r\n}\r\n\r\naddEventListener(\"resize\", () => {\r\n\tqueueLayout();\r\n});\r\n","import { addClassForeignStaticMethods, addForeignMethod } from \"../foreign.js\";\r\nimport { internalResolutionHeight, internalResolutionWidth } from \"../layout.js\";\r\nimport { HEAP, wrenAbort, wrenGetSlotDouble, wrenGetSlotType, wren_sock_get_transform } from \"../vm.js\";\r\n\r\n/**\r\n * @type {Float32Array|null}\r\n */\r\nlet cameraMatrix = null;\r\n\r\n/**\r\n * Returns the 3x3 camera matrix.\r\n */\r\nexport function getCameraMatrix() {\r\n\tif (!cameraMatrix) {\r\n\t\tsetCameraOrigin(0, 0);\r\n\t}\r\n\treturn cameraMatrix;\r\n}\r\n\r\n/**\r\n * @returns {Float32Array}\r\n */\r\nexport function saveCameraMatrix() {\r\n\treturn getCameraMatrix().slice();\r\n}\r\n\r\n/**\r\n * @param {Float32Array} camera \r\n */\r\nexport function loadCameraMatrix(camera) {\r\n\tgetCameraMatrix().set(camera);\r\n}\r\n\r\n/**\r\n * @param {number} x\r\n * @param {number} y\r\n * @param {Float32Array|null} [tf] a 3x2 transform, will not be modified\r\n */\r\nexport function setCameraOrigin(x, y, tf) {\r\n\tif (!cameraMatrix) {\r\n\t\tcameraMatrix = new Float32Array(9);\r\n\t}\r\n\r\n\tlet sx =  2 / internalResolutionWidth;\r\n\tlet sy = -2 / internalResolutionHeight;\r\n\r\n\tif (tf) {\r\n\t\tcameraMatrix[0] = sx * tf[0];\r\n\t\tcameraMatrix[1] = sy * tf[1];\r\n\t\tcameraMatrix[2] = 0;\r\n\t\t\r\n\t\tcameraMatrix[3] = sx * tf[2];\r\n\t\tcameraMatrix[4] = sy * tf[3];\r\n\t\tcameraMatrix[5] = 0;\r\n\t\r\n\t\tcameraMatrix[6] = x * sx - 1 + sx * tf[4];\r\n\t\tcameraMatrix[7] = y * sy + 1 + sy * tf[5];\r\n\t\tcameraMatrix[8] = 1;\r\n\t} else {\r\n\t\tcameraMatrix[0] = sx;\r\n\t\tcameraMatrix[1] = 0;\r\n\t\tcameraMatrix[2] = 0;\r\n\t\t\r\n\t\tcameraMatrix[3] = 0;\r\n\t\tcameraMatrix[4] = sy;\r\n\t\tcameraMatrix[5] = 0;\r\n\t\r\n\t\tcameraMatrix[6] = x * sx - 1;\r\n\t\tcameraMatrix[7] = y * sy + 1;\r\n\t\tcameraMatrix[8] = 1;\r\n\t}\r\n}\r\n\r\n\r\n/**\r\n * @param {number} x\r\n * @param {number} y\r\n * @param {Float32Array|null} [tf] a 3x2 transform, will not be modified\r\n */\r\nexport function cameraLookAt(x, y, tf) {\r\n\tif (!cameraMatrix) {\r\n\t\tcameraMatrix = new Float32Array(9);\r\n\t}\r\n\r\n\tlet sx =  2 / internalResolutionWidth;\r\n\tlet sy = -2 / internalResolutionHeight;\r\n\r\n\t// If dimensions are not even, need shift origin by half a pixel.\r\n\tlet dx = internalResolutionWidth  % 2 == 0 ? 0 : 0.5;\r\n\tlet dy = internalResolutionHeight % 2 == 0 ? 0 : 0.5;\r\n\r\n\tif (tf) {\r\n\t\tcameraMatrix[0] = sx * tf[0];\r\n\t\tcameraMatrix[1] = sy * tf[1];\r\n\t\tcameraMatrix[2] = 0;\r\n\t\t\r\n\t\tcameraMatrix[3] = sx * tf[2];\r\n\t\tcameraMatrix[4] = sy * tf[3];\r\n\t\tcameraMatrix[5] = 0;\r\n\r\n\t\tcameraMatrix[6] = sx * (tf[4] - tf[0] * x - tf[2] * y + dx);\r\n\t\tcameraMatrix[7] = sy * (tf[5] - tf[1] * x - tf[3] * y + dy);\r\n\t\tcameraMatrix[8] = 1;\r\n\t} else {\r\n\t\tcameraMatrix[0] = sx;\r\n\t\tcameraMatrix[1] = 0;\r\n\t\tcameraMatrix[2] = 0;\r\n\t\t\r\n\t\tcameraMatrix[3] = 0;\r\n\t\tcameraMatrix[4] = sy;\r\n\t\tcameraMatrix[5] = 0;\r\n\r\n\t\tcameraMatrix[6] = (dx - x) * sx;\r\n\t\tcameraMatrix[7] = (dy - y) * sy;\r\n\t\tcameraMatrix[8] = 1;\r\n\t}\r\n}\r\n\r\n\r\n// Wren -> JS\r\n\r\naddClassForeignStaticMethods(\"sock\", \"Camera\", {\r\n\t\"setOrigin(_,_,_)\"() {\r\n\t\twrenSetCamera(setCameraOrigin);\r\n\t},\r\n\t\"lookAt(_,_,_)\"() {\r\n\t\twrenSetCamera(cameraLookAt);\r\n\t},\r\n\t\"reset()\"() {\r\n\t\tsetCameraOrigin(0, 0);\r\n\t},\r\n// \t\"project(_,_)\"() {\r\n// \t\tfor (let i = 1; i <= 2; i++) {\r\n// \t\t\tif (wrenGetSlotType(i) !== 1) {\r\n// \t\t\t\twrenAbort(\"x/y must be Num\");\r\n// \t\t\t\treturn;\r\n// \t\t\t}\r\n// \t\t}\r\n// \t\r\n// \t\tlet x = wrenGetSlotDouble(1);\r\n// \t\tlet y = wrenGetSlotDouble(2);\r\n// \t\tlet m = getCameraMatrix();\r\n// \r\n// \t\tlet px = m[0] * x + m[3] * y + m[6];\r\n// \t\tlet py = m[1] * x + m[4] * y + m[7];\r\n// \t\t// let pw = m[2] * x + m[5] * y + m[8];\r\n// \t}\r\n});\r\n\r\n/**\r\n * @param {(x: number, y: number, t: Float32Array | null) => void} setter \r\n */\r\nfunction wrenSetCamera(setter) {\r\n\tfor (let i = 1; i <= 2; i++) {\r\n\t\tif (wrenGetSlotType(i) !== 1) {\r\n\t\t\twrenAbort(\"x/y must be Num\");\r\n\t\t\treturn;\r\n\t\t}\r\n\t}\r\n\r\n\tlet x = wrenGetSlotDouble(1);\r\n\tlet y = wrenGetSlotDouble(2);\r\n\tlet tf = null;\r\n\tif (wrenGetSlotType(3) !== 5) {\r\n\t\tlet tp = wren_sock_get_transform(3);\r\n\t\tif (!tp) return;\r\n\t\ttf = new Float32Array(HEAP(), tp, 6);\r\n\t}\r\n\r\n\tif (!tf) {\r\n\t\tx = Math.floor(x);\r\n\t\ty = Math.floor(y);\r\n\t}\r\n\r\n\tsetter(x, y, tf);\r\n}\r\n","import { canvas } from \"../canvas.js\";\r\nimport { sockJsGlobal } from \"../globals.js\";\r\n\r\n/**\r\n * The main WebGL 1.0 context.\r\n */\r\nexport let gl = canvas.getContext(\"webgl\", {\r\n\tantialias: false,\r\n});\r\n\r\ngl.enable(gl.BLEND);\r\ngl.blendFuncSeparate(gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA, gl.ONE, gl.ONE_MINUS_SRC_ALPHA);\r\n\r\nsockJsGlobal.gl = gl;\r\n","import { wrenAbort, wrenGetSlotString, wrenGetSlotType, wrenSetSlotString } from \"../vm.js\";\r\nimport { gl } from \"./gl.js\";\r\n\r\n\r\n/** @type {Record<string, number>} */\r\nexport const GL_FILTER_MAP = {\r\n\tlinear: gl.LINEAR,\r\n\tnearest: gl.NEAREST,\r\n};\r\n\r\n/** @type {Record<string, number>} */\r\nexport const GL_WRAP_MAP = {\r\n\tclamp: gl.CLAMP_TO_EDGE,\r\n\trepeat: gl.REPEAT,\r\n\tmirror: gl.MIRRORED_REPEAT,\r\n};\r\n\r\n/**\r\n * @param {number} slot\r\n * @returns {number|null}\r\n */\r\nexport function wrenGlFilterStringToNumber(slot) {\r\n\tif (wrenGetSlotType(slot) !== 6) {\r\n\t\twrenAbort(\"filter must be a String\");\r\n\t\treturn;\r\n\t}\r\n\r\n\tlet name = wrenGetSlotString(slot);\r\n\r\n\tif (GL_FILTER_MAP.hasOwnProperty(name)) {\r\n\t\treturn GL_FILTER_MAP[name];\r\n\t} else {\r\n\t\twrenAbort(`invalid filter \"${name}\"`);\r\n\t\treturn null;\r\n\t}\r\n}\r\n\r\n/**\r\n * @param {number} slot\r\n * @returns {number|null}\r\n */\r\nexport function wrenGlWrapModeStringToNumber(slot) {\r\n\tif (wrenGetSlotType(slot) !== 6) {\r\n\t\twrenAbort(\"wrap mode must be a String\");\r\n\t\treturn;\r\n\t}\r\n\r\n\tlet name = wrenGetSlotString(slot);\r\n\r\n\tif (GL_WRAP_MAP.hasOwnProperty(name)) {\r\n\t\treturn GL_WRAP_MAP[name];\r\n\t} else {\r\n\t\twrenAbort(`invalid wrap mode \"${name}\"`);\r\n\t\treturn null;\r\n\t}\r\n}\r\n\r\n/**\r\n * @param {string} s\r\n */\r\nexport function glFilterStringToNumber(s) {\r\n\tif (GL_FILTER_MAP.hasOwnProperty(s)) {\r\n\t\treturn GL_FILTER_MAP[s];\r\n\t} else {\r\n\t\tthrow Error(`Invalid scale filter \"${s}\"`);\r\n\t}\r\n}\r\n\r\n/**\r\n * @param {string} s\r\n */\r\nexport function glWrapModeStringToNumber(s) {\r\n\tif (GL_WRAP_MAP.hasOwnProperty(s)) {\r\n\t\treturn GL_WRAP_MAP[s];\r\n\t} else {\r\n\t\tthrow Error(`Invalid wrap mode \"${s}\"`);\r\n\t}\r\n}\r\n\r\n/**\r\n * @param {number} n\r\n */\r\nexport function glFilterNumberToString(n) {\r\n\tfor (let name in GL_FILTER_MAP) {\r\n\t\tif (GL_FILTER_MAP[name] === n) {\r\n\t\t\treturn name;\r\n\t\t}\r\n\t}\r\n\r\n\treturn \"???\";\r\n}\r\n\r\n/**\r\n * @param {number} n\r\n */\r\nexport function glWrapModeNumberToString(n) {\r\n\tfor (let name in GL_WRAP_MAP) {\r\n\t\tif (GL_WRAP_MAP[name] === n) {\r\n\t\t\treturn name;\r\n\t\t}\r\n\t}\r\n\r\n\treturn \"???\";\r\n}\r\n","import { sockJsGlobal } from \"../globals.js\";\r\nimport { gl } from \"./gl.js\";\r\n\r\n/**\r\n * @type {Uint16Array|null}\r\n */\r\nlet indices = null;\r\n\r\nlet populatedIndices = 0;\r\n\r\n/**\r\n * The underlying WebGL buffer for quad indices.\r\n */\r\nexport let quadIndexBuffer = gl.createBuffer();\r\n\r\n/**\r\n * Binds the quad index buffer, and also ensures it is big for the given number of indices.\r\n * @param {number} indexCount The number of indices needed. Should be a multiple of 6 (each quad used 2 triangles = 6 indices). e.g. `vertexCount * 1.5`\r\n */\r\nexport function bindQuadIndexBuffer(indexCount) {\r\n\tgl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, quadIndexBuffer);\r\n\r\n\tif (indices == null || indices.length < indexCount) {\r\n\t\tlet capacity = indices ? indices.length : 256;\r\n\r\n\t\twhile (capacity < indexCount) {\r\n\t\t\tcapacity *= 2;\r\n\t\t}\r\n\r\n\t\tlet newIndices = new Uint16Array(capacity);\r\n\t\t\r\n\t\t// Copy across old indices.\r\n\t\tif (indices != null) {\r\n\t\t\tnewIndices.set(indices);\r\n\t\t}\r\n\t\t\r\n\t\t// Set new indices.\r\n\t\tlet vi = populatedIndices / 1.5;\r\n\r\n\t\tfor ( ; populatedIndices + 5 < capacity; populatedIndices += 6) {\r\n\t\t\tnewIndices[populatedIndices    ] = vi;\r\n\t\t\tnewIndices[populatedIndices + 1] = vi + 1;\r\n\t\t\tnewIndices[populatedIndices + 2] = vi + 2;\r\n\t\t\tnewIndices[populatedIndices + 3] = vi + 1;\r\n\t\t\tnewIndices[populatedIndices + 4] = vi + 3;\r\n\t\t\tnewIndices[populatedIndices + 5] = vi + 2;\r\n\t\t\tvi += 4;\r\n\t\t}\r\n\r\n\t\tgl.bufferData(gl.ELEMENT_ARRAY_BUFFER, newIndices, gl.DYNAMIC_DRAW);\r\n\r\n\t\tindices = newIndices;\r\n\r\n\t\tsockJsGlobal.quadSize = capacity;\r\n\t}\r\n}\r\n","import { gl } from \"./gl.js\";\r\n\r\n/** @type {Shader[]} */\r\nlet shadersAwaitingCompilation = [];\r\n\r\n/**\r\n * A complete WebGL shader (vertex + fragment + program).\r\n */\r\nexport class Shader {\r\n\t/**\r\n\t * @param {ShaderOptions} opt\r\n\t */\r\n\tconstructor(opt) {\r\n\t\t/**\r\n\t\t * Attribute locations.\r\n\t\t * @type {Record<string, number>}\r\n\t\t */\r\n\t\tthis.attributes = {};\r\n\r\n\t\t/**\r\n\t\t * Uniform locations.\r\n\t\t * @type {Record<string, WebGLUniformLocation | null>}\r\n\t\t */\r\n\t\tthis.uniforms = {};\r\n\r\n\t\tlet attributesSource = initShaderVariables(\"attribute\", opt.attributes, this.attributes, -1);\r\n\t\tlet varyingsSource = initShaderVariables(\"varying\", opt.varyings, null, null);\r\n\t\tlet vertUniforms = initShaderVariables(\"uniform\", opt.vertUniforms, this.uniforms, null);\r\n\t\tlet fragUniforms = initShaderVariables(\"uniform\", opt.fragUniforms, this.uniforms, null);\r\n\r\n\t\t// Create shader source code.\r\n\t\t/**\r\n\t\t * WebGL Vertex Shader source code.\r\n\t\t * @type {string}\r\n\t\t */\r\n\t\tthis.vertSource = attributesSource + varyingsSource + vertUniforms + createShaderSourceMain(opt.vert ?? \"\");\r\n\r\n\t\t/**\r\n\t\t * WebGL Fragment Shader source code.\r\n\t\t * @type {string}\r\n\t\t */\r\n\t\tthis.fragSource = varyingsSource + fragUniforms + createShaderSourceMain(opt.frag ?? \"gl_FragColor=vec4(1.0,0.0,1.0,1.0);\");\r\n\r\n\t\t// Create shaders + program.\r\n\t\t/**\r\n\t\t * WebGL Vertex Shader.\r\n\t\t * @type {WebGLShader}\r\n\t\t * @private\r\n\t\t */\r\n\t\tthis._vert = gl.createShader(gl.VERTEX_SHADER);\r\n\t\tgl.shaderSource(this._vert, this.vertSource);\r\n\r\n\t\t/**\r\n\t\t * WebGL Vertex Shader.\r\n\t\t * @type {WebGLShader}\r\n\t\t * @private\r\n\t\t */\r\n\t\tthis._frag = gl.createShader(gl.FRAGMENT_SHADER);\r\n\t\tgl.shaderSource(this._frag, this.fragSource);\r\n\r\n\t\t/**\r\n\t\t * WebGL Shader Program.\r\n\t\t * @type {WebGLProgram}\r\n\t\t */\r\n\t\tthis.prog = gl.createProgram();\r\n\r\n\t\tgl.attachShader(this.prog, this._vert);\r\n\t\tgl.attachShader(this.prog, this._frag);\r\n\r\n\t\t/**\r\n\t\t * If this the shader has been compiled yet.\r\n\t\t * @type {boolean}\r\n\t\t */\r\n\t\tthis.compiled = false;\r\n\t}\r\n\r\n\t/**\r\n\t * When compiling multiple shaders at once, use {@link Shader.compile()} for better performance.\r\n\t * @see {@link needsCompilation()}.\r\n\t */\r\n\tcompile() {\r\n\t\tShader.compile(this);\r\n\t}\r\n\r\n\t/**\r\n\t * Compiles the shader during game load.\r\n\t * \r\n\t * This method is preferred over {@link compile()} since multiple shaders can be compiled in parallel.\r\n\t * \r\n\t * See also {@link Shader.compile()}.\r\n\t */\r\n\tneedsCompilation() {\r\n\t\tshadersAwaitingCompilation.push(this);\r\n\t}\r\n\r\n\tfree() {\r\n\t\tgl.deleteProgram(this.prog);\r\n\t\tgl.deleteShader(this._frag);\r\n\t\tgl.deleteShader(this._vert);\r\n\t\tthis.prog = -1;\r\n\t\tthis.compiled = false;\r\n\t}\r\n\r\n\tuse() {\r\n\t\tif (!this.compiled) throw Error(\"shader not compiled\");\r\n\t\tgl.useProgram(this.prog);\r\n\t}\r\n\r\n\t/**\r\n\t * @param {string} name\r\n\t * @returns {WebGLUniformLocation}\r\n\t * @throws If name is not one of the program's uniform names.\r\n\t * @protected\r\n\t */\r\n\tgetUniformLocation(name) {\r\n\t\tlet location = this.uniforms[name];\r\n\t\tif (location == null) throw Error(`Shader does not contain a uniform named \"${name}\"`);\r\n\t\treturn location;\r\n\t}\r\n\r\n\t/**\r\n\t * Sets a uniform texture in the shader.\r\n\t * @param {string} name The name of the uniform variable.\r\n\t * @param {WebGLTexture} tex The texture to set.\r\n\t * @param {number} unit The texture unit. Either [0..31] or [`gl.TEXTURE0`..`gl.TEXTURE31`]\r\n\t */\r\n\tsetUniformTexture(name, tex, unit) {\r\n\t\tlet location = this.getUniformLocation(name);\r\n\t\t\r\n\t\t// Convert from `gl.TEXTURE##` constants.\r\n\t\tif (unit >= gl.TEXTURE0) {\r\n\t\t\tunit -= gl.TEXTURE0;\r\n\t\t}\r\n\t\t\r\n\t\t// Set the uniform!\r\n\t\tgl.activeTexture(gl.TEXTURE0 + unit);\r\n\t\tgl.bindTexture(gl.TEXTURE_2D, tex);\r\n\t\tgl.uniform1i(location, unit);\r\n\t}\r\n\r\n\t/**\r\n\t * @param {string} name\r\n\t * @param {number} x \r\n\t * @param {number} y \r\n\t */\r\n\tsetUniformFloat2(name, x, y) {\r\n\t\tlet location = this.getUniformLocation(name);\r\n\r\n\t\tgl.uniform2f(location, x, y);\r\n\t}\r\n\r\n\t/**\r\n\t * @param {string} name\r\n\t * @param {number[]|Float32Array} matrix \r\n\t */\r\n\tsetUniformMatrix3(name, matrix) {\r\n\t\tlet location = this.getUniformLocation(name);\r\n\r\n\t\tgl.uniformMatrix3fv(location, false, matrix);\r\n\t}\r\n\t\r\n\t/**\r\n\t * @param {string} name\r\n\t * @param {number[]} matrix \r\n\t */\r\n\tsetUniformMatrix4(name, matrix) {\r\n\t\tlet location = this.getUniformLocation(name);\r\n\r\n\t\tgl.uniformMatrix4fv(location, false, matrix);\r\n\t}\r\n\r\n\t/**\r\n\t * Compiles all shaders that are yet to be compiled.\r\n\t */\r\n\tstatic compileAll() {\r\n\t\tthis.compile(shadersAwaitingCompilation);\r\n\r\n\t\tshadersAwaitingCompilation.length = 0;\r\n\t}\r\n\r\n\t/**\r\n\t * Compile a set of shaders in parallel.\r\n\t * @param {Shader|Shader[]} shaders\r\n\t */\r\n\tstatic compile(shaders) {\r\n\t\tif (shaders instanceof Shader) shaders = [ shaders ];\r\n\r\n\t\t// Frag/Vert\r\n\t\tfor (let sh of shaders) {\r\n\t\t\tgl.compileShader(sh._vert);\r\n\t\t\tgl.compileShader(sh._frag);\r\n\t\t}\r\n\r\n\t\t// Link\r\n\t\tfor (let sh of shaders) {\r\n\t\t\tgl.linkProgram(sh.prog);\r\n\t\t}\r\n\r\n\t\t// Check status\r\n\t\tlet errors = [];\r\n\t\tfor (let sh of shaders) {\r\n\t\t\tif (gl.getProgramParameter(sh.prog, gl.LINK_STATUS)) {\r\n\t\t\t\tsh.compiled = true;\r\n\t\t\t} else {\r\n\t\t\t\tlet sProg = gl.getProgramInfoLog(sh.prog);\r\n\t\t\t\tlet sVert = gl.getShaderInfoLog(sh._vert);\r\n\t\t\t\tlet sFrag = gl.getShaderInfoLog(sh._frag);\r\n\r\n\t\t\t\tlet error = \"Shader Compilation Error:\";\r\n\r\n\t\t\t\tif (sProg) error += \"\\n\\n===   PROGRAM   ===\\n\" + sProg;\r\n\t\t\t\tif (sVert) error += \"\\n\\n=== VERT SHADER ===\\n\" + sVert;\r\n\t\t\t\tif (sFrag) error += \"\\n\\n=== FRAG SHADER ===\\n\" + sFrag;\r\n\r\n\t\t\t\terrors.push(error);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (errors.length > 0) {\r\n\t\t\tthrow Error(errors.join(\"\\n\\n\"));\r\n\t\t}\r\n\r\n\t\t// Get locations.\r\n\t\tfor (let sh of shaders) {\r\n\t\t\tfor (let name in sh.attributes) {\r\n\t\t\t\tsh.attributes[name] = gl.getAttribLocation(sh.prog, name);\r\n\t\t\t}\r\n\t\t\tfor (let name in sh.uniforms) {\r\n\t\t\t\tlet location = gl.getUniformLocation(sh.prog, name);\r\n\t\t\t\tif (location == null) throw Error(`Failed to find uniform \"${name}\" in Shader.`);\r\n\t\t\t\tsh.uniforms[name] = location;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n\r\n/**\r\n * @param {string} keyword\r\n * @param {Record<string, string>} src\r\n * @param {Record<string, T>|null} dst\r\n * @param {T} init\r\n * @returns {string}\r\n * @template T\r\n */\r\nfunction initShaderVariables(keyword, src, dst, init) {\r\n\tlet s = \"\";\r\n\tif (src) {\r\n\t\tfor (let name in src) {\r\n\t\t\tif (dst) dst[name] = init;\r\n\t\t\ts += keyword +  \" \" + src[name] + \" \" + name + \";\\n\";\r\n\t\t}\r\n\t}\r\n\treturn s;\r\n}\r\n\r\n/**\r\n * @param {string|string[]} a\r\n * @returns {string}\r\n */\r\nfunction createShaderSourceMain(a) {\r\n\tif (Array.isArray(a)) {\r\n\t\ta = a.join(\"\");\r\n\t}\r\n\r\n\treturn \"void main(){\" + a + \"}\";\r\n}\r\n\r\n/**\r\n * @typedef {object} ShaderOptions\r\n * @property {Record<string, string> | null} [attributes] Vertex shader attributes, as name-type pairs.\r\n * @property {Record<string, string> | null} [varyings] Vertex/fragment shader varyings, as name-type pairs.\r\n * @property {Record<string, string> | null} [vertUniforms] Vertex shader uniforms, as name-type pairs.\r\n * @property {Record<string, string> | null} [fragUniforms] Fragment shader uniforms, as name-type pairs.\r\n * @property {string|string[]|null} [vert] Vertex shader code, just the contents of the `main()` function.\r\n * @property {string|string[]|null} [frag] Fragment shader code, just the contents of the `main()` function.\r\n */\r\n","\r\nexport class Vec2 {\r\n\t/**\r\n\t * @param {number} x\r\n\t * @param {number} y\r\n\t */\r\n\tconstructor(x, y) {\r\n\t\tthis.x = x;\r\n\t\tthis.y = y;\r\n\t}\r\n}","import { Vec2 } from \"../math.js\";\r\nimport { gl } from \"./gl.js\";\r\n\r\n/**\r\n * A 2D WebGL texture.\r\n */\r\nexport class Texture {\r\n\t/**\r\n\t * @param {number} filter\r\n\t * @param {number} wrap\r\n\t */\r\n\tconstructor(filter, wrap) {\r\n\t\tthis.width = 0;\r\n\t\tthis.height = 0;\r\n\t\t// this.mipmaps = false;\r\n\t\tthis.filter = filter;\r\n\t\tthis.wrap = wrap;\r\n\t\tthis.size = 1;\r\n\t\t/**\r\n\t\t * The WebGL texture.\r\n\t\t * @type {WebGLTexture}\r\n\t\t */\r\n\t\tthis.texture = null;\r\n\t}\r\n\r\n\tname() {\r\n\t\treturn \"Texture\";\r\n\t}\r\n\r\n\t/**\r\n\t * @param {number} n\r\n\t */\r\n\tsetFilter(n) {\r\n\t\tif (this.filter !== n) {\r\n\t\t\tthis.filter = n;\r\n\t\t\t\r\n\t\t\tif (this.texture) {\r\n\t\t\t\tgl.bindTexture(gl.TEXTURE_2D, this.texture);\r\n\t\t\t\tgl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, this.filter);\r\n\t\t\t\tgl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, this.filter);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * @param {number} n\r\n\t */\r\n\tsetWrap(n) {\r\n\t\tif (this.wrap !== n) {\r\n\t\t\tthis.wrap = n;\r\n\r\n\t\t\tif (this.texture) {\r\n\t\t\t\tgl.bindTexture(gl.TEXTURE_2D, this.texture);\r\n\t\t\t\tgl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, this.wrap);\r\n\t\t\t\tgl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, this.wrap);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * @param {TexImageSource} source \r\n\t */\r\n\tload(source) {\r\n\t\tlet res = getResolution(source);\r\n\t\tthis.width = res.x;\r\n\t\tthis.height = res.y;\r\n\t\tthis.size = imageSize(source, res);\r\n\t\tthis.texture = gl.createTexture();\r\n\r\n\t\tgl.bindTexture(gl.TEXTURE_2D, this.texture);\r\n\r\n\t\tgl.texImage2D(\r\n\t\t\tgl.TEXTURE_2D,\r\n\t\t\t0,\r\n\t\t\tgl.RGBA,\r\n\t\t\tgl.RGBA,\r\n\t\t\tgl.UNSIGNED_BYTE,\r\n\t\t\tsource\r\n\t\t);\r\n\r\n\t\t// if (this.mipmaps) {\r\n\t\t// \tgl.generateMipmap(gl.TEXTURE_2D);\r\n\t\t// }\r\n\r\n\t\t// Handle issues with non-power-of-two textures.\r\n\t\tlet texIsPowerOf2 = isPowerOf2(this.width) && isPowerOf2(this.height);\r\n\r\n\t\tif (!texIsPowerOf2) {\r\n\t\t\t// Non-power-of-two textures in WebGL 1.0 will be read as a black texture unless we set:\r\n\t\t\t// * Minification filter to NEAREST or LINEAR (i.e. not one of the mip-map options).\r\n\t\t\t// * Wrap mode to CLAMP_TO_EDGE.\r\n\t\t\t// https://www.khronos.org/webgl/wiki/WebGL_and_OpenGL_Differences#Non-Power_of_Two_Texture_Support\r\n\t\t\tlet warn = [];\r\n\r\n\t\t\t// if (isMipMapFilter(this.filter)) {\r\n\t\t\t// \tthis.filter = gl.LINEAR;\r\n\t\t\t// \twarn.push(\"minification filter to LINEAR\");\r\n\t\t\t// }\r\n\r\n\t\t\tif (this.wrap !== gl.CLAMP_TO_EDGE) {\r\n\t\t\t\tthis.wrap = gl.CLAMP_TO_EDGE;\r\n\t\t\t\twarn.push(\"wrap mode to CLAMP_TO_EDGE\");\r\n\t\t\t}\r\n\r\n\t\t\tif (warn.length > 0) {\r\n\t\t\t\tconsole.warn(`Forced settings on non power-of-two texture \"${this.name()}\": ${warn.join(\", \")}.\\nThe texture would not function properly otherwise, see https://www.khronos.org/webgl/wiki/WebGL_and_OpenGL_Differences#Non-Power_of_Two_Texture_Support`);\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tgl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, this.filter);\r\n\t\tgl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, this.filter);\r\n\t\t\r\n\t\tif (this.wrap != null && this.wrap !== gl.REPEAT) {\r\n\t\t\tgl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, this.wrap);\r\n\t\t\tgl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, this.wrap);\r\n\t\t}\r\n\t}\r\n\r\n\tfree() {\r\n\t\tgl.deleteTexture(this.texture);\r\n\t\tthis.texture = null;\r\n\t}\r\n}\r\n\r\n/**\r\n * @param {TexImageSource} source\r\n * @returns {Vec2}\r\n */\r\nfunction getResolution(source) {\r\n\tif (source instanceof HTMLImageElement) {\r\n\t\treturn new Vec2(source.naturalWidth, source.naturalHeight);\r\n\t} else if (source instanceof HTMLVideoElement) {\r\n\t\treturn new Vec2(source.videoWidth, source.videoHeight);\r\n\t} else {\r\n\t\treturn new Vec2(source.width, source.height);\r\n\t}\r\n}\r\n\r\n/**\r\n * @param {TexImageSource} img\r\n * @param {Vec2} resolution\r\n * @returns {number}\r\n */\r\nfunction imageSize(img, resolution) {\r\n\tif (img instanceof HTMLImageElement) {\r\n\t\tlet entry = performance.getEntriesByName(img.src)[0];\r\n\t\r\n\t\tif (entry instanceof PerformanceResourceTiming) {\r\n\t\t\treturn entry.decodedBodySize || entry.transferSize;\r\n\t\t}\r\n\t} else if (img instanceof ImageData) {\r\n\t\treturn img.data.byteLength;\r\n\t}\r\n\t\r\n\t// Just guess based on dimensions.\r\n\treturn 1 + Math.floor(resolution.x * resolution.y * 0.25);\r\n}\r\n\r\n/**\r\n * @param {number} n\r\n * @returns {boolean}\r\n */\r\nfunction isPowerOf2(n) {\r\n\treturn (n & (n - 1)) === 0;\r\n}\r\n\r\n/**\r\n * @param {number | null | undefined} n\r\n */\r\nfunction isMipMapFilter(n) {\r\n\treturn n == null || (n >= 0x2700 && n <= 0x2703);\r\n}\r\n","import { getCameraMatrix } from \"../api/camera.js\";\r\nimport { gl } from \"./gl.js\";\r\nimport { bindQuadIndexBuffer } from \"./quad-index-buffer.js\";\r\nimport { Shader } from \"./shader.js\";\r\nimport { Texture } from \"./texture.js\";\r\n\r\nlet shader = new Shader({\r\n\tattributes: {\r\n\t\t\"vertex\": \"vec3\",\r\n\t\t\"color\": \"vec4\",\r\n\t\t\"uv\": \"vec2\",\r\n\t},\r\n\tvaryings: {\r\n\t\t\"v_color\": \"lowp vec4\",\r\n\t\t\"v_uv\": \"highp vec2\",\r\n\t},\r\n\tvertUniforms: {\r\n\t\t\"mat\": \"mat3\",\r\n\t},\r\n\tvert: [\r\n\t\t\"v_uv = uv;\",\r\n\t\t\"v_color = color;\",\r\n\t\t// \"gl_Position = vec4(vertex, 1.0);\",\r\n\t\t\"vec3 tv = mat * vec3(vertex.x, vertex.y, 1.0);\",\r\n\t\t\"gl_Position = vec4(tv.x, tv.y, vertex.z, 1.0);\",\r\n\t],\r\n\tfragUniforms: {\r\n\t\t\"tex\": \"sampler2D\",\r\n\t},\r\n\tfrag: \"gl_FragColor = texture2D(tex, v_uv) * v_color;\",\r\n});\r\n\r\nshader.needsCompilation();\r\n\r\n\r\n/**\r\n * Helper for drawing sprites (textured quads) in an efficient manner.\r\n * \r\n * Each `SpriteBatcher` contains growing buffers for geometry data, so it's best to re-use instances where possible.\r\n * \r\n * `SpriteBatcher` should be destroyed explicitly using {@link free()}.\r\n */\r\nexport class SpriteBatcher {\r\n\tconstructor() {\r\n\t\t/**\r\n\t\t * Number of vertices we can fit.\r\n\t\t * @protected\r\n\t\t */\r\n\t\tthis._capacity = 128;\r\n\t\t/**\r\n\t\t * Vertex data array.\r\n\t\t * ```\r\n\t\t *  x     y     z     rgba  u     v\r\n\t\t * [----][----][----][----][----][----]\r\n\t\t * ```\r\n\t\t * @protected\r\n\t\t */\r\n\t\tthis._array = new ArrayBuffer(this._capacity * 24);\r\n\t\t/**\r\n\t\t * @protected\r\n\t\t */\r\n\t\tthis._floats = new Float32Array(this._array);\r\n\t\t/**\r\n\t\t * @protected\r\n\t\t */\r\n\t\tthis._bytes = new Uint8Array(this._array);\r\n\t\t/**\r\n\t\t * @protected\r\n\t\t */\r\n\t\tthis._ints = new Uint32Array(this._array);\r\n\t\t/**\r\n\t\t * @protected\r\n\t\t */\r\n\t\tthis._vertexCount = -1;\r\n\t\t/**\r\n\t\t * @protected\r\n\t\t */\r\n\t\tthis._vertexBuffer = gl.createBuffer();\r\n\t\t/**\r\n\t\t * The number of vertices we can fit in the vertex buffer.\r\n\t\t * @protected\r\n\t\t */\r\n\t\tthis._vertexBufferCapacity = 0;\r\n\t}\r\n\r\n\t/**\r\n\t * Begin a batch.\r\n\t * \r\n\t * Each batch can only use one texture, and you can only provide it here.\r\n\t * \r\n\t * Use {@link end()} to end a batch.\r\n\t * @param {Texture} texture\r\n\t */\r\n\tbegin(texture) {\r\n\t\tif (this._vertexCount >= 0) throw Error(\"already called begin()\");\r\n\r\n\t\t/**\r\n\t\t * @protected\r\n\t\t */\r\n\t\tthis._texture = texture;\r\n\t\tthis._vertexCount = 0;\r\n\r\n\t\treturn this;\r\n\t}\r\n\r\n\t// /**\r\n\t//  * @param {number} x1\r\n\t//  * @param {number} y1\r\n\t//  * @param {number} x2\r\n\t//  * @param {number} y2\r\n\t//  * @param {number} z\r\n\t//  * @param {number} c\r\n\t//  */\r\n\t// draw(x1, y1, x2, y2, z, c) {\r\n\t// \tthis.draw2(x1, y1, x2, y2, z, 0, 0, 1, 1, c, tf, tfo);\r\n\t// }\r\n\t\r\n\t/**\r\n\t * @param {number} x1\r\n\t * @param {number} y1\r\n\t * @param {number} x2\r\n\t * @param {number} y2\r\n\t * @param {number} z\r\n\t * @param {number} u1\r\n\t * @param {number} v1\r\n\t * @param {number} u2\r\n\t * @param {number} v2\r\n\t * @param {number} c\r\n\t * @param {number[]|null} [tf] A 2x3 transform matrix\r\n\t * @param {number[]|null} [tfo] A 2d transform origin\r\n\t */\r\n\tdrawQuad(x1, y1, x2, y2, z, u1, v1, u2, v2, c, tf, tfo) {\r\n\t\tthis.checkResize(4);\r\n\t\t\r\n\t\tif (tf) {\r\n\t\t\tlet tx1 = x1 * tf[0] + y1 * tf[2] + tf[4];\r\n\t\t\tlet ty1 = x1 * tf[1] + y1 * tf[3] + tf[5];\r\n\t\t\tlet tx2 = x1 * tf[0] + y2 * tf[2] + tf[4];\r\n\t\t\tlet ty2 = x1 * tf[1] + y2 * tf[3] + tf[5];\r\n\t\t\tlet tx3 = x2 * tf[0] + y1 * tf[2] + tf[4];\r\n\t\t\tlet ty3 = x2 * tf[1] + y1 * tf[3] + tf[5];\r\n\t\t\tlet tx4 = x2 * tf[0] + y2 * tf[2] + tf[4];\r\n\t\t\tlet ty4 = x2 * tf[1] + y2 * tf[3] + tf[5];\r\n\r\n\t\t\tlet tfox = tfo ? (x1 + tfo[0]) : ((x1 + x2) / 2);\r\n\t\t\tlet tfoy = tfo ? (y1 + tfo[1]) : ((y1 + y2) / 2);\r\n\t\t\tlet dx = tfox - tf[0] * tfox - tf[2] * tfoy;\r\n\t\t\tlet dy = tfoy - tf[1] * tfox - tf[3] * tfoy;\r\n\r\n\t\t\tthis.addVertex(tx1 + dx, ty1 + dy, z, c, u1, v1);\r\n\t\t\tthis.addVertex(tx2 + dx, ty2 + dy, z, c, u1, v2);\r\n\t\t\tthis.addVertex(tx3 + dx, ty3 + dy, z, c, u2, v1);\r\n\t\t\tthis.addVertex(tx4 + dx, ty4 + dy, z, c, u2, v2);\r\n\t\t} else {\r\n\t\t\tthis.addVertex(x1, y1, z, c, u1, v1);\r\n\t\t\tthis.addVertex(x1, y2, z, c, u1, v2);\r\n\t\t\tthis.addVertex(x2, y1, z, c, u2, v1);\r\n\t\t\tthis.addVertex(x2, y2, z, c, u2, v2);\r\n\t\t}\r\n\t\t\r\n\t}\r\n\r\n\t/**\r\n\t * Add a single vertex.\r\n\t * Should be preceded by a call to {@link checkResize()}.\r\n\t * @param {number} x\r\n\t * @param {number} y\r\n\t * @param {number} z\r\n\t * @param {number} color\r\n\t * @param {number} u\r\n\t * @param {number} v\r\n\t * @protected\r\n\t */\r\n\taddVertex(x, y, z, color, u, v) {\r\n\t\tlet i4 = this._vertexCount * 6;\r\n\r\n\t\tthis._floats[i4    ] = x;\r\n\t\tthis._floats[i4 + 1] = y;\r\n\t\tthis._floats[i4 + 2] = z;\r\n\r\n\t\tthis._ints[i4 + 3] = color;\r\n\r\n\t\tthis._floats[i4 + 4] = u;\r\n\t\tthis._floats[i4 + 5] = v;\r\n\r\n\t\tthis._vertexCount++;\r\n\t}\r\n\r\n\t/**\r\n\t * @param {number} vertexCount\r\n\t * @protected\r\n\t */\r\n\tcheckResize(vertexCount) {\r\n\t\tif (this._vertexCount + vertexCount > this._capacity) {\r\n\t\t\t// Grow capacity.\r\n\t\t\tthis._capacity *= 2;\r\n\r\n\t\t\tif (this._capacity >= 0xfffff) throw Error(`exceeded max batch capacity of ${0xfffff}, did you forget to call end()?`);\r\n\r\n\t\t\t// Create new buffer.\r\n\t\t\tthis._array = new ArrayBuffer(this._capacity * 24);\r\n\r\n\t\t\t// Copy data from old buffer.\r\n\t\t\tlet newInts = new Uint32Array(this._array);\r\n\t\t\tnewInts.set(this._ints);\r\n\r\n\t\t\t// Create new views.\r\n\t\t\tthis._floats = new Float32Array(this._array);\r\n\t\t\tthis._bytes = new Uint8Array(this._array);\r\n\t\t\tthis._ints = newInts;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Ends a batch.\r\n\t * Has no effect if no sprites have been queued up.\r\n\t */\r\n\tend() {\r\n\t\tif (this._vertexCount < 0) throw Error(\"have not called begin()\");\r\n\r\n\t\tif (this._vertexCount > 0) {\r\n\t\t\t// Draw!\r\n\t\t\tshader.use();\r\n\t\r\n\t\t\t// Put vertex data.\r\n\t\t\tgl.bindBuffer(gl.ARRAY_BUFFER, this._vertexBuffer);\r\n\r\n\t\t\tif (this._vertexCount > this._vertexBufferCapacity) {\r\n\t\t\t\t// Re-allocate vertex data.\r\n\t\t\t\tthis._vertexBufferCapacity = this._capacity;\r\n\t\t\t\tgl.bufferData(gl.ARRAY_BUFFER, this._array, gl.DYNAMIC_DRAW);\r\n\t\t\t} else {\r\n\t\t\t\t// Put in sub-data.\r\n\t\t\t\tgl.bufferSubData(gl.ARRAY_BUFFER, 0, this._ints.subarray(0, this._vertexCount * 6));\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// Configure/enable attributes.\r\n\t\t\tlet vertLocation = shader.attributes.vertex;\r\n\t\t\tlet colorlocation = shader.attributes.color;\r\n\t\t\tlet uvLocation = shader.attributes.uv;\r\n\r\n\t\t\tgl.vertexAttribPointer(\r\n\t\t\t\tvertLocation,\r\n\t\t\t\t3,\r\n\t\t\t\tgl.FLOAT,\r\n\t\t\t\tfalse,\r\n\t\t\t\t24,\r\n\t\t\t\t0,\r\n\t\t\t);\r\n\t\t\tgl.enableVertexAttribArray(vertLocation);\r\n\t\t\t\r\n\t\t\tgl.vertexAttribPointer(\r\n\t\t\t\tcolorlocation,\r\n\t\t\t\t4,\r\n\t\t\t\tgl.UNSIGNED_BYTE,\r\n\t\t\t\ttrue,\r\n\t\t\t\t24,\r\n\t\t\t\t12,\r\n\t\t\t);\r\n\t\t\tgl.enableVertexAttribArray(colorlocation);\r\n\r\n\t\t\tgl.vertexAttribPointer(\r\n\t\t\t\tuvLocation,\r\n\t\t\t\t2,\r\n\t\t\t\tgl.FLOAT,\r\n\t\t\t\tfalse,\r\n\t\t\t\t24,\r\n\t\t\t\t16,\r\n\t\t\t);\r\n\t\t\tgl.enableVertexAttribArray(uvLocation);\r\n\r\n\t\t\t// Set shader texture.\r\n\t\t\tshader.setUniformTexture(\"tex\", this._texture.texture, 0);\r\n\r\n\t\t\t// Set shader matrix.\r\n\t\t\tshader.setUniformMatrix3(\"mat\", getCameraMatrix());\r\n\t\t\r\n\t\t\t// Setup index buffer.\r\n\t\t\tlet indexCount = this._vertexCount * 1.5;\r\n\t\t\t\r\n\t\t\tbindQuadIndexBuffer(indexCount);\r\n\r\n\t\t\t// Draw!\r\n\t\t\tgl.drawElements(gl.TRIANGLES, indexCount, gl.UNSIGNED_SHORT, 0);\r\n\r\n\t\t\t// Clean up.\r\n\t\t\tgl.disableVertexAttribArray(vertLocation);\r\n\t\t\tgl.disableVertexAttribArray(colorlocation);\r\n\t\t\tgl.disableVertexAttribArray(uvLocation);\r\n\t\t}\r\n\r\n\t\t// Reset state.\r\n\t\tthis._vertexCount = -1;\r\n\t}\r\n\r\n\t/**\r\n\t * Free all WebGL buffers and internal buffers.\r\n\t */\r\n\tfree() {\r\n\t\tgl.deleteBuffer(this._vertexBuffer);\r\n\t\tthis._array = this._bytes = this._floats = this._ints = null;\r\n\t}\r\n}\r\n","import { getAssetAsIMG } from \"../asset-database.js\";\r\nimport { addForeignClass } from \"../foreign.js\";\r\nimport { glFilterNumberToString, glFilterStringToNumber, glWrapModeNumberToString, glWrapModeStringToNumber, GL_FILTER_MAP, GL_WRAP_MAP, wrenGlFilterStringToNumber, wrenGlWrapModeStringToNumber } from \"../gl/api.js\";\r\nimport { gl } from \"../gl/gl.js\";\r\nimport { SpriteBatcher } from \"../gl/sprite-batcher.js\";\r\nimport { Texture } from \"../gl/texture.js\";\r\nimport { wrenAbort, vm, wrenEnsureSlots, wrenGetSlotDouble, wrenGetSlotForeign, wrenGetSlotHandle, wrenGetSlotString, wrenGetSlotType, wrenInsertInList, wrenReleaseHandle, wrenSetListElement, wrenSetSlotDouble, wrenSetSlotHandle, wrenSetSlotNewForeign, wrenSetSlotNewList, wrenSetSlotNull, wrenSetSlotString, wrenGetVariable, Module, HEAP, wren_sock_get_transform } from \"../vm.js\";\r\nimport { loadAsset } from \"./asset.js\";\r\nimport { WrenHandle } from \"./promise.js\";\r\n\r\n\r\nlet handle_Sprite = 0;\r\n\r\nexport function initSpriteModule() {\r\n\twrenEnsureSlots(1);\r\n\twrenGetVariable(\"sock\", \"Sprite\", 0);\r\n\thandle_Sprite = wrenGetSlotHandle(0);\r\n}\r\n\r\nlet defaultFilter = gl.NEAREST;\r\nlet defaultWrap = gl.CLAMP_TO_EDGE;\r\n\r\nclass Sprite extends Texture {\r\n\t/**\r\n\t * @param {number} ptr\r\n\t */\r\n\tconstructor(ptr) {\r\n\t\tsuper(defaultFilter, defaultWrap);\r\n\r\n\t\t/**\r\n\t\t * Foreign slot pointer.\r\n\t\t */\r\n\t\tthis.ptr = ptr;\r\n\r\n\t\t/** @type {string} */\r\n\t\tthis.path = null;\r\n\r\n\t\t/** @type {SpriteBatcher|null} */\r\n\t\tthis.batcher = null;\r\n\r\n\t\tthis.color = 0xffffffff;\r\n\r\n\t\t/**\r\n\t\t * Transform origin.\r\n\t\t * @type {number[]|null}\r\n\t\t */\r\n\t\tthis.tfo = null;\r\n\r\n\t\t/**\r\n\t\t * Transform matrix.\r\n\t\t * @type {number[]}\r\n\t\t */\r\n\t\tthis.tf = null;\r\n\t}\r\n\r\n\tname() {\r\n\t\treturn this.path || \"Sprite#\" + this.ptr;\r\n\t}\r\n\r\n\tbeginBatch() {\r\n\t\tthis.batcher = getBatcher();\r\n\t\tthis.batcher.begin(this);\r\n\t}\r\n\r\n\tendBatch() {\r\n\t\tthis.batcher.end();\r\n\t\tfreeSpriteBatchers.push(this.batcher);\r\n\t\tthis.batcher = null;\r\n\t}\r\n}\r\n\r\n\r\n/** @type {SpriteBatcher[]} */\r\nlet freeSpriteBatchers = [];\r\n\r\nfunction getBatcher() {\r\n\tif (freeSpriteBatchers.length > 0) {\r\n\t\treturn freeSpriteBatchers.pop();\r\n\t} else {\r\n\t\treturn new SpriteBatcher();\r\n\t}\r\n}\r\n\r\nfunction getTempBatcher() {\r\n\tif (freeSpriteBatchers.length > 0) {\r\n\t\treturn freeSpriteBatchers[0];\r\n\t} else {\r\n\t\tlet bat = new SpriteBatcher();\r\n\t\tfreeSpriteBatchers.push(bat);\r\n\t\treturn bat;\r\n\t}\r\n}\r\n\r\n\r\n/**\r\n * Maps foreign C pointer to Sprite object.\r\n * @type {Map<number, Sprite>}\r\n */\r\nlet sprites = new Map();\r\n\r\n/**\r\n * Gets the current Sprite in slot 0.\r\n * @returns {Sprite}\r\n */\r\nfunction getSprite() {\r\n\treturn sprites.get(wrenGetSlotForeign(0));\r\n}\r\n\r\n\r\naddForeignClass(\"sock\", \"Sprite\", [\r\n\t() => {\r\n\t\tlet ptr = wrenSetSlotNewForeign(0, 0, 0);\r\n\r\n\t\tlet spr = new Sprite(ptr);\r\n\r\n\t\tsprites.set(ptr, spr);\r\n\t},\r\n\t(ptr) => {\r\n\t\tlet tex = sprites.get(ptr);\r\n\t\ttex.free();\r\n\t\tsprites.delete(ptr);\r\n\t},\r\n], {\r\n\t\"width\"() {\r\n\t\twrenSetSlotDouble(0, getSprite().width);\r\n\t},\r\n\t\"height\"() {\r\n\t\twrenSetSlotDouble(0, getSprite().height);\r\n\t},\r\n\t\"scaleFilter\"() {\r\n\t\twrenSetSlotString(0, glFilterNumberToString(getSprite().filter));\r\n\t},\r\n\t\"scaleFilter=(_)\"() {\r\n\t\tlet filter = wrenGlFilterStringToNumber(1);\r\n\r\n\t\tif (filter != null) {\r\n\t\t\tgetSprite().setFilter(filter);\r\n\t\t}\r\n\t},\r\n\t\"wrapMode\"() {\r\n\t\twrenSetSlotString(0, glWrapModeNumberToString(getSprite().wrap));\r\n\t},\r\n\t\"wrapMode=(_)\"() {\r\n\t\tlet wrapMode = wrenGlWrapModeStringToNumber(1);\r\n\r\n\t\tif (wrapMode != null) {\r\n\t\t\tgetSprite().setWrap(wrapMode);\r\n\t\t}\r\n\t},\r\n\t\"color\"() {\r\n\t\twrenSetSlotDouble(0, getSprite().color);\r\n\t},\r\n\t\"color=(_)\"() {\r\n\t\tif (wrenGetSlotType(1) === 1) {\r\n\t\t\tgetSprite().color = wrenGetSlotDouble(1);\r\n\t\t} else {\r\n\t\t\twrenAbort(\"color must be Num\");\r\n\t\t}\r\n\t},\r\n\t\"beginBatch()\"() {\r\n\t\tlet spr = getSprite();\r\n\t\tif (spr.batcher) {\r\n\t\t\twrenAbort(\"batch already started\");\r\n\t\t} else {\r\n\t\t\tspr.beginBatch();\r\n\t\t}\r\n\t},\r\n\t\"endBatch()\"() {\r\n\t\tlet spr = getSprite();\r\n\t\tif (spr.batcher) {\r\n\t\t\tspr.endBatch();\r\n\t\t} else {\r\n\t\t\twrenAbort(\"batch no yet started\");\r\n\t\t}\r\n\t},\r\n\t\"transform\"() {\r\n\t\tlet spr = getSprite();\r\n\r\n\t\tif (spr.tf == null) {\r\n\t\t\twrenSetSlotNull(0);\r\n\t\t} else {\r\n\t\t\tModule.ccall(\"sock_new_transform\", null, [ \"number\", \"number\", \"number\", \"number\", \"number\", \"number\" ], spr.tf);\r\n\t\t}\r\n\t},\r\n\t\"transform=(_)\"() {\r\n\t\tlet spr = getSprite();\r\n\t\tlet ptr = /** @type {number} */( Module.ccall(\"sock_get_transform\", \"number\", [ \"number\" ], [ 1 ]) );\r\n\t\tif (ptr) {\r\n\t\t\tspr.tfo = null;\r\n\t\t\tspr.tf = Array.from(new Float32Array(HEAP(), ptr, 6));\r\n\t\t}\r\n\t},\r\n\t\"setTransform(_,_,_)\"() {\r\n\t\tlet spr = getSprite();\r\n\r\n\t\tif (wrenGetSlotType(1) !== 1 || wrenGetSlotType(2) !== 1) {\r\n\t\t\twrenAbort(\"x/y must be Nums\");\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tlet x = wrenGetSlotDouble(1);\r\n\t\tlet y = wrenGetSlotDouble(2);\r\n\t\tlet ptr = wren_sock_get_transform(3);\r\n\r\n\t\tif (ptr) {\r\n\t\t\tspr.tfo = [ x, y ];\r\n\t\t\tspr.tf = Array.from(new Float32Array(HEAP(), ptr, 6));\r\n\t\t}\r\n\t},\r\n\t\"draw(_,_,_,_)\"() {\r\n\t\tlet spr = getSprite();\r\n\t\tlet x1 = wrenGetSlotDouble(1);\r\n\t\tlet y1 = wrenGetSlotDouble(2);\r\n\t\tlet x2 = x1 + wrenGetSlotDouble(3);\r\n\t\tlet y2 = y1 + wrenGetSlotDouble(4);\r\n\r\n\t\tlet bat = spr.batcher || getTempBatcher().begin(spr);\r\n\r\n\t\tbat.drawQuad(x1, y1, x2, y2, 0, 0, 0, 1, 1, spr.color, spr.tf, spr.tfo);\r\n\r\n\t\tif (!spr.batcher) bat.end();\r\n\t},\r\n\t\"draw(_,_,_,_,_,_,_,_)\"() {\r\n\t\tlet spr = getSprite();\r\n\t\tlet x1 = wrenGetSlotDouble(1);\r\n\t\tlet y1 = wrenGetSlotDouble(2);\r\n\t\tlet x2 = x1 + wrenGetSlotDouble(3);\r\n\t\tlet y2 = y1 + wrenGetSlotDouble(4);\r\n\t\tlet u1 = wrenGetSlotDouble(5) / spr.width;\r\n\t\tlet v1 = wrenGetSlotDouble(6) / spr.height;\r\n\t\tlet u2 = u1 + wrenGetSlotDouble(7) / spr.width;\r\n\t\tlet v2 = v1 + wrenGetSlotDouble(8) / spr.height;\r\n\r\n\t\tlet bat = spr.batcher || getTempBatcher().begin(spr);\r\n\r\n\t\tbat.drawQuad(x1, y1, x2, y2, 0, u1, v1, u2, v2, spr.color, spr.tf, spr.tfo);\r\n\r\n\t\tif (!spr.batcher) bat.end();\r\n\t},\r\n\t\"toString\"() {\r\n\t\twrenSetSlotString(0, getSprite().name());\r\n\t}\r\n}, {\r\n\t\"load_(_,_)\"() {\r\n\t\tloadAsset(async (path) => {\r\n\t\t\tlet img = await getAssetAsIMG(path);\r\n\r\n\t\t\twrenEnsureSlots(2);\r\n\t\t\twrenSetSlotHandle(0, handle_Sprite);\r\n\t\t\tlet ptr = wrenSetSlotNewForeign(0, 0, 0);\r\n\r\n\t\t\tlet spr = new Sprite(ptr);\r\n\t\t\tspr.path = path;\r\n\r\n\t\t\tsprites.set(ptr, spr);\r\n\r\n\t\t\tspr.load(img);\r\n\r\n\t\t\treturn new WrenHandle(wrenGetSlotHandle(0));\r\n\t\t});\r\n\t},\r\n\t\"defaultScaleFilter\"() {\r\n\t\twrenSetSlotString(0, glFilterNumberToString(defaultFilter));\r\n\t},\r\n\t\"defaultScaleFilter=(_)\"() {\r\n\t\tlet filter = wrenGlFilterStringToNumber(1);\r\n\r\n\t\tif (filter != null) {\r\n\t\t\tdefaultFilter = filter;\r\n\t\t}\r\n\t},\r\n\t\"defaultWrapMode\"() {\r\n\t\twrenSetSlotString(0, glWrapModeNumberToString(defaultWrap));\r\n\t},\r\n\t\"defaultWrapMode=(_)\"() {\r\n\t\tlet wrapMode = wrenGlWrapModeStringToNumber(1);\r\n\r\n\t\tif (wrapMode != null) {\r\n\t\t\tdefaultWrap = wrapMode;\r\n\t\t}\r\n\t},\r\n});\r\n","import { sockJsGlobal } from \"./globals.js\";\r\n\r\n/** @type {\"windows\"|\"mac\"|\"ios\"|\"linux\"|\"android\"} */\r\nexport let deviceOS;\r\n/** @type {\"unknown\"|\"chrome\"|\"edge\"|\"firefox\"|\"safari\"} */\r\nexport let deviceBrowser;\r\nexport let deviceIsMobile = false;\r\n\r\nlet platform = navigator.platform;\r\nlet userAgent = navigator.userAgent;\r\n\r\nif (platform === \"iPhone\" || platform === \"iPad\" || userAgent.includes(\"iPhone\")) {\r\n\tdeviceOS = \"ios\";\r\n\tdeviceIsMobile = true;\r\n} else if (platform === \"Win32\") {\r\n\tdeviceOS = \"windows\";\r\n} else if (platform.includes(\"Mac\")) {\r\n\tdeviceOS = \"mac\";\r\n} else if (userAgent.includes(\"Android\")) {\r\n\tdeviceOS = \"android\";\r\n\tdeviceIsMobile = true;\r\n} else {\r\n\tdeviceOS = \"linux\";\r\n}\r\n\r\nif (userAgent.includes(\"Edg/\")) {\r\n\tdeviceBrowser = \"edge\";\r\n} else if (userAgent.includes(\"Chrome/\")) {\r\n\tdeviceBrowser = \"chrome\";\r\n} else if (userAgent.includes(\"Safari/\")) {\r\n\tdeviceBrowser = \"safari\";\r\n} else if (userAgent.includes(\"Firefox/\")) {\r\n\tdeviceBrowser = \"firefox\";\r\n} else {\r\n\tdeviceBrowser = \"unknown\";\r\n}\r\n\r\nsockJsGlobal.device = {\r\n\tos: deviceOS,\r\n\tisMobile: deviceIsMobile,\r\n\tbrowser: deviceBrowser,\r\n};\r\n","import { internalResolutionHeight, internalResolutionWidth, viewportHeight, viewportOffsetX, viewportOffsetY, viewportWidth } from \"../layout.js\";\r\nimport { gl } from \"./gl.js\";\r\nimport { Shader } from \"./shader.js\";\r\n\r\nlet shader = new Shader({\r\n\tattributes: {\r\n\t\t\"vertex\": \"vec2\",\r\n\t},\r\n\tvaryings: {\r\n\t\t\"v_uv\": \"highp vec2\",\r\n\t},\r\n\tvert: [\r\n\t\t\"v_uv = 0.5 + vertex.xy * 0.5;\",\r\n\t\t\"gl_Position = vec4(vertex, 0.0, 1.0);\",\r\n\t],\r\n\tfragUniforms: {\r\n\t\t\"tex\": \"sampler2D\",\r\n\t},\r\n\tfrag: \"gl_FragColor = texture2D(tex, v_uv);\",\r\n});\r\n\r\nshader.needsCompilation();\r\n\r\nexport class Framebuffer {\r\n\t/**\r\n\t * @param {number} [filter]\r\n\t */\r\n\tconstructor(filter) {\r\n\t\tthis.filter = filter ?? gl.LINEAR;\r\n\r\n\t\tthis.texture = gl.createTexture();\r\n\t\tthis.depthBuffer = gl.createRenderbuffer();\r\n\t\tthis.framebuffer = gl.createFramebuffer();\r\n\t\tthis.quadBuffer = gl.createBuffer();\r\n\r\n\t\tgl.bindBuffer(gl.ARRAY_BUFFER, this.quadBuffer);\r\n\t\tgl.bufferData(\r\n\t\t\tgl.ARRAY_BUFFER,\r\n\t\t\tnew Float32Array([\r\n\t\t\t\t-1, -1,\r\n\t\t\t\t+1, -1,\r\n\t\t\t\t-1, +1,\r\n\t\t\t\t-1, +1,\r\n\t\t\t\t+1, -1,\r\n\t\t\t\t+1, +1,\r\n\t\t\t]),\r\n\t\t\tgl.STATIC_DRAW\r\n\t\t);\r\n\r\n\t\tgl.bindTexture(gl.TEXTURE_2D, this.texture);\r\n\t\tgl.texImage2D(\r\n\t\t\tgl.TEXTURE_2D,\r\n\t\t\t0,\r\n\t\t\tgl.RGBA,\r\n\t\t\t8,\r\n\t\t\t8,\r\n\t\t\t0,\r\n\t\t\tgl.RGBA,\r\n\t\t\tgl.UNSIGNED_BYTE,\r\n\t\t\tnull,\r\n\t\t);\r\n\t}\r\n\r\n\tupdateResolution() {\r\n\t\tgl.bindTexture(gl.TEXTURE_2D, this.texture);\r\n\t\tgl.texImage2D(\r\n\t\t\tgl.TEXTURE_2D,\r\n\t\t\t0,\r\n\t\t\tgl.RGBA,\r\n\t\t\tinternalResolutionWidth,\r\n\t\t\tinternalResolutionHeight,\r\n\t\t\t0,\r\n\t\t\tgl.RGBA,\r\n\t\t\tgl.UNSIGNED_BYTE,\r\n\t\t\tnull,\r\n\t\t);\r\n\r\n\t\tgl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, this.filter);\r\n\t\tgl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, this.filter);\r\n\t\t\r\n\t\tgl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\r\n\t\tgl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\r\n\r\n\t\tgl.bindRenderbuffer(gl.RENDERBUFFER, this.depthBuffer);\r\n\t\tgl.renderbufferStorage(gl.RENDERBUFFER, gl.DEPTH_COMPONENT16, internalResolutionWidth, internalResolutionHeight);\r\n\r\n\t\tgl.bindFramebuffer(gl.FRAMEBUFFER, this.framebuffer);\r\n\t\tgl.framebufferTexture2D(\r\n\t\t\tgl.FRAMEBUFFER,\r\n\t\t\tgl.COLOR_ATTACHMENT0,\r\n\t\t\tgl.TEXTURE_2D,\r\n\t\t\tthis.texture,\r\n\t\t\t0,\r\n\t\t);\r\n\r\n\t\tgl.framebufferRenderbuffer(gl.FRAMEBUFFER, gl.DEPTH_ATTACHMENT, gl.RENDERBUFFER, this.depthBuffer);\r\n\t}\r\n\r\n\t/**\r\n\t * @param {number} filter\r\n\t */\r\n\tsetFilter(filter) {\r\n\t\tthis.filter = filter;\r\n\r\n\t\tgl.bindTexture(gl.TEXTURE_2D, this.texture);\r\n\r\n\t\tgl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, this.filter);\r\n\t\tgl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, this.filter);\r\n\t}\r\n\r\n\t/**\r\n\t * Binds the framebuffer as the target for subsequent draw calls.\r\n\t */\r\n\tbind() {\r\n\t\tgl.bindFramebuffer(gl.FRAMEBUFFER, this.framebuffer);\r\n\r\n\t\tgl.viewport(0, 0, internalResolutionWidth, internalResolutionHeight);\r\n\t}\r\n\r\n\tunbind() {\r\n\t\tgl.bindFramebuffer(gl.FRAMEBUFFER, null);\r\n\r\n\t\tlet scale = devicePixelRatio;\r\n\r\n\t\tgl.viewport(\r\n\t\t\tviewportOffsetX * scale,\r\n\t\t\tviewportOffsetY * scale,\r\n\t\t\tviewportWidth * scale,\r\n\t\t\tviewportHeight * scale,\r\n\t\t);\r\n\t}\r\n\r\n\t/**\r\n\t * Draws the framebuffer to the canvas.\r\n\t */\r\n\tdraw() {\r\n\t\tthis.unbind();\r\n\r\n\t\tshader.use();\r\n\r\n\t\tshader.setUniformTexture(\"tex\", this.texture, 0);\r\n\r\n\t\tlet vertAttr = shader.attributes.vertex;\r\n\r\n\t\tgl.bindBuffer(gl.ARRAY_BUFFER, this.quadBuffer);\r\n\t\tgl.vertexAttribPointer(\r\n\t\t\tvertAttr,\r\n\t\t\t2,\r\n\t\t\tgl.FLOAT,\r\n\t\t\tfalse,\r\n\t\t\t0,\r\n\t\t\t0,\r\n\t\t);\r\n\t\tgl.enableVertexAttribArray(vertAttr);\r\n\r\n\t\tgl.drawArrays(gl.TRIANGLES, 0, 6);\r\n\r\n\t\tgl.disableVertexAttribArray(vertAttr);\r\n\t}\r\n\r\n\tfree() {\r\n\t\tgl.deleteFramebuffer(this.framebuffer);\r\n\t\tgl.deleteBuffer(this.quadBuffer);\r\n\t\tgl.deleteTexture(this.texture);\r\n\t\tgl.deleteRenderbuffer(this.depthBuffer);\r\n\t}\r\n}\r\n\r\nexport let mainFramebuffer = new Framebuffer(gl.NEAREST);\r\n","import { gl } from \"./gl/gl.js\";\r\nimport { Texture } from \"./gl/texture.js\";\r\nimport { HEAPU8, Module } from \"./vm.js\";\r\nimport { SpriteBatcher } from \"./gl/sprite-batcher.js\";\r\nimport { httpGETImage } from \"./network/http.js\";\r\nimport { Color } from \"./color.js\";\r\nimport { internalResolutionWidth } from \"./layout.js\";\r\n\r\n// TODO: most of this file will end up in C eventually.\r\n\r\nlet FONT_BYTE_SIZE = 750;\r\nlet BITMAP_WIDTH = 96;\r\nlet BITMAP_HEIGHT = 72;\r\n\r\n/**\r\n * @type {Texture}\r\n */\r\nexport let SYSTEM_FONT;\r\n\r\n/**\r\n * @type {SpriteBatcher}\r\n */\r\nlet systemFontSpriteBatcher;\r\n\r\nexport async function initSystemFont() {\r\n\tlet ptr = Module.ccall(\"sock_font\", \"number\");\r\n\tlet url = URL.createObjectURL(new Blob([ HEAPU8().subarray(ptr, ptr + FONT_BYTE_SIZE) ], { type: \"image/gif\" }));\r\n\r\n\ttry {\r\n\t\tlet img = await httpGETImage(url);\r\n\r\n\t\tSYSTEM_FONT = new Texture(gl.NEAREST, gl.CLAMP_TO_EDGE);\r\n\t\tSYSTEM_FONT.load(img);\r\n\t} finally {\r\n\t\tURL.revokeObjectURL(url);\r\n\t}\r\n}\r\n\r\n/**\r\n * @param {Uint8Array|string} s\r\n * @param {number} cornerX\r\n * @param {number} cornerY\r\n * @param {Color|number} [color]\r\n */\r\nexport function systemFontDraw(s, cornerX, cornerY, color) {\r\n\tif (typeof s === \"string\") {\r\n\t\ts = new TextEncoder().encode(s);\r\n\t}\r\n\r\n\tlet colorInt = color == null ? 0xffffffff : (typeof color === \"number\" ? color : color.int);\r\n\r\n\tif (!systemFontSpriteBatcher) systemFontSpriteBatcher = new SpriteBatcher();\r\n\r\n\tsystemFontSpriteBatcher.begin(SYSTEM_FONT);\r\n\r\n\tlet dx = cornerX;\r\n\tlet dy = cornerY;\r\n\r\n\tfor (let i = 0; i < s.length; i++) {\r\n\t\tlet c = s[i];\r\n\r\n\t\tif (c == 9) {\r\n\t\t\t// Tab\r\n\t\t\tdx += 24;\r\n\t\t} else if (c === 10) {\r\n\t\t\t// Newline\r\n\t\t\tdx = cornerX;\r\n\t\t\tdy += 14;\r\n\t\t} else if (c == 13) {\r\n\t\t\t// Carriage return\r\n\t\t} else if (c == 32) {\r\n\t\t\t// Space\r\n\t\t\tdx += 6;\r\n\t\t} else {\r\n\t\t\t// Convert out of range characters to heart glyph\r\n\t\t\tif (c < 32 || c > 127) c = 127;\r\n\r\n\t\t\t// Draw the character!\r\n\t\t\tlet idx = c - 32;\r\n\t\t\tlet spx = (idx % 16) * 6;\r\n\t\t\tlet spy = Math.trunc(idx / 16) * 12;\r\n\t\r\n\t\t\tsystemFontSpriteBatcher.drawQuad(\r\n\t\t\t\tdx,     dy,\r\n\t\t\t\tdx + 6, dy + 12,\r\n\t\t\t\t0,\r\n\t\t\t\tspx / BITMAP_WIDTH, spy / BITMAP_HEIGHT,\r\n\t\t\t\t(spx + 6) / BITMAP_WIDTH, (spy + 12) / BITMAP_HEIGHT,\r\n\t\t\t\tcolorInt\r\n\t\t\t);\r\n\t\r\n\t\t\tdx += 6;\r\n\t\t}\r\n\t}\r\n\r\n\tsystemFontSpriteBatcher.end();\r\n\r\n\treturn dy;\r\n}\r\n","import { canvas } from \"../canvas.js\";\r\nimport { deviceIsMobile } from \"../device.js\";\r\nimport { addClassForeignStaticMethods } from \"../foreign.js\";\r\nimport { wrenGlFilterStringToNumber } from \"../gl/api.js\";\r\nimport { mainFramebuffer } from \"../gl/framebuffer.js\";\r\nimport { gl } from \"../gl/gl.js\";\r\nimport { createElement } from \"../html.js\";\r\nimport { layoutOptions, queueLayout, screenHeight, screenWidth } from \"../layout.js\";\r\nimport { systemFontDraw } from \"../system-font.js\";\r\nimport { callHandle_init_2, callHandle_update_0, callHandle_update_2 } from \"../vm-call-handles.js\";\r\nimport { getSlotBytes, wrenAbort, wrenCall, wrenEnsureSlots, wrenGetSlotBool, wrenGetSlotDouble, wrenGetSlotHandle, wrenGetSlotString, wrenGetSlotType, wrenGetVariable, wrenSetMapValue, wrenSetSlotBool, wrenSetSlotDouble, wrenSetSlotHandle, wrenSetSlotNewMap, wrenSetSlotNull, wrenSetSlotString } from \"../vm.js\";\r\n\r\n// Wren -> JS\r\n\r\nlet title = document.title;\r\n\r\nexport let fps = 60;\r\nexport let quitFromAPI = false;\r\nexport let gameIsReady = false;\r\n/** @type {Promise<any>} */\r\nexport let updatePromise = null;\r\n/** @type {(value: any) => void} */\r\nlet updatePromiseFunction = null;\r\nlet cursor = \"default\";\r\nlet printColor = 0xffffffff;\r\nlet wantFullscreen = false;\r\nlet gettingDOMFullscreen = false;\r\n/** @type {number} */\r\nlet argumentsMapHandle = null;\r\n\r\nexport function prepareUpdatePromise() {\r\n\treturn updatePromise = new Promise((resolve) => {\r\n\t\tupdatePromiseFunction = resolve;\r\n\t});\r\n}\r\n\r\nexport function gameBusyWithDOMFallback() {\r\n\treturn gettingDOMFullscreen;\r\n}\r\n\r\naddClassForeignStaticMethods(\"sock\", \"Game\", {\r\n\t\"title\"() {\r\n\t\twrenSetSlotString(0, title);\r\n\t},\r\n\t\"title=(_)\"() {\r\n\t\tif (wrenGetSlotType(1) !== 6) {\r\n\t\t\twrenAbort(\"title must be a String\");\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tdocument.title = title = wrenGetSlotString(1);\r\n\t},\r\n\t\"layoutChanged_(_,_,_,_,_)\"() {\r\n\t\tif (\r\n\t\t\twrenGetSlotType(1) !== 1\r\n\t\t\t||\r\n\t\t\twrenGetSlotType(2) !== 1\r\n\t\t\t||\r\n\t\t\twrenGetSlotType(3) !== 0\r\n\t\t\t||\r\n\t\t\twrenGetSlotType(4) !== 0\r\n\t\t\t||\r\n\t\t\twrenGetSlotType(5) !== 1\r\n\t\t) {\r\n\t\t\twrenAbort(\"invalid args\");\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tlet width = wrenGetSlotDouble(1);\r\n\t\tlet height = wrenGetSlotDouble(2);\r\n\t\tlet isFixed = wrenGetSlotBool(3);\r\n\t\tlet isPixelPerfect = wrenGetSlotBool(4);\r\n\t\tlet maxScale = wrenGetSlotDouble(5);\r\n\r\n\t\tif (width < 1 || height < 1 || maxScale < 1) {\r\n\t\t\twrenAbort(\"resolution/scale must be positive\");\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tlayoutOptions.pixelScaling = isPixelPerfect;\r\n\t\tlayoutOptions.resolution = isFixed ? [ Math.trunc(width), Math.trunc(height) ] : null;\r\n\t\tlayoutOptions.maxScale = Math.trunc(maxScale);\r\n\r\n\t\tqueueLayout();\r\n\t},\r\n\t\"scaleFilter\"() {\r\n\t\treturn mainFramebuffer.filter ? \"nearest\" : \"linear\";\r\n\t},\r\n\t\"scaleFilter=(_)\"() {\r\n\t\tlet filter = wrenGlFilterStringToNumber(1);\r\n\r\n\t\tif (filter != null) {\r\n\t\t\tmainFramebuffer.setFilter(filter);\r\n\t\t}\r\n\t},\r\n\t\"fullscreenAllowed\"() {\r\n\t\twrenSetSlotBool(0, document.fullscreenEnabled);\r\n\t},\r\n\t\"fullscreen\"() {\r\n\t\twrenSetSlotBool(0, wantFullscreen || document.fullscreenElement != null);\r\n\t},\r\n\t\"setFullscreen_(_)\"() {\r\n\t\tif (wrenGetSlotType(1) !== 0) {\r\n\t\t\twrenAbort(\"fullscreen must be a Bool\");\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tlet fullscreen = wrenGetSlotBool(1);\r\n\r\n\t\tif (fullscreen) {\r\n\t\t\tif (!wantFullscreen && !document.fullscreenElement) {\r\n\t\t\t\t// Check if the browser will even let us use fullscreen at all.\r\n\t\t\t\tif (!document.fullscreenEnabled) {\r\n\t\t\t\t\tconsole.warn(\"fullscreen is blocked by the browser, see Game.fullscreenAllowed\");\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Since fullscreen request may be async, track that we're going to trigger request.\r\n\t\t\t\twantFullscreen = true;\r\n\t\t\t\t\r\n\t\t\t\t// Request fullscreen.\r\n\t\t\t\t// Note that this may fail if the browser doesn't think this was triggered by a user interaction.\r\n\t\t\t\t// (e.g. Safari almost always thinks this, since we don't handle inputs directly within input callbacks)\r\n\t\t\t\tdocument.body.requestFullscreen().then(() => {\r\n\t\t\t\t\twantFullscreen = false;\r\n\t\t\t\t}, () => {\r\n\t\t\t\t\tgettingDOMFullscreen = true;\r\n\r\n\t\t\t\t\t// TODO this message needs to be localised.\r\n\t\t\t\t\tlet input = deviceIsMobile ? \"tap\" : \"press any mouse or keyboard button\";\r\n\t\t\t\t\tlet message = `Please ${input} to enter fullscreen.`;\r\n\r\n\t\t\t\t\tlet dialog = createElement(\"div\", { class: \"overlay\" }, [\r\n\t\t\t\t\t\tcreateElement(\"img\", { style: \"width: 185px; margin-bottom: 14px;\", class: \"pixel\", alt: \"icons of a mouse, keyboard, and fullscreen warning\", src: \"data:image/gif;base64,R0lGODdhJQAJAJAAAAAAAP///yH5BAkKAAAALAAAAAAlAAkAAAIzjB+ge2zrEFIJVHgxpJvW311Z6H2g1Wkph5rSuMFqY43ySrZenKOsGrP1gJGXMfQoIY0FADs=\" }),\r\n\t\t\t\t\t\tmessage,\r\n\t\t\t\t\t]);\r\n\r\n\t\t\t\t\t\r\n\t\t\t\t\tlet triggerFullscreen = () => {\r\n\t\t\t\t\t\tdocument.body.requestFullscreen().catch((error) => {\r\n\t\t\t\t\t\t\tconsole.warn(\"DOM fullscreen fallback failed\", error);\r\n\t\t\t\t\t\t}).then(() => {\r\n\t\t\t\t\t\t\twantFullscreen = false;\r\n\t\t\t\t\t\t\tgettingDOMFullscreen = false;\r\n\r\n\t\t\t\t\t\t\tdialog.remove();\r\n\r\n\t\t\t\t\t\t\tremoveEventListener(\"keydown\", triggerFullscreen);\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t\tdialog.onclick = triggerFullscreen;\r\n\t\t\t\t\taddEventListener(\"keydown\", triggerFullscreen);\r\n\r\n\t\t\t\t\tdocument.body.append(dialog);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\twantFullscreen = false;\r\n\t\t\tif (document.fullscreenElement) {\r\n\t\t\t\tdocument.exitFullscreen();\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\t\"fps\"() {\r\n\t\tif (fps < 0) {\r\n\t\t\twrenSetSlotNull(0);\r\n\t\t} else {\r\n\t\t\twrenSetSlotDouble(0, fps);\r\n\t\t}\r\n\t},\r\n\t\"fps=(_)\"() {\r\n\t\tlet type = wrenGetSlotType(1);\r\n\t\tif (type === 5) {\r\n\t\t\tfps = -1;\r\n\t\t} else if (type === 1) {\r\n\t\t\tlet value = wrenGetSlotDouble(1);\r\n\t\t\tif (fps <= 0) {\r\n\t\t\t\twrenAbort(\"fps must be positive\");\r\n\t\t\t} else {\r\n\t\t\t\tfps = value;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\twrenAbort(\"fps must be Num or null\");\r\n\t\t}\r\n\t},\r\n\t\"cursor\"() {\r\n\t\twrenSetSlotString(0, cursor);\r\n\t},\r\n\t\"cursor=(_)\"() {\r\n\t\tlet type = wrenGetSlotType(1);\r\n\t\tif (type === 5) {\r\n\t\t\tcursor = \"default\";\r\n\t\t} else if (type === 6) {\r\n\t\t\tlet name = wrenGetSlotString(1);\r\n\t\t\t\r\n\t\t\tif (!cursorSockToCSS.hasOwnProperty(name)) {\r\n\t\t\t\twrenAbort(`invalid cursor type \"${name}\"`);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tcursor = name;\r\n\t\t} else {\r\n\t\t\twrenAbort(\"cursor must be null or a string\");\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tcanvas.style.cursor = cursorSockToCSS[cursor] || cursor;\r\n\t},\r\n\t\"quit()\"() {\r\n\t\tquitFromAPI = true;\r\n\t},\r\n\t\"ready_()\"() {\r\n\t\tgameIsReady = true;\r\n\r\n\t\tif (updatePromiseFunction) {\r\n\t\t\tupdatePromiseFunction();\r\n\t\t\tupdatePromiseFunction = null;\r\n\t\t\tupdatePromise = null;\r\n\t\t}\r\n\t},\r\n\t\"print_(_,_,_)\"() {\r\n\t\tif (wrenGetSlotType(1) !== 6 || wrenGetSlotType(2) !== 1 || wrenGetSlotType(3) !== 1) {\r\n\t\t\twrenAbort(\"invalid args\");\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tlet bytes = getSlotBytes(1);\r\n\t\tlet x = Math.trunc(wrenGetSlotDouble(2));\r\n\t\tlet y = Math.trunc(wrenGetSlotDouble(3));\r\n\r\n\t\tlet resultY = systemFontDraw(bytes, x, y, printColor);\r\n\r\n\t\twrenSetSlotDouble(0, resultY);\r\n\t},\r\n\t\"setPrintColor_(_)\"() {\r\n\t\tif (wrenGetSlotType(1) !== 1) {\r\n\t\t\twrenAbort(\"color must be a Num\");\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tprintColor = wrenGetSlotDouble(1);\r\n\t},\r\n\t\"clear_(_,_,_)\"() {\r\n\t\tfor (let i = 1; i <= 3; i++) {\r\n\t\t\tif (wrenGetSlotType(i) !== 1) {\r\n\t\t\t\twrenAbort(\"colors must be numbers\");\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tlet r = wrenGetSlotDouble(1);\r\n\t\tlet g = wrenGetSlotDouble(2);\r\n\t\tlet b = wrenGetSlotDouble(3);\r\n\r\n\t\tgl.clearColor(r, g, b, 1);\r\n\t\tgl.clear(gl.COLOR_BUFFER_BIT);\r\n\t},\r\n\t\"openURL(_)\"() {\r\n\t\tif (wrenGetSlotType(1) !== 6) {\r\n\t\t\twrenAbort(\"url must be a string\");\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tlet url = wrenGetSlotString(1);\r\n\r\n\t\topen(url, \"_blank\", \"noreferrer\");\r\n\t},\r\n\t\"arguments\"() {\r\n\t\tif (argumentsMapHandle) {\r\n\t\t\twrenSetSlotHandle(0, argumentsMapHandle);\r\n\t\t} else {\r\n\t\t\twrenEnsureSlots(3);\r\n\t\t\twrenSetSlotNewMap(0);\r\n\r\n\t\t\tlet search = new URL(location.href).searchParams;\r\n\t\t\tsearch.forEach((value, key) => {\r\n\t\t\t\twrenSetSlotString(1, key);\r\n\t\t\t\twrenSetSlotString(2, value);\r\n\t\t\t\twrenSetMapValue(0, 1, 2);\r\n\t\t\t});\r\n\r\n\t\t\targumentsMapHandle = wrenGetSlotHandle(0);\r\n\t\t}\r\n\t},\r\n});\r\n\r\n/**\r\n * Mapping from Sock cursor name to CSS cursor name.\r\n * `\"\"` indicates a 1:1 mapping.\r\n * @type {Record<string, string>}\r\n */\r\nlet cursorSockToCSS = {\r\n\t\"default\": \"\",\r\n\t\"pointer\": \"\",\r\n\t\"wait\": \"progress\",\r\n\t\"hidden\": \"none\",\r\n};\r\n\r\n\r\n// JS -> Wren\r\n\r\nlet handle_Game = 0;\r\n\r\nexport function initGameModule() {\r\n\twrenEnsureSlots(1);\r\n\twrenGetVariable(\"sock\", \"Game\", 0);\r\n\thandle_Game = wrenGetSlotHandle(0);\r\n\r\n\tupdateGameModuleResolution(callHandle_init_2);\r\n}\r\n\r\n/**\r\n * @param {number} callHandle\r\n */\r\nfunction updateGameModuleResolution(callHandle) {\r\n\twrenEnsureSlots(3);\r\n\twrenSetSlotHandle(0, handle_Game);\r\n\twrenSetSlotDouble(1, screenWidth);\r\n\twrenSetSlotDouble(2, screenHeight);\r\n\twrenCall(callHandle || callHandle_update_2);\r\n}\r\n\r\nexport function gameUpdate() {\r\n\tgameIsReady = false;\r\n\t\r\n\twrenEnsureSlots(1);\r\n\twrenSetSlotHandle(0, handle_Game);\r\n\treturn wrenCall(callHandle_update_0);\r\n}\r\n","import { addClassForeignStaticMethods } from \"../foreign.js\";\r\nimport { wrenSetSlotDouble } from \"../vm.js\";\r\n\r\n\r\nlet refreshRate = 60;\r\n\r\n/**\r\n * @param {number} rate\r\n */\r\nexport function updateRefreshRate(rate) {\r\n\trefreshRate = rate;\r\n}\r\n\r\naddClassForeignStaticMethods(\"sock\", \"Screen\", {\r\n\t\"width\"() {\r\n\t\twrenSetSlotDouble(0, screen.width);\r\n\t},\r\n\t\"height\"() {\r\n\t\twrenSetSlotDouble(0, screen.height);\r\n\t},\r\n\t\"availableWidth\"() {\r\n\t\twrenSetSlotDouble(0, screen.availWidth);\r\n\t},\r\n\t\"availableHeight\"() {\r\n\t\twrenSetSlotDouble(0, screen.availHeight);\r\n\t},\r\n\t\"refreshRate\"() {\r\n\t\twrenSetSlotDouble(0, refreshRate);\r\n\t},\r\n});\r\n","import { getCameraMatrix } from \"../api/camera.js\";\r\nimport { sockJsGlobal } from \"../globals.js\";\r\nimport { gl } from \"./gl.js\";\r\nimport { PrimitiveBatcher } from \"./primitive-batcher.js\";\r\nimport { bindQuadIndexBuffer } from \"./quad-index-buffer.js\";\r\nimport { Shader } from \"./shader.js\";\r\n\r\nlet shader = new Shader({\r\n\tattributes: {\r\n\t\t\"vertex\": \"vec3\",\r\n\t\t\"color\": \"vec4\",\r\n\t},\r\n\tvaryings: {\r\n\t\t\"v_color\": \"lowp vec4\",\r\n\t},\r\n\tvertUniforms: {\r\n\t\t\"mat\": \"mat3\",\r\n\t},\r\n\tvert: [\r\n\t\t\"v_color = color;\",\r\n\t\t\"vec3 tv = mat * vec3(vertex.x, vertex.y, 1.0);\",\r\n\t\t\"gl_Position = vec4(tv.x, tv.y, vertex.z, 1.0);\",\r\n\t],\r\n\tfrag: \"gl_FragColor = v_color;\",\r\n});\r\n\r\nshader.needsCompilation();\r\n\r\n/**\r\n * Helper for quads in an efficient manner.\r\n */\r\nexport class QuadBatcher extends PrimitiveBatcher {\r\n\t/**\r\n\t * @param {number} x1\r\n\t * @param {number} y1\r\n\t * @param {number} x2\r\n\t * @param {number} y2\r\n\t * @param {number} z\r\n\t * @param {number} c\r\n\t * @param {number[]|null} [tf] A 2x3 transform matrix\r\n\t * @param {number[]|null} [tfo] A 2d transform origin\r\n\t */\r\n\tdrawRect(x1, y1, x2, y2, z, c, tf, tfo) {\r\n\t\tthis.drawQuad(\r\n\t\t\tx1, y1,\r\n\t\t\tx1, y2,\r\n\t\t\tx2, y1,\r\n\t\t\tx2, y2,\r\n\t\t\tz,\r\n\t\t\tc,\r\n\t\t\ttf, tfo\r\n\t\t);\r\n\t}\r\n\r\n\t/**\r\n\t * @param {number} x1\r\n\t * @param {number} y1\r\n\t * @param {number} x2\r\n\t * @param {number} y2\r\n\t * @param {number} x3\r\n\t * @param {number} y3\r\n\t * @param {number} x4\r\n\t * @param {number} y4\r\n\t * @param {number} z\r\n\t * @param {number} c\r\n\t * @param {number[]|null} [tf] A 2x3 transform matrix\r\n\t * @param {number[]|null} [tfo] A 2d transform origin\r\n\t */\r\n\tdrawQuad(x1, y1, x2, y2, x3, y3, x4, y4, z, c, tf, tfo) {\r\n\t\tthis.checkResize(4);\r\n\t\t\r\n\t\tif (tf) {\r\n\t\t\tlet tx1 = x1 * tf[0] + y1 * tf[2] + tf[4];\r\n\t\t\tlet ty1 = x1 * tf[1] + y1 * tf[3] + tf[5];\r\n\t\t\tlet tx2 = x2 * tf[0] + y2 * tf[2] + tf[4];\r\n\t\t\tlet ty2 = x2 * tf[1] + y2 * tf[3] + tf[5];\r\n\t\t\tlet tx3 = x3 * tf[0] + y3 * tf[2] + tf[4];\r\n\t\t\tlet ty3 = x3 * tf[1] + y3 * tf[3] + tf[5];\r\n\t\t\tlet tx4 = x4 * tf[0] + y4 * tf[2] + tf[4];\r\n\t\t\tlet ty4 = x4 * tf[1] + y4 * tf[3] + tf[5];\r\n\r\n\t\t\tlet tfox = tfo ? (x1 + tfo[0]) : ((x1 + x2) / 2);\r\n\t\t\tlet tfoy = tfo ? (y1 + tfo[1]) : ((y1 + y2) / 2);\r\n\t\t\tlet dx = tfox - tf[0] * tfox - tf[2] * tfoy;\r\n\t\t\tlet dy = tfoy - tf[1] * tfox - tf[3] * tfoy;\r\n\r\n\t\t\tthis.addVertex(tx1 + dx, ty1 + dy, z, c);\r\n\t\t\tthis.addVertex(tx2 + dx, ty2 + dy, z, c);\r\n\t\t\tthis.addVertex(tx3 + dx, ty3 + dy, z, c);\r\n\t\t\tthis.addVertex(tx4 + dx, ty4 + dy, z, c);\r\n\t\t} else {\r\n\t\t\tthis.addVertex(x1, y1, z, c);\r\n\t\t\tthis.addVertex(x2, y2, z, c);\r\n\t\t\tthis.addVertex(x3, y3, z, c);\r\n\t\t\tthis.addVertex(x4, y4, z, c);\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * @protected\r\n\t */\r\n\tdrawBatch() {\r\n\t\tif (this._vertexCount < 0) throw Error(\"have not called begin()\");\r\n\r\n\t\tif (this._vertexCount > 0) {\r\n\t\t\t// Draw!\r\n\t\t\tshader.use();\r\n\t\r\n\t\t\t// Put vertex data.\r\n\t\t\tgl.bindBuffer(gl.ARRAY_BUFFER, this._vertexBuffer);\r\n\r\n\t\t\tif (this._vertexCount > this._vertexBufferCapacity) {\r\n\t\t\t\t// Re-allocate vertex data.\r\n\t\t\t\tthis._vertexBufferCapacity = this._capacity;\r\n\t\t\t\tgl.bufferData(gl.ARRAY_BUFFER, this._array, gl.DYNAMIC_DRAW);\r\n\t\t\t} else {\r\n\t\t\t\t// Put in sub-data.\r\n\t\t\t\tgl.bufferSubData(gl.ARRAY_BUFFER, 0, this._ints.subarray(0, this._vertexCount * 6));\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// Configure/enable attributes.\r\n\t\t\tlet vertLocation = shader.attributes.vertex;\r\n\t\t\tlet colorlocation = shader.attributes.color;\r\n\r\n\t\t\tgl.vertexAttribPointer(\r\n\t\t\t\tvertLocation,\r\n\t\t\t\t3,\r\n\t\t\t\tgl.FLOAT,\r\n\t\t\t\tfalse,\r\n\t\t\t\t16,\r\n\t\t\t\t0,\r\n\t\t\t);\r\n\t\t\tgl.enableVertexAttribArray(vertLocation);\r\n\t\t\t\r\n\t\t\tgl.vertexAttribPointer(\r\n\t\t\t\tcolorlocation,\r\n\t\t\t\t4,\r\n\t\t\t\tgl.UNSIGNED_BYTE,\r\n\t\t\t\ttrue,\r\n\t\t\t\t16,\r\n\t\t\t\t12,\r\n\t\t\t);\r\n\t\t\tgl.enableVertexAttribArray(colorlocation);\r\n\r\n\t\t\t// Set shader matrix.\r\n\t\t\tshader.setUniformMatrix3(\"mat\", getCameraMatrix());\r\n\t\t\r\n\t\t\t// Setup index buffer.\r\n\t\t\tlet indexCount = this._vertexCount * 1.5;\r\n\t\t\t\r\n\t\t\tbindQuadIndexBuffer(indexCount);\r\n\r\n\t\t\tsockJsGlobal.quadInfo = `vertexCount=${this._vertexCount} indexCount=${indexCount}`\r\n\r\n\t\t\t// Draw!\r\n\t\t\tgl.drawElements(gl.TRIANGLES, indexCount, gl.UNSIGNED_SHORT, 0);\r\n\r\n\t\t\t// Clean up.\r\n\t\t\tgl.disableVertexAttribArray(vertLocation);\r\n\t\t\tgl.disableVertexAttribArray(colorlocation);\r\n\t\t}\r\n\r\n\t\t// Reset state.\r\n\t\tthis._vertexCount = -1;\r\n\t}\r\n}\r\n","import { Color } from \"../color.js\";\r\nimport { gl } from \"./gl.js\";\r\n\r\n/**\r\n * Batches primitive vertices (position + color) into a single growing `ArrayBuffer`.\r\n * @abstract\r\n */\r\nexport class PrimitiveBatcher {\r\n\tconstructor() {\r\n\t\t/**\r\n\t\t * Number of vertices we can fit.\r\n\t\t * @protected\r\n\t\t */\r\n\t\tthis._capacity = 128;\r\n\t\t/**\r\n\t\t * Vertex data array.\r\n\t\t * ```\r\n\t\t *  x     y     z     rgba  u     v\r\n\t\t * [----][----][----][----][----][----]\r\n\t\t * ```\r\n\t\t * @protected\r\n\t\t */\r\n\t\tthis._array = new ArrayBuffer(this._capacity * 16);\r\n\t\t/**\r\n\t\t * @protected\r\n\t\t */\r\n\t\tthis._floats = new Float32Array(this._array);\r\n\t\t/**\r\n\t\t * @protected\r\n\t\t */\r\n\t\tthis._bytes = new Uint8Array(this._array);\r\n\t\t/**\r\n\t\t * @protected\r\n\t\t */\r\n\t\tthis._ints = new Uint32Array(this._array);\r\n\t\t/**\r\n\t\t * @protected\r\n\t\t */\r\n\t\tthis._vertexCount = -1;\r\n\t\t/**\r\n\t\t * @protected\r\n\t\t */\r\n\t\tthis._vertexBuffer = gl.createBuffer();\r\n\t\t/**\r\n\t\t * The number of vertices we can fit in the vertex buffer.\r\n\t\t * @protected\r\n\t\t */\r\n\t\tthis._vertexBufferCapacity = 0;\r\n\t}\r\n\r\n\tfree() {\r\n\t\tgl.deleteBuffer(this._vertexBuffer);\r\n\t\tthis._array = this._bytes = this._floats = this._ints = null;\r\n\t}\r\n\t\r\n\t/**\r\n\t * @protected\r\n\t */\r\n\tdrawBatch() {\r\n\t}\r\n\r\n\t/**\r\n\t * @param {number} vertexCount\r\n\t * @protected\r\n\t */\r\n\tcheckResize(vertexCount) {\r\n\t\tif (this._vertexCount + vertexCount > this._capacity) {\r\n\t\t\tconsole.log(\"expand vertex buffer\");\r\n\r\n\t\t\t// Grow capacity.\r\n\t\t\tthis._capacity *= 2;\r\n\r\n\t\t\tif (this._capacity >= 0xfffff) throw Error(`exceeded max batch capacity of ${0xfffff}, did you forget to call end()?`);\r\n\r\n\t\t\t// Create new buffer.\r\n\t\t\tthis._array = new ArrayBuffer(this._capacity * 16);\r\n\r\n\t\t\t// Copy data from old buffer.\r\n\t\t\tlet newInts = new Uint32Array(this._array);\r\n\t\t\tnewInts.set(this._ints);\r\n\r\n\t\t\t// Create new views.\r\n\t\t\tthis._floats = new Float32Array(this._array);\r\n\t\t\tthis._bytes = new Uint8Array(this._array);\r\n\t\t\tthis._ints = newInts;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Add a single vertex.\r\n\t * @param {number} x\r\n\t * @param {number} y\r\n\t * @param {number} z\r\n\t * @param {number} color\r\n\t * @protected\r\n\t */\r\n\taddVertex(x, y, z, color) {\r\n\t\tlet i4 = this._vertexCount * 4;\r\n\r\n\t\tthis._floats[i4    ] = x;\r\n\t\tthis._floats[i4 + 1] = y;\r\n\t\tthis._floats[i4 + 2] = z;\r\n\r\n\t\tthis._ints[i4 + 3] = color;\r\n\r\n\t\tthis._vertexCount++;\r\n\t}\r\n\r\n\tinBatch() {\r\n\t\treturn this._vertexCount >= 0;\r\n\t}\r\n\r\n\tbegin() {\r\n\t\tif (this.inBatch()) throw Error(\"already called begin()\");\r\n\t\tthis._vertexCount = 0;\r\n\t}\r\n\r\n\tend() {\r\n\t\tif (!this.inBatch()) throw Error(\"not yet called begin()\");\r\n\r\n\t\tif (this._vertexCount > 0) {\r\n\t\t\tthis.drawBatch();\r\n\t\t}\r\n\r\n\t\tthis._vertexCount = -1;\r\n\t}\r\n}\r\n","import { addClassForeignStaticMethods } from \"../foreign.js\";\r\nimport { QuadBatcher } from \"../gl/quad-batcher.js\";\r\nimport { wrenAbort, wrenGetSlotDouble, wrenGetSlotType } from \"../vm.js\";\r\n\r\n/**\r\n * @type {QuadBatcher}\r\n */\r\nlet batcher = null;\r\n\r\naddClassForeignStaticMethods(\"sock\", \"Quad\", {\r\n\t\"beginBatch()\"() {\r\n\t\tif (!batcher) batcher = new QuadBatcher();\r\n\t\tif (batcher.inBatch()) {\r\n\t\t\twrenAbort(\"batch already started\");\r\n\t\t} else {\r\n\t\t\tbatcher.begin();\r\n\t\t}\r\n\t},\r\n\t\"endBatch()\"() {\r\n\t\tif (!batcher) batcher = new QuadBatcher();\r\n\t\tif (batcher.inBatch()) {\r\n\t\t\tbatcher.end();\r\n\t\t} else {\r\n\t\t\twrenAbort(\"batch not yet started\");\r\n\t\t}\r\n\t},\r\n\t\"draw(_,_,_,_,_)\"() {\r\n\t\tfor (let i = 1; i <= 5; i++) {\r\n\t\t\tif (wrenGetSlotType(i) !== 1) {\r\n\t\t\t\twrenAbort(\"args must be Nums\");\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tlet x = wrenGetSlotDouble(1);\r\n\t\tlet y = wrenGetSlotDouble(2);\r\n\t\tlet w = wrenGetSlotDouble(3);\r\n\t\tlet h = wrenGetSlotDouble(4);\r\n\t\tlet color = wrenGetSlotDouble(5);\r\n\r\n\t\tif (!batcher) batcher = new QuadBatcher();\r\n\r\n\t\tlet singleBatch = !batcher.inBatch();\r\n\r\n\t\tif (singleBatch) batcher.begin();\r\n\r\n\t\tbatcher.drawRect(x, y, x + w, y + h, 0, color);\r\n\r\n\t\tif (singleBatch) batcher.end();\r\n\t},\r\n\t\"draw(_,_,_,_,_,_,_,_,_)\"() {\r\n\t\tfor (let i = 1; i <= 9; i++) {\r\n\t\t\tif (wrenGetSlotType(i) !== 1) {\r\n\t\t\t\twrenAbort(\"args must be Nums\");\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tlet x1 = wrenGetSlotDouble(1);\r\n\t\tlet y1 = wrenGetSlotDouble(2);\r\n\t\tlet x2 = wrenGetSlotDouble(3);\r\n\t\tlet y2 = wrenGetSlotDouble(4);\r\n\t\tlet x3 = wrenGetSlotDouble(5);\r\n\t\tlet y3 = wrenGetSlotDouble(6);\r\n\t\tlet x4 = wrenGetSlotDouble(7);\r\n\t\tlet y4 = wrenGetSlotDouble(8);\r\n\t\tlet color = wrenGetSlotDouble(9);\r\n\r\n\t\tif (!batcher) batcher = new QuadBatcher();\r\n\r\n\t\tlet singleBatch = !batcher.inBatch();\r\n\r\n\t\tif (singleBatch) batcher.begin();\r\n\r\n\t\tbatcher.drawQuad(x1, y1, x2, y2, x4, y4, x3, y3, 0, color);\r\n\r\n\t\tif (singleBatch) batcher.end();\r\n\t},\r\n});\r\n","\r\n// The actual solution would be to use the KeyBoard API.\r\n// But this will never be supported by Firefox, and is not currently by Safari.\r\n//  https://mozilla.github.io/standards-positions/#keyboard-map\r\n\r\n// Out solution is to make guesses of common layouts based on\r\n// keyboard event code vs key differences.\r\n\r\nconst QWERTY = \"QWERTY\";\r\nconst QWERTZ = \"QWERTZ\";\r\nconst AZERTY = \"AZERTY\";\r\n\r\n/**\r\n * @type {\"QWERTY\" | \"QWERTZ\" | \"AZERTY\"}\r\n */\r\nexport let keyboardLayout = QWERTY;\r\n\r\n// Make a first guess on the layout based on language.\r\nlet lang = navigator.language || \"en-US\";\r\nif (lang.includes(\"fr\")) {\r\n\tkeyboardLayout = AZERTY;\r\n}\r\n\r\n// Update layout as we get more information from key presses.\r\nlet layoutChecks = 0;\r\n/**\r\n * @param {KeyboardEvent} event\r\n */\r\nlet onKeydown = (event) => {\r\n\tlet code = event.code;\r\n\tlet key = event.key.toLowerCase();\r\n\r\n\tif (code === \"KeyQ\") {\r\n\t\tlayoutChecks++;\r\n\r\n\t\tif (key === \"a\") {\r\n\t\t\tkeyboardLayout = AZERTY;\r\n\t\t\tconsole.log(\"layout is \" + keyboardLayout + \"?\");\r\n\t\t}\r\n\t} else if (code === \"KeyA\") {\r\n\t\tlayoutChecks++;\r\n\r\n\t\tif (key === \"q\") {\r\n\t\t\tkeyboardLayout = AZERTY;\r\n\t\t\tconsole.log(\"layout is \" + keyboardLayout + \"?\");\r\n\t\t}\r\n\t} else if (code === \"KeyW\") {\r\n\t\tlayoutChecks++;\r\n\r\n\t\tif (key === \"z\") {\r\n\t\t\tkeyboardLayout = AZERTY;\r\n\t\t\tconsole.log(\"layout is \" + keyboardLayout + \"?\");\r\n\t\t}\r\n\t} else if (code === \"KeyZ\") {\r\n\t\tlayoutChecks++;\r\n\r\n\t\tif (key === \"w\") {\r\n\t\t\tkeyboardLayout = AZERTY;\r\n\t\t\tconsole.log(\"layout is \" + keyboardLayout + \"?\");\r\n\t\t}\r\n\t} else if (code === \"KeyY\") {\r\n\t\tlayoutChecks++;\r\n\r\n\t\tif (key === \"z\") {\r\n\t\t\tkeyboardLayout = QWERTZ;\r\n\t\t\tconsole.log(\"layout is \" + keyboardLayout + \"?\");\r\n\t\t}\r\n\t} else if (code === \"KeyZ\") {\r\n\t\tlayoutChecks++;\r\n\r\n\t\tif (key === \"y\") {\r\n\t\t\tkeyboardLayout = QWERTZ;\r\n\t\t\tconsole.log(\"layout is \" + keyboardLayout + \"?\");\r\n\t\t}\r\n\t}\r\n\r\n\tif (layoutChecks >= 3) {\r\n\t\tremoveEventListener(\"keydown\", onKeydown);\r\n\t}\r\n};\r\n\r\naddEventListener(\"keydown\", onKeydown, { passive: true });\r\n","import { canvas } from \"../canvas.js\";\r\nimport { deviceIsMobile } from \"../device.js\";\r\nimport { addClassForeignStaticMethods } from \"../foreign.js\";\r\nimport { createElement } from \"../html.js\";\r\nimport { keyboardLayout } from \"../keyboard-layout.js\";\r\nimport { releaseLayoutContainer, useLayoutContainer, viewportOffsetX, viewportOffsetY, viewportScale } from \"../layout.js\";\r\nimport { callHandle_updateMouse_3, callHandle_updateTouch_5, callHandle_update_2 } from \"../vm-call-handles.js\";\r\nimport { wrenAbort, wrenCall, wrenEnsureSlots, wrenGetSlotHandle, wrenGetSlotString, wrenGetSlotType, wrenGetVariable, wrenSetSlotBool, wrenSetSlotDouble, wrenSetSlotHandle, wrenSetSlotNull, wrenSetSlotRange, wrenSetSlotString } from \"../vm.js\";\r\n\r\nlet textInput = createElement(\"input\");\r\nlet textForm = createElement(\"form\", {}, [\r\n\ttextInput,\r\n\t// createElement(\"button\", { type: \"button\" }, \"Submit\"),\r\n]);\r\ntextInput.placeholder = \"Text\";\r\n\r\nfunction removeTextInput() {\r\n\tif (textForm.parentNode) {\r\n\t\ttextForm.remove();\r\n\t\treleaseLayoutContainer();\r\n\t}\r\n}\r\n\r\n// Stop text input when user presses \"enter\".\r\n// The form submission method is preffered over listening for \"enter\" key,\r\n// as IMEs may fire \"enter\" when composition ends.\r\n/**\r\n * @param {Event} event \r\n */\r\ntextForm.onsubmit = (event) => {\r\n\tevent.preventDefault();\r\n\t\r\n\tremoveTextInput();\r\n};\r\n\r\n// Stop text input when unfocussed.\r\ntextInput.onblur = () => {\r\n\t// Need to use setTimeout() to prevent weird timing issues\r\n\t// related to removing elements during onblur.\r\n\tsetTimeout(() => {\r\n\t\tif (document.activeElement !== textInput) {\r\n\t\t\tremoveTextInput();\r\n\t\t}\r\n\t}, 1);\r\n};\r\n\r\n// Stop text input when user presses escape.\r\n/**\r\n * @param {KeyboardEvent} event \r\n */\r\ntextInput.onkeydown = (event) => {\r\n\tif (event.code === \"Escape\") {\r\n\t\tremoveTextInput();\r\n\t}\r\n};\r\n\r\naddClassForeignStaticMethods(\"sock\", \"Input\", {\r\n\t\"localize(_)\"() {\r\n\t\tlet idType = wrenGetSlotType(1);\r\n\t\tif (idType === 5) {\r\n\t\t\twrenSetSlotNull(0);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (idType !== 6) {\r\n\t\t\twrenAbort(\"input ID must be a String\");\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tlet id = wrenGetSlotString(1);\r\n\r\n\t\tif (keyboardLayout === \"AZERTY\") {\r\n\t\t\tif (id === \"Q\") {\r\n\t\t\t\tid = \"A\";\r\n\t\t\t} else if (id === \"A\") {\r\n\t\t\t\tid = \"Q\";\r\n\t\t\t} else if (id === \"Z\") {\r\n\t\t\t\tid = \"W\";\r\n\t\t\t} else if (id === \"W\") {\r\n\t\t\t\tid = \"Z\";\r\n\t\t\t} else if (id === \"M\") {\r\n\t\t\t\tid = \",\";\r\n\t\t\t} else if (id === \",\") {\r\n\t\t\t\tid = \";\";\r\n\t\t\t} else if (id === \";\") {\r\n\t\t\t\tid = \"M\";\r\n\t\t\t}\r\n\t\t} else if (keyboardLayout === \"QWERTZ\") {\r\n\t\t\tif (id === \"Z\") {\r\n\t\t\t\tid = \"Y\";\r\n\t\t\t} else if (id === \"Y\") {\r\n\t\t\t\tid = \"Z\";\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\twrenSetSlotString(0, id);\r\n\t},\r\n\t\"textBegin(_)\"() {\r\n\t\tlet argType = wrenGetSlotType(1);\r\n\t\tif (argType === 5) {\r\n\t\t\ttextInput.type = \"text\";\r\n\t\t} else if (argType === 6) {\r\n\t\t\tlet type = wrenGetSlotString(1);\r\n\r\n\t\t\tif (type === \"text\" || type === \"number\" || type === \"password\") {\r\n\t\t\t\ttextInput.type = type;\r\n\t\t\t} else {\r\n\t\t\t\twrenAbort(`invalid text type '${type}'`);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\twrenAbort(\"type must be a String\");\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\ttextForm.className = \"text-form invisible\";\r\n\r\n\t\ttextInput.className = \"text\";\r\n\t\ttextInput.value = \"\";\r\n\r\n\t\tif (!textForm.parentNode) {\r\n\t\t\tuseLayoutContainer().append(textForm);\r\n\t\t}\r\n\r\n\t\tif (!deviceIsMobile) {\r\n\t\t\ttextInput.focus();\r\n\r\n\t\t\tif (document.activeElement === textInput) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// Visible text input fallback. Used for:\r\n\t\t// * Mobile\r\n\t\t// * if browser blocks .focus() (due to being outside event handler)\r\n\t\ttextForm.className = \"text-form\";\r\n\t\ttextForm.onclick = (event) => {\r\n\t\t\tif (event.target === textForm) {\r\n\t\t\t\tremoveTextInput();\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\ttextInput.className = \"text\";\r\n\t},\r\n\t\"textDescription\"() {\r\n\t\twrenSetSlotString(0, textInput.placeholder);\r\n\t},\r\n\t\"textDescription=(_)\"() {\r\n\t\tif (wrenGetSlotType(1) !== 6) {\r\n\t\t\twrenAbort(\"description must be String\");\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\ttextInput.placeholder = wrenGetSlotString(1);\r\n\t},\r\n\t\"textIsActive\"() {\r\n\t\twrenSetSlotBool(0, document.activeElement === textInput);\r\n\t},\r\n\t\"textSelection\"() {\r\n\t\tif (document.activeElement === textInput) {\r\n\t\t\tlet start = textInput.selectionStart;\r\n\t\t\tlet end = textInput.selectionEnd;\r\n\r\n\t\t\tif (textInput.selectionDirection === \"backward\") {\r\n\t\t\t\tlet tmp = start;\r\n\t\t\t\tstart = end;\r\n\t\t\t\tend = tmp;\r\n\t\t\t}\r\n\r\n\t\t\twrenSetSlotRange(0, start, end, 1, true);\r\n\t\t} else {\r\n\t\t\twrenSetSlotRange(0, 0, 0, 1, true);\r\n\t\t}\r\n\t},\r\n\t\"textString\"() {\r\n\t\twrenSetSlotString(0, textInput.value);\r\n\t},\r\n})\r\n\r\nlet handle_Input = 0;\r\n\r\n/**\r\n * @type {Set<string>}\r\n */\r\nlet queuedInputs = new Set();\r\n\r\n/**\r\n * Record the current and previous value for each input: `[curr, prev, frame]`.\r\n * @type {Record<string, number>}\r\n */\r\nlet inputTable = Object.create(null);\r\n\r\nlet mouseX = 0, mouseY = 0, mouseExactX = 0, mouseExactY = 0, mouseRawX = 0, mouseRawY = 0, mouseWheel = 0;\r\n\r\nexport function initInputModule() {\r\n\twrenEnsureSlots(1);\r\n\twrenGetVariable(\"sock\", \"Input\", 0);\r\n\thandle_Input = wrenGetSlotHandle(0);\r\n\r\n\t// Pass in initial mouse state.\r\n\trecalculateAndUpdateMousePosition();\r\n}\r\n\r\nexport function recalculateAndUpdateMousePosition() {\r\n\trecalculateMousePosition();\r\n\ttransferCurrentMousePosition();\r\n}\r\n\r\nfunction transferCurrentMousePosition() {\r\n\twrenEnsureSlots(4);\r\n\twrenSetSlotHandle(0, handle_Input);\r\n\twrenSetSlotDouble(1, mouseX);\r\n\twrenSetSlotDouble(2, mouseY);\r\n\twrenSetSlotDouble(3, mouseWheel);\r\n\twrenCall(callHandle_updateMouse_3);\r\n}\r\n\r\nexport function updateInputModule() {\r\n\t// Read gamepads.\r\n\t// May not be available, requires HTTPS.\r\n\tif (navigator.getGamepads) {\r\n\t\tfor (let gp of navigator.getGamepads()) {\r\n\t\t\tif (gp != null) {\r\n\t\t\t\tlet buttons = gp.buttons;\r\n\t\t\t\tlet axes = gp.axes;\r\n\t\r\n\t\t\t\tupdateInputValue(\"FaceDown\", buttons[0].value);\r\n\t\t\t\tupdateInputValue(\"FaceRight\", buttons[1].value);\r\n\t\t\t\tupdateInputValue(\"FaceLeft\", buttons[2].value);\r\n\t\t\t\tupdateInputValue(\"FaceUp\", buttons[3].value);\r\n\t\t\t\tupdateInputValue(\"LeftBumper\", buttons[4].value);\r\n\t\t\t\tupdateInputValue(\"RightBumper\", buttons[5].value);\r\n\t\t\t\tupdateInputValue(\"LeftTrigger\", buttons[6].value);\r\n\t\t\t\tupdateInputValue(\"RightTrigger\", buttons[7].value);\r\n\t\t\t\tupdateInputValue(\"Select\", buttons[8].value);\r\n\t\t\t\tupdateInputValue(\"Start\", buttons[9].value);\r\n\t\t\t\tupdateInputValue(\"LeftStick\", buttons[10].value);\r\n\t\t\t\tupdateInputValue(\"RightStick\", buttons[11].value);\r\n\t\t\t\tupdateInputValue(\"DPadUp\", buttons[12].value);\r\n\t\t\t\tupdateInputValue(\"DPadDown\", buttons[13].value);\r\n\t\t\t\tupdateInputValue(\"DPadLeft\", buttons[14].value);\r\n\t\t\t\tupdateInputValue(\"DPadRight\", buttons[15].value);\r\n\t\t\t\tupdateInputValue(\"Guide\", buttons[16].value);\r\n\t\r\n\t\t\t\tupdateInputValue1D(\"LeftStickLeft\", \"LeftStickRight\", axes[0]);\r\n\t\t\t\tupdateInputValue1D(\"LeftStickUp\", \"LeftStickDown\", axes[1]);\r\n\t\t\t\tupdateInputValue1D(\"RightStickLeft\", \"RightStickRight\", axes[2]);\r\n\t\t\t\tupdateInputValue1D(\"RightStickUp\", \"RightStickDown\", axes[3]);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t// Pass state changes to Wren.\r\n\t// Mouse\r\n\ttransferCurrentMousePosition();\r\n\r\n\t// Inputs\r\n\tfor (let inputID of queuedInputs) {\r\n\t\twrenEnsureSlots(3);\r\n\t\twrenSetSlotHandle(0, handle_Input);\r\n\t\twrenSetSlotString(1, inputID);\r\n\t\twrenSetSlotDouble(2, inputTable[inputID]);\r\n\t\twrenCall(callHandle_update_2);\r\n\t}\r\n\r\n\tqueuedInputs.clear();\r\n\tmouseWheel = 0;\r\n}\r\n\r\n/**\r\n * @param {string} name\r\n * @param {number} value 0..1\r\n */\r\nfunction updateInputValue(name, value) {\r\n\tif (value !== inputTable[name]) {\r\n\t\tinputTable[name] = value;\r\n\t\tqueuedInputs.add(name);\r\n\t}\r\n}\r\n\r\n/**\r\n * @param {string} nameNegative\r\n * @param {string} namePositive\r\n * @param {number} value -1..1\r\n */\r\nfunction updateInputValue1D(nameNegative, namePositive, value) {\r\n\tupdateInputValue(nameNegative, value < 0 ? -value : 0);\r\n\tupdateInputValue(namePositive, value > 0 ?  value : 0);\r\n}\r\n\r\n/**\r\n * @param {string} name\r\n * @param {number} value 0..1\r\n */\r\nfunction updateInputValueWithNativeName(name, value) {\r\n\tupdateInputValue(INPUT_NAME_MAP[name] || name, value);\r\n}\r\n\r\n\r\n/**\r\n * One-to-one mapping from InputID to native input name.\r\n * @type {Record<string, string>}\r\n */\r\nconst INPUT_NAME_MAP = Object.assign(Object.create(null), {\r\n\t\"Backquote\": \"`\",\r\n\t\"Minus\": \"-\",\r\n\t\"Equal\": \"=\",\r\n\t\"Comma\": \",\",\r\n\t\"Period\": \".\",\r\n\t\"Slash\": \"/\",\r\n\t\"Semicolon\": \";\",\r\n\t\"Quote\": \"'\",\r\n\t\"BracketLeft\": \"[\",\r\n\t\"BracketRight\": \"]\",\r\n\t\"Backslash\": \"\\\\\",\r\n});\r\n\r\nfor (let i = 0; i <= 25; i++) {\r\n\tlet letter = String.fromCharCode(65 + i);\r\n\tINPUT_NAME_MAP[\"Key\" + letter] = letter;\r\n}\r\n\r\nfor (let i = 0; i <= 9; i++) {\r\n\tINPUT_NAME_MAP[\"Digit\" + i] = String(i);\r\n}\r\n\r\n\r\n// === GLOBAL EVENT LISTENERS ===\r\n\r\naddEventListener(\"keydown\", (event) => {\r\n\tif (event.repeat) return;\r\n\tupdateInputValueWithNativeName(event.code, 1);\r\n}, { passive: true });\r\n\r\naddEventListener(\"keyup\", (event) => {\r\n\tupdateInputValueWithNativeName(event.code, 0);\r\n}, { passive: true });\r\n\r\naddEventListener(\"mousemove\", (event) => {\r\n\tupdateMousePosition(event.x, event.y);\r\n});\r\n\r\naddEventListener(\"wheel\", (event) => {\r\n\tevent.preventDefault();\r\n\tevent.stopPropagation();\r\n\tmouseWheel += event.deltaY;\r\n\tupdateInputValue1D(\"MouseWheelUp\", \"MouseWheelDown\", Math.sign(event.deltaY));\r\n}, { passive: false });\r\n\r\naddEventListener(\"mousedown\", (event) => {\r\n\tupdateMouseButton(event.button, 1);\r\n});\r\n\r\naddEventListener(\"mouseup\", (event) => {\r\n\tupdateMouseButton(event.button, 0);\r\n});\r\n\r\ncanvas.addEventListener(\"contextmenu\", (event) => {\r\n\tevent.preventDefault();\r\n});\r\n\r\ncanvas.addEventListener(\"touchstart\", (event) => {\r\n\tevent.preventDefault();\r\n\r\n\tupdateTouches(event.changedTouches, true);\r\n\r\n\t// Emulate mouse with touch.\r\n\tif (event.changedTouches.length === event.touches.length) {\r\n\t\tlet touch = event.changedTouches[0];\r\n\t\tupdateInputValue(\"MouseLeft\", 1);\r\n\t\tupdateMousePosition(touch.clientX, touch.clientY);\r\n\t}\r\n}, { passive: false });\r\n\r\ncanvas.addEventListener(\"touchmove\", (event) => {\r\n\tevent.preventDefault();\r\n\r\n\tupdateTouches(event.changedTouches, true);\r\n\r\n\t// Emulate mouse with touch.\r\n\tlet touch = event.changedTouches[0];\r\n\tupdateMousePosition(touch.clientX, touch.clientY);\r\n}, { passive: false });\r\n\r\ncanvas.addEventListener(\"touchend\", (event) => {\r\n\tevent.preventDefault();\r\n\r\n\tupdateTouches(event.changedTouches, false);\r\n\r\n\t// Emulate mouse with touch.\r\n\tif (event.touches.length === 0) {\r\n\t\tupdateInputValue(\"MouseLeft\", 0);\r\n\t}\r\n}, { passive: false });\r\n\r\n/**\r\n * \r\n * @param {TouchList} touches\r\n * @param {boolean} isDown\r\n */\r\nfunction updateTouches(touches, isDown) {\r\n\tfor (let i = 0; i < touches.length; i++) {\r\n\t\tlet touch = touches[i];\r\n\r\n\t\tlet id = touch.identifier;\r\n\t\tlet x = (touch.clientX - viewportOffsetX) / viewportScale;\r\n\t\tlet y = (touch.clientY - viewportOffsetY) / viewportScale;\r\n\t\tlet force = touch.force;\r\n\t\tif (force === 0) force = (isDown ? 1 : 0);\r\n\r\n\t\twrenEnsureSlots(6);\r\n\t\twrenSetSlotHandle(0, handle_Input);\r\n\t\twrenSetSlotDouble(1, id);\r\n\t\twrenSetSlotBool(2, isDown);\r\n\t\twrenSetSlotDouble(3, force);\r\n\t\twrenSetSlotDouble(4, x);\r\n\t\twrenSetSlotDouble(5, y);\r\n\t\twrenCall(callHandle_updateTouch_5);\r\n\t}\r\n}\r\n\r\n/**\r\n * @param {number} x\r\n * @param {number} y\r\n */\r\nfunction updateMousePosition(x, y) {\r\n\tmouseRawX = x;\r\n\tmouseRawY = y;\r\n\trecalculateMousePosition();\r\n}\r\n\r\nfunction recalculateMousePosition() {\r\n\tmouseExactX = (mouseRawX - viewportOffsetX) / viewportScale;\r\n\tmouseExactY = (mouseRawY - viewportOffsetY) / viewportScale;\r\n\tmouseX = Math.floor(mouseExactX);\r\n\tmouseY = Math.floor(mouseExactY);\r\n}\r\n\r\n/**\r\n * @param {number} button\r\n * @param {number} value\r\n */\r\nfunction updateMouseButton(button, value) {\r\n\tlet name;\r\n\tif (button === 0) { name = \"Left\"; }\r\n\telse if (button === 1) { name = \"Middle\"; }\r\n\telse if (button === 2) { name = \"Right\"; }\r\n\tupdateInputValue(\"Mouse\" + (name || button), value);\r\n}\r\n\r\naddEventListener(\"gamepadconnected\", (event) => {\r\n\t// Need to add this event listener for `navigator.getGamepads()` to work.\r\n\tconsole.info(\"Gamepad: \" + event.gamepad.id);\r\n});\r\n\r\n","\r\n/**\r\n * @param {string} s\r\n * @returns {any}\r\n */\r\nexport function wrenJSONToJS(s) {\r\n\treturn JSON.parse(s, (key, value) => {\r\n\t\tif (Array.isArray(value) && value.length === 2 && typeof value[0] === \"string\" && value[0][0] === \"»\") {\r\n\t\t\tlet type = value[0].slice(1);\r\n\t\t\tvalue = value[1];\r\n\r\n\t\t\tif (type === \"Num\") {\r\n\t\t\t\tif (value === \"infinity\") return Infinity;\r\n\t\t\t\tif (value === \"nan\") return NaN;\r\n\t\t\t\treturn Number(value);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif (type === \"Range\") {\r\n\t\t\t\treturn {\r\n\t\t\t\t\tfrom: value[0],\r\n\t\t\t\t\tto: value[1],\r\n\t\t\t\t\tstep: value[2],\r\n\t\t\t\t\tisInclusive: value[3],\r\n\t\t\t\t};\r\n\t\t\t}\r\n\r\n\t\t\tif (type === \"Map\") {\r\n\t\t\t\tlet map = new Map();\r\n\t\t\t\tfor (let i = 1; i < value.length; i += 2) {\r\n\t\t\t\t\tmap.set(value[i - 1], value[i]);\r\n\t\t\t\t}\r\n\t\t\t\treturn map;\r\n\t\t\t}\r\n\r\n\t\t\tif (type === \"Vec\") {\r\n\t\t\t\treturn { x: value[0], y: value[1] };\r\n\t\t\t}\r\n\r\n\t\t\tif (type === \"Color\") {\r\n\t\t\t\tlet u8 = new Uint8Array(new Uint32Array([ value ]).buffer);\r\n\t\t\t\treturn { r: u8[0], g: u8[1], b: u8[2], a: u8[3] };\r\n\t\t\t}\r\n\r\n\t\t\tif (type === \"Buffer\") {\r\n\t\t\t\tlet b = atob(value);\r\n\t\t\t\tlet array = new Uint8Array(b.length);\r\n\t\t\t\tfor (let i = 0; i < b.length; i++) array[i] = b.charCodeAt(i);\r\n\t\t\t\treturn array;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// console.warn(`unhandled type \"${type}\"`);\r\n\t\t}\r\n\r\n\t\treturn value;\r\n\t});\r\n}\r\n\r\n/**\r\n * Converts Sock Wren JSON object to JavaScript, in place.\r\n * @param {any} obj\r\n * @returns {any}\r\n */\r\nfunction wrenObjectToJS(obj) {\r\n\tif (Array.isArray(obj)) {\r\n\t\t// Handle custom serialization.\r\n\t\tif (obj.length === 2 && typeof obj[0] === \"string\" && obj[0][0] === \"»\") {\r\n\t\t\tlet type = obj[0].slice(1);\r\n\t\t\tobj = obj[1];\r\n\r\n\t\t\tif (type === \"Vec\") {\r\n\t\t\t\treturn { x: obj[0], y: obj[1] };\r\n\t\t\t}\r\n\t\t\tif (type === \"Color\") {\r\n\t\t\t\tlet u8 = new Uint8Array(new Uint32Array([ obj ]).buffer);\r\n\t\t\t\treturn { r: u8[0] / 255, g: u8[1] / 255, b: u8[2] / 255, a: u8[3] / 255 };\r\n\t\t\t}\r\n\t\t\tif (type === \"Buffer\") {\r\n\t\t\t\tlet s = atob(obj);\r\n\t\t\t\tlet array = new Uint8Array(s.length);\r\n\t\t\t\tfor (let i = 0; i < s.length; i++) array[i] = s.charCodeAt(i);\r\n\t\t\t\treturn array;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tfor (let i = 0; i < obj.length; i++) {\r\n\t\t\t\tobj[i] = wrenObjectToJS(obj[i]);\r\n\t\t\t}\r\n\t\t}\r\n\t} else if (Object.getPrototypeOf(obj) === Object.prototype) {\r\n\t\tfor (let k in obj) {\r\n\t\t\tobj[k] = wrenObjectToJS(obj[k]);\r\n\t\t}\r\n\t}\r\n\r\n\treturn obj;\r\n}\r\n\r\n\r\n/**\r\n * Create copy of JS object that matches Sock Wren JSON spec.\r\n * @param {any} obj\r\n * @returns {string}\r\n */\r\nexport function jsToWrenJSON(obj) {\r\n\treturn JSON.stringify(jsToWrenObject(obj));\r\n}\r\n\r\n/**\r\n * @param {any} obj\r\n * @returns {any}\r\n */\r\nfunction jsToWrenObject(obj) {\r\n\tif (obj == null) {\r\n\t\treturn null;\r\n\t}\r\n\r\n\tif (typeof obj === \"number\" || typeof obj === \"string\" || typeof obj === \"boolean\") {\r\n\t\treturn obj;\r\n\t}\r\n\r\n\tif (Array.isArray(obj)) {\r\n\t\treturn obj.map(child => jsToWrenObject(child));\r\n\t}\r\n\r\n\tif (Object.getPrototypeOf(obj) === Object.prototype) {\r\n\t\tlet result = {};\r\n\t\tfor (let k in obj) {\r\n\t\t\tresult[k] = jsToWrenObject(obj[k]);\r\n\t\t}\r\n\t\treturn result;\r\n\t}\r\n\r\n\tif (obj instanceof Uint8Array || obj instanceof Uint8ClampedArray) {\r\n\t\tlet s = \"\";\r\n\t\tfor (let i = 0; i < obj.length; i++) {\r\n\t\t\ts += String.fromCharCode(obj[i]);\r\n\t\t}\r\n\t\treturn [ \"»Array\", btoa(s) ];\r\n\t}\r\n\r\n\treturn null;\r\n}\r\n","import { addClassForeignStaticMethods } from \"../foreign.js\";\r\nimport { jsToWrenJSON, wrenJSONToJS } from \"../json.js\";\r\nimport { wrenAbort, wrenGetSlotHandle, wrenGetSlotIsInstanceOf, wrenGetSlotString, wrenGetSlotType, wrenSetSlotHandle, wrenSetSlotString } from \"../vm.js\";\r\nimport { handle_Promise, resolveWrenPromise } from \"./promise.js\";\r\n\r\naddClassForeignStaticMethods(\"sock\", \"JavaScript\", {\r\n\t// eval_(promise, argValuesJSON, argNamesJSON, jsScript)\r\n\t\"eval_(_,_,_,_)\"() {\r\n\t\t// Get JavaScript source.\r\n\t\tif (wrenGetSlotType(4) !== 6) {\r\n\t\t\twrenAbort(\"script must be a string\");\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tlet source = wrenGetSlotString(4);\r\n\r\n\t\t// Get arg names and values.\r\n\t\tlet argValues = getJSONFromSlot(2);\r\n\t\tif (!argValues) return;\r\n\r\n\t\tlet argNames = getJSONFromSlot(3);\r\n\t\tif (!argNames) return;\r\n\r\n\t\tif (!isStringArray(argNames) || !Array.isArray(argValues)) {\r\n\t\t\twrenAbort(\"arg values and names must be Lists, arg names must be a String List\");\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (argNames.length !== argValues.length) {\r\n\t\t\twrenAbort(\"arg names and values must have same length\");\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t// Get promise.\r\n\t\tlet arg1Type = wrenGetSlotType(1);\r\n\t\tlet promise;\r\n\t\tif (arg1Type === 5) {\r\n\t\t\tpromise = null;\r\n\t\t} else {\r\n\t\t\twrenSetSlotHandle(2, handle_Promise);\r\n\r\n\t\t\tif (!wrenGetSlotIsInstanceOf(1, 2)) {\r\n\t\t\t\twrenAbort(\"first arg must be null or Promise\");\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tpromise = wrenGetSlotHandle(1);\r\n\t\t}\r\n\r\n\t\tlet isSync = promise == null;\r\n\r\n\t\t// Compile and execute function.\r\n\t\tlet fnArgs = argNames.concat(source);\r\n\r\n\t\tlet result;\r\n\t\ttry {\r\n\t\t\tlet fn = isSync ? new Function(...fnArgs) : new AsyncFunction(...fnArgs);\r\n\r\n\t\t\tresult = fn.apply(null, argValues);\r\n\t\t} catch (error) {\r\n\t\t\twrenAbort(\"JavaScript error: \" + error);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t// Return result.\r\n\t\tif (isSync) {\r\n\t\t\twrenSetSlotString(0, jsToWrenJSON(result));\r\n\t\t} else {\r\n\t\t\tresolveWrenPromise(promise, result.then(value => jsToWrenJSON(value)));\r\n\r\n\t\t\twrenSetSlotHandle(0, promise);\r\n\t\t}\r\n\t}\r\n});\r\n\r\n/**\r\n * @param {number} slot\r\n */\r\nfunction getJSONFromSlot(slot) {\r\n\tlet type = wrenGetSlotType(slot);\r\n\tif (type === 5) {\r\n\t\treturn [];\r\n\t} else if (type === 6) {\r\n\t\treturn wrenJSONToJS(wrenGetSlotString(slot));\r\n\t} else {\r\n\t\twrenAbort(\"expected string or null for JS args\");\r\n\t\treturn false;\r\n\t}\r\n}\r\n\r\n/**\r\n * @param {any} xs\r\n * @returns {xs is string[]}\r\n */\r\nfunction isStringArray(xs) {\r\n\treturn Array.isArray(xs) && xs.every(x => typeof x === \"string\");\r\n}\r\n\r\nlet AsyncFunction = Object.getPrototypeOf(async function(){}).constructor;\r\n","import { deviceBrowser, deviceOS } from \"../device.js\";\r\nimport { addClassForeignStaticMethods } from \"../foreign.js\";\r\nimport { wrenSetSlotString } from \"../vm.js\";\r\n\r\naddClassForeignStaticMethods(\"sock\", \"Platform\", {\r\n\t\"os\"() {\r\n\t\twrenSetSlotString(0, deviceOS);\r\n\t},\r\n\t\"browser\"() {\r\n\t\twrenSetSlotString(0, deviceBrowser);\r\n\t},\r\n});\r\n","import { createElement } from \"./html.js\";\r\nimport { wrenErrorMessage, wrenErrorStack, wrenErrorString } from \"./vm.js\";\r\n\r\n/**\r\n * @param {any} error\r\n */\r\nexport function showError(error) {\r\n\tconsole.error(error);\r\n\r\n\tdocument.body.append(\r\n\t\tcreateElement(\"div\", { class: \"error\" }, [\r\n\t\t\tcreateElement(\"pre\", { class: \"message\" }, error),\r\n\t\t\t// createElement(\"pre\", { style: \"padding:.6em\" }, \"[no stack trace]\"),\r\n\t\t])\r\n\t);\r\n}\r\n\r\n\r\nexport function showWrenError() {\r\n\tif (wrenErrorStack.length === 0) {\r\n\t\tdocument.body.append(\r\n\t\t\tcreateElement(\"div\", { class: \"error\" }, [\r\n\t\t\t\tcreateElement(\"pre\", { class: \"message\" }, wrenErrorString),\r\n\t\t\t\tcreateElement(\"pre\", { style: \"padding:.6em\" }, \"[no stack trace]\"),\r\n\t\t\t])\r\n\t\t);\r\n\t\treturn;\r\n\t}\r\n\r\n\t// Create popup with message and show immediately.\r\n\tlet messageElement = createElement(\"pre\", { class: \"message\" }, \r\n\t\tcreateElement(\"div\", {}, wrenErrorMessage)\r\n\t);\r\n\r\n\r\n\tfor (let i = 0; i < wrenErrorStack.length; i++) {\r\n\t\tlet [moduleName, lineNumber, location] = wrenErrorStack[i];\r\n\r\n\t\tlet name = moduleName[0] === \"/\" ? moduleName.slice(1) : moduleName;\r\n\r\n\t\tlet stackEl = createElement(\"div\", {}, [\r\n\t\t\tlocation ? `  ${location} at ` : `  at `,\r\n\t\t\tcreateElement(\"a\", { href: getModulePath(moduleName), onclick: onclick }, name + \":\" + lineNumber),\r\n\t\t]);\r\n\r\n\t\t/**\r\n\t\t * @param {MouseEvent} event\r\n\t\t */\r\n\t\tfunction onclick(event) {\r\n\t\t\tevent.preventDefault();\r\n\t\t\tshowScript(i);\r\n\t\t}\r\n\r\n\t\tmessageElement.append(stackEl);\r\n\t}\r\n\r\n\r\n\tlet outerElement = createElement(\"div\", { class: \"error\" }, messageElement);\r\n\r\n\tdocument.body.append(outerElement);\r\n\r\n\tlet shownScript, scriptElement, scriptTitleElement, lineNumbers, lines, targetLine, targetLineNum;\r\n\r\n\tshowScript(0);\r\n\t\r\n\t/**\r\n\t * @param {number} stackIndex\r\n\t */\r\n\tasync function showScript(stackIndex) {\r\n\t\tlet [ moduleName, lineNumber  ] = wrenErrorStack[stackIndex];\r\n\t\t\r\n\t\tif (shownScript !== moduleName) {\r\n\t\t\tif (scriptElement) {\r\n\t\t\t\tscriptElement.remove();\r\n\t\t\t}\r\n\t\t\tif (scriptTitleElement) {\r\n\t\t\t\tscriptTitleElement.remove();\r\n\t\t\t}\r\n\r\n\t\t\tlet url = getModulePath(moduleName);\r\n\t\t\r\n\t\t\tlet source = await (await fetch(url)).text();\r\n\t\r\n\t\t\tshownScript = moduleName;\r\n\t\r\n\t\t\tlet sourceLines = source.split(/\\r\\n|\\n/);\r\n\t\t\t\r\n\t\t\t// Re-format sock script.\r\n\t\t\tif (moduleName === \"sock\") {\r\n\t\t\t\tlet indent = 0;\r\n\t\t\t\tsourceLines = sourceLines.map(line => {\r\n\t\t\t\t\tif (line[0] === \"}\") indent--;\r\n\t\r\n\t\t\t\t\tlet newLine = \"\\t\".repeat(indent) + line;\r\n\t\r\n\t\t\t\t\tif (line[0] !== \"}\" && line.endsWith(\"}\")) indent--;\r\n\t\t\t\t\tif (line.includes(\"{\")) indent++;\r\n\t\r\n\t\t\t\t\treturn newLine;\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\r\n\t\t\tlineNumbers = [];\r\n\t\t\tlines = [];\r\n\t\t\r\n\t\t\tfor (let i = 0; i < sourceLines.length; i++) {\r\n\t\t\t\tlineNumbers.push(createElement(\"div\", {}, 1 + i));\r\n\t\t\t\tlines.push(createElement(\"div\", {}, sourceLines[i] || \"\\u00A0\"));\r\n\t\t\t}\r\n\t\t\r\n\t\t\touterElement.append(\r\n\t\t\t\tscriptTitleElement = createElement(\"div\", { class: \"code-name\" }, moduleName + \".wren\"),\r\n\t\t\t\tscriptElement = createElement(\"div\", { class: \"code\" }, [\r\n\t\t\t\t\tcreateElement(\"pre\", { class: \"code-lines\" }, lineNumbers),\r\n\t\t\t\t\tcreateElement(\"pre\", { class: \"code-source\" }, lines),\r\n\t\t\t\t])\r\n\t\t\t);\r\n\t\t}\r\n\r\n\t\t// Highlight line and scroll to.\r\n\t\tif (targetLine) {\r\n\t\t\ttargetLine.className = targetLineNum.className = \"\";\r\n\t\t}\r\n\r\n\t\ttargetLine = lines[lineNumber - 1];\r\n\t\ttargetLineNum = lineNumbers[lineNumber - 1];\r\n\r\n\t\tif (targetLine) {\r\n\t\t\ttargetLine.className = targetLineNum.className = \"code-target\";\r\n\t\t\ttargetLineNum.scrollIntoView({ block: \"center\" });\r\n\t\t}\r\n\t}\r\n}\r\n\r\n/**\r\n * @param {string} name\r\n */\r\nfunction getModulePath(name) {\r\n\tif (name === \"sock\") {\r\n\t\tname = \"sock_web\";\r\n\t}\r\n\r\n\tif (name[0] === \"/\") {\r\n\t\tname = \"assets\" + name;\r\n\t}\r\n\r\n\treturn name + \".wren\"\r\n}\r\n","import { wrenJSONToJS } from \"../json.js\";\r\nimport { callHandle_toString } from \"../vm-call-handles.js\";\r\nimport { wrenCall, wrenEnsureSlots, wrenGetSlotString, wrenGetVariable, wrenHasVariable, wrenInterpret } from \"../vm.js\";\r\n\r\nlet init = false;\r\nlet terminalModule = \"_terminal\";\r\n\r\n/**\r\n * @param {any} args\r\n * @returns {any} result\r\n */\r\nexport function terminalInterpret(...args) {\r\n\tlet a = args[0];\r\n\r\n\tif (typeof a === \"string\") {\r\n\t\treturn interpret(a);\r\n\t} else if (a.raw && a.map) {\r\n\t\tlet raw = a.raw;\r\n\t\tlet script = \"\";\r\n\r\n\t\tfor (let i = 0; i < raw.length; i++) {\r\n\t\t\tif (i > 0) {\r\n\t\t\t\tscript += a[i];\r\n\t\t\t}\r\n\r\n\t\t\tscript += raw[i];\r\n\t\t}\r\n\r\n\t\treturn interpret(script);\r\n\t} else {\r\n\t\tconsole.error(a);\r\n\t\tthrow TypeError(\"call like this: wren`script`\");\r\n\t}\r\n}\r\n\r\n/**\r\n * @param {string} s\r\n * @returns {any} result\r\n */\r\nfunction interpret(s) {\r\n\tif (!init) {\r\n\t\tinit = true;\r\n\t\twrenInterpret(terminalModule, \"var r__\");\r\n\t}\r\n\r\n\ts = s.trim();\r\n\r\n\tlet maybeExpression = false;\r\n\r\n\tif (!s.includes(\"\\n\")) {\r\n\t\t// Single line\r\n\t\tif (s.startsWith(\"var \")) {\r\n\t\t\t// Var initialization\r\n\t\t\tlet r = /var\\s+([_a-zA-Z][_a-zA-Z0-9]*)/.exec(s);\r\n\t\t\tif (r) {\r\n\t\t\t\tlet varName = r[1];\r\n\r\n\t\t\t\t// Allow repeated variable declaration\r\n\t\t\t\tif (wrenHasVariable(terminalModule, varName)) {\r\n\t\t\t\t\tif (s.includes(\"=\")) {\r\n\t\t\t\t\t\t// Remove [var ] from start if already declared.\r\n\t\t\t\t\t\ts = s.slice(4);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t// Ignore repeated initialization.\r\n\t\t\t\t\t\treturn\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tlet result = wrenInterpret(terminalModule, s);\r\n\r\n\t\t\t\tif (result === 0) {\r\n\t\t\t\t\treturn getVariableAsJavaScript(varName);\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t} else if (!startsWithStatement(s)) {\r\n\t\t\t// This should be an expression of some kind!\r\n\t\t\tmaybeExpression = true;\r\n\r\n\t\t\t// For simple assignments, decare base as variable if it doesn't look like a class.\r\n\t\t\tlet r = /^([_a-zA-Z][_a-zA-Z0-9]*)\\s*=/.exec(s) || /^([_a-zA-Z][_a-zA-Z0-9]*)$/.exec(s);\r\n\t\t\tif (r) {\r\n\t\t\t\tlet baseVarName = r[1];\r\n\r\n\t\t\t\tif (!wrenHasVariable(terminalModule, baseVarName)) {\r\n\t\t\t\t\tif (baseVarName[0] === baseVarName[0].toLowerCase()) {\r\n\t\t\t\t\t\twrenInterpret(terminalModule, \"var \" + baseVarName);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t} else {\r\n\t\tmaybeExpression = !startsWithStatement(s);\r\n\t}\r\n\r\n\tif (maybeExpression) {\r\n\t\t// Try as expression!\r\n\t\tlet result = wrenInterpret(terminalModule, `r__=JSON.toString(${s})`);\r\n\t\r\n\t\tif (result === 0) {\r\n\t\t\treturn getVariableAsJavaScript(\"r__\", true);\r\n\t\t} else if (result === 2) {\r\n\t\t\treturn \"[error]\";\r\n\t\t}\r\n\t}\r\n\t\t\r\n\t// Try just interpreting.\r\n\tlet result = wrenInterpret(terminalModule, s);\r\n\tif (result === 0) {\r\n\t\treturn \"[success]\";\r\n\t} else {\r\n\t\treturn \"[error]\";\r\n\t}\r\n}\r\n\r\n/**\r\n * @param {string} s\r\n */\r\nfunction startsWithStatement(s) {\r\n\treturn s.startsWith(\"var \") || s.startsWith(\"if \") || s.startsWith(\"if(\") || s.startsWith(\"for \") || s.startsWith(\"for(\") || s.startsWith(\"while \") || s.startsWith(\"while(\") || s.startsWith(\"import \") || s.startsWith(\"class \") || s.startsWith(\"#!\") || s.startsWith(\"#?\");\r\n}\r\n\r\n/**\r\n * @param {string} varName\r\n */\r\nfunction getVariableAsJavaScript(varName, json=false) {\r\n\twrenEnsureSlots(1);\r\n\twrenGetVariable(terminalModule, varName, 0);\r\n\r\n\tlet result = wrenCall(callHandle_toString);\r\n\tif (result === 0) {\r\n\t\tlet toStr = wrenGetSlotString(0);\r\n\r\n\t\tif (json) {\r\n\t\t\treturn wrenJSONToJS(toStr);\r\n\t\t} else {\r\n\t\t\treturn toStr;\r\n\t\t}\r\n\t}\r\n\r\n\treturn \"[error]\";\r\n}\r\n\r\n/**\r\n * @param {string} s\r\n */\r\nfunction fromBase64(s) {\r\n\ts = atob(s);\r\n\tlet array = new Uint8Array(s.length);\r\n\tfor (let i = 0; i < s.length; i++) array[i] = s.charCodeAt(i);\r\n\treturn array;\r\n}\r\n","import \"./polyfill.js\";\r\nimport \"./api/add-all-api.js\";\r\nimport { initTimeModule, updateTimeModule } from \"./api/time.js\";\r\nimport { fps, gameBusyWithDOMFallback, gameIsReady, gameUpdate, initGameModule, prepareUpdatePromise, quitFromAPI } from \"./api/game.js\";\r\nimport { initAssetModule } from \"./api/asset.js\";\r\nimport { initInputModule, recalculateAndUpdateMousePosition, updateInputModule } from \"./api/input.js\";\r\nimport { httpGET } from \"./network/http.js\";\r\nimport { finalizeLayout, redoLayout } from \"./layout.js\";\r\nimport { Shader } from \"./gl/shader.js\";\r\nimport { mainFramebuffer } from \"./gl/framebuffer.js\";\r\nimport { canvas } from \"./canvas.js\";\r\nimport { showError, showWrenError } from \"./error.js\";\r\nimport { until } from \"./async.js\";\r\nimport { terminalInterpret } from \"./debug/terminal.js\";\r\nimport { loadEmscripten, wrenAddImplicitImportModule, wrenHasError, wrenInterpret } from \"./vm.js\";\r\nimport { makeCallHandles } from \"./vm-call-handles.js\";\r\nimport { initSystemFont } from \"./system-font.js\";\r\nimport { initAudioModule, stopAllAudio } from \"./api/audio.js\";\r\nimport { initPromiseModule } from \"./api/promise.js\";\r\nimport { initSpriteModule } from \"./api/sprite.js\";\r\nimport { sockJsGlobal } from \"./globals.js\";\r\nimport { updateRefreshRate } from \"./api/screen.js\";\r\nimport { messagingEnabled, sendMessage, waitForMessage } from \"./messaging.js\";\r\nimport { getAssetAsArrayBuffer, loadOptionalBundle } from \"./asset-database.js\";\r\n\r\n/** @type {number} */\r\nlet prevTime = null;\r\n/** @type {number} */\r\nlet startTime = null;\r\nlet time = 0;\r\nlet refreshrateCounter = 0;\r\nlet refreshrateInterval = 0;\r\nlet remainingTime = 0;\r\nlet quit = false;\r\n/** @type {string|ArrayBuffer|Promise<string|ArrayBuffer>} */\r\nlet promGameMainScript;\r\nlet loadingBarProgress = document.getElementById(\"loading-bar-progress\");\r\n\r\n\r\n/**\r\n * We want track loading progress accumulated from multiple sources, each with different 'weights'.\r\n * \r\n * These weights are purely aesthetic and arbitary, they were chosen based on feel/timing.\r\n * \r\n * Represent this with progress slots. Each slot is `[progress, weight]`.\r\n * @type {number[][]}\r\n */\r\nlet loadingBarProgressSlots = [];\r\n\r\nfunction addProgressSlot(weight = 1, progress = 0) {\r\n\tlet slot = [ progress, weight ];\r\n\tloadingBarProgressSlots.push(slot);\r\n\treturn slot;\r\n}\r\n\r\n/**\r\n * @param {number[]} slot\r\n * @param {number} progress 0..1\r\n */\r\nfunction setLoadingBarSlotProgress(slot, progress) {\r\n\tslot[0] = progress;\r\n\r\n\t// Get total progress and render to progress bar.\r\n\tlet total = 0;\r\n\tlet sum = 0;\r\n\tfor (let slot of loadingBarProgressSlots) {\r\n\t\ttotal += slot[1];\r\n\t\tsum += slot[0] * slot[1];\r\n\t}\r\n\tlet totalProgress = sum / total;\r\n\r\n\t// Using clipping to move the progress bar has severable advantages:\r\n\t// * does not trigger layout\r\n\t// * works well with textured progress bars (e.g. someone may want to put an image as the loading bar)\r\n\t// * simple to implement in CSS\r\n\t//\r\n\t// Note we use \"-1px\" on the edges to ensure those edges don't get clipped unnecessarily.\r\n\tloadingBarProgress.style.clipPath = `inset(-1px ${((1 - totalProgress) * 100).toFixed(1)}% -1px -1px)`;\r\n\tloadingBarProgress.hidden = false;\r\n}\r\n\r\n// Handle setup when messaing is enabled.\r\nif (messagingEnabled) {\r\n\tpromGameMainScript = waitForMessage(\"script\");\r\n\r\n\tpromGameMainScript.then(() => {\r\n\t\tplay();\r\n\t});\r\n\r\n\tsendMessage(\"ready\");\r\n}\r\n\r\n/**\r\n * Loads all resources and performs setup.\r\n * \r\n * Called automatically as soon as possible.\r\n */\r\nasync function play() {\r\n\t// Setup loading bar slots.\r\n\tlet progressSlotEmscripten = addProgressSlot(0.75);\r\n\tlet progressSlotSystemFont = addProgressSlot(0.05);\r\n\tlet progressSlotMainScript = addProgressSlot(0.15);\r\n\tlet progressSlotMainBundle;\r\n\r\n\t// Load the following resources in parallel.\r\n\tlet promSockScript = httpGET(\"sock_web.wren\", \"arraybuffer\");\r\n\r\n\t// Load the main asset bundle (if it exists).\r\n\tlet promMainBundle = loadOptionalBundle(\"assets.zip\", progress => {\r\n\t\tif (!progressSlotMainBundle) progressSlotMainBundle = addProgressSlot();\r\n\r\n\t\tsetLoadingBarSlotProgress(progressSlotMainBundle, progress);\r\n\t});\r\n\t\r\n\t// As soon as the main bundle loads (or we know it doesn't exist) start loading the main script.\r\n\tif (!promGameMainScript) {\r\n\t\tpromMainBundle.then(() => {\r\n\t\t\tpromGameMainScript = getAssetAsArrayBuffer(\"main.wren\", (progress) => {\r\n\t\t\t\tsetLoadingBarSlotProgress(progressSlotMainScript, progress);\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\t\r\n\t// Load Wren VM.\r\n\tawait loadEmscripten();\r\n\r\n\tsetLoadingBarSlotProgress(progressSlotEmscripten, 1);\r\n\t\r\n\t// Load system font from WASM code.\r\n\tlet promSystemFont = initSystemFont();\r\n\r\n\t// Create the shared Wren call handles.\r\n\tmakeCallHandles();\r\n\r\n\t// Prepare preview / core init.\r\n\tredoLayout();\r\n\tcanvas.hidden = false;\r\n\r\n\t// Load in the \"sock\" script.\r\n\tawait promSystemFont;\r\n\tsetLoadingBarSlotProgress(progressSlotSystemFont, 1);\r\n\r\n\tlet sockScript = await promSockScript;\r\n\t\r\n\tlet result = wrenInterpret(\"sock\", sockScript);\r\n\t\r\n\tif (result !== 0) {\r\n\t\tfinalize();\r\n\t\treturn;\r\n\t}\r\n\r\n\t// Make the \"sock\" module part of the implicit import API.\r\n\twrenAddImplicitImportModule(\"sock\");\r\n\r\n\t// Init sock modules.\r\n\tinitTimeModule();\r\n\tinitPromiseModule();\r\n\tinitAssetModule();\r\n\tinitGameModule();\r\n\tinitInputModule();\r\n\tinitSpriteModule();\r\n\tinitAudioModule();\r\n\r\n\t// Init WebGL.\r\n\tmainFramebuffer.updateResolution();\r\n\r\n\tShader.compileAll();\r\n\r\n\t// Load main game module\r\n\tawait promMainBundle;\r\n\tlet gameMainScript = await promGameMainScript;\r\n\r\n\t// Setup is mostly done! Hide loading UI.\r\n\tdocument.getElementById(\"setup\").remove();\r\n\r\n\t// Load the main game script.\r\n\tresult = wrenInterpret(\"/main\", gameMainScript);\r\n\tif (result !== 0) {\r\n\t\tfinalize();\r\n\t\treturn;\r\n\t}\r\n\r\n\t// Now we wait for Game.ready_() to be called! Or for an error to occurr.\r\n\tif (!await until(100, 60000, () => gameIsReady || wrenHasError)) {\r\n\t\tfinalize(\"took to long for Game.begin() to be called...\");\r\n\t\treturn;\r\n\t}\r\n\r\n\tif (wrenHasError) {\r\n\t\tfinalize();\r\n\t\treturn;\r\n\t}\r\n\r\n\t// Begin!\r\n\trequestAnimationFrame(update);\r\n}\r\n\r\nfunction update() {\r\n\tlet now = performance.now() / 1000;\r\n\tif (startTime == null) startTime = now;\r\n\tnow -= startTime;\r\n\r\n\tlet tickDelta = prevTime == null ? 0 : Math.min(4 / 60, now - prevTime);\r\n\tprevTime = now;\r\n\r\n\trefreshrateInterval += tickDelta;\r\n\trefreshrateCounter++;\r\n\tif (refreshrateCounter === 60) {\r\n\t\tupdateRefreshRate(Math.round(refreshrateCounter / refreshrateInterval));\r\n\t\trefreshrateCounter = refreshrateInterval = 0;\r\n\t}\r\n\r\n\tlet isBusy = gameBusyWithDOMFallback();\r\n\t\r\n\tif (gameIsReady && !isBusy) {\r\n\t\tif (fps) {\r\n\t\t\tremainingTime -= tickDelta;\r\n\t\t} else {\r\n\t\t\tremainingTime = 0;\r\n\t\t}\r\n\t\r\n\t\tif (!fps || remainingTime <= 0) {\r\n\t\t\t// Increment frame timer.\r\n\t\t\tif (fps) {\r\n\t\t\t\tremainingTime += 1 / fps;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// Update module state.\r\n\t\t\tupdateTimeModule(now, now - time);\r\n\t\t\ttime = now;\r\n\t\t\t\r\n\t\t\tupdateInputModule();\r\n\r\n\t\t\t// Prepare WebGL.\r\n\t\t\tlet layoutChanged = finalizeLayout();\r\n\t\t\t\r\n\t\t\tif (layoutChanged) {\r\n\t\t\t\trecalculateAndUpdateMousePosition();\r\n\t\t\t\tmainFramebuffer.updateResolution();\r\n\t\t\t}\r\n\t\r\n\t\t\tmainFramebuffer.bind();\r\n\t\r\n\t\t\t// Do game update.\r\n\t\t\tlet result = gameUpdate();\r\n\t\t\t\t\r\n\t\t\t// Check result of call.\r\n\t\t\tif (result !== 0) {\r\n\t\t\t\tquit = true;\r\n\t\t\t}\r\n\r\n\t\t\t// Await update promise.\r\n\t\t\tif (!gameIsReady && !quit && !quitFromAPI) {\r\n\t\t\t\tconsole.info(\"[SOCK] awaiting update completion\")\r\n\t\t\t\tprepareUpdatePromise().then(() => {\r\n\t\t\t\t\tfinalizeUpdateInner();\r\n\t\t\t\t\tfinalizeUpdateOuter();\r\n\t\t\t\t});\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\t// ...otherwise finalize synchronusly.\r\n\t\t\tfinalizeUpdateInner();\r\n\t\t}\r\n\t}\r\n\r\n\tfinalizeUpdateOuter();\r\n}\r\n\r\nfunction finalizeUpdateInner() {\r\n\t// Finalize WebGL.\r\n\tmainFramebuffer.draw();\r\n}\r\n\r\nfunction finalizeUpdateOuter() {\r\n\tif (quit || quitFromAPI) {\r\n\t\t// End the loop.\r\n\t\tcanvas.classList.add(\"quit\");\r\n\t\tfinalize();\r\n\t} else {\r\n\t\trequestAnimationFrame(update);\r\n\t}\r\n}\r\n\r\n/**\r\n * @param {string|null} [error]\r\n */\r\nfunction finalize(error) {\r\n\tstopAllAudio();\r\n\t\r\n\tif (error) {\r\n\t\tshowError(error);\r\n\t} else if (wrenHasError) {\r\n\t\tshowWrenError();\r\n\t}\r\n}\r\n\r\n// Add some useful globals.\r\nself[\"wren\"] = terminalInterpret;\r\n\r\nsockJsGlobal.quit = () => {\r\n\tquit = true;\r\n};\r\n\r\n// When to start playing?\r\nif (sockJsGlobal.play) {\r\n\t// Play already clicked (`sock.play = true` handled by JS in main HTML).\r\n\r\n\t// This slot represents the time taken to load the JavaScript code.\r\n\taddProgressSlot(0.2, 1);\r\n\r\n\tplay();\r\n} else {\r\n\t// Play not clicked yet. Set our own callback, which the other JS will call.\r\n\tsockJsGlobal.play = () => {\r\n\t\tsockJsGlobal.play = null;\r\n\t\tplay();\r\n\t};\r\n}\r\n","\r\n/**\r\n * @param {number} delay\r\n * @param {number} timeout\r\n * @param {() => boolean} f\r\n * @returns {Promise<boolean>} resolves to false if timedout\r\n */\r\nexport function until(delay, timeout, f) {\r\n\tlet time = 0;\r\n\treturn new Promise((resolve) => {\r\n\t\tlet id = setInterval(() => {\r\n\t\t\ttime += delay;\r\n\t\t\tif (f()) {\r\n\t\t\t\tclearInterval(id);\r\n\t\t\t\tresolve(true);\r\n\t\t\t}\r\n\t\t\tif (time >= timeout) {\r\n\t\t\t\tclearInterval(id);\r\n\t\t\t\tresolve(false);\r\n\t\t\t}\r\n\t\t}, delay);\r\n\t});\r\n}\r\n"],"names":["documentProto","Document","prototype","elementProto","Element","addForeignMethod","moduleName","className","isStatic","signature","callback","foreignMethods","methodID","addClassForeignStaticMethods","methods","addForeignClass","classMethods","staticMethods","foreignClasses","classID","addClassForeignMethods","requestFullscreen","Object","defineProperty","get","this","Promise","resolve","reject","fullscreenChange","finalize","fullscreenError","TypeError","removeEventListener","addEventListener","httpGET","url","type","progressCallback","xhr","XMLHttpRequest","responseType","open","onprogress","event","ok","status","lengthComputable","loaded","total","Math","min","onerror","onload","response","HTTPError","statusText","send","httpGETImage","el","Image","src","Error","constructor","super","_scriptDir","Module","document","currentScript","URL","baseURI","href","readyPromiseResolve","readyPromiseReject","getOwnPropertyDescriptor","configurable","abort","set","key","moduleOverrides","hasOwnProperty","arguments_","scriptDirectory","indexOf","substr","replace","lastIndexOf","window","importScripts","out","console","log","bind","err","warn","warnOnce","text","shown","assert","functionsInTableMap","wasmMemory","freeTableIndexes","WebAssembly","ABORT","condition","buffer","HEAP8","HEAPU8","HEAP32","HEAPU32","UTF8Decoder","TextDecoder","undefined","UTF8ArrayToString","maxBytesToRead","endIdx","idx","endPtr","heap","subarray","decode","str","u0","u1","u2","toString","String","fromCharCode","ch","UTF8ToString","ptr","stringToUTF8","outPtr","maxBytesToWrite","outIdx","startIdx","i","length","u","charCodeAt","stringToUTF8Array","updateGlobalBufferAndViews","buf","Int8Array","Int16Array","Int32Array","Uint8Array","Uint16Array","Uint32Array","Float32Array","Float64Array","wasmTable","TOTAL_STACK","writeStackCookie","max","_emscripten_stack_get_end","checkStackCookie","cookie1","cookie2","INITIAL_MEMORY","h16","h8","__ATPRERUN__","__ATINIT__","__ATPOSTRUN__","runtimeInitialized","imul","fround","clz32","trunc","runDependencies","runDependencyWatcher","dependenciesFulfilled","runDependencyTracking","what","e","RuntimeError","wasmBinaryFile","FS","error","init","createDataFile","createPreloadedFile","createLazyFile","mkdev","registerDevice","analyzePath","loadFilesFromDB","ErrnoError","isDataURI","filename","startsWith","createExportWrapper","name","fixedasm","displayName","asm","apply","arguments","getBinary","file","callbacks","shift","func","arg","getWasmTableEntry","wasmTableMirror","funcPtr","emscripten_realloc_buffer","size","grow","byteLength","SYSCALLS","mappings","buffers","printChar","stream","curr","varargs","getStr","get64","low","high","asmLibraryArg","clock","_clock","start","Date","now","emscripten_memcpy_big","dest","num","copyWithin","emscripten_resize_heap","requestedSize","oldSize","x","multiple","maxHeapSize","cutDown","overGrownHeapSize","newSize","fd_close","fd","fd_seek","offset_low","offset_high","whence","newOffset","fd_write","iov","iovcnt","pnum","len","j","js_bindClass","vm","module","bindClass","allocate","fns","u32","addFunction","js_bindMethod","fn","sock","bindMethod","js_error","line","message","js_loadModule","lengthBytesUTF8","heapString","_malloc","ArrayBuffer","nullTerminated","mallocString","loadModule","js_write","write","setTempRet0","val","id","info","env","wasi_snapshot_preview1","receiveInstance","instance","cb","exports","unshift","clearInterval","removeRunDependency","setInterval","dep","trueModule","receiveInstantiationResult","result","instantiateArrayBuffer","receiver","fetch","credentials","then","catch","binary","instantiate","reason","instantiateStreaming","createWasm","stackSave","stackRestore","stackAlloc","_emscripten_stack_init","calledRun","run","args","callRuntimeCallbacks","ident","returnType","argTypes","opts","toC","string","ret","array","arr","writeArrayToMemory","getCFunc","cArgs","stack","converter","Boolean","convertReturnValue","onDone","sig","offset","count","item","updateTableMap","has","pop","RangeError","getEmptyTableSlot","setWasmTableEntry","Function","typeNames","f","d","parameters","results","push","typeSection","sigRet","slice","sigParam","typeCodes","concat","bytes","Instance","wrapped","runCaller","ready","canvas","querySelector","sockJsGlobal","assign","self","async","fullscreenEnabled","fullscreenElement","exitFullscreen","body","togglePointerLock","pointerLockElement","exitPointerLock","requestPointerLock","messagingEnabled","messaging","waitingMessages","sendMessage","data","parent","postMessage","HEAP","sockEmscriptenFactory","Module$1","lineNumber","s","wrenHasError","wrenErrorMessage","formatModuleLineTrace","wrenErrorStack","wrenErrorString","wrenInterpret","r","c","stringToWrenString","resolveForeignMethod","resolveForeignClass","ccall","moduleSource","srcType","stackAllocUTF8ArrayAsCString","wrenHasVariable","wrenEnsureSlots","numSlots","wrenGetSlotType","slot","wrenGetSlotBool","wrenGetSlotString","wrenGetSlotDouble","wrenGetSlotForeign","wrenGetSlotIsInstanceOf","classSlot","wrenGetSlotHandle","wrenGetVariable","wrenSetSlotNull","wrenSetSlotBool","value","wrenSetSlotDouble","wrenSetSlotRange","from","to","step","isInclusive","wrenSetSlotString","textRaw","textType","wrenSetSlotHandle","handle","wrenSetSlotNewForeign","wrenCall","callHandle","wrenReleaseHandle","msgType","stillWaiting","callNow","arraySource","u8","wren_sock_get_transform","callHandle_init_2","callHandle_update_0","callHandle_update_2","callHandle_resolve_2","callHandle_toString","callHandle_updateMouse_3","callHandle_updateTouch_5","wrenMakeCallHandle","handle_Time","readBlobAsArrayBuffer","blob","arrayBuffer","FileReader","reader","readAsArrayBuffer","readBlobAsUint8Array","isBlob","v","Blob","isSharedArrayBuffer","b","SharedArrayBuffer","epoch","ArrayBufferReader","arrayBufferOrView","typedArray","byteOffset","BlobReader","_check","bl","nbuf","_decodeTiny","lmap","LL","pos","tree","bitsE","_bitsE","get17","_get17","code","lit","ll","n","ni","_copyOut","off","mx","tl","makeCodes","MAX_BITS","bits","max_code","bl_count","U","next_code","codes2map","map","rev15","cl","rest","i0","i1","r15","revCodes","imb","dt","_bitsF","u16","ordr","of0","exb","ldef","df0","dxb","ddef","flmap","fltree","fdmap","fdtree","ltree","ttree","dmap","dtree","imap","itree","lhst","dhst","ihst","lits","strt","pushV","tgt","sv","crc","table","tab","k","update","o","l","inflateRaw","bitsF","decodeTiny","noBuf","BFINAL","BTYPE","HLIT","HDIST","HCLEN","ML","MD","mx0","mx1","end","ebs","dcode","dlit","dbs","dst","p8","inflate","config","numWorkers","workerURL","useWorkers","nextId","canUseWorkers","workers","availableWorkers","waitingForWorkerQueue","currentlyProcessingIdToRequestMap","Map","handleResult","makeWorkerAvailable","target","delete","request","startWorker","worker","onmessage","workerHelper","req","mode","createObjectURL","btoa","terminate","processWaitingForWorkerQueue","uncompressedSize","createWorker","getAvailableWorker","transferables","inflateRawLocal","inflateRawAsync","ZipEntry","_reader","_rawEntry","rawEntry","nameBytes","compressedSize","comment","commentBytes","compressionMethod","lastModDate","date","time","dosDateTimeToDate","lastModFileDate","lastModFileTime","isDirectory","endsWith","encrypted","generalPurposeBitFlag","externalFileAttributes","versionMadeBy","fileDataStart","readEntryDataHeader","decompress","typedArrayOrBlob","readAsBlobOrTypedArray","readEntryDataAsBlob","dataView","readAs","readEntryDataAsArrayBuffer","decodeBuffer","JSON","parse","read","sliceAsBlob","crc$1","unsigned","getUint16LE","uint8View","getUint32LE","getUint64LE","utf8Decoder","isUTF8","readZip64CentralDirectory","zip64EocdlOffset","eocdl","zip64EocdrOffset","zip64Eocdr","entryCount","centralDirectorySize","readEntries","centralDirectoryOffset","rawEntryCount","readEntryCursor","allEntriesBuffer","rawEntries","versionNeededToExtract","crc32","fileNameLength","extraFieldLength","fileCommentLength","internalFileAttributes","relativeOffsetOfLocalHeader","fileCommentStart","extraFieldBuffer","extraFields","headerId","dataStart","dataEnd","find","zip64ExtraField","zip64EiefBuffer","index","nameField","fileName","expectedCompressedSize","zip","entries","totalLength","getLength","localFileHeaderEnd","fileDataEnd","unzipRaw","source","Number","MAX_SAFE_INTEGER","EOCDR_WITHOUT_COMMENT_SIZE","readStart","eocdr","diskNumber","commentLength","expectedCommentLength","createElement","tag","attributes","nodes","element","setAttribute","isArray","node","append","getExtension","dot","path","toLowerCase","resolveAssetURL","resolveAbsoluteAssetPath","assets","create","getAssetAsArrayBuffer","loadBundleEx","loadProgress","root","entry","commonRoot","getCommonRootDirectory","filePromises","files","filter","loadCount","dataPromise","ext","all","options","setOptions","handle_Promise","resolveWrenPromise","promiseHandle","pvalue","putResultInSlot","resolveSync","success","WrenHandle","loader","wrenAbort","promise","method","httpExists","loadAsset","loadBundle","EFFECT_TYPE_NAMES","audioctx","masterGain","implulseChurch","offlineContext","handle_Audio","handle_AudioBus","handle_Voice","fadeVolume","gainNode","volume","fade","gain","cancelScheduledValues","currentTime","linearRampToValueAtTime","AudioControls","destination","effects","fill","createGain","updateGraph","getInput","effect","input","getEffectType","connect","outputs","disconnect","setupGraph","AudioBus","Audio","setBuffer","effectSetAudioParam","param","minValue","maxValue","FilterEffect","createBiquadFilter","getParam","frequency","Q","checkParam","setParam","floor","EchoEffect","maxDelay","GainNode","decay","mix","delay","DelayNode","delayTime","maxDelayTime","free","ReverbEffect","wetGain","frameCount","duration","sampleRate","AudioBuffer","numberOfChannels","ch1","getChannelData","ch2","exp","random","generateImpulse","convolver","ConvolverNode","disableNormalization","Voice","audio","audioHandle","_initSource","state","createBufferSource","onended","play","old","loop","loopStart","playbackRate","startTime","saveTime","pause","stopSource","stop","buses","audios","voices","getAudioBus","getAudio","getVoice","stbvorbisPromise","canDecodeOGG","script","head","stbvorbis","eof","reduce","acc","chunk","channelCount","writeOffset","channelIndex","copyToChannel","wrenAudioSetEffect","params","Array","oldEffect","output","wrenAudioGetEffect","wrenAudioGetParam","paramIndex","wrenAudioSetParam","paramValue","fadeTime","wrenFadeVolume","bus","voice","isOGG","decodeOGG","OfflineAudioContext","decodeAudioData","loadAudioBuffer","isPaused","rate","loopEnd","storageID","validateKey","validateKeyIdentifier","test","localStorage","getItem","setItem","removeItem","screenWidth","screenHeight","internalResolutionWidth","internalResolutionHeight","viewportOffsetX","viewportOffsetY","viewportWidth","viewportHeight","viewportScale","layoutOptions","pixelScaling","resolution","maxScale","Infinity","layoutContainer","style","layoutContainerRefCount","isLayoutQueued","queueLayout","redoLayout","innerWidth","innerHeight","resx","resy","scale","devicePixelRatio","width","pixeRatio","height","res","scaleX","scaleY","left","top","cameraMatrix","setCameraOrigin","sx","sy","tf","y","dx","dy","wrenSetCamera","setter","tp","cameraLookAt","gl","getContext","antialias","enable","BLEND","blendFuncSeparate","SRC_ALPHA","ONE_MINUS_SRC_ALPHA","ONE","GL_FILTER_MAP","linear","LINEAR","nearest","NEAREST","GL_WRAP_MAP","clamp","CLAMP_TO_EDGE","repeat","REPEAT","mirror","MIRRORED_REPEAT","wrenGlFilterStringToNumber","wrenGlWrapModeStringToNumber","glFilterNumberToString","glWrapModeNumberToString","indices","populatedIndices","quadIndexBuffer","createBuffer","bindQuadIndexBuffer","indexCount","bindBuffer","ELEMENT_ARRAY_BUFFER","capacity","newIndices","vi","bufferData","DYNAMIC_DRAW","quadSize","shadersAwaitingCompilation","Shader","opt","uniforms","attributesSource","initShaderVariables","varyingsSource","varyings","vertUniforms","fragUniforms","vertSource","createShaderSourceMain","vert","fragSource","frag","_vert","createShader","VERTEX_SHADER","shaderSource","_frag","FRAGMENT_SHADER","prog","createProgram","attachShader","compiled","compile","needsCompilation","deleteProgram","deleteShader","use","useProgram","getUniformLocation","location","setUniformTexture","tex","unit","TEXTURE0","activeTexture","bindTexture","TEXTURE_2D","uniform1i","setUniformFloat2","uniform2f","setUniformMatrix3","matrix","uniformMatrix3fv","setUniformMatrix4","uniformMatrix4fv","static","shaders","sh","compileShader","linkProgram","errors","getProgramParameter","LINK_STATUS","sProg","getProgramInfoLog","sVert","getShaderInfoLog","sFrag","join","keyword","a","Vec2","Texture","wrap","texture","setFilter","texParameteri","TEXTURE_MAG_FILTER","TEXTURE_MIN_FILTER","setWrap","TEXTURE_WRAP_S","TEXTURE_WRAP_T","load","HTMLImageElement","naturalWidth","naturalHeight","HTMLVideoElement","videoWidth","videoHeight","getResolution","img","performance","getEntriesByName","PerformanceResourceTiming","decodedBodySize","transferSize","ImageData","imageSize","createTexture","texImage2D","RGBA","UNSIGNED_BYTE","isPowerOf2","deleteTexture","shader$2","vertex","color","v_color","SpriteBatcher","_capacity","_array","_floats","_bytes","_ints","_vertexCount","_vertexBuffer","_vertexBufferCapacity","begin","_texture","drawQuad","x1","y1","x2","y2","z","v1","v2","tfo","tx1","ty1","tx2","ty2","tx3","ty3","tx4","ty4","tfox","tfoy","addVertex","i4","checkResize","vertexCount","newInts","ARRAY_BUFFER","bufferSubData","vertLocation","shader","colorlocation","uvLocation","uv","vertexAttribPointer","FLOAT","enableVertexAttribArray","getCameraMatrix","drawElements","TRIANGLES","UNSIGNED_SHORT","disableVertexAttribArray","deleteBuffer","handle_Sprite","defaultFilter","defaultWrap","Sprite","batcher","beginBatch","freeSpriteBatchers","endBatch","getTempBatcher","bat","deviceOS","deviceBrowser","sprites","getSprite","spr","scaleFilter","wrapMode","transform","setTimeout","revokeObjectURL","getAssetAsIMG","defaultScaleFilter","defaultWrapMode","deviceIsMobile","platform","navigator","userAgent","includes","device","os","isMobile","shader$1","SYSTEM_FONT","systemFontSpriteBatcher","mainFramebuffer","depthBuffer","createRenderbuffer","framebuffer","createFramebuffer","quadBuffer","STATIC_DRAW","updateResolution","bindRenderbuffer","RENDERBUFFER","renderbufferStorage","DEPTH_COMPONENT16","bindFramebuffer","FRAMEBUFFER","framebufferTexture2D","COLOR_ATTACHMENT0","framebufferRenderbuffer","DEPTH_ATTACHMENT","viewport","unbind","draw","vertAttr","drawArrays","deleteFramebuffer","deleteRenderbuffer","title","fps","quitFromAPI","gameIsReady","updatePromiseFunction","cursor","printColor","wantFullscreen","gettingDOMFullscreen","argumentsMapHandle","isFixed","isPixelPerfect","fullscreenAllowed","fullscreen","dialog","class","alt","triggerFullscreen","onclick","cursorSockToCSS","cornerX","cornerY","TextEncoder","encode","colorInt","int","spx","spy","lenPtr","getSlotBytes","g","clearColor","COLOR_BUFFER_BIT","mapSlot","searchParams","keySlot","valueSlot","wrenSetMapValue","default","pointer","wait","hidden","handle_Game","initGameModule","refreshRate","screen","availableWidth","availWidth","availableHeight","availHeight","QuadBatcher","drawBatch","inBatch","drawRect","x3","y3","x4","y4","quadInfo","w","h","singleBatch","QWERTZ","AZERTY","keyboardLayout","language","layoutChecks","onKeydown","passive","textInput","textForm","removeTextInput","parentNode","remove","onsubmit","preventDefault","onblur","activeElement","onkeydown","idType","argType","focus","textDescription","placeholder","textIsActive","textSelection","selectionStart","selectionEnd","selectionDirection","tmp","textString","handle_Input","queuedInputs","Set","inputTable","mouseX","mouseExactX","mouseExactY","mouseRawX","mouseRawY","mouseWheel","recalculateAndUpdateMousePosition","recalculateMousePosition","transferCurrentMousePosition","mouseY","add","updateInputValue1D","nameNegative","namePositive","updateInputValue","updateInputValueWithNativeName","INPUT_NAME_MAP","Backquote","Minus","Equal","Comma","Period","Slash","Semicolon","Quote","BracketLeft","BracketRight","Backslash","letter","updateTouches","touches","isDown","touch","identifier","clientX","clientY","force","updateMousePosition","updateMouseButton","button","wrenJSONToJS","NaN","atob","jsToWrenJSON","obj","stringify","jsToWrenObject","child","getPrototypeOf","Uint8ClampedArray","getJSONFromSlot","stopPropagation","deltaY","sign","changedTouches","argValues","argNames","xs","every","isSync","fnArgs","AsyncFunction","getModulePath","browser","terminalModule","interpret","maybeExpression","trim","startsWithStatement","exec","varName","getVariableAsJavaScript","baseVarName","json","toStr","promGameMainScript","prevTime","refreshrateCounter","refreshrateInterval","remainingTime","quit","loadingBarProgress","getElementById","loadingBarProgressSlots","weight","progress","setLoadingBarSlotProgress","totalProgress","sum","clipPath","toFixed","progressSlotMainBundle","progressSlotEmscripten","addProgressSlot","progressSlotSystemFont","progressSlotMainScript","promSockScript","promMainBundle","loadOptionalBundle","promSystemFont","initSystemFont","AudioContext","compileAll","gameMainScript","timeout","until","requestAnimationFrame","tickDelta","round","deltaTime","updateTimeModule","getGamepads","gp","buttons","axes","inputID","clear","updateInputModule","finalizeLayout","finalizeUpdateInner","finalizeUpdateOuter","classList","close","showError","messageElement","stackEl","showScript","shownScript","scriptElement","scriptTitleElement","lineNumbers","lines","targetLine","targetLineNum","outerElement","stackIndex","sourceLines","split","indent","newLine","scrollIntoView","block","showWrenError","raw"],"mappings":"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"}