{"version":3,"file":"sock.js","sources":["../src/js/polyfill.js","../src/js/foreign.js","../src/js/network/http.js","../src/js-generated/sock_c.js","../src/js/globals.js","../src/js/vm.js","../src/js/messaging.js","../src/js/vm-call-handles.js","../src/js/api/time.js","../src/js/api/promise.js","../src/js/api/asset.js","../src/js/path.js","../src/js/api/audio.js","../src/js/api/buffer.js","../src/js/api/storage.js","../src/js/html.js","../src/js/layout.js","../src/js/api/camera.js","../src/js/gl/gl.js","../src/js/gl/api.js","../src/js/gl/quad-index-buffer.js","../src/js/gl/shader.js","../src/js/math.js","../src/js/gl/texture.js","../src/js/gl/sprite-batcher.js","../src/js/api/sprite.js","../src/js/device.js","../src/js/gl/framebuffer.js","../src/js/system-font.js","../src/js/api/game.js","../src/js/api/screen.js","../src/js/gl/quad-batcher.js","../src/js/gl/primitive-batcher.js","../src/js/api/quad.js","../src/js/keyboard-layout.js","../src/js/api/input.js","../src/js/json.js","../src/js/api/javascript.js","../src/js/api/platform.js","../src/js/error.js","../src/js/debug/terminal.js","../src/js/main.js","../src/js/async.js"],"sourcesContent":["\r\nlet documentProto = Document.prototype;\r\nlet elementProto = Element.prototype;\r\n\r\nexport let fullscreenChangeEvent = \"fullscreenchange\";\r\n\r\nif (!elementProto.requestFullscreen) {\r\n\tif (elementProto[\"webkitRequestFullscreen\"]) {\r\n\t\t// Safari uses webkit prefix for fullscreen API.\r\n\r\n\t\tfullscreenChangeEvent = \"webkit\" + fullscreenChangeEvent;\r\n\r\n\t\tObject.defineProperty(documentProto, \"fullscreenElement\", {\r\n\t\t\tget() {\r\n\t\t\t\treturn this[\"webkitFullscreenElement\"];\r\n\t\t\t}\r\n\t\t});\r\n\t\t\r\n\t\tObject.defineProperty(documentProto, \"fullscreenEnabled\", {\r\n\t\t\tget() {\r\n\t\t\t\treturn this[\"webkitFullscreenEnabled\"];\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tdocumentProto[\"exitFullscreen\"] = function () {\r\n\t\t\tthis[\"webkitExitFullscreen\"]();\r\n\r\n\t\t\treturn Promise.resolve();\r\n\t\t};\r\n\r\n\t\telementProto[\"requestFullscreen\"] = function () {\r\n\t\t\treturn new Promise((resolve, reject) => {\r\n\t\t\t\tlet fullscreenChange = () => {\r\n\t\t\t\t\tfinalize();\r\n\t\t\t\t\tresolve();\r\n\t\t\t\t};\r\n\r\n\t\t\t\tlet fullscreenError = () => {\r\n\t\t\t\t\tfinalize();\r\n\t\t\t\t\treject(new TypeError(\"failed to get fullscreen\"));\r\n\t\t\t\t};\r\n\r\n\t\t\t\tlet finalize = () => {\r\n\t\t\t\t\tthis.removeEventListener(\"webkitfullscreenchange\", fullscreenChange);\r\n\t\t\t\t\tthis.removeEventListener(\"webkitfullscreenerror\", fullscreenError);\r\n\t\t\t\t};\r\n\r\n\t\t\t\tthis.addEventListener(\"webkitfullscreenchange\", fullscreenChange);\r\n\t\t\t\tthis.addEventListener(\"webkitfullscreenerror\", fullscreenError);\r\n\r\n\t\t\t\tthis[\"webkitRequestFullscreen\"]();\r\n\t\t\t});\r\n\t\t};\r\n\t}\r\n}\r\n","\r\n/**\r\n * @param {string} moduleName\r\n * @param {string} className\r\n * @param {boolean} isStatic\r\n * @param {string} signature\r\n * @param {() => void} callback\r\n */\r\nexport function addForeignMethod(moduleName, className, isStatic, signature, callback) {\r\n\tforeignMethods[methodID(moduleName || \"sock\", className, isStatic, signature)] = callback;\r\n}\r\n\r\n/**\r\n * @param {string} moduleName\r\n * @param {string} className\r\n * @param {Record<string, () => void>} methods\r\n */\r\nexport function addClassForeignStaticMethods(moduleName, className, methods) {\r\n\tfor (let signature in methods) {\r\n\t\taddForeignMethod(moduleName, className, true, signature, methods[signature]);\r\n\t}\r\n}\r\n\r\n/**\r\n * @param {string} moduleName\r\n * @param {string} className\r\n * @param {Record<string, () => void>} methods\r\n */\r\nexport function addClassForeignMethods(moduleName, className, methods) {\r\n\tfor (let signature in methods) {\r\n\t\taddForeignMethod(moduleName, className, false, signature, methods[signature]);\r\n\t}\r\n}\r\n\r\n/**\r\n * @param {string} moduleName\r\n * @param {string} className\r\n * @param {ForeignClassMethods} classMethods\r\n * @param {Record<string, () => void>} [methods]\r\n * @param {Record<string, () => void>} [staticMethods]\r\n */\r\nexport function addForeignClass(moduleName, className, classMethods, methods, staticMethods) {\r\n\tforeignClasses[classID(moduleName, className)] = classMethods;\r\n\r\n\tif (methods) {\r\n\t\taddClassForeignMethods(moduleName, className, methods);\r\n\t}\r\n\r\n\tif (staticMethods) {\r\n\t\taddClassForeignStaticMethods(moduleName, className, staticMethods);\r\n\t}\r\n}\r\n\r\n/**\r\n * @param {string} moduleName\r\n * @param {string} className\r\n * @param {boolean} isStatic\r\n * @param {string} signature\r\n * @returns {undefined | (() => void)}\r\n */\r\nexport function resolveForeignMethod(moduleName, className, isStatic, signature) {\r\n\treturn foreignMethods[methodID(moduleName, className, isStatic, signature)];\r\n}\r\n\r\n/**\r\n * @param {string} moduleName\r\n * @param {string} className\r\n * @returns {undefined | ForeignClassMethods}\r\n */\r\nexport function resolveForeignClass(moduleName, className) {\r\n\treturn foreignClasses[classID(moduleName, className)];\r\n}\r\n\r\n/**\r\n * @param {string} moduleName\r\n * @param {string} className\r\n * @param {boolean} isStatic\r\n * @param {string} signature\r\n */\r\nfunction methodID(moduleName, className, isStatic, signature) {\r\n\treturn `${moduleName}:${className}:${isStatic}:${signature}`;\r\n}\r\n\r\n/**\r\n * @param {string} moduleName\r\n * @param {string} className\r\n */\r\nfunction classID(moduleName, className) {\r\n\treturn `${moduleName}:${className}`;\r\n}\r\n\r\n/** @type {Record<string, () => void>} */\r\nlet foreignMethods = {};\r\n\r\n/** @type {Record<string, ForeignClassMethods>} */\r\nlet foreignClasses = {};\r\n\r\n/**\r\n * @typedef {[() => void, (ptr: number) => void]} ForeignClassMethods\r\n */\r\n","\r\n/**\r\n * @param {string} url\r\n * @param {XMLHttpRequestResponseType} type\r\n * @param {(progress: number) => void} [progressCallback]\r\n * @returns {Promise<any>}\r\n */\r\nexport function httpGET(url, type, progressCallback) {\r\n\treturn new Promise((resolve, reject) => {\r\n\t\tlet xhr = new XMLHttpRequest();\r\n\r\n\t\txhr.responseType = type;\r\n\t\txhr.open(\"GET\", url);\r\n\r\n\t\tif (progressCallback) {\r\n\t\t\txhr.onprogress = (event) => {\r\n\t\t\t\tif (event.lengthComputable) {\r\n\t\t\t\t\tprogressCallback(event.loaded / event.total)\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\txhr.onerror = () => {\r\n\t\t\treject(\"Could not connect to server\");\r\n\t\t};\r\n\r\n\t\txhr.onload = () => {\r\n\t\t\tif (xhr.status === 200) {\r\n\t\t\t\tresolve(xhr.response);\r\n\t\t\t} else {\r\n\t\t\t\treject(xhr.status + \": \" + xhr.statusText + \": \" + url);\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\txhr.send();\r\n\t});\r\n}\r\n\r\n/**\r\n * @param {string} url\r\n * @returns {Promise<HTMLImageElement|null>}\r\n */\r\nexport function httpGETImage(url) {\r\n\treturn new Promise((resolve, reject) => {\r\n\t\tlet el = new Image();\r\n\t\tel.onload = () => {\r\n\t\t\tresolve(el);\r\n\t\t};\r\n\t\tel.onerror = () => {\r\n\t\t\treject(`Could not load image ${url}`);\r\n\t\t};\r\n\t\tel.src = url;\r\n\t});\r\n}\r\n\r\n/**\r\n * @param {string} url\r\n * @returns {Promise<boolean>}\r\n */\r\nexport async function httpExists(url) {\r\n\ttry {\r\n\t\tlet response = await fetch(url, { method: \"HEAD\" });\r\n\r\n\t\treturn response.ok;\r\n\t} catch (error) {\r\n\t\tconsole.error(\"error for head request at \" + url, error);\r\n\r\n\t\treturn false;\r\n\t}\r\n}\r\n\r\n/**\r\n * @param {string} url\r\n * @returns {Promise<number>}\r\n */\r\nexport async function httpContentLength(url) {\r\n\ttry {\r\n\t\tlet response = await fetch(url, { method: \"HEAD\" });\r\n\t\tif (response.ok) {\r\n\t\t\tlet contentLength = response.headers.get(\"content-length\");\r\n\t\t\tif (contentLength) {\r\n\t\t\t\treturn Number(contentLength);\r\n\t\t\t}\r\n\t\t}\r\n\t} catch (error) {\r\n\t\tconsole.error(\"error for head request at \" + url, error);\r\n\t}\r\n\treturn 0;\r\n}\r\n","\r\nvar Module = (function() {\r\n  var _scriptDir = import.meta.url;\r\n  \r\n  return (\r\nfunction(Module) {\r\n  Module = Module || {};\r\n\r\n\r\n\r\n// The Module object: Our interface to the outside world. We import\r\n// and export values on it. There are various ways Module can be used:\r\n// 1. Not defined. We create it here\r\n// 2. A function parameter, function(Module) { ..generated code.. }\r\n// 3. pre-run appended it, var Module = {}; ..generated code..\r\n// 4. External script tag defines var Module.\r\n// We need to check if Module already exists (e.g. case 3 above).\r\n// Substitution will be replaced with actual code on later stage of the build,\r\n// this way Closure Compiler will not mangle it (e.g. case 4. above).\r\n// Note that if you want to run closure, and also to use Module\r\n// after the generated code, you will need to define   var Module = {};\r\n// before the code. Then that object will be used in the code, and you\r\n// can continue to use Module afterwards as well.\r\nvar Module = typeof Module !== 'undefined' ? Module : {};\r\n\r\n// Set up the promise that indicates the Module is initialized\r\nvar readyPromiseResolve, readyPromiseReject;\r\nModule['ready'] = new Promise(function(resolve, reject) {\r\n  readyPromiseResolve = resolve;\r\n  readyPromiseReject = reject;\r\n});\r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '_malloc')) {\r\n        Object.defineProperty(Module['ready'], '_malloc', { configurable: true, get: function() { abort('You are getting _malloc on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '_malloc', { configurable: true, set: function() { abort('You are setting _malloc on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '_realloc')) {\r\n        Object.defineProperty(Module['ready'], '_realloc', { configurable: true, get: function() { abort('You are getting _realloc on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '_realloc', { configurable: true, set: function() { abort('You are setting _realloc on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '_free')) {\r\n        Object.defineProperty(Module['ready'], '_free', { configurable: true, get: function() { abort('You are getting _free on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '_free', { configurable: true, set: function() { abort('You are setting _free on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '_sock_init')) {\r\n        Object.defineProperty(Module['ready'], '_sock_init', { configurable: true, get: function() { abort('You are getting _sock_init on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '_sock_init', { configurable: true, set: function() { abort('You are setting _sock_init on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '_sock_font')) {\r\n        Object.defineProperty(Module['ready'], '_sock_font', { configurable: true, get: function() { abort('You are getting _sock_font on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '_sock_font', { configurable: true, set: function() { abort('You are setting _sock_font on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '_sock_new_buffer')) {\r\n        Object.defineProperty(Module['ready'], '_sock_new_buffer', { configurable: true, get: function() { abort('You are getting _sock_new_buffer on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '_sock_new_buffer', { configurable: true, set: function() { abort('You are setting _sock_new_buffer on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '_sock_new_transform')) {\r\n        Object.defineProperty(Module['ready'], '_sock_new_transform', { configurable: true, get: function() { abort('You are getting _sock_new_transform on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '_sock_new_transform', { configurable: true, set: function() { abort('You are setting _sock_new_transform on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '_sock_get_transform')) {\r\n        Object.defineProperty(Module['ready'], '_sock_get_transform', { configurable: true, get: function() { abort('You are getting _sock_get_transform on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '_sock_get_transform', { configurable: true, set: function() { abort('You are setting _sock_get_transform on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '_wrenGetVersionNumber')) {\r\n        Object.defineProperty(Module['ready'], '_wrenGetVersionNumber', { configurable: true, get: function() { abort('You are getting _wrenGetVersionNumber on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '_wrenGetVersionNumber', { configurable: true, set: function() { abort('You are setting _wrenGetVersionNumber on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '_wrenInitConfiguration')) {\r\n        Object.defineProperty(Module['ready'], '_wrenInitConfiguration', { configurable: true, get: function() { abort('You are getting _wrenInitConfiguration on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '_wrenInitConfiguration', { configurable: true, set: function() { abort('You are setting _wrenInitConfiguration on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '_wrenNewVM')) {\r\n        Object.defineProperty(Module['ready'], '_wrenNewVM', { configurable: true, get: function() { abort('You are getting _wrenNewVM on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '_wrenNewVM', { configurable: true, set: function() { abort('You are setting _wrenNewVM on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '_wrenFreeVM')) {\r\n        Object.defineProperty(Module['ready'], '_wrenFreeVM', { configurable: true, get: function() { abort('You are getting _wrenFreeVM on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '_wrenFreeVM', { configurable: true, set: function() { abort('You are setting _wrenFreeVM on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '_wrenCollectGarbage')) {\r\n        Object.defineProperty(Module['ready'], '_wrenCollectGarbage', { configurable: true, get: function() { abort('You are getting _wrenCollectGarbage on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '_wrenCollectGarbage', { configurable: true, set: function() { abort('You are setting _wrenCollectGarbage on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '_wrenInterpret')) {\r\n        Object.defineProperty(Module['ready'], '_wrenInterpret', { configurable: true, get: function() { abort('You are getting _wrenInterpret on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '_wrenInterpret', { configurable: true, set: function() { abort('You are setting _wrenInterpret on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '_wrenMakeCallHandle')) {\r\n        Object.defineProperty(Module['ready'], '_wrenMakeCallHandle', { configurable: true, get: function() { abort('You are getting _wrenMakeCallHandle on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '_wrenMakeCallHandle', { configurable: true, set: function() { abort('You are setting _wrenMakeCallHandle on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '_wrenCall')) {\r\n        Object.defineProperty(Module['ready'], '_wrenCall', { configurable: true, get: function() { abort('You are getting _wrenCall on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '_wrenCall', { configurable: true, set: function() { abort('You are setting _wrenCall on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '_wrenReleaseHandle')) {\r\n        Object.defineProperty(Module['ready'], '_wrenReleaseHandle', { configurable: true, get: function() { abort('You are getting _wrenReleaseHandle on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '_wrenReleaseHandle', { configurable: true, set: function() { abort('You are setting _wrenReleaseHandle on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '_wrenGetSlotCount')) {\r\n        Object.defineProperty(Module['ready'], '_wrenGetSlotCount', { configurable: true, get: function() { abort('You are getting _wrenGetSlotCount on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '_wrenGetSlotCount', { configurable: true, set: function() { abort('You are setting _wrenGetSlotCount on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '_wrenEnsureSlots')) {\r\n        Object.defineProperty(Module['ready'], '_wrenEnsureSlots', { configurable: true, get: function() { abort('You are getting _wrenEnsureSlots on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '_wrenEnsureSlots', { configurable: true, set: function() { abort('You are setting _wrenEnsureSlots on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '_wrenGetSlotType')) {\r\n        Object.defineProperty(Module['ready'], '_wrenGetSlotType', { configurable: true, get: function() { abort('You are getting _wrenGetSlotType on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '_wrenGetSlotType', { configurable: true, set: function() { abort('You are setting _wrenGetSlotType on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '_wrenGetSlotBool')) {\r\n        Object.defineProperty(Module['ready'], '_wrenGetSlotBool', { configurable: true, get: function() { abort('You are getting _wrenGetSlotBool on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '_wrenGetSlotBool', { configurable: true, set: function() { abort('You are setting _wrenGetSlotBool on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '_wrenGetSlotBytes')) {\r\n        Object.defineProperty(Module['ready'], '_wrenGetSlotBytes', { configurable: true, get: function() { abort('You are getting _wrenGetSlotBytes on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '_wrenGetSlotBytes', { configurable: true, set: function() { abort('You are setting _wrenGetSlotBytes on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '_wrenGetSlotDouble')) {\r\n        Object.defineProperty(Module['ready'], '_wrenGetSlotDouble', { configurable: true, get: function() { abort('You are getting _wrenGetSlotDouble on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '_wrenGetSlotDouble', { configurable: true, set: function() { abort('You are setting _wrenGetSlotDouble on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '_wrenGetSlotForeign')) {\r\n        Object.defineProperty(Module['ready'], '_wrenGetSlotForeign', { configurable: true, get: function() { abort('You are getting _wrenGetSlotForeign on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '_wrenGetSlotForeign', { configurable: true, set: function() { abort('You are setting _wrenGetSlotForeign on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '_wrenGetSlotIsInstanceOf')) {\r\n        Object.defineProperty(Module['ready'], '_wrenGetSlotIsInstanceOf', { configurable: true, get: function() { abort('You are getting _wrenGetSlotIsInstanceOf on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '_wrenGetSlotIsInstanceOf', { configurable: true, set: function() { abort('You are setting _wrenGetSlotIsInstanceOf on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '_wrenGetSlotInstanceField')) {\r\n        Object.defineProperty(Module['ready'], '_wrenGetSlotInstanceField', { configurable: true, get: function() { abort('You are getting _wrenGetSlotInstanceField on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '_wrenGetSlotInstanceField', { configurable: true, set: function() { abort('You are setting _wrenGetSlotInstanceField on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '_wrenGetSlotString')) {\r\n        Object.defineProperty(Module['ready'], '_wrenGetSlotString', { configurable: true, get: function() { abort('You are getting _wrenGetSlotString on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '_wrenGetSlotString', { configurable: true, set: function() { abort('You are setting _wrenGetSlotString on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '_wrenGetSlotHandle')) {\r\n        Object.defineProperty(Module['ready'], '_wrenGetSlotHandle', { configurable: true, get: function() { abort('You are getting _wrenGetSlotHandle on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '_wrenGetSlotHandle', { configurable: true, set: function() { abort('You are setting _wrenGetSlotHandle on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '_wrenSetSlotBool')) {\r\n        Object.defineProperty(Module['ready'], '_wrenSetSlotBool', { configurable: true, get: function() { abort('You are getting _wrenSetSlotBool on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '_wrenSetSlotBool', { configurable: true, set: function() { abort('You are setting _wrenSetSlotBool on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '_wrenSetSlotBytes')) {\r\n        Object.defineProperty(Module['ready'], '_wrenSetSlotBytes', { configurable: true, get: function() { abort('You are getting _wrenSetSlotBytes on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '_wrenSetSlotBytes', { configurable: true, set: function() { abort('You are setting _wrenSetSlotBytes on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '_wrenSetSlotDouble')) {\r\n        Object.defineProperty(Module['ready'], '_wrenSetSlotDouble', { configurable: true, get: function() { abort('You are getting _wrenSetSlotDouble on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '_wrenSetSlotDouble', { configurable: true, set: function() { abort('You are setting _wrenSetSlotDouble on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '_wrenSetSlotRange')) {\r\n        Object.defineProperty(Module['ready'], '_wrenSetSlotRange', { configurable: true, get: function() { abort('You are getting _wrenSetSlotRange on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '_wrenSetSlotRange', { configurable: true, set: function() { abort('You are setting _wrenSetSlotRange on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '_wrenSetSlotNewForeign')) {\r\n        Object.defineProperty(Module['ready'], '_wrenSetSlotNewForeign', { configurable: true, get: function() { abort('You are getting _wrenSetSlotNewForeign on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '_wrenSetSlotNewForeign', { configurable: true, set: function() { abort('You are setting _wrenSetSlotNewForeign on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '_wrenSetSlotNewList')) {\r\n        Object.defineProperty(Module['ready'], '_wrenSetSlotNewList', { configurable: true, get: function() { abort('You are getting _wrenSetSlotNewList on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '_wrenSetSlotNewList', { configurable: true, set: function() { abort('You are setting _wrenSetSlotNewList on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '_wrenSetSlotNewMap')) {\r\n        Object.defineProperty(Module['ready'], '_wrenSetSlotNewMap', { configurable: true, get: function() { abort('You are getting _wrenSetSlotNewMap on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '_wrenSetSlotNewMap', { configurable: true, set: function() { abort('You are setting _wrenSetSlotNewMap on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '_wrenSetSlotNull')) {\r\n        Object.defineProperty(Module['ready'], '_wrenSetSlotNull', { configurable: true, get: function() { abort('You are getting _wrenSetSlotNull on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '_wrenSetSlotNull', { configurable: true, set: function() { abort('You are setting _wrenSetSlotNull on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '_wrenSetSlotString')) {\r\n        Object.defineProperty(Module['ready'], '_wrenSetSlotString', { configurable: true, get: function() { abort('You are getting _wrenSetSlotString on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '_wrenSetSlotString', { configurable: true, set: function() { abort('You are setting _wrenSetSlotString on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '_wrenSetSlotHandle')) {\r\n        Object.defineProperty(Module['ready'], '_wrenSetSlotHandle', { configurable: true, get: function() { abort('You are getting _wrenSetSlotHandle on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '_wrenSetSlotHandle', { configurable: true, set: function() { abort('You are setting _wrenSetSlotHandle on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '_wrenGetListCount')) {\r\n        Object.defineProperty(Module['ready'], '_wrenGetListCount', { configurable: true, get: function() { abort('You are getting _wrenGetListCount on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '_wrenGetListCount', { configurable: true, set: function() { abort('You are setting _wrenGetListCount on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '_wrenGetListElement')) {\r\n        Object.defineProperty(Module['ready'], '_wrenGetListElement', { configurable: true, get: function() { abort('You are getting _wrenGetListElement on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '_wrenGetListElement', { configurable: true, set: function() { abort('You are setting _wrenGetListElement on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '_wrenSetListElement')) {\r\n        Object.defineProperty(Module['ready'], '_wrenSetListElement', { configurable: true, get: function() { abort('You are getting _wrenSetListElement on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '_wrenSetListElement', { configurable: true, set: function() { abort('You are setting _wrenSetListElement on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '_wrenInsertInList')) {\r\n        Object.defineProperty(Module['ready'], '_wrenInsertInList', { configurable: true, get: function() { abort('You are getting _wrenInsertInList on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '_wrenInsertInList', { configurable: true, set: function() { abort('You are setting _wrenInsertInList on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '_wrenGetMapCount')) {\r\n        Object.defineProperty(Module['ready'], '_wrenGetMapCount', { configurable: true, get: function() { abort('You are getting _wrenGetMapCount on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '_wrenGetMapCount', { configurable: true, set: function() { abort('You are setting _wrenGetMapCount on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '_wrenGetMapContainsKey')) {\r\n        Object.defineProperty(Module['ready'], '_wrenGetMapContainsKey', { configurable: true, get: function() { abort('You are getting _wrenGetMapContainsKey on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '_wrenGetMapContainsKey', { configurable: true, set: function() { abort('You are setting _wrenGetMapContainsKey on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '_wrenGetMapValue')) {\r\n        Object.defineProperty(Module['ready'], '_wrenGetMapValue', { configurable: true, get: function() { abort('You are getting _wrenGetMapValue on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '_wrenGetMapValue', { configurable: true, set: function() { abort('You are setting _wrenGetMapValue on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '_wrenSetMapValue')) {\r\n        Object.defineProperty(Module['ready'], '_wrenSetMapValue', { configurable: true, get: function() { abort('You are getting _wrenSetMapValue on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '_wrenSetMapValue', { configurable: true, set: function() { abort('You are setting _wrenSetMapValue on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '_wrenRemoveMapValue')) {\r\n        Object.defineProperty(Module['ready'], '_wrenRemoveMapValue', { configurable: true, get: function() { abort('You are getting _wrenRemoveMapValue on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '_wrenRemoveMapValue', { configurable: true, set: function() { abort('You are setting _wrenRemoveMapValue on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '_wrenGetVariable')) {\r\n        Object.defineProperty(Module['ready'], '_wrenGetVariable', { configurable: true, get: function() { abort('You are getting _wrenGetVariable on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '_wrenGetVariable', { configurable: true, set: function() { abort('You are setting _wrenGetVariable on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '_wrenHasVariable')) {\r\n        Object.defineProperty(Module['ready'], '_wrenHasVariable', { configurable: true, get: function() { abort('You are getting _wrenHasVariable on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '_wrenHasVariable', { configurable: true, set: function() { abort('You are setting _wrenHasVariable on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '_wrenHasModule')) {\r\n        Object.defineProperty(Module['ready'], '_wrenHasModule', { configurable: true, get: function() { abort('You are getting _wrenHasModule on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '_wrenHasModule', { configurable: true, set: function() { abort('You are setting _wrenHasModule on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '_wrenAbortFiber')) {\r\n        Object.defineProperty(Module['ready'], '_wrenAbortFiber', { configurable: true, get: function() { abort('You are getting _wrenAbortFiber on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '_wrenAbortFiber', { configurable: true, set: function() { abort('You are setting _wrenAbortFiber on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '_wrenGetUserData')) {\r\n        Object.defineProperty(Module['ready'], '_wrenGetUserData', { configurable: true, get: function() { abort('You are getting _wrenGetUserData on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '_wrenGetUserData', { configurable: true, set: function() { abort('You are setting _wrenGetUserData on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '_wrenSetUserData')) {\r\n        Object.defineProperty(Module['ready'], '_wrenSetUserData', { configurable: true, get: function() { abort('You are getting _wrenSetUserData on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '_wrenSetUserData', { configurable: true, set: function() { abort('You are setting _wrenSetUserData on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '_wrenAddImplicitImportModule')) {\r\n        Object.defineProperty(Module['ready'], '_wrenAddImplicitImportModule', { configurable: true, get: function() { abort('You are getting _wrenAddImplicitImportModule on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '_wrenAddImplicitImportModule', { configurable: true, set: function() { abort('You are setting _wrenAddImplicitImportModule on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '_emscripten_stack_get_end')) {\r\n        Object.defineProperty(Module['ready'], '_emscripten_stack_get_end', { configurable: true, get: function() { abort('You are getting _emscripten_stack_get_end on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '_emscripten_stack_get_end', { configurable: true, set: function() { abort('You are setting _emscripten_stack_get_end on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '_emscripten_stack_get_free')) {\r\n        Object.defineProperty(Module['ready'], '_emscripten_stack_get_free', { configurable: true, get: function() { abort('You are getting _emscripten_stack_get_free on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '_emscripten_stack_get_free', { configurable: true, set: function() { abort('You are setting _emscripten_stack_get_free on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '_emscripten_stack_init')) {\r\n        Object.defineProperty(Module['ready'], '_emscripten_stack_init', { configurable: true, get: function() { abort('You are getting _emscripten_stack_init on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '_emscripten_stack_init', { configurable: true, set: function() { abort('You are setting _emscripten_stack_init on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '_stackSave')) {\r\n        Object.defineProperty(Module['ready'], '_stackSave', { configurable: true, get: function() { abort('You are getting _stackSave on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '_stackSave', { configurable: true, set: function() { abort('You are setting _stackSave on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '_stackRestore')) {\r\n        Object.defineProperty(Module['ready'], '_stackRestore', { configurable: true, get: function() { abort('You are getting _stackRestore on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '_stackRestore', { configurable: true, set: function() { abort('You are setting _stackRestore on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '_stackAlloc')) {\r\n        Object.defineProperty(Module['ready'], '_stackAlloc', { configurable: true, get: function() { abort('You are getting _stackAlloc on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '_stackAlloc', { configurable: true, set: function() { abort('You are setting _stackAlloc on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '___wasm_call_ctors')) {\r\n        Object.defineProperty(Module['ready'], '___wasm_call_ctors', { configurable: true, get: function() { abort('You are getting ___wasm_call_ctors on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '___wasm_call_ctors', { configurable: true, set: function() { abort('You are setting ___wasm_call_ctors on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], '___errno_location')) {\r\n        Object.defineProperty(Module['ready'], '___errno_location', { configurable: true, get: function() { abort('You are getting ___errno_location on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], '___errno_location', { configurable: true, set: function() { abort('You are setting ___errno_location on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n      if (!Object.getOwnPropertyDescriptor(Module['ready'], 'onRuntimeInitialized')) {\r\n        Object.defineProperty(Module['ready'], 'onRuntimeInitialized', { configurable: true, get: function() { abort('You are getting onRuntimeInitialized on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n        Object.defineProperty(Module['ready'], 'onRuntimeInitialized', { configurable: true, set: function() { abort('You are setting onRuntimeInitialized on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js') } });\r\n      }\r\n    \r\n\r\n// --pre-jses are emitted after the Module integration code, so that they can\r\n// refer to Module (if they choose; they can also define Module)\r\n\r\n// This file provides utilities to the inline EM_ASM JavaScript found in [shim.c]. \r\n\r\n/**\r\n * @param {string|ArrayBuffer|Uint8Array|undefined|null} src\r\n * @returns {number} The string's pointer\r\n */\r\nfunction mallocString(src) {\r\n\tif (!src) return 0;\r\n\tif (typeof src === \"string\") {\r\n\t\tvar len = lengthBytesUTF8(src) + 1;\r\n\t\tvar heapString = _malloc(len);\r\n\t\tstringToUTF8(src, heapString, len);\r\n\t\treturn heapString;\r\n\t} else {\r\n\t\tif (src instanceof ArrayBuffer) {\r\n\t\t\tsrc = new Uint8Array(src);\r\n\t\t}\r\n\t\r\n\t\tvar nullTerminated = src[src.length - 1] === 0;\r\n\t\tvar len = nullTerminated ? src.length : src.length + 1;\r\n\t\tvar heapString = _malloc(len);\r\n\t\r\n\t\tHEAPU8.set(src, heapString);\r\n\t\r\n\t\tif (!nullTerminated) {\r\n\t\t\tHEAPU8[ptr + len - 1] = 0;\r\n\t\t}\r\n\r\n\t\treturn heapString;\r\n\t}\r\n}\r\n\r\n\r\n// Sometimes an existing Module object exists with properties\r\n// meant to overwrite the default module functionality. Here\r\n// we collect those properties and reapply _after_ we configure\r\n// the current environment's defaults to avoid having to be so\r\n// defensive during initialization.\r\nvar moduleOverrides = {};\r\nvar key;\r\nfor (key in Module) {\r\n  if (Module.hasOwnProperty(key)) {\r\n    moduleOverrides[key] = Module[key];\r\n  }\r\n}\r\n\r\nvar arguments_ = [];\r\nvar thisProgram = './this.program';\r\nvar quit_ = function(status, toThrow) {\r\n  throw toThrow;\r\n};\r\n\r\n// Determine the runtime environment we are in. You can customize this by\r\n// setting the ENVIRONMENT setting at compile time (see settings.js).\r\n\r\nvar ENVIRONMENT_IS_WEB = true;\r\nvar ENVIRONMENT_IS_WORKER = false;\r\nvar ENVIRONMENT_IS_NODE = false;\r\nvar ENVIRONMENT_IS_SHELL = false;\r\n\r\nif (Module['ENVIRONMENT']) {\r\n  throw new Error('Module.ENVIRONMENT has been deprecated. To force the environment, use the ENVIRONMENT compile-time option (for example, -s ENVIRONMENT=web or -s ENVIRONMENT=node)');\r\n}\r\n\r\n// `/` should be present at the end if `scriptDirectory` is not empty\r\nvar scriptDirectory = '';\r\nfunction locateFile(path) {\r\n  return scriptDirectory + path;\r\n}\r\n\r\n// Hooks that are implemented differently in different runtime environments.\r\nvar read_,\r\n    readAsync,\r\n    readBinary,\r\n    setWindowTitle;\r\n\r\n// Normally we don't log exceptions but instead let them bubble out the top\r\n// level where the embedding environment (e.g. the browser) can handle\r\n// them.\r\n// However under v8 and node we sometimes exit the process direcly in which case\r\n// its up to use us to log the exception before exiting.\r\n// If we fix https://github.com/emscripten-core/emscripten/issues/15080\r\n// this may no longer be needed under node.\r\nfunction logExceptionOnExit(e) {\r\n  if (e instanceof ExitStatus) return;\r\n  var toLog = e;\r\n  if (e && typeof e === 'object' && e.stack) {\r\n    toLog = [e, e.stack];\r\n  }\r\n  err('exiting due to exception: ' + toLog);\r\n}\r\n\r\nif (ENVIRONMENT_IS_SHELL) {\r\n\r\n  if ((typeof process === 'object' && typeof require === 'function') || typeof window === 'object' || typeof importScripts === 'function') throw new Error('not compiled for this environment (did you build to HTML and try to run it not on the web, or set ENVIRONMENT to something - like node - and run it someplace else - like on the web?)');\r\n\r\n  if (typeof read != 'undefined') {\r\n    read_ = function shell_read(f) {\r\n      return read(f);\r\n    };\r\n  }\r\n\r\n  readBinary = function readBinary(f) {\r\n    var data;\r\n    if (typeof readbuffer === 'function') {\r\n      return new Uint8Array(readbuffer(f));\r\n    }\r\n    data = read(f, 'binary');\r\n    assert(typeof data === 'object');\r\n    return data;\r\n  };\r\n\r\n  readAsync = function readAsync(f, onload, onerror) {\r\n    setTimeout(function() { onload(readBinary(f)); }, 0);\r\n  };\r\n\r\n  if (typeof scriptArgs != 'undefined') {\r\n    arguments_ = scriptArgs;\r\n  } else if (typeof arguments != 'undefined') {\r\n    arguments_ = arguments;\r\n  }\r\n\r\n  if (typeof quit === 'function') {\r\n    quit_ = function(status, toThrow) {\r\n      logExceptionOnExit(toThrow);\r\n      quit(status);\r\n    };\r\n  }\r\n\r\n  if (typeof print !== 'undefined') {\r\n    // Prefer to use print/printErr where they exist, as they usually work better.\r\n    if (typeof console === 'undefined') console = /** @type{!Console} */({});\r\n    console.log = /** @type{!function(this:Console, ...*): undefined} */ (print);\r\n    console.warn = console.error = /** @type{!function(this:Console, ...*): undefined} */ (typeof printErr !== 'undefined' ? printErr : print);\r\n  }\r\n\r\n} else\r\n\r\n// Note that this includes Node.js workers when relevant (pthreads is enabled).\r\n// Node.js workers are detected as a combination of ENVIRONMENT_IS_WORKER and\r\n// ENVIRONMENT_IS_NODE.\r\nif (ENVIRONMENT_IS_WEB || ENVIRONMENT_IS_WORKER) {\r\n  if (ENVIRONMENT_IS_WORKER) { // Check worker, not web, since window could be polyfilled\r\n    scriptDirectory = self.location.href;\r\n  } else if (typeof document !== 'undefined' && document.currentScript) { // web\r\n    scriptDirectory = document.currentScript.src;\r\n  }\r\n  // When MODULARIZE, this JS may be executed later, after document.currentScript\r\n  // is gone, so we saved it, and we use it here instead of any other info.\r\n  if (_scriptDir) {\r\n    scriptDirectory = _scriptDir;\r\n  }\r\n  // blob urls look like blob:http://site.com/etc/etc and we cannot infer anything from them.\r\n  // otherwise, slice off the final part of the url to find the script directory.\r\n  // if scriptDirectory does not contain a slash, lastIndexOf will return -1,\r\n  // and scriptDirectory will correctly be replaced with an empty string.\r\n  // If scriptDirectory contains a query (starting with ?) or a fragment (starting with #),\r\n  // they are removed because they could contain a slash.\r\n  if (scriptDirectory.indexOf('blob:') !== 0) {\r\n    scriptDirectory = scriptDirectory.substr(0, scriptDirectory.replace(/[?#].*/, \"\").lastIndexOf('/')+1);\r\n  } else {\r\n    scriptDirectory = '';\r\n  }\r\n\r\n  if (!(typeof window === 'object' || typeof importScripts === 'function')) throw new Error('not compiled for this environment (did you build to HTML and try to run it not on the web, or set ENVIRONMENT to something - like node - and run it someplace else - like on the web?)');\r\n\r\n  // Differentiate the Web Worker from the Node Worker case, as reading must\r\n  // be done differently.\r\n  {\r\n\r\n// include: web_or_worker_shell_read.js\r\n\r\n\r\n  read_ = function(url) {\r\n      var xhr = new XMLHttpRequest();\r\n      xhr.open('GET', url, false);\r\n      xhr.send(null);\r\n      return xhr.responseText;\r\n  };\r\n\r\n  if (ENVIRONMENT_IS_WORKER) {\r\n    readBinary = function(url) {\r\n        var xhr = new XMLHttpRequest();\r\n        xhr.open('GET', url, false);\r\n        xhr.responseType = 'arraybuffer';\r\n        xhr.send(null);\r\n        return new Uint8Array(/** @type{!ArrayBuffer} */(xhr.response));\r\n    };\r\n  }\r\n\r\n  readAsync = function(url, onload, onerror) {\r\n    var xhr = new XMLHttpRequest();\r\n    xhr.open('GET', url, true);\r\n    xhr.responseType = 'arraybuffer';\r\n    xhr.onload = function() {\r\n      if (xhr.status == 200 || (xhr.status == 0 && xhr.response)) { // file URLs can return 0\r\n        onload(xhr.response);\r\n        return;\r\n      }\r\n      onerror();\r\n    };\r\n    xhr.onerror = onerror;\r\n    xhr.send(null);\r\n  };\r\n\r\n// end include: web_or_worker_shell_read.js\r\n  }\r\n\r\n  setWindowTitle = function(title) { document.title = title };\r\n} else\r\n{\r\n  throw new Error('environment detection error');\r\n}\r\n\r\nvar out = console.log.bind(console);\r\nvar err = console.warn.bind(console);\r\n\r\n// Merge back in the overrides\r\nfor (key in moduleOverrides) {\r\n  if (moduleOverrides.hasOwnProperty(key)) {\r\n    Module[key] = moduleOverrides[key];\r\n  }\r\n}\r\n// Free the object hierarchy contained in the overrides, this lets the GC\r\n// reclaim data used e.g. in memoryInitializerRequest, which is a large typed array.\r\nmoduleOverrides = null;\r\n\r\n// Emit code to handle expected values on the Module object. This applies Module.x\r\n// to the proper local x. This has two benefits: first, we only emit it if it is\r\n// expected to arrive, and second, by using a local everywhere else that can be\r\n// minified.\r\n\r\nif (!Object.getOwnPropertyDescriptor(Module, 'arguments')) {\r\n  Object.defineProperty(Module, 'arguments', {\r\n    configurable: true,\r\n    get: function() {\r\n      abort('Module.arguments has been replaced with plain arguments_ (the initial value can be provided on Module, but after startup the value is only looked for on a local variable of that name)')\r\n    }\r\n  });\r\n}\r\n\r\nif (!Object.getOwnPropertyDescriptor(Module, 'thisProgram')) {\r\n  Object.defineProperty(Module, 'thisProgram', {\r\n    configurable: true,\r\n    get: function() {\r\n      abort('Module.thisProgram has been replaced with plain thisProgram (the initial value can be provided on Module, but after startup the value is only looked for on a local variable of that name)')\r\n    }\r\n  });\r\n}\r\n\r\nif (!Object.getOwnPropertyDescriptor(Module, 'quit')) {\r\n  Object.defineProperty(Module, 'quit', {\r\n    configurable: true,\r\n    get: function() {\r\n      abort('Module.quit has been replaced with plain quit_ (the initial value can be provided on Module, but after startup the value is only looked for on a local variable of that name)')\r\n    }\r\n  });\r\n}\r\n\r\n// perform assertions in shell.js after we set up out() and err(), as otherwise if an assertion fails it cannot print the message\r\n// Assertions on removed incoming Module JS APIs.\r\nassert(typeof Module['memoryInitializerPrefixURL'] === 'undefined', 'Module.memoryInitializerPrefixURL option was removed, use Module.locateFile instead');\r\nassert(typeof Module['pthreadMainPrefixURL'] === 'undefined', 'Module.pthreadMainPrefixURL option was removed, use Module.locateFile instead');\r\nassert(typeof Module['cdInitializerPrefixURL'] === 'undefined', 'Module.cdInitializerPrefixURL option was removed, use Module.locateFile instead');\r\nassert(typeof Module['filePackagePrefixURL'] === 'undefined', 'Module.filePackagePrefixURL option was removed, use Module.locateFile instead');\r\nassert(typeof Module['read'] === 'undefined', 'Module.read option was removed (modify read_ in JS)');\r\nassert(typeof Module['readAsync'] === 'undefined', 'Module.readAsync option was removed (modify readAsync in JS)');\r\nassert(typeof Module['readBinary'] === 'undefined', 'Module.readBinary option was removed (modify readBinary in JS)');\r\nassert(typeof Module['setWindowTitle'] === 'undefined', 'Module.setWindowTitle option was removed (modify setWindowTitle in JS)');\r\nassert(typeof Module['TOTAL_MEMORY'] === 'undefined', 'Module.TOTAL_MEMORY has been renamed Module.INITIAL_MEMORY');\r\n\r\nif (!Object.getOwnPropertyDescriptor(Module, 'read')) {\r\n  Object.defineProperty(Module, 'read', {\r\n    configurable: true,\r\n    get: function() {\r\n      abort('Module.read has been replaced with plain read_ (the initial value can be provided on Module, but after startup the value is only looked for on a local variable of that name)')\r\n    }\r\n  });\r\n}\r\n\r\nif (!Object.getOwnPropertyDescriptor(Module, 'readAsync')) {\r\n  Object.defineProperty(Module, 'readAsync', {\r\n    configurable: true,\r\n    get: function() {\r\n      abort('Module.readAsync has been replaced with plain readAsync (the initial value can be provided on Module, but after startup the value is only looked for on a local variable of that name)')\r\n    }\r\n  });\r\n}\r\n\r\nif (!Object.getOwnPropertyDescriptor(Module, 'readBinary')) {\r\n  Object.defineProperty(Module, 'readBinary', {\r\n    configurable: true,\r\n    get: function() {\r\n      abort('Module.readBinary has been replaced with plain readBinary (the initial value can be provided on Module, but after startup the value is only looked for on a local variable of that name)')\r\n    }\r\n  });\r\n}\r\n\r\nif (!Object.getOwnPropertyDescriptor(Module, 'setWindowTitle')) {\r\n  Object.defineProperty(Module, 'setWindowTitle', {\r\n    configurable: true,\r\n    get: function() {\r\n      abort('Module.setWindowTitle has been replaced with plain setWindowTitle (the initial value can be provided on Module, but after startup the value is only looked for on a local variable of that name)')\r\n    }\r\n  });\r\n}\r\nvar IDBFS = 'IDBFS is no longer included by default; build with -lidbfs.js';\r\nvar PROXYFS = 'PROXYFS is no longer included by default; build with -lproxyfs.js';\r\nvar WORKERFS = 'WORKERFS is no longer included by default; build with -lworkerfs.js';\r\nvar NODEFS = 'NODEFS is no longer included by default; build with -lnodefs.js';\r\nfunction alignMemory() { abort('`alignMemory` is now a library function and not included by default; add it to your library.js __deps or to DEFAULT_LIBRARY_FUNCS_TO_INCLUDE on the command line'); }\r\n\r\nassert(!ENVIRONMENT_IS_WORKER, \"worker environment detected but not enabled at build time.  Add 'worker' to `-s ENVIRONMENT` to enable.\");\r\n\r\nassert(!ENVIRONMENT_IS_NODE, \"node environment detected but not enabled at build time.  Add 'node' to `-s ENVIRONMENT` to enable.\");\r\n\r\nassert(!ENVIRONMENT_IS_SHELL, \"shell environment detected but not enabled at build time.  Add 'shell' to `-s ENVIRONMENT` to enable.\");\r\n\r\n\r\n\r\n\r\nvar STACK_ALIGN = 16;\r\nvar POINTER_SIZE = 4;\r\n\r\nfunction getNativeTypeSize(type) {\r\n  switch (type) {\r\n    case 'i1': case 'i8': return 1;\r\n    case 'i16': return 2;\r\n    case 'i32': return 4;\r\n    case 'i64': return 8;\r\n    case 'float': return 4;\r\n    case 'double': return 8;\r\n    default: {\r\n      if (type[type.length-1] === '*') {\r\n        return POINTER_SIZE;\r\n      } else if (type[0] === 'i') {\r\n        var bits = Number(type.substr(1));\r\n        assert(bits % 8 === 0, 'getNativeTypeSize invalid bits ' + bits + ', type ' + type);\r\n        return bits / 8;\r\n      } else {\r\n        return 0;\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nfunction warnOnce(text) {\r\n  if (!warnOnce.shown) warnOnce.shown = {};\r\n  if (!warnOnce.shown[text]) {\r\n    warnOnce.shown[text] = 1;\r\n    err(text);\r\n  }\r\n}\r\n\r\n// include: runtime_functions.js\r\n\r\n\r\n// Wraps a JS function as a wasm function with a given signature.\r\nfunction convertJsFunctionToWasm(func, sig) {\r\n\r\n  // If the type reflection proposal is available, use the new\r\n  // \"WebAssembly.Function\" constructor.\r\n  // Otherwise, construct a minimal wasm module importing the JS function and\r\n  // re-exporting it.\r\n  if (typeof WebAssembly.Function === \"function\") {\r\n    var typeNames = {\r\n      'i': 'i32',\r\n      'j': 'i64',\r\n      'f': 'f32',\r\n      'd': 'f64'\r\n    };\r\n    var type = {\r\n      parameters: [],\r\n      results: sig[0] == 'v' ? [] : [typeNames[sig[0]]]\r\n    };\r\n    for (var i = 1; i < sig.length; ++i) {\r\n      type.parameters.push(typeNames[sig[i]]);\r\n    }\r\n    return new WebAssembly.Function(type, func);\r\n  }\r\n\r\n  // The module is static, with the exception of the type section, which is\r\n  // generated based on the signature passed in.\r\n  var typeSection = [\r\n    0x01, // id: section,\r\n    0x00, // length: 0 (placeholder)\r\n    0x01, // count: 1\r\n    0x60, // form: func\r\n  ];\r\n  var sigRet = sig.slice(0, 1);\r\n  var sigParam = sig.slice(1);\r\n  var typeCodes = {\r\n    'i': 0x7f, // i32\r\n    'j': 0x7e, // i64\r\n    'f': 0x7d, // f32\r\n    'd': 0x7c, // f64\r\n  };\r\n\r\n  // Parameters, length + signatures\r\n  typeSection.push(sigParam.length);\r\n  for (var i = 0; i < sigParam.length; ++i) {\r\n    typeSection.push(typeCodes[sigParam[i]]);\r\n  }\r\n\r\n  // Return values, length + signatures\r\n  // With no multi-return in MVP, either 0 (void) or 1 (anything else)\r\n  if (sigRet == 'v') {\r\n    typeSection.push(0x00);\r\n  } else {\r\n    typeSection = typeSection.concat([0x01, typeCodes[sigRet]]);\r\n  }\r\n\r\n  // Write the overall length of the type section back into the section header\r\n  // (excepting the 2 bytes for the section id and length)\r\n  typeSection[1] = typeSection.length - 2;\r\n\r\n  // Rest of the module is static\r\n  var bytes = new Uint8Array([\r\n    0x00, 0x61, 0x73, 0x6d, // magic (\"\\0asm\")\r\n    0x01, 0x00, 0x00, 0x00, // version: 1\r\n  ].concat(typeSection, [\r\n    0x02, 0x07, // import section\r\n      // (import \"e\" \"f\" (func 0 (type 0)))\r\n      0x01, 0x01, 0x65, 0x01, 0x66, 0x00, 0x00,\r\n    0x07, 0x05, // export section\r\n      // (export \"f\" (func 0 (type 0)))\r\n      0x01, 0x01, 0x66, 0x00, 0x00,\r\n  ]));\r\n\r\n   // We can compile this wasm module synchronously because it is very small.\r\n  // This accepts an import (at \"e.f\"), that it reroutes to an export (at \"f\")\r\n  var module = new WebAssembly.Module(bytes);\r\n  var instance = new WebAssembly.Instance(module, {\r\n    'e': {\r\n      'f': func\r\n    }\r\n  });\r\n  var wrappedFunc = instance.exports['f'];\r\n  return wrappedFunc;\r\n}\r\n\r\nvar freeTableIndexes = [];\r\n\r\n// Weak map of functions in the table to their indexes, created on first use.\r\nvar functionsInTableMap;\r\n\r\nfunction getEmptyTableSlot() {\r\n  // Reuse a free index if there is one, otherwise grow.\r\n  if (freeTableIndexes.length) {\r\n    return freeTableIndexes.pop();\r\n  }\r\n  // Grow the table\r\n  try {\r\n    wasmTable.grow(1);\r\n  } catch (err) {\r\n    if (!(err instanceof RangeError)) {\r\n      throw err;\r\n    }\r\n    throw 'Unable to grow wasm table. Set ALLOW_TABLE_GROWTH.';\r\n  }\r\n  return wasmTable.length - 1;\r\n}\r\n\r\nfunction updateTableMap(offset, count) {\r\n  for (var i = offset; i < offset + count; i++) {\r\n    var item = getWasmTableEntry(i);\r\n    // Ignore null values.\r\n    if (item) {\r\n      functionsInTableMap.set(item, i);\r\n    }\r\n  }\r\n}\r\n\r\n// Add a function to the table.\r\n// 'sig' parameter is required if the function being added is a JS function.\r\nfunction addFunction(func, sig) {\r\n  assert(typeof func !== 'undefined');\r\n\r\n  // Check if the function is already in the table, to ensure each function\r\n  // gets a unique index. First, create the map if this is the first use.\r\n  if (!functionsInTableMap) {\r\n    functionsInTableMap = new WeakMap();\r\n    updateTableMap(0, wasmTable.length);\r\n  }\r\n  if (functionsInTableMap.has(func)) {\r\n    return functionsInTableMap.get(func);\r\n  }\r\n\r\n  // It's not in the table, add it now.\r\n\r\n  var ret = getEmptyTableSlot();\r\n\r\n  // Set the new value.\r\n  try {\r\n    // Attempting to call this with JS function will cause of table.set() to fail\r\n    setWasmTableEntry(ret, func);\r\n  } catch (err) {\r\n    if (!(err instanceof TypeError)) {\r\n      throw err;\r\n    }\r\n    assert(typeof sig !== 'undefined', 'Missing signature argument to addFunction: ' + func);\r\n    var wrapped = convertJsFunctionToWasm(func, sig);\r\n    setWasmTableEntry(ret, wrapped);\r\n  }\r\n\r\n  functionsInTableMap.set(func, ret);\r\n\r\n  return ret;\r\n}\r\n\r\nfunction removeFunction(index) {\r\n  functionsInTableMap.delete(getWasmTableEntry(index));\r\n  freeTableIndexes.push(index);\r\n}\r\n\r\n// end include: runtime_functions.js\r\n// include: runtime_debug.js\r\n\r\n\r\n// end include: runtime_debug.js\r\nvar tempRet0 = 0;\r\n\r\nvar setTempRet0 = function(value) {\r\n  tempRet0 = value;\r\n};\r\n\r\nvar getTempRet0 = function() {\r\n  return tempRet0;\r\n};\r\n\r\n\r\n\r\n// === Preamble library stuff ===\r\n\r\n// Documentation for the public APIs defined in this file must be updated in:\r\n//    site/source/docs/api_reference/preamble.js.rst\r\n// A prebuilt local version of the documentation is available at:\r\n//    site/build/text/docs/api_reference/preamble.js.txt\r\n// You can also build docs locally as HTML or other formats in site/\r\n// An online HTML version (which may be of a different version of Emscripten)\r\n//    is up at http://kripken.github.io/emscripten-site/docs/api_reference/preamble.js.html\r\n\r\nvar wasmBinary;\r\nif (!Object.getOwnPropertyDescriptor(Module, 'wasmBinary')) {\r\n  Object.defineProperty(Module, 'wasmBinary', {\r\n    configurable: true,\r\n    get: function() {\r\n      abort('Module.wasmBinary has been replaced with plain wasmBinary (the initial value can be provided on Module, but after startup the value is only looked for on a local variable of that name)')\r\n    }\r\n  });\r\n}\r\nvar noExitRuntime = true;\r\nif (!Object.getOwnPropertyDescriptor(Module, 'noExitRuntime')) {\r\n  Object.defineProperty(Module, 'noExitRuntime', {\r\n    configurable: true,\r\n    get: function() {\r\n      abort('Module.noExitRuntime has been replaced with plain noExitRuntime (the initial value can be provided on Module, but after startup the value is only looked for on a local variable of that name)')\r\n    }\r\n  });\r\n}\r\n\r\nif (typeof WebAssembly !== 'object') {\r\n  abort('no native wasm support detected');\r\n}\r\n\r\n// include: runtime_safe_heap.js\r\n\r\n\r\n// In MINIMAL_RUNTIME, setValue() and getValue() are only available when building with safe heap enabled, for heap safety checking.\r\n// In traditional runtime, setValue() and getValue() are always available (although their use is highly discouraged due to perf penalties)\r\n\r\n/** @param {number} ptr\r\n    @param {number} value\r\n    @param {string} type\r\n    @param {number|boolean=} noSafe */\r\nfunction setValue(ptr, value, type, noSafe) {\r\n  type = type || 'i8';\r\n  if (type.charAt(type.length-1) === '*') type = 'i32';\r\n    switch (type) {\r\n      case 'i1': HEAP8[((ptr)>>0)] = value; break;\r\n      case 'i8': HEAP8[((ptr)>>0)] = value; break;\r\n      case 'i16': HEAP16[((ptr)>>1)] = value; break;\r\n      case 'i32': HEAP32[((ptr)>>2)] = value; break;\r\n      case 'i64': (tempI64 = [value>>>0,(tempDouble=value,(+(Math.abs(tempDouble))) >= 1.0 ? (tempDouble > 0.0 ? ((Math.min((+(Math.floor((tempDouble)/4294967296.0))), 4294967295.0))|0)>>>0 : (~~((+(Math.ceil((tempDouble - +(((~~(tempDouble)))>>>0))/4294967296.0)))))>>>0) : 0)],HEAP32[((ptr)>>2)] = tempI64[0],HEAP32[(((ptr)+(4))>>2)] = tempI64[1]); break;\r\n      case 'float': HEAPF32[((ptr)>>2)] = value; break;\r\n      case 'double': HEAPF64[((ptr)>>3)] = value; break;\r\n      default: abort('invalid type for setValue: ' + type);\r\n    }\r\n}\r\n\r\n/** @param {number} ptr\r\n    @param {string} type\r\n    @param {number|boolean=} noSafe */\r\nfunction getValue(ptr, type, noSafe) {\r\n  type = type || 'i8';\r\n  if (type.charAt(type.length-1) === '*') type = 'i32';\r\n    switch (type) {\r\n      case 'i1': return HEAP8[((ptr)>>0)];\r\n      case 'i8': return HEAP8[((ptr)>>0)];\r\n      case 'i16': return HEAP16[((ptr)>>1)];\r\n      case 'i32': return HEAP32[((ptr)>>2)];\r\n      case 'i64': return HEAP32[((ptr)>>2)];\r\n      case 'float': return HEAPF32[((ptr)>>2)];\r\n      case 'double': return Number(HEAPF64[((ptr)>>3)]);\r\n      default: abort('invalid type for getValue: ' + type);\r\n    }\r\n  return null;\r\n}\r\n\r\n// end include: runtime_safe_heap.js\r\n// Wasm globals\r\n\r\nvar wasmMemory;\r\n\r\n//========================================\r\n// Runtime essentials\r\n//========================================\r\n\r\n// whether we are quitting the application. no code should run after this.\r\n// set in exit() and abort()\r\nvar ABORT = false;\r\n\r\n// set by exit() and abort().  Passed to 'onExit' handler.\r\n// NOTE: This is also used as the process return code code in shell environments\r\n// but only when noExitRuntime is false.\r\nvar EXITSTATUS;\r\n\r\n/** @type {function(*, string=)} */\r\nfunction assert(condition, text) {\r\n  if (!condition) {\r\n    abort('Assertion failed: ' + text);\r\n  }\r\n}\r\n\r\n// Returns the C function with a specified identifier (for C++, you need to do manual name mangling)\r\nfunction getCFunc(ident) {\r\n  var func = Module['_' + ident]; // closure exported function\r\n  assert(func, 'Cannot call unknown function ' + ident + ', make sure it is exported');\r\n  return func;\r\n}\r\n\r\n// C calling interface.\r\n/** @param {string|null=} returnType\r\n    @param {Array=} argTypes\r\n    @param {Arguments|Array=} args\r\n    @param {Object=} opts */\r\nfunction ccall(ident, returnType, argTypes, args, opts) {\r\n  // For fast lookup of conversion functions\r\n  var toC = {\r\n    'string': function(str) {\r\n      var ret = 0;\r\n      if (str !== null && str !== undefined && str !== 0) { // null string\r\n        // at most 4 bytes per UTF-8 code point, +1 for the trailing '\\0'\r\n        var len = (str.length << 2) + 1;\r\n        ret = stackAlloc(len);\r\n        stringToUTF8(str, ret, len);\r\n      }\r\n      return ret;\r\n    },\r\n    'array': function(arr) {\r\n      var ret = stackAlloc(arr.length);\r\n      writeArrayToMemory(arr, ret);\r\n      return ret;\r\n    }\r\n  };\r\n\r\n  function convertReturnValue(ret) {\r\n    if (returnType === 'string') return UTF8ToString(ret);\r\n    if (returnType === 'boolean') return Boolean(ret);\r\n    return ret;\r\n  }\r\n\r\n  var func = getCFunc(ident);\r\n  var cArgs = [];\r\n  var stack = 0;\r\n  assert(returnType !== 'array', 'Return type should not be \"array\".');\r\n  if (args) {\r\n    for (var i = 0; i < args.length; i++) {\r\n      var converter = toC[argTypes[i]];\r\n      if (converter) {\r\n        if (stack === 0) stack = stackSave();\r\n        cArgs[i] = converter(args[i]);\r\n      } else {\r\n        cArgs[i] = args[i];\r\n      }\r\n    }\r\n  }\r\n  var ret = func.apply(null, cArgs);\r\n  function onDone(ret) {\r\n    if (stack !== 0) stackRestore(stack);\r\n    return convertReturnValue(ret);\r\n  }\r\n\r\n  ret = onDone(ret);\r\n  return ret;\r\n}\r\n\r\n/** @param {string=} returnType\r\n    @param {Array=} argTypes\r\n    @param {Object=} opts */\r\nfunction cwrap(ident, returnType, argTypes, opts) {\r\n  return function() {\r\n    return ccall(ident, returnType, argTypes, arguments, opts);\r\n  }\r\n}\r\n\r\n// We used to include malloc/free by default in the past. Show a helpful error in\r\n// builds with assertions.\r\n\r\nvar ALLOC_NORMAL = 0; // Tries to use _malloc()\r\nvar ALLOC_STACK = 1; // Lives for the duration of the current function call\r\n\r\n// allocate(): This is for internal use. You can use it yourself as well, but the interface\r\n//             is a little tricky (see docs right below). The reason is that it is optimized\r\n//             for multiple syntaxes to save space in generated code. So you should\r\n//             normally not use allocate(), and instead allocate memory using _malloc(),\r\n//             initialize it with setValue(), and so forth.\r\n// @slab: An array of data.\r\n// @allocator: How to allocate memory, see ALLOC_*\r\n/** @type {function((Uint8Array|Array<number>), number)} */\r\nfunction allocate(slab, allocator) {\r\n  var ret;\r\n  assert(typeof allocator === 'number', 'allocate no longer takes a type argument')\r\n  assert(typeof slab !== 'number', 'allocate no longer takes a number as arg0')\r\n\r\n  if (allocator == ALLOC_STACK) {\r\n    ret = stackAlloc(slab.length);\r\n  } else {\r\n    ret = _malloc(slab.length);\r\n  }\r\n\r\n  if (slab.subarray || slab.slice) {\r\n    HEAPU8.set(/** @type {!Uint8Array} */(slab), ret);\r\n  } else {\r\n    HEAPU8.set(new Uint8Array(slab), ret);\r\n  }\r\n  return ret;\r\n}\r\n\r\n// include: runtime_strings.js\r\n\r\n\r\n// runtime_strings.js: Strings related runtime functions that are part of both MINIMAL_RUNTIME and regular runtime.\r\n\r\n// Given a pointer 'ptr' to a null-terminated UTF8-encoded string in the given array that contains uint8 values, returns\r\n// a copy of that string as a Javascript String object.\r\n\r\nvar UTF8Decoder = typeof TextDecoder !== 'undefined' ? new TextDecoder('utf8') : undefined;\r\n\r\n/**\r\n * @param {number} idx\r\n * @param {number=} maxBytesToRead\r\n * @return {string}\r\n */\r\nfunction UTF8ArrayToString(heap, idx, maxBytesToRead) {\r\n  var endIdx = idx + maxBytesToRead;\r\n  var endPtr = idx;\r\n  // TextDecoder needs to know the byte length in advance, it doesn't stop on null terminator by itself.\r\n  // Also, use the length info to avoid running tiny strings through TextDecoder, since .subarray() allocates garbage.\r\n  // (As a tiny code save trick, compare endPtr against endIdx using a negation, so that undefined means Infinity)\r\n  while (heap[endPtr] && !(endPtr >= endIdx)) ++endPtr;\r\n\r\n  if (endPtr - idx > 16 && heap.subarray && UTF8Decoder) {\r\n    return UTF8Decoder.decode(heap.subarray(idx, endPtr));\r\n  } else {\r\n    var str = '';\r\n    // If building with TextDecoder, we have already computed the string length above, so test loop end condition against that\r\n    while (idx < endPtr) {\r\n      // For UTF8 byte structure, see:\r\n      // http://en.wikipedia.org/wiki/UTF-8#Description\r\n      // https://www.ietf.org/rfc/rfc2279.txt\r\n      // https://tools.ietf.org/html/rfc3629\r\n      var u0 = heap[idx++];\r\n      if (!(u0 & 0x80)) { str += String.fromCharCode(u0); continue; }\r\n      var u1 = heap[idx++] & 63;\r\n      if ((u0 & 0xE0) == 0xC0) { str += String.fromCharCode(((u0 & 31) << 6) | u1); continue; }\r\n      var u2 = heap[idx++] & 63;\r\n      if ((u0 & 0xF0) == 0xE0) {\r\n        u0 = ((u0 & 15) << 12) | (u1 << 6) | u2;\r\n      } else {\r\n        if ((u0 & 0xF8) != 0xF0) warnOnce('Invalid UTF-8 leading byte 0x' + u0.toString(16) + ' encountered when deserializing a UTF-8 string in wasm memory to a JS string!');\r\n        u0 = ((u0 & 7) << 18) | (u1 << 12) | (u2 << 6) | (heap[idx++] & 63);\r\n      }\r\n\r\n      if (u0 < 0x10000) {\r\n        str += String.fromCharCode(u0);\r\n      } else {\r\n        var ch = u0 - 0x10000;\r\n        str += String.fromCharCode(0xD800 | (ch >> 10), 0xDC00 | (ch & 0x3FF));\r\n      }\r\n    }\r\n  }\r\n  return str;\r\n}\r\n\r\n// Given a pointer 'ptr' to a null-terminated UTF8-encoded string in the emscripten HEAP, returns a\r\n// copy of that string as a Javascript String object.\r\n// maxBytesToRead: an optional length that specifies the maximum number of bytes to read. You can omit\r\n//                 this parameter to scan the string until the first \\0 byte. If maxBytesToRead is\r\n//                 passed, and the string at [ptr, ptr+maxBytesToReadr[ contains a null byte in the\r\n//                 middle, then the string will cut short at that byte index (i.e. maxBytesToRead will\r\n//                 not produce a string of exact length [ptr, ptr+maxBytesToRead[)\r\n//                 N.B. mixing frequent uses of UTF8ToString() with and without maxBytesToRead may\r\n//                 throw JS JIT optimizations off, so it is worth to consider consistently using one\r\n//                 style or the other.\r\n/**\r\n * @param {number} ptr\r\n * @param {number=} maxBytesToRead\r\n * @return {string}\r\n */\r\nfunction UTF8ToString(ptr, maxBytesToRead) {\r\n  ;\r\n  return ptr ? UTF8ArrayToString(HEAPU8, ptr, maxBytesToRead) : '';\r\n}\r\n\r\n// Copies the given Javascript String object 'str' to the given byte array at address 'outIdx',\r\n// encoded in UTF8 form and null-terminated. The copy will require at most str.length*4+1 bytes of space in the HEAP.\r\n// Use the function lengthBytesUTF8 to compute the exact number of bytes (excluding null terminator) that this function will write.\r\n// Parameters:\r\n//   str: the Javascript string to copy.\r\n//   heap: the array to copy to. Each index in this array is assumed to be one 8-byte element.\r\n//   outIdx: The starting offset in the array to begin the copying.\r\n//   maxBytesToWrite: The maximum number of bytes this function can write to the array.\r\n//                    This count should include the null terminator,\r\n//                    i.e. if maxBytesToWrite=1, only the null terminator will be written and nothing else.\r\n//                    maxBytesToWrite=0 does not write any bytes to the output, not even the null terminator.\r\n// Returns the number of bytes written, EXCLUDING the null terminator.\r\n\r\nfunction stringToUTF8Array(str, heap, outIdx, maxBytesToWrite) {\r\n  if (!(maxBytesToWrite > 0)) // Parameter maxBytesToWrite is not optional. Negative values, 0, null, undefined and false each don't write out any bytes.\r\n    return 0;\r\n\r\n  var startIdx = outIdx;\r\n  var endIdx = outIdx + maxBytesToWrite - 1; // -1 for string null terminator.\r\n  for (var i = 0; i < str.length; ++i) {\r\n    // Gotcha: charCodeAt returns a 16-bit word that is a UTF-16 encoded code unit, not a Unicode code point of the character! So decode UTF16->UTF32->UTF8.\r\n    // See http://unicode.org/faq/utf_bom.html#utf16-3\r\n    // For UTF8 byte structure, see http://en.wikipedia.org/wiki/UTF-8#Description and https://www.ietf.org/rfc/rfc2279.txt and https://tools.ietf.org/html/rfc3629\r\n    var u = str.charCodeAt(i); // possibly a lead surrogate\r\n    if (u >= 0xD800 && u <= 0xDFFF) {\r\n      var u1 = str.charCodeAt(++i);\r\n      u = 0x10000 + ((u & 0x3FF) << 10) | (u1 & 0x3FF);\r\n    }\r\n    if (u <= 0x7F) {\r\n      if (outIdx >= endIdx) break;\r\n      heap[outIdx++] = u;\r\n    } else if (u <= 0x7FF) {\r\n      if (outIdx + 1 >= endIdx) break;\r\n      heap[outIdx++] = 0xC0 | (u >> 6);\r\n      heap[outIdx++] = 0x80 | (u & 63);\r\n    } else if (u <= 0xFFFF) {\r\n      if (outIdx + 2 >= endIdx) break;\r\n      heap[outIdx++] = 0xE0 | (u >> 12);\r\n      heap[outIdx++] = 0x80 | ((u >> 6) & 63);\r\n      heap[outIdx++] = 0x80 | (u & 63);\r\n    } else {\r\n      if (outIdx + 3 >= endIdx) break;\r\n      if (u > 0x10FFFF) warnOnce('Invalid Unicode code point 0x' + u.toString(16) + ' encountered when serializing a JS string to a UTF-8 string in wasm memory! (Valid unicode code points should be in range 0-0x10FFFF).');\r\n      heap[outIdx++] = 0xF0 | (u >> 18);\r\n      heap[outIdx++] = 0x80 | ((u >> 12) & 63);\r\n      heap[outIdx++] = 0x80 | ((u >> 6) & 63);\r\n      heap[outIdx++] = 0x80 | (u & 63);\r\n    }\r\n  }\r\n  // Null-terminate the pointer to the buffer.\r\n  heap[outIdx] = 0;\r\n  return outIdx - startIdx;\r\n}\r\n\r\n// Copies the given Javascript String object 'str' to the emscripten HEAP at address 'outPtr',\r\n// null-terminated and encoded in UTF8 form. The copy will require at most str.length*4+1 bytes of space in the HEAP.\r\n// Use the function lengthBytesUTF8 to compute the exact number of bytes (excluding null terminator) that this function will write.\r\n// Returns the number of bytes written, EXCLUDING the null terminator.\r\n\r\nfunction stringToUTF8(str, outPtr, maxBytesToWrite) {\r\n  assert(typeof maxBytesToWrite == 'number', 'stringToUTF8(str, outPtr, maxBytesToWrite) is missing the third parameter that specifies the length of the output buffer!');\r\n  return stringToUTF8Array(str, HEAPU8,outPtr, maxBytesToWrite);\r\n}\r\n\r\n// Returns the number of bytes the given Javascript string takes if encoded as a UTF8 byte array, EXCLUDING the null terminator byte.\r\nfunction lengthBytesUTF8(str) {\r\n  var len = 0;\r\n  for (var i = 0; i < str.length; ++i) {\r\n    // Gotcha: charCodeAt returns a 16-bit word that is a UTF-16 encoded code unit, not a Unicode code point of the character! So decode UTF16->UTF32->UTF8.\r\n    // See http://unicode.org/faq/utf_bom.html#utf16-3\r\n    var u = str.charCodeAt(i); // possibly a lead surrogate\r\n    if (u >= 0xD800 && u <= 0xDFFF) u = 0x10000 + ((u & 0x3FF) << 10) | (str.charCodeAt(++i) & 0x3FF);\r\n    if (u <= 0x7F) ++len;\r\n    else if (u <= 0x7FF) len += 2;\r\n    else if (u <= 0xFFFF) len += 3;\r\n    else len += 4;\r\n  }\r\n  return len;\r\n}\r\n\r\n// end include: runtime_strings.js\r\n// include: runtime_strings_extra.js\r\n\r\n\r\n// runtime_strings_extra.js: Strings related runtime functions that are available only in regular runtime.\r\n\r\n// Given a pointer 'ptr' to a null-terminated ASCII-encoded string in the emscripten HEAP, returns\r\n// a copy of that string as a Javascript String object.\r\n\r\nfunction AsciiToString(ptr) {\r\n  var str = '';\r\n  while (1) {\r\n    var ch = HEAPU8[((ptr++)>>0)];\r\n    if (!ch) return str;\r\n    str += String.fromCharCode(ch);\r\n  }\r\n}\r\n\r\n// Copies the given Javascript String object 'str' to the emscripten HEAP at address 'outPtr',\r\n// null-terminated and encoded in ASCII form. The copy will require at most str.length+1 bytes of space in the HEAP.\r\n\r\nfunction stringToAscii(str, outPtr) {\r\n  return writeAsciiToMemory(str, outPtr, false);\r\n}\r\n\r\n// Given a pointer 'ptr' to a null-terminated UTF16LE-encoded string in the emscripten HEAP, returns\r\n// a copy of that string as a Javascript String object.\r\n\r\nvar UTF16Decoder = typeof TextDecoder !== 'undefined' ? new TextDecoder('utf-16le') : undefined;\r\n\r\nfunction UTF16ToString(ptr, maxBytesToRead) {\r\n  assert(ptr % 2 == 0, 'Pointer passed to UTF16ToString must be aligned to two bytes!');\r\n  var endPtr = ptr;\r\n  // TextDecoder needs to know the byte length in advance, it doesn't stop on null terminator by itself.\r\n  // Also, use the length info to avoid running tiny strings through TextDecoder, since .subarray() allocates garbage.\r\n  var idx = endPtr >> 1;\r\n  var maxIdx = idx + maxBytesToRead / 2;\r\n  // If maxBytesToRead is not passed explicitly, it will be undefined, and this\r\n  // will always evaluate to true. This saves on code size.\r\n  while (!(idx >= maxIdx) && HEAPU16[idx]) ++idx;\r\n  endPtr = idx << 1;\r\n\r\n  if (endPtr - ptr > 32 && UTF16Decoder) {\r\n    return UTF16Decoder.decode(HEAPU8.subarray(ptr, endPtr));\r\n  } else {\r\n    var str = '';\r\n\r\n    // If maxBytesToRead is not passed explicitly, it will be undefined, and the for-loop's condition\r\n    // will always evaluate to true. The loop is then terminated on the first null char.\r\n    for (var i = 0; !(i >= maxBytesToRead / 2); ++i) {\r\n      var codeUnit = HEAP16[(((ptr)+(i*2))>>1)];\r\n      if (codeUnit == 0) break;\r\n      // fromCharCode constructs a character from a UTF-16 code unit, so we can pass the UTF16 string right through.\r\n      str += String.fromCharCode(codeUnit);\r\n    }\r\n\r\n    return str;\r\n  }\r\n}\r\n\r\n// Copies the given Javascript String object 'str' to the emscripten HEAP at address 'outPtr',\r\n// null-terminated and encoded in UTF16 form. The copy will require at most str.length*4+2 bytes of space in the HEAP.\r\n// Use the function lengthBytesUTF16() to compute the exact number of bytes (excluding null terminator) that this function will write.\r\n// Parameters:\r\n//   str: the Javascript string to copy.\r\n//   outPtr: Byte address in Emscripten HEAP where to write the string to.\r\n//   maxBytesToWrite: The maximum number of bytes this function can write to the array. This count should include the null\r\n//                    terminator, i.e. if maxBytesToWrite=2, only the null terminator will be written and nothing else.\r\n//                    maxBytesToWrite<2 does not write any bytes to the output, not even the null terminator.\r\n// Returns the number of bytes written, EXCLUDING the null terminator.\r\n\r\nfunction stringToUTF16(str, outPtr, maxBytesToWrite) {\r\n  assert(outPtr % 2 == 0, 'Pointer passed to stringToUTF16 must be aligned to two bytes!');\r\n  assert(typeof maxBytesToWrite == 'number', 'stringToUTF16(str, outPtr, maxBytesToWrite) is missing the third parameter that specifies the length of the output buffer!');\r\n  // Backwards compatibility: if max bytes is not specified, assume unsafe unbounded write is allowed.\r\n  if (maxBytesToWrite === undefined) {\r\n    maxBytesToWrite = 0x7FFFFFFF;\r\n  }\r\n  if (maxBytesToWrite < 2) return 0;\r\n  maxBytesToWrite -= 2; // Null terminator.\r\n  var startPtr = outPtr;\r\n  var numCharsToWrite = (maxBytesToWrite < str.length*2) ? (maxBytesToWrite / 2) : str.length;\r\n  for (var i = 0; i < numCharsToWrite; ++i) {\r\n    // charCodeAt returns a UTF-16 encoded code unit, so it can be directly written to the HEAP.\r\n    var codeUnit = str.charCodeAt(i); // possibly a lead surrogate\r\n    HEAP16[((outPtr)>>1)] = codeUnit;\r\n    outPtr += 2;\r\n  }\r\n  // Null-terminate the pointer to the HEAP.\r\n  HEAP16[((outPtr)>>1)] = 0;\r\n  return outPtr - startPtr;\r\n}\r\n\r\n// Returns the number of bytes the given Javascript string takes if encoded as a UTF16 byte array, EXCLUDING the null terminator byte.\r\n\r\nfunction lengthBytesUTF16(str) {\r\n  return str.length*2;\r\n}\r\n\r\nfunction UTF32ToString(ptr, maxBytesToRead) {\r\n  assert(ptr % 4 == 0, 'Pointer passed to UTF32ToString must be aligned to four bytes!');\r\n  var i = 0;\r\n\r\n  var str = '';\r\n  // If maxBytesToRead is not passed explicitly, it will be undefined, and this\r\n  // will always evaluate to true. This saves on code size.\r\n  while (!(i >= maxBytesToRead / 4)) {\r\n    var utf32 = HEAP32[(((ptr)+(i*4))>>2)];\r\n    if (utf32 == 0) break;\r\n    ++i;\r\n    // Gotcha: fromCharCode constructs a character from a UTF-16 encoded code (pair), not from a Unicode code point! So encode the code point to UTF-16 for constructing.\r\n    // See http://unicode.org/faq/utf_bom.html#utf16-3\r\n    if (utf32 >= 0x10000) {\r\n      var ch = utf32 - 0x10000;\r\n      str += String.fromCharCode(0xD800 | (ch >> 10), 0xDC00 | (ch & 0x3FF));\r\n    } else {\r\n      str += String.fromCharCode(utf32);\r\n    }\r\n  }\r\n  return str;\r\n}\r\n\r\n// Copies the given Javascript String object 'str' to the emscripten HEAP at address 'outPtr',\r\n// null-terminated and encoded in UTF32 form. The copy will require at most str.length*4+4 bytes of space in the HEAP.\r\n// Use the function lengthBytesUTF32() to compute the exact number of bytes (excluding null terminator) that this function will write.\r\n// Parameters:\r\n//   str: the Javascript string to copy.\r\n//   outPtr: Byte address in Emscripten HEAP where to write the string to.\r\n//   maxBytesToWrite: The maximum number of bytes this function can write to the array. This count should include the null\r\n//                    terminator, i.e. if maxBytesToWrite=4, only the null terminator will be written and nothing else.\r\n//                    maxBytesToWrite<4 does not write any bytes to the output, not even the null terminator.\r\n// Returns the number of bytes written, EXCLUDING the null terminator.\r\n\r\nfunction stringToUTF32(str, outPtr, maxBytesToWrite) {\r\n  assert(outPtr % 4 == 0, 'Pointer passed to stringToUTF32 must be aligned to four bytes!');\r\n  assert(typeof maxBytesToWrite == 'number', 'stringToUTF32(str, outPtr, maxBytesToWrite) is missing the third parameter that specifies the length of the output buffer!');\r\n  // Backwards compatibility: if max bytes is not specified, assume unsafe unbounded write is allowed.\r\n  if (maxBytesToWrite === undefined) {\r\n    maxBytesToWrite = 0x7FFFFFFF;\r\n  }\r\n  if (maxBytesToWrite < 4) return 0;\r\n  var startPtr = outPtr;\r\n  var endPtr = startPtr + maxBytesToWrite - 4;\r\n  for (var i = 0; i < str.length; ++i) {\r\n    // Gotcha: charCodeAt returns a 16-bit word that is a UTF-16 encoded code unit, not a Unicode code point of the character! We must decode the string to UTF-32 to the heap.\r\n    // See http://unicode.org/faq/utf_bom.html#utf16-3\r\n    var codeUnit = str.charCodeAt(i); // possibly a lead surrogate\r\n    if (codeUnit >= 0xD800 && codeUnit <= 0xDFFF) {\r\n      var trailSurrogate = str.charCodeAt(++i);\r\n      codeUnit = 0x10000 + ((codeUnit & 0x3FF) << 10) | (trailSurrogate & 0x3FF);\r\n    }\r\n    HEAP32[((outPtr)>>2)] = codeUnit;\r\n    outPtr += 4;\r\n    if (outPtr + 4 > endPtr) break;\r\n  }\r\n  // Null-terminate the pointer to the HEAP.\r\n  HEAP32[((outPtr)>>2)] = 0;\r\n  return outPtr - startPtr;\r\n}\r\n\r\n// Returns the number of bytes the given Javascript string takes if encoded as a UTF16 byte array, EXCLUDING the null terminator byte.\r\n\r\nfunction lengthBytesUTF32(str) {\r\n  var len = 0;\r\n  for (var i = 0; i < str.length; ++i) {\r\n    // Gotcha: charCodeAt returns a 16-bit word that is a UTF-16 encoded code unit, not a Unicode code point of the character! We must decode the string to UTF-32 to the heap.\r\n    // See http://unicode.org/faq/utf_bom.html#utf16-3\r\n    var codeUnit = str.charCodeAt(i);\r\n    if (codeUnit >= 0xD800 && codeUnit <= 0xDFFF) ++i; // possibly a lead surrogate, so skip over the tail surrogate.\r\n    len += 4;\r\n  }\r\n\r\n  return len;\r\n}\r\n\r\n// Allocate heap space for a JS string, and write it there.\r\n// It is the responsibility of the caller to free() that memory.\r\nfunction allocateUTF8(str) {\r\n  var size = lengthBytesUTF8(str) + 1;\r\n  var ret = _malloc(size);\r\n  if (ret) stringToUTF8Array(str, HEAP8, ret, size);\r\n  return ret;\r\n}\r\n\r\n// Allocate stack space for a JS string, and write it there.\r\nfunction allocateUTF8OnStack(str) {\r\n  var size = lengthBytesUTF8(str) + 1;\r\n  var ret = stackAlloc(size);\r\n  stringToUTF8Array(str, HEAP8, ret, size);\r\n  return ret;\r\n}\r\n\r\n// Deprecated: This function should not be called because it is unsafe and does not provide\r\n// a maximum length limit of how many bytes it is allowed to write. Prefer calling the\r\n// function stringToUTF8Array() instead, which takes in a maximum length that can be used\r\n// to be secure from out of bounds writes.\r\n/** @deprecated\r\n    @param {boolean=} dontAddNull */\r\nfunction writeStringToMemory(string, buffer, dontAddNull) {\r\n  warnOnce('writeStringToMemory is deprecated and should not be called! Use stringToUTF8() instead!');\r\n\r\n  var /** @type {number} */ lastChar, /** @type {number} */ end;\r\n  if (dontAddNull) {\r\n    // stringToUTF8Array always appends null. If we don't want to do that, remember the\r\n    // character that existed at the location where the null will be placed, and restore\r\n    // that after the write (below).\r\n    end = buffer + lengthBytesUTF8(string);\r\n    lastChar = HEAP8[end];\r\n  }\r\n  stringToUTF8(string, buffer, Infinity);\r\n  if (dontAddNull) HEAP8[end] = lastChar; // Restore the value under the null character.\r\n}\r\n\r\nfunction writeArrayToMemory(array, buffer) {\r\n  assert(array.length >= 0, 'writeArrayToMemory array must have a length (should be an array or typed array)')\r\n  HEAP8.set(array, buffer);\r\n}\r\n\r\n/** @param {boolean=} dontAddNull */\r\nfunction writeAsciiToMemory(str, buffer, dontAddNull) {\r\n  for (var i = 0; i < str.length; ++i) {\r\n    assert(str.charCodeAt(i) === (str.charCodeAt(i) & 0xff));\r\n    HEAP8[((buffer++)>>0)] = str.charCodeAt(i);\r\n  }\r\n  // Null-terminate the pointer to the HEAP.\r\n  if (!dontAddNull) HEAP8[((buffer)>>0)] = 0;\r\n}\r\n\r\n// end include: runtime_strings_extra.js\r\n// Memory management\r\n\r\nfunction alignUp(x, multiple) {\r\n  if (x % multiple > 0) {\r\n    x += multiple - (x % multiple);\r\n  }\r\n  return x;\r\n}\r\n\r\nvar HEAP,\r\n/** @type {ArrayBuffer} */\r\n  buffer,\r\n/** @type {Int8Array} */\r\n  HEAP8,\r\n/** @type {Uint8Array} */\r\n  HEAPU8,\r\n/** @type {Int16Array} */\r\n  HEAP16,\r\n/** @type {Uint16Array} */\r\n  HEAPU16,\r\n/** @type {Int32Array} */\r\n  HEAP32,\r\n/** @type {Uint32Array} */\r\n  HEAPU32,\r\n/** @type {Float32Array} */\r\n  HEAPF32,\r\n/** @type {Float64Array} */\r\n  HEAPF64;\r\n\r\nfunction updateGlobalBufferAndViews(buf) {\r\n  buffer = buf;\r\n  Module['HEAP8'] = HEAP8 = new Int8Array(buf);\r\n  Module['HEAP16'] = HEAP16 = new Int16Array(buf);\r\n  Module['HEAP32'] = HEAP32 = new Int32Array(buf);\r\n  Module['HEAPU8'] = HEAPU8 = new Uint8Array(buf);\r\n  Module['HEAPU16'] = HEAPU16 = new Uint16Array(buf);\r\n  Module['HEAPU32'] = HEAPU32 = new Uint32Array(buf);\r\n  Module['HEAPF32'] = HEAPF32 = new Float32Array(buf);\r\n  Module['HEAPF64'] = HEAPF64 = new Float64Array(buf);\r\n}\r\n\r\nvar TOTAL_STACK = 5242880;\r\nif (Module['TOTAL_STACK']) assert(TOTAL_STACK === Module['TOTAL_STACK'], 'the stack size can no longer be determined at runtime')\r\n\r\nvar INITIAL_MEMORY = 16777216;\r\nif (!Object.getOwnPropertyDescriptor(Module, 'INITIAL_MEMORY')) {\r\n  Object.defineProperty(Module, 'INITIAL_MEMORY', {\r\n    configurable: true,\r\n    get: function() {\r\n      abort('Module.INITIAL_MEMORY has been replaced with plain INITIAL_MEMORY (the initial value can be provided on Module, but after startup the value is only looked for on a local variable of that name)')\r\n    }\r\n  });\r\n}\r\n\r\nassert(INITIAL_MEMORY >= TOTAL_STACK, 'INITIAL_MEMORY should be larger than TOTAL_STACK, was ' + INITIAL_MEMORY + '! (TOTAL_STACK=' + TOTAL_STACK + ')');\r\n\r\n// check for full engine support (use string 'subarray' to avoid closure compiler confusion)\r\nassert(typeof Int32Array !== 'undefined' && typeof Float64Array !== 'undefined' && Int32Array.prototype.subarray !== undefined && Int32Array.prototype.set !== undefined,\r\n       'JS engine does not provide full typed array support');\r\n\r\n// If memory is defined in wasm, the user can't provide it.\r\nassert(!Module['wasmMemory'], 'Use of `wasmMemory` detected.  Use -s IMPORTED_MEMORY to define wasmMemory externally');\r\nassert(INITIAL_MEMORY == 16777216, 'Detected runtime INITIAL_MEMORY setting.  Use -s IMPORTED_MEMORY to define wasmMemory dynamically');\r\n\r\n// include: runtime_init_table.js\r\n// In regular non-RELOCATABLE mode the table is exported\r\n// from the wasm module and this will be assigned once\r\n// the exports are available.\r\nvar wasmTable;\r\n\r\n// end include: runtime_init_table.js\r\n// include: runtime_stack_check.js\r\n\r\n\r\n// Initializes the stack cookie. Called at the startup of main and at the startup of each thread in pthreads mode.\r\nfunction writeStackCookie() {\r\n  var max = _emscripten_stack_get_end();\r\n  assert((max & 3) == 0);\r\n  // The stack grows downwards\r\n  HEAP32[((max + 4)>>2)] = 0x2135467;\r\n  HEAP32[((max + 8)>>2)] = 0x89BACDFE;\r\n  // Also test the global address 0 for integrity.\r\n  HEAP32[0] = 0x63736d65; /* 'emsc' */\r\n}\r\n\r\nfunction checkStackCookie() {\r\n  if (ABORT) return;\r\n  var max = _emscripten_stack_get_end();\r\n  var cookie1 = HEAPU32[((max + 4)>>2)];\r\n  var cookie2 = HEAPU32[((max + 8)>>2)];\r\n  if (cookie1 != 0x2135467 || cookie2 != 0x89BACDFE) {\r\n    abort('Stack overflow! Stack cookie has been overwritten, expected hex dwords 0x89BACDFE and 0x2135467, but received 0x' + cookie2.toString(16) + ' 0x' + cookie1.toString(16));\r\n  }\r\n  // Also test the global address 0 for integrity.\r\n  if (HEAP32[0] !== 0x63736d65 /* 'emsc' */) abort('Runtime error: The application has corrupted its heap memory area (address zero)!');\r\n}\r\n\r\n// end include: runtime_stack_check.js\r\n// include: runtime_assertions.js\r\n\r\n\r\n// Endianness check\r\n(function() {\r\n  var h16 = new Int16Array(1);\r\n  var h8 = new Int8Array(h16.buffer);\r\n  h16[0] = 0x6373;\r\n  if (h8[0] !== 0x73 || h8[1] !== 0x63) throw 'Runtime error: expected the system to be little-endian! (Run with -s SUPPORT_BIG_ENDIAN=1 to bypass)';\r\n})();\r\n\r\n// end include: runtime_assertions.js\r\nvar __ATPRERUN__  = []; // functions called before the runtime is initialized\r\nvar __ATINIT__    = []; // functions called during startup\r\nvar __ATEXIT__    = []; // functions called during shutdown\r\nvar __ATPOSTRUN__ = []; // functions called after the main() is called\r\n\r\nvar runtimeInitialized = false;\r\nvar runtimeExited = false;\r\nvar runtimeKeepaliveCounter = 0;\r\n\r\nfunction keepRuntimeAlive() {\r\n  return noExitRuntime || runtimeKeepaliveCounter > 0;\r\n}\r\n\r\nfunction preRun() {\r\n\r\n  callRuntimeCallbacks(__ATPRERUN__);\r\n}\r\n\r\nfunction initRuntime() {\r\n  checkStackCookie();\r\n  assert(!runtimeInitialized);\r\n  runtimeInitialized = true;\r\n\r\n  \r\n  callRuntimeCallbacks(__ATINIT__);\r\n}\r\n\r\nfunction exitRuntime() {\r\n  checkStackCookie();\r\n  runtimeExited = true;\r\n}\r\n\r\nfunction postRun() {\r\n  checkStackCookie();\r\n\r\n  callRuntimeCallbacks(__ATPOSTRUN__);\r\n}\r\n\r\nfunction addOnPreRun(cb) {\r\n  __ATPRERUN__.unshift(cb);\r\n}\r\n\r\nfunction addOnInit(cb) {\r\n  __ATINIT__.unshift(cb);\r\n}\r\n\r\nfunction addOnExit(cb) {\r\n}\r\n\r\nfunction addOnPostRun(cb) {\r\n  __ATPOSTRUN__.unshift(cb);\r\n}\r\n\r\n// include: runtime_math.js\r\n\r\n\r\n// https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Math/imul\r\n\r\n// https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Math/fround\r\n\r\n// https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Math/clz32\r\n\r\n// https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Math/trunc\r\n\r\nassert(Math.imul, 'This browser does not support Math.imul(), build with LEGACY_VM_SUPPORT or POLYFILL_OLD_MATH_FUNCTIONS to add in a polyfill');\r\nassert(Math.fround, 'This browser does not support Math.fround(), build with LEGACY_VM_SUPPORT or POLYFILL_OLD_MATH_FUNCTIONS to add in a polyfill');\r\nassert(Math.clz32, 'This browser does not support Math.clz32(), build with LEGACY_VM_SUPPORT or POLYFILL_OLD_MATH_FUNCTIONS to add in a polyfill');\r\nassert(Math.trunc, 'This browser does not support Math.trunc(), build with LEGACY_VM_SUPPORT or POLYFILL_OLD_MATH_FUNCTIONS to add in a polyfill');\r\n\r\n// end include: runtime_math.js\r\n// A counter of dependencies for calling run(). If we need to\r\n// do asynchronous work before running, increment this and\r\n// decrement it. Incrementing must happen in a place like\r\n// Module.preRun (used by emcc to add file preloading).\r\n// Note that you can add dependencies in preRun, even though\r\n// it happens right before run - run will be postponed until\r\n// the dependencies are met.\r\nvar runDependencies = 0;\r\nvar runDependencyWatcher = null;\r\nvar dependenciesFulfilled = null; // overridden to take different actions when all run dependencies are fulfilled\r\nvar runDependencyTracking = {};\r\n\r\nfunction getUniqueRunDependency(id) {\r\n  var orig = id;\r\n  while (1) {\r\n    if (!runDependencyTracking[id]) return id;\r\n    id = orig + Math.random();\r\n  }\r\n}\r\n\r\nfunction addRunDependency(id) {\r\n  runDependencies++;\r\n\r\n  if (id) {\r\n    assert(!runDependencyTracking[id]);\r\n    runDependencyTracking[id] = 1;\r\n    if (runDependencyWatcher === null && typeof setInterval !== 'undefined') {\r\n      // Check for missing dependencies every few seconds\r\n      runDependencyWatcher = setInterval(function() {\r\n        if (ABORT) {\r\n          clearInterval(runDependencyWatcher);\r\n          runDependencyWatcher = null;\r\n          return;\r\n        }\r\n        var shown = false;\r\n        for (var dep in runDependencyTracking) {\r\n          if (!shown) {\r\n            shown = true;\r\n            err('still waiting on run dependencies:');\r\n          }\r\n          err('dependency: ' + dep);\r\n        }\r\n        if (shown) {\r\n          err('(end of list)');\r\n        }\r\n      }, 10000);\r\n    }\r\n  } else {\r\n    err('warning: run dependency added without ID');\r\n  }\r\n}\r\n\r\nfunction removeRunDependency(id) {\r\n  runDependencies--;\r\n\r\n  if (id) {\r\n    assert(runDependencyTracking[id]);\r\n    delete runDependencyTracking[id];\r\n  } else {\r\n    err('warning: run dependency removed without ID');\r\n  }\r\n  if (runDependencies == 0) {\r\n    if (runDependencyWatcher !== null) {\r\n      clearInterval(runDependencyWatcher);\r\n      runDependencyWatcher = null;\r\n    }\r\n    if (dependenciesFulfilled) {\r\n      var callback = dependenciesFulfilled;\r\n      dependenciesFulfilled = null;\r\n      callback(); // can add another dependenciesFulfilled\r\n    }\r\n  }\r\n}\r\n\r\nModule[\"preloadedImages\"] = {}; // maps url to image data\r\nModule[\"preloadedAudios\"] = {}; // maps url to audio data\r\n\r\n/** @param {string|number=} what */\r\nfunction abort(what) {\r\n\r\n  what = 'Aborted(' + what + ')';\r\n  // TODO(sbc): Should we remove printing and leave it up to whoever\r\n  // catches the exception?\r\n  err(what);\r\n\r\n  ABORT = true;\r\n  EXITSTATUS = 1;\r\n\r\n  // Use a wasm runtime error, because a JS error might be seen as a foreign\r\n  // exception, which means we'd run destructors on it. We need the error to\r\n  // simply make the program stop.\r\n  var e = new WebAssembly.RuntimeError(what);\r\n\r\n  readyPromiseReject(e);\r\n  // Throw the error whether or not MODULARIZE is set because abort is used\r\n  // in code paths apart from instantiation where an exception is expected\r\n  // to be thrown when abort is called.\r\n  throw e;\r\n}\r\n\r\n// {{MEM_INITIALIZER}}\r\n\r\n// include: memoryprofiler.js\r\n\r\n\r\n// end include: memoryprofiler.js\r\n// show errors on likely calls to FS when it was not included\r\nvar FS = {\r\n  error: function() {\r\n    abort('Filesystem support (FS) was not included. The problem is that you are using files from JS, but files were not used from C/C++, so filesystem support was not auto-included. You can force-include filesystem support with  -s FORCE_FILESYSTEM=1');\r\n  },\r\n  init: function() { FS.error() },\r\n  createDataFile: function() { FS.error() },\r\n  createPreloadedFile: function() { FS.error() },\r\n  createLazyFile: function() { FS.error() },\r\n  open: function() { FS.error() },\r\n  mkdev: function() { FS.error() },\r\n  registerDevice: function() { FS.error() },\r\n  analyzePath: function() { FS.error() },\r\n  loadFilesFromDB: function() { FS.error() },\r\n\r\n  ErrnoError: function ErrnoError() { FS.error() },\r\n};\r\nModule['FS_createDataFile'] = FS.createDataFile;\r\nModule['FS_createPreloadedFile'] = FS.createPreloadedFile;\r\n\r\n// include: URIUtils.js\r\n\r\n\r\n// Prefix of data URIs emitted by SINGLE_FILE and related options.\r\nvar dataURIPrefix = 'data:application/octet-stream;base64,';\r\n\r\n// Indicates whether filename is a base64 data URI.\r\nfunction isDataURI(filename) {\r\n  // Prefix of data URIs emitted by SINGLE_FILE and related options.\r\n  return filename.startsWith(dataURIPrefix);\r\n}\r\n\r\n// Indicates whether filename is delivered via file protocol (as opposed to http/https)\r\nfunction isFileURI(filename) {\r\n  return filename.startsWith('file://');\r\n}\r\n\r\n// end include: URIUtils.js\r\nfunction createExportWrapper(name, fixedasm) {\r\n  return function() {\r\n    var displayName = name;\r\n    var asm = fixedasm;\r\n    if (!fixedasm) {\r\n      asm = Module['asm'];\r\n    }\r\n    assert(runtimeInitialized, 'native function `' + displayName + '` called before runtime initialization');\r\n    assert(!runtimeExited, 'native function `' + displayName + '` called after runtime exit (use NO_EXIT_RUNTIME to keep it alive after main() exits)');\r\n    if (!asm[name]) {\r\n      assert(asm[name], 'exported native function `' + displayName + '` not found');\r\n    }\r\n    return asm[name].apply(null, arguments);\r\n  };\r\n}\r\n\r\nvar wasmBinaryFile;\r\nif (Module['locateFile']) {\r\n  wasmBinaryFile = 'sock_c.wasm';\r\n  if (!isDataURI(wasmBinaryFile)) {\r\n    wasmBinaryFile = locateFile(wasmBinaryFile);\r\n  }\r\n} else {\r\n  // Use bundler-friendly `new URL(..., import.meta.url)` pattern; works in browsers too.\r\n  wasmBinaryFile = new URL('sock_c.wasm', import.meta.url).toString();\r\n}\r\n\r\nfunction getBinary(file) {\r\n  try {\r\n    if (file == wasmBinaryFile && wasmBinary) {\r\n      return new Uint8Array(wasmBinary);\r\n    }\r\n    if (readBinary) {\r\n      return readBinary(file);\r\n    } else {\r\n      throw \"both async and sync fetching of the wasm failed\";\r\n    }\r\n  }\r\n  catch (err) {\r\n    abort(err);\r\n  }\r\n}\r\n\r\nfunction getBinaryPromise() {\r\n  // If we don't have the binary yet, try to to load it asynchronously.\r\n  // Fetch has some additional restrictions over XHR, like it can't be used on a file:// url.\r\n  // See https://github.com/github/fetch/pull/92#issuecomment-140665932\r\n  // Cordova or Electron apps are typically loaded from a file:// url.\r\n  // So use fetch if it is available and the url is not a file, otherwise fall back to XHR.\r\n  if (!wasmBinary && (ENVIRONMENT_IS_WEB || ENVIRONMENT_IS_WORKER)) {\r\n    if (typeof fetch === 'function'\r\n    ) {\r\n      return fetch(wasmBinaryFile, { credentials: 'same-origin' }).then(function(response) {\r\n        if (!response['ok']) {\r\n          throw \"failed to load wasm binary file at '\" + wasmBinaryFile + \"'\";\r\n        }\r\n        return response['arrayBuffer']();\r\n      }).catch(function () {\r\n          return getBinary(wasmBinaryFile);\r\n      });\r\n    }\r\n  }\r\n\r\n  // Otherwise, getBinary should be able to get it synchronously\r\n  return Promise.resolve().then(function() { return getBinary(wasmBinaryFile); });\r\n}\r\n\r\n// Create the wasm instance.\r\n// Receives the wasm imports, returns the exports.\r\nfunction createWasm() {\r\n  // prepare imports\r\n  var info = {\r\n    'env': asmLibraryArg,\r\n    'wasi_snapshot_preview1': asmLibraryArg,\r\n  };\r\n  // Load the wasm module and create an instance of using native support in the JS engine.\r\n  // handle a generated wasm instance, receiving its exports and\r\n  // performing other necessary setup\r\n  /** @param {WebAssembly.Module=} module*/\r\n  function receiveInstance(instance, module) {\r\n    var exports = instance.exports;\r\n\r\n    Module['asm'] = exports;\r\n\r\n    wasmMemory = Module['asm']['memory'];\r\n    assert(wasmMemory, \"memory not found in wasm exports\");\r\n    // This assertion doesn't hold when emscripten is run in --post-link\r\n    // mode.\r\n    // TODO(sbc): Read INITIAL_MEMORY out of the wasm file in post-link mode.\r\n    //assert(wasmMemory.buffer.byteLength === 16777216);\r\n    updateGlobalBufferAndViews(wasmMemory.buffer);\r\n\r\n    wasmTable = Module['asm']['__indirect_function_table'];\r\n    assert(wasmTable, \"table not found in wasm exports\");\r\n\r\n    addOnInit(Module['asm']['__wasm_call_ctors']);\r\n\r\n    removeRunDependency('wasm-instantiate');\r\n  }\r\n  // we can't run yet (except in a pthread, where we have a custom sync instantiator)\r\n  addRunDependency('wasm-instantiate');\r\n\r\n  // Prefer streaming instantiation if available.\r\n  // Async compilation can be confusing when an error on the page overwrites Module\r\n  // (for example, if the order of elements is wrong, and the one defining Module is\r\n  // later), so we save Module and check it later.\r\n  var trueModule = Module;\r\n  function receiveInstantiationResult(result) {\r\n    // 'result' is a ResultObject object which has both the module and instance.\r\n    // receiveInstance() will swap in the exports (to Module.asm) so they can be called\r\n    assert(Module === trueModule, 'the Module object should not be replaced during async compilation - perhaps the order of HTML elements is wrong?');\r\n    trueModule = null;\r\n    // TODO: Due to Closure regression https://github.com/google/closure-compiler/issues/3193, the above line no longer optimizes out down to the following line.\r\n    // When the regression is fixed, can restore the above USE_PTHREADS-enabled path.\r\n    receiveInstance(result['instance']);\r\n  }\r\n\r\n  function instantiateArrayBuffer(receiver) {\r\n    return getBinaryPromise().then(function(binary) {\r\n      return WebAssembly.instantiate(binary, info);\r\n    }).then(function (instance) {\r\n      return instance;\r\n    }).then(receiver, function(reason) {\r\n      err('failed to asynchronously prepare wasm: ' + reason);\r\n\r\n      // Warn on some common problems.\r\n      if (isFileURI(wasmBinaryFile)) {\r\n        err('warning: Loading from a file URI (' + wasmBinaryFile + ') is not supported in most browsers. See https://emscripten.org/docs/getting_started/FAQ.html#how-do-i-run-a-local-webserver-for-testing-why-does-my-program-stall-in-downloading-or-preparing');\r\n      }\r\n      abort(reason);\r\n    });\r\n  }\r\n\r\n  function instantiateAsync() {\r\n    if (!wasmBinary &&\r\n        typeof WebAssembly.instantiateStreaming === 'function' &&\r\n        !isDataURI(wasmBinaryFile) &&\r\n        typeof fetch === 'function') {\r\n      return fetch(wasmBinaryFile, { credentials: 'same-origin' }).then(function (response) {\r\n        var result = WebAssembly.instantiateStreaming(response, info);\r\n\r\n        return result.then(\r\n          receiveInstantiationResult,\r\n          function(reason) {\r\n            // We expect the most common failure cause to be a bad MIME type for the binary,\r\n            // in which case falling back to ArrayBuffer instantiation should work.\r\n            err('wasm streaming compile failed: ' + reason);\r\n            err('falling back to ArrayBuffer instantiation');\r\n            return instantiateArrayBuffer(receiveInstantiationResult);\r\n          });\r\n      });\r\n    } else {\r\n      return instantiateArrayBuffer(receiveInstantiationResult);\r\n    }\r\n  }\r\n\r\n  // User shell pages can write their own Module.instantiateWasm = function(imports, successCallback) callback\r\n  // to manually instantiate the Wasm module themselves. This allows pages to run the instantiation parallel\r\n  // to any other async startup actions they are performing.\r\n  if (Module['instantiateWasm']) {\r\n    try {\r\n      var exports = Module['instantiateWasm'](info, receiveInstance);\r\n      return exports;\r\n    } catch(e) {\r\n      err('Module.instantiateWasm callback failed with error: ' + e);\r\n      return false;\r\n    }\r\n  }\r\n\r\n  // If instantiation fails, reject the module ready promise.\r\n  instantiateAsync().catch(readyPromiseReject);\r\n  return {}; // no exports yet; we'll fill them in later\r\n}\r\n\r\n// Globals used by JS i64 conversions (see makeSetValue)\r\nvar tempDouble;\r\nvar tempI64;\r\n\r\n// === Body ===\r\n\r\nvar ASM_CONSTS = {\r\n  \r\n};\r\n\r\n\r\n\r\n\r\n\r\n\r\n  function callRuntimeCallbacks(callbacks) {\r\n      while (callbacks.length > 0) {\r\n        var callback = callbacks.shift();\r\n        if (typeof callback == 'function') {\r\n          callback(Module); // Pass the module as the first argument.\r\n          continue;\r\n        }\r\n        var func = callback.func;\r\n        if (typeof func === 'number') {\r\n          if (callback.arg === undefined) {\r\n            getWasmTableEntry(func)();\r\n          } else {\r\n            getWasmTableEntry(func)(callback.arg);\r\n          }\r\n        } else {\r\n          func(callback.arg === undefined ? null : callback.arg);\r\n        }\r\n      }\r\n    }\r\n\r\n  function withStackSave(f) {\r\n      var stack = stackSave();\r\n      var ret = f();\r\n      stackRestore(stack);\r\n      return ret;\r\n    }\r\n  function demangle(func) {\r\n      warnOnce('warning: build with  -s DEMANGLE_SUPPORT=1  to link in libcxxabi demangling');\r\n      return func;\r\n    }\r\n\r\n  function demangleAll(text) {\r\n      var regex =\r\n        /\\b_Z[\\w\\d_]+/g;\r\n      return text.replace(regex,\r\n        function(x) {\r\n          var y = demangle(x);\r\n          return x === y ? x : (y + ' [' + x + ']');\r\n        });\r\n    }\r\n\r\n  var wasmTableMirror = [];\r\n  function getWasmTableEntry(funcPtr) {\r\n      var func = wasmTableMirror[funcPtr];\r\n      if (!func) {\r\n        if (funcPtr >= wasmTableMirror.length) wasmTableMirror.length = funcPtr + 1;\r\n        wasmTableMirror[funcPtr] = func = wasmTable.get(funcPtr);\r\n      }\r\n      assert(wasmTable.get(funcPtr) == func, \"JavaScript-side Wasm function table mirror is out of date!\");\r\n      return func;\r\n    }\r\n\r\n  function handleException(e) {\r\n      // Certain exception types we do not treat as errors since they are used for\r\n      // internal control flow.\r\n      // 1. ExitStatus, which is thrown by exit()\r\n      // 2. \"unwind\", which is thrown by emscripten_unwind_to_js_event_loop() and others\r\n      //    that wish to return to JS event loop.\r\n      if (e instanceof ExitStatus || e == 'unwind') {\r\n        return EXITSTATUS;\r\n      }\r\n      quit_(1, e);\r\n    }\r\n\r\n  function jsStackTrace() {\r\n      var error = new Error();\r\n      if (!error.stack) {\r\n        // IE10+ special cases: It does have callstack info, but it is only populated if an Error object is thrown,\r\n        // so try that as a special-case.\r\n        try {\r\n          throw new Error();\r\n        } catch(e) {\r\n          error = e;\r\n        }\r\n        if (!error.stack) {\r\n          return '(no stack trace available)';\r\n        }\r\n      }\r\n      return error.stack.toString();\r\n    }\r\n\r\n  function setWasmTableEntry(idx, func) {\r\n      wasmTable.set(idx, func);\r\n      wasmTableMirror[idx] = func;\r\n    }\r\n\r\n  function stackTrace() {\r\n      var js = jsStackTrace();\r\n      if (Module['extraStackTrace']) js += '\\n' + Module['extraStackTrace']();\r\n      return demangleAll(js);\r\n    }\r\n\r\n  function _abort() {\r\n      abort('native code called abort()');\r\n    }\r\n\r\n  function _clock() {\r\n      if (_clock.start === undefined) _clock.start = Date.now();\r\n      return ((Date.now() - _clock.start) * (1000000 / 1000))|0;\r\n    }\r\n\r\n  function _emscripten_memcpy_big(dest, src, num) {\r\n      HEAPU8.copyWithin(dest, src, src + num);\r\n    }\r\n\r\n  function emscripten_realloc_buffer(size) {\r\n      try {\r\n        // round size grow request up to wasm page size (fixed 64KB per spec)\r\n        wasmMemory.grow((size - buffer.byteLength + 65535) >>> 16); // .grow() takes a delta compared to the previous size\r\n        updateGlobalBufferAndViews(wasmMemory.buffer);\r\n        return 1 /*success*/;\r\n      } catch(e) {\r\n        err('emscripten_realloc_buffer: Attempted to grow heap from ' + buffer.byteLength  + ' bytes to ' + size + ' bytes, but got error: ' + e);\r\n      }\r\n      // implicit 0 return to save code size (caller will cast \"undefined\" into 0\r\n      // anyhow)\r\n    }\r\n  function _emscripten_resize_heap(requestedSize) {\r\n      var oldSize = HEAPU8.length;\r\n      requestedSize = requestedSize >>> 0;\r\n      // With pthreads, races can happen (another thread might increase the size in between), so return a failure, and let the caller retry.\r\n      assert(requestedSize > oldSize);\r\n  \r\n      // Memory resize rules:\r\n      // 1. Always increase heap size to at least the requested size, rounded up to next page multiple.\r\n      // 2a. If MEMORY_GROWTH_LINEAR_STEP == -1, excessively resize the heap geometrically: increase the heap size according to\r\n      //                                         MEMORY_GROWTH_GEOMETRIC_STEP factor (default +20%),\r\n      //                                         At most overreserve by MEMORY_GROWTH_GEOMETRIC_CAP bytes (default 96MB).\r\n      // 2b. If MEMORY_GROWTH_LINEAR_STEP != -1, excessively resize the heap linearly: increase the heap size by at least MEMORY_GROWTH_LINEAR_STEP bytes.\r\n      // 3. Max size for the heap is capped at 2048MB-WASM_PAGE_SIZE, or by MAXIMUM_MEMORY, or by ASAN limit, depending on which is smallest\r\n      // 4. If we were unable to allocate as much memory, it may be due to over-eager decision to excessively reserve due to (3) above.\r\n      //    Hence if an allocation fails, cut down on the amount of excess growth, in an attempt to succeed to perform a smaller allocation.\r\n  \r\n      // A limit is set for how much we can grow. We should not exceed that\r\n      // (the wasm binary specifies it, so if we tried, we'd fail anyhow).\r\n      // In CAN_ADDRESS_2GB mode, stay one Wasm page short of 4GB: while e.g. Chrome is able to allocate full 4GB Wasm memories, the size will wrap\r\n      // back to 0 bytes in Wasm side for any code that deals with heap sizes, which would require special casing all heap size related code to treat\r\n      // 0 specially.\r\n      var maxHeapSize = 2147483648;\r\n      if (requestedSize > maxHeapSize) {\r\n        err('Cannot enlarge memory, asked to go up to ' + requestedSize + ' bytes, but the limit is ' + maxHeapSize + ' bytes!');\r\n        return false;\r\n      }\r\n  \r\n      // Loop through potential heap size increases. If we attempt a too eager reservation that fails, cut down on the\r\n      // attempted size and reserve a smaller bump instead. (max 3 times, chosen somewhat arbitrarily)\r\n      for (var cutDown = 1; cutDown <= 4; cutDown *= 2) {\r\n        var overGrownHeapSize = oldSize * (1 + 0.2 / cutDown); // ensure geometric growth\r\n        // but limit overreserving (default to capping at +96MB overgrowth at most)\r\n        overGrownHeapSize = Math.min(overGrownHeapSize, requestedSize + 100663296 );\r\n  \r\n        var newSize = Math.min(maxHeapSize, alignUp(Math.max(requestedSize, overGrownHeapSize), 65536));\r\n  \r\n        var replacement = emscripten_realloc_buffer(newSize);\r\n        if (replacement) {\r\n  \r\n          return true;\r\n        }\r\n      }\r\n      err('Failed to grow the heap from ' + oldSize + ' bytes to ' + newSize + ' bytes, not enough memory!');\r\n      return false;\r\n    }\r\n\r\n  var SYSCALLS = {mappings:{},buffers:[null,[],[]],printChar:function(stream, curr) {\r\n        var buffer = SYSCALLS.buffers[stream];\r\n        assert(buffer);\r\n        if (curr === 0 || curr === 10) {\r\n          (stream === 1 ? out : err)(UTF8ArrayToString(buffer, 0));\r\n          buffer.length = 0;\r\n        } else {\r\n          buffer.push(curr);\r\n        }\r\n      },varargs:undefined,get:function() {\r\n        assert(SYSCALLS.varargs != undefined);\r\n        SYSCALLS.varargs += 4;\r\n        var ret = HEAP32[(((SYSCALLS.varargs)-(4))>>2)];\r\n        return ret;\r\n      },getStr:function(ptr) {\r\n        var ret = UTF8ToString(ptr);\r\n        return ret;\r\n      },get64:function(low, high) {\r\n        if (low >= 0) assert(high === 0);\r\n        else assert(high === -1);\r\n        return low;\r\n      }};\r\n  function _fd_close(fd) {\r\n      abort('it should not be possible to operate on streams when !SYSCALLS_REQUIRE_FILESYSTEM');\r\n      return 0;\r\n    }\r\n\r\n  function _fd_seek(fd, offset_low, offset_high, whence, newOffset) {\r\n  abort('it should not be possible to operate on streams when !SYSCALLS_REQUIRE_FILESYSTEM');\r\n  }\r\n\r\n  function flush_NO_FILESYSTEM() {\r\n      // flush anything remaining in the buffers during shutdown\r\n      if (typeof _fflush !== 'undefined') _fflush(0);\r\n      var buffers = SYSCALLS.buffers;\r\n      if (buffers[1].length) SYSCALLS.printChar(1, 10);\r\n      if (buffers[2].length) SYSCALLS.printChar(2, 10);\r\n    }\r\n  function _fd_write(fd, iov, iovcnt, pnum) {\r\n      ;\r\n      // hack to support printf in SYSCALLS_REQUIRE_FILESYSTEM=0\r\n      var num = 0;\r\n      for (var i = 0; i < iovcnt; i++) {\r\n        var ptr = HEAP32[((iov)>>2)];\r\n        var len = HEAP32[(((iov)+(4))>>2)];\r\n        iov += 8;\r\n        for (var j = 0; j < len; j++) {\r\n          SYSCALLS.printChar(fd, HEAPU8[ptr+j]);\r\n        }\r\n        num += len;\r\n      }\r\n      HEAP32[((pnum)>>2)] = num;\r\n      return 0;\r\n    }\r\n\r\n  function _js_bindClass(vm, module, className, methods) {\r\n  \t\tlet fns = Module.sock.bindClass(UTF8ToString(module), UTF8ToString(className));\r\n  \t\tif (fns) {\r\n  \t\t\tlet allocate = fns[0];\r\n  \t\t\tlet finalize = fns[1];\r\n  \r\n  \t\t\tif (allocate) {\r\n  \t\t\t\tlet u32 = new Uint32Array(Module.HEAP8.buffer, methods);\r\n  \r\n  \t\t\t\tu32[0] = Module.addFunction(allocate, \"vi\");\r\n  \r\n  \t\t\t\tif (finalize) {\r\n  \t\t\t\t\tu32[1] = Module.addFunction(finalize, \"vi\");\r\n  \t\t\t\t}\r\n  \t\t\t}\r\n  \t\t}\r\n  \t}\r\n\r\n  function _js_bindMethod(vm, module, className, isStatic, signature) {\r\n  \t\tlet fn = Module.sock.bindMethod(UTF8ToString(module), UTF8ToString(className), !!isStatic, UTF8ToString(signature));\r\n  \t\treturn fn ? Module.addFunction(fn, \"vi\") : 0;\r\n  \t}\r\n\r\n  function _js_error(vm, type, module, line, message) {\r\n  \t\tModule.sock.error(type, UTF8ToString(module), line, UTF8ToString(message));\r\n  \t}\r\n\r\n  function _js_loadModule(vm, name) {\r\n  \t\treturn mallocString(Module.sock.loadModule(UTF8ToString(name)));\r\n  \t}\r\n\r\n  function _js_write(vm, text) {\r\n  \t\tModule.sock.write(UTF8ToString(text));\r\n  \t}\r\n\r\n  function _setTempRet0(val) {\r\n      setTempRet0(val);\r\n    }\r\nvar ASSERTIONS = true;\r\n\r\n\r\n\r\n/** @type {function(string, boolean=, number=)} */\r\nfunction intArrayFromString(stringy, dontAddNull, length) {\r\n  var len = length > 0 ? length : lengthBytesUTF8(stringy)+1;\r\n  var u8array = new Array(len);\r\n  var numBytesWritten = stringToUTF8Array(stringy, u8array, 0, u8array.length);\r\n  if (dontAddNull) u8array.length = numBytesWritten;\r\n  return u8array;\r\n}\r\n\r\nfunction intArrayToString(array) {\r\n  var ret = [];\r\n  for (var i = 0; i < array.length; i++) {\r\n    var chr = array[i];\r\n    if (chr > 0xFF) {\r\n      if (ASSERTIONS) {\r\n        assert(false, 'Character code ' + chr + ' (' + String.fromCharCode(chr) + ')  at offset ' + i + ' not in 0x00-0xFF.');\r\n      }\r\n      chr &= 0xFF;\r\n    }\r\n    ret.push(String.fromCharCode(chr));\r\n  }\r\n  return ret.join('');\r\n}\r\n\r\n\r\nvar asmLibraryArg = {\r\n  \"abort\": _abort,\r\n  \"clock\": _clock,\r\n  \"emscripten_memcpy_big\": _emscripten_memcpy_big,\r\n  \"emscripten_resize_heap\": _emscripten_resize_heap,\r\n  \"fd_close\": _fd_close,\r\n  \"fd_seek\": _fd_seek,\r\n  \"fd_write\": _fd_write,\r\n  \"js_bindClass\": _js_bindClass,\r\n  \"js_bindMethod\": _js_bindMethod,\r\n  \"js_error\": _js_error,\r\n  \"js_loadModule\": _js_loadModule,\r\n  \"js_write\": _js_write,\r\n  \"setTempRet0\": _setTempRet0\r\n};\r\nvar asm = createWasm();\r\n/** @type {function(...*):?} */\r\nvar ___wasm_call_ctors = Module[\"___wasm_call_ctors\"] = createExportWrapper(\"__wasm_call_ctors\");\r\n\r\n/** @type {function(...*):?} */\r\nvar _wrenInterpret = Module[\"_wrenInterpret\"] = createExportWrapper(\"wrenInterpret\");\r\n\r\n/** @type {function(...*):?} */\r\nvar ___errno_location = Module[\"___errno_location\"] = createExportWrapper(\"__errno_location\");\r\n\r\n/** @type {function(...*):?} */\r\nvar _wrenCollectGarbage = Module[\"_wrenCollectGarbage\"] = createExportWrapper(\"wrenCollectGarbage\");\r\n\r\n/** @type {function(...*):?} */\r\nvar _wrenGetVersionNumber = Module[\"_wrenGetVersionNumber\"] = createExportWrapper(\"wrenGetVersionNumber\");\r\n\r\n/** @type {function(...*):?} */\r\nvar _wrenInitConfiguration = Module[\"_wrenInitConfiguration\"] = createExportWrapper(\"wrenInitConfiguration\");\r\n\r\n/** @type {function(...*):?} */\r\nvar _free = Module[\"_free\"] = createExportWrapper(\"free\");\r\n\r\n/** @type {function(...*):?} */\r\nvar _realloc = Module[\"_realloc\"] = createExportWrapper(\"realloc\");\r\n\r\n/** @type {function(...*):?} */\r\nvar _wrenNewVM = Module[\"_wrenNewVM\"] = createExportWrapper(\"wrenNewVM\");\r\n\r\n/** @type {function(...*):?} */\r\nvar _wrenFreeVM = Module[\"_wrenFreeVM\"] = createExportWrapper(\"wrenFreeVM\");\r\n\r\n/** @type {function(...*):?} */\r\nvar _wrenMakeCallHandle = Module[\"_wrenMakeCallHandle\"] = createExportWrapper(\"wrenMakeCallHandle\");\r\n\r\n/** @type {function(...*):?} */\r\nvar _wrenCall = Module[\"_wrenCall\"] = createExportWrapper(\"wrenCall\");\r\n\r\n/** @type {function(...*):?} */\r\nvar _wrenReleaseHandle = Module[\"_wrenReleaseHandle\"] = createExportWrapper(\"wrenReleaseHandle\");\r\n\r\n/** @type {function(...*):?} */\r\nvar _wrenGetSlotCount = Module[\"_wrenGetSlotCount\"] = createExportWrapper(\"wrenGetSlotCount\");\r\n\r\n/** @type {function(...*):?} */\r\nvar _wrenEnsureSlots = Module[\"_wrenEnsureSlots\"] = createExportWrapper(\"wrenEnsureSlots\");\r\n\r\n/** @type {function(...*):?} */\r\nvar _wrenGetSlotType = Module[\"_wrenGetSlotType\"] = createExportWrapper(\"wrenGetSlotType\");\r\n\r\n/** @type {function(...*):?} */\r\nvar _wrenGetSlotBool = Module[\"_wrenGetSlotBool\"] = createExportWrapper(\"wrenGetSlotBool\");\r\n\r\n/** @type {function(...*):?} */\r\nvar _wrenGetSlotBytes = Module[\"_wrenGetSlotBytes\"] = createExportWrapper(\"wrenGetSlotBytes\");\r\n\r\n/** @type {function(...*):?} */\r\nvar _wrenGetSlotDouble = Module[\"_wrenGetSlotDouble\"] = createExportWrapper(\"wrenGetSlotDouble\");\r\n\r\n/** @type {function(...*):?} */\r\nvar _wrenGetSlotForeign = Module[\"_wrenGetSlotForeign\"] = createExportWrapper(\"wrenGetSlotForeign\");\r\n\r\n/** @type {function(...*):?} */\r\nvar _wrenGetSlotIsInstanceOf = Module[\"_wrenGetSlotIsInstanceOf\"] = createExportWrapper(\"wrenGetSlotIsInstanceOf\");\r\n\r\n/** @type {function(...*):?} */\r\nvar _wrenGetSlotInstanceField = Module[\"_wrenGetSlotInstanceField\"] = createExportWrapper(\"wrenGetSlotInstanceField\");\r\n\r\n/** @type {function(...*):?} */\r\nvar _wrenGetSlotString = Module[\"_wrenGetSlotString\"] = createExportWrapper(\"wrenGetSlotString\");\r\n\r\n/** @type {function(...*):?} */\r\nvar _wrenGetSlotHandle = Module[\"_wrenGetSlotHandle\"] = createExportWrapper(\"wrenGetSlotHandle\");\r\n\r\n/** @type {function(...*):?} */\r\nvar _wrenSetSlotBool = Module[\"_wrenSetSlotBool\"] = createExportWrapper(\"wrenSetSlotBool\");\r\n\r\n/** @type {function(...*):?} */\r\nvar _wrenSetSlotBytes = Module[\"_wrenSetSlotBytes\"] = createExportWrapper(\"wrenSetSlotBytes\");\r\n\r\n/** @type {function(...*):?} */\r\nvar _wrenSetSlotDouble = Module[\"_wrenSetSlotDouble\"] = createExportWrapper(\"wrenSetSlotDouble\");\r\n\r\n/** @type {function(...*):?} */\r\nvar _wrenSetSlotRange = Module[\"_wrenSetSlotRange\"] = createExportWrapper(\"wrenSetSlotRange\");\r\n\r\n/** @type {function(...*):?} */\r\nvar _wrenSetSlotNewForeign = Module[\"_wrenSetSlotNewForeign\"] = createExportWrapper(\"wrenSetSlotNewForeign\");\r\n\r\n/** @type {function(...*):?} */\r\nvar _wrenSetSlotNewList = Module[\"_wrenSetSlotNewList\"] = createExportWrapper(\"wrenSetSlotNewList\");\r\n\r\n/** @type {function(...*):?} */\r\nvar _wrenSetSlotNewMap = Module[\"_wrenSetSlotNewMap\"] = createExportWrapper(\"wrenSetSlotNewMap\");\r\n\r\n/** @type {function(...*):?} */\r\nvar _wrenSetSlotNull = Module[\"_wrenSetSlotNull\"] = createExportWrapper(\"wrenSetSlotNull\");\r\n\r\n/** @type {function(...*):?} */\r\nvar _wrenSetSlotString = Module[\"_wrenSetSlotString\"] = createExportWrapper(\"wrenSetSlotString\");\r\n\r\n/** @type {function(...*):?} */\r\nvar _wrenSetSlotHandle = Module[\"_wrenSetSlotHandle\"] = createExportWrapper(\"wrenSetSlotHandle\");\r\n\r\n/** @type {function(...*):?} */\r\nvar _wrenGetListCount = Module[\"_wrenGetListCount\"] = createExportWrapper(\"wrenGetListCount\");\r\n\r\n/** @type {function(...*):?} */\r\nvar _wrenGetListElement = Module[\"_wrenGetListElement\"] = createExportWrapper(\"wrenGetListElement\");\r\n\r\n/** @type {function(...*):?} */\r\nvar _wrenSetListElement = Module[\"_wrenSetListElement\"] = createExportWrapper(\"wrenSetListElement\");\r\n\r\n/** @type {function(...*):?} */\r\nvar _wrenInsertInList = Module[\"_wrenInsertInList\"] = createExportWrapper(\"wrenInsertInList\");\r\n\r\n/** @type {function(...*):?} */\r\nvar _wrenGetMapCount = Module[\"_wrenGetMapCount\"] = createExportWrapper(\"wrenGetMapCount\");\r\n\r\n/** @type {function(...*):?} */\r\nvar _wrenGetMapContainsKey = Module[\"_wrenGetMapContainsKey\"] = createExportWrapper(\"wrenGetMapContainsKey\");\r\n\r\n/** @type {function(...*):?} */\r\nvar _wrenGetMapValue = Module[\"_wrenGetMapValue\"] = createExportWrapper(\"wrenGetMapValue\");\r\n\r\n/** @type {function(...*):?} */\r\nvar _wrenSetMapValue = Module[\"_wrenSetMapValue\"] = createExportWrapper(\"wrenSetMapValue\");\r\n\r\n/** @type {function(...*):?} */\r\nvar _wrenRemoveMapValue = Module[\"_wrenRemoveMapValue\"] = createExportWrapper(\"wrenRemoveMapValue\");\r\n\r\n/** @type {function(...*):?} */\r\nvar _wrenGetVariable = Module[\"_wrenGetVariable\"] = createExportWrapper(\"wrenGetVariable\");\r\n\r\n/** @type {function(...*):?} */\r\nvar _wrenHasVariable = Module[\"_wrenHasVariable\"] = createExportWrapper(\"wrenHasVariable\");\r\n\r\n/** @type {function(...*):?} */\r\nvar _wrenHasModule = Module[\"_wrenHasModule\"] = createExportWrapper(\"wrenHasModule\");\r\n\r\n/** @type {function(...*):?} */\r\nvar _wrenAbortFiber = Module[\"_wrenAbortFiber\"] = createExportWrapper(\"wrenAbortFiber\");\r\n\r\n/** @type {function(...*):?} */\r\nvar _wrenGetUserData = Module[\"_wrenGetUserData\"] = createExportWrapper(\"wrenGetUserData\");\r\n\r\n/** @type {function(...*):?} */\r\nvar _wrenSetUserData = Module[\"_wrenSetUserData\"] = createExportWrapper(\"wrenSetUserData\");\r\n\r\n/** @type {function(...*):?} */\r\nvar _wrenAddImplicitImportModule = Module[\"_wrenAddImplicitImportModule\"] = createExportWrapper(\"wrenAddImplicitImportModule\");\r\n\r\n/** @type {function(...*):?} */\r\nvar _malloc = Module[\"_malloc\"] = createExportWrapper(\"malloc\");\r\n\r\n/** @type {function(...*):?} */\r\nvar _sock_font = Module[\"_sock_font\"] = createExportWrapper(\"sock_font\");\r\n\r\n/** @type {function(...*):?} */\r\nvar _sock_init = Module[\"_sock_init\"] = createExportWrapper(\"sock_init\");\r\n\r\n/** @type {function(...*):?} */\r\nvar _sock_new_buffer = Module[\"_sock_new_buffer\"] = createExportWrapper(\"sock_new_buffer\");\r\n\r\n/** @type {function(...*):?} */\r\nvar _sock_new_transform = Module[\"_sock_new_transform\"] = createExportWrapper(\"sock_new_transform\");\r\n\r\n/** @type {function(...*):?} */\r\nvar _sock_get_transform = Module[\"_sock_get_transform\"] = createExportWrapper(\"sock_get_transform\");\r\n\r\n/** @type {function(...*):?} */\r\nvar stackSave = Module[\"stackSave\"] = createExportWrapper(\"stackSave\");\r\n\r\n/** @type {function(...*):?} */\r\nvar stackRestore = Module[\"stackRestore\"] = createExportWrapper(\"stackRestore\");\r\n\r\n/** @type {function(...*):?} */\r\nvar stackAlloc = Module[\"stackAlloc\"] = createExportWrapper(\"stackAlloc\");\r\n\r\n/** @type {function(...*):?} */\r\nvar _emscripten_stack_init = Module[\"_emscripten_stack_init\"] = function() {\r\n  return (_emscripten_stack_init = Module[\"_emscripten_stack_init\"] = Module[\"asm\"][\"emscripten_stack_init\"]).apply(null, arguments);\r\n};\r\n\r\n/** @type {function(...*):?} */\r\nvar _emscripten_stack_get_free = Module[\"_emscripten_stack_get_free\"] = function() {\r\n  return (_emscripten_stack_get_free = Module[\"_emscripten_stack_get_free\"] = Module[\"asm\"][\"emscripten_stack_get_free\"]).apply(null, arguments);\r\n};\r\n\r\n/** @type {function(...*):?} */\r\nvar _emscripten_stack_get_end = Module[\"_emscripten_stack_get_end\"] = function() {\r\n  return (_emscripten_stack_get_end = Module[\"_emscripten_stack_get_end\"] = Module[\"asm\"][\"emscripten_stack_get_end\"]).apply(null, arguments);\r\n};\r\n\r\n/** @type {function(...*):?} */\r\nvar dynCall_jiji = Module[\"dynCall_jiji\"] = createExportWrapper(\"dynCall_jiji\");\r\n\r\n\r\n\r\n\r\n\r\n// === Auto-generated postamble setup entry stuff ===\r\n\r\nif (!Object.getOwnPropertyDescriptor(Module, \"intArrayFromString\")) Module[\"intArrayFromString\"] = function() { abort(\"'intArrayFromString' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"intArrayToString\")) Module[\"intArrayToString\"] = function() { abort(\"'intArrayToString' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nModule[\"ccall\"] = ccall;\r\nif (!Object.getOwnPropertyDescriptor(Module, \"cwrap\")) Module[\"cwrap\"] = function() { abort(\"'cwrap' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"setValue\")) Module[\"setValue\"] = function() { abort(\"'setValue' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"getValue\")) Module[\"getValue\"] = function() { abort(\"'getValue' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"allocate\")) Module[\"allocate\"] = function() { abort(\"'allocate' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"UTF8ArrayToString\")) Module[\"UTF8ArrayToString\"] = function() { abort(\"'UTF8ArrayToString' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"UTF8ToString\")) Module[\"UTF8ToString\"] = function() { abort(\"'UTF8ToString' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"stringToUTF8Array\")) Module[\"stringToUTF8Array\"] = function() { abort(\"'stringToUTF8Array' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"stringToUTF8\")) Module[\"stringToUTF8\"] = function() { abort(\"'stringToUTF8' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"lengthBytesUTF8\")) Module[\"lengthBytesUTF8\"] = function() { abort(\"'lengthBytesUTF8' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"stackTrace\")) Module[\"stackTrace\"] = function() { abort(\"'stackTrace' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"addOnPreRun\")) Module[\"addOnPreRun\"] = function() { abort(\"'addOnPreRun' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"addOnInit\")) Module[\"addOnInit\"] = function() { abort(\"'addOnInit' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"addOnPreMain\")) Module[\"addOnPreMain\"] = function() { abort(\"'addOnPreMain' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"addOnExit\")) Module[\"addOnExit\"] = function() { abort(\"'addOnExit' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"addOnPostRun\")) Module[\"addOnPostRun\"] = function() { abort(\"'addOnPostRun' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"writeStringToMemory\")) Module[\"writeStringToMemory\"] = function() { abort(\"'writeStringToMemory' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"writeArrayToMemory\")) Module[\"writeArrayToMemory\"] = function() { abort(\"'writeArrayToMemory' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"writeAsciiToMemory\")) Module[\"writeAsciiToMemory\"] = function() { abort(\"'writeAsciiToMemory' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"addRunDependency\")) Module[\"addRunDependency\"] = function() { abort(\"'addRunDependency' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ). Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"removeRunDependency\")) Module[\"removeRunDependency\"] = function() { abort(\"'removeRunDependency' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ). Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"FS_createFolder\")) Module[\"FS_createFolder\"] = function() { abort(\"'FS_createFolder' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"FS_createPath\")) Module[\"FS_createPath\"] = function() { abort(\"'FS_createPath' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ). Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"FS_createDataFile\")) Module[\"FS_createDataFile\"] = function() { abort(\"'FS_createDataFile' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ). Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"FS_createPreloadedFile\")) Module[\"FS_createPreloadedFile\"] = function() { abort(\"'FS_createPreloadedFile' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ). Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"FS_createLazyFile\")) Module[\"FS_createLazyFile\"] = function() { abort(\"'FS_createLazyFile' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ). Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"FS_createLink\")) Module[\"FS_createLink\"] = function() { abort(\"'FS_createLink' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"FS_createDevice\")) Module[\"FS_createDevice\"] = function() { abort(\"'FS_createDevice' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ). Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"FS_unlink\")) Module[\"FS_unlink\"] = function() { abort(\"'FS_unlink' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ). Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"getLEB\")) Module[\"getLEB\"] = function() { abort(\"'getLEB' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"getFunctionTables\")) Module[\"getFunctionTables\"] = function() { abort(\"'getFunctionTables' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"alignFunctionTables\")) Module[\"alignFunctionTables\"] = function() { abort(\"'alignFunctionTables' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"registerFunctions\")) Module[\"registerFunctions\"] = function() { abort(\"'registerFunctions' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nModule[\"addFunction\"] = addFunction;\r\nif (!Object.getOwnPropertyDescriptor(Module, \"removeFunction\")) Module[\"removeFunction\"] = function() { abort(\"'removeFunction' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"getFuncWrapper\")) Module[\"getFuncWrapper\"] = function() { abort(\"'getFuncWrapper' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"prettyPrint\")) Module[\"prettyPrint\"] = function() { abort(\"'prettyPrint' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"dynCall\")) Module[\"dynCall\"] = function() { abort(\"'dynCall' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"getCompilerSetting\")) Module[\"getCompilerSetting\"] = function() { abort(\"'getCompilerSetting' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"print\")) Module[\"print\"] = function() { abort(\"'print' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"printErr\")) Module[\"printErr\"] = function() { abort(\"'printErr' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"getTempRet0\")) Module[\"getTempRet0\"] = function() { abort(\"'getTempRet0' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"setTempRet0\")) Module[\"setTempRet0\"] = function() { abort(\"'setTempRet0' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"callMain\")) Module[\"callMain\"] = function() { abort(\"'callMain' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"abort\")) Module[\"abort\"] = function() { abort(\"'abort' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"keepRuntimeAlive\")) Module[\"keepRuntimeAlive\"] = function() { abort(\"'keepRuntimeAlive' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"zeroMemory\")) Module[\"zeroMemory\"] = function() { abort(\"'zeroMemory' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"stringToNewUTF8\")) Module[\"stringToNewUTF8\"] = function() { abort(\"'stringToNewUTF8' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"setFileTime\")) Module[\"setFileTime\"] = function() { abort(\"'setFileTime' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"emscripten_realloc_buffer\")) Module[\"emscripten_realloc_buffer\"] = function() { abort(\"'emscripten_realloc_buffer' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"ENV\")) Module[\"ENV\"] = function() { abort(\"'ENV' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"withStackSave\")) Module[\"withStackSave\"] = function() { abort(\"'withStackSave' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"ERRNO_CODES\")) Module[\"ERRNO_CODES\"] = function() { abort(\"'ERRNO_CODES' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"ERRNO_MESSAGES\")) Module[\"ERRNO_MESSAGES\"] = function() { abort(\"'ERRNO_MESSAGES' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"setErrNo\")) Module[\"setErrNo\"] = function() { abort(\"'setErrNo' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"inetPton4\")) Module[\"inetPton4\"] = function() { abort(\"'inetPton4' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"inetNtop4\")) Module[\"inetNtop4\"] = function() { abort(\"'inetNtop4' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"inetPton6\")) Module[\"inetPton6\"] = function() { abort(\"'inetPton6' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"inetNtop6\")) Module[\"inetNtop6\"] = function() { abort(\"'inetNtop6' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"readSockaddr\")) Module[\"readSockaddr\"] = function() { abort(\"'readSockaddr' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"writeSockaddr\")) Module[\"writeSockaddr\"] = function() { abort(\"'writeSockaddr' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"DNS\")) Module[\"DNS\"] = function() { abort(\"'DNS' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"getHostByName\")) Module[\"getHostByName\"] = function() { abort(\"'getHostByName' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"GAI_ERRNO_MESSAGES\")) Module[\"GAI_ERRNO_MESSAGES\"] = function() { abort(\"'GAI_ERRNO_MESSAGES' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"Protocols\")) Module[\"Protocols\"] = function() { abort(\"'Protocols' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"Sockets\")) Module[\"Sockets\"] = function() { abort(\"'Sockets' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"getRandomDevice\")) Module[\"getRandomDevice\"] = function() { abort(\"'getRandomDevice' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"traverseStack\")) Module[\"traverseStack\"] = function() { abort(\"'traverseStack' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"UNWIND_CACHE\")) Module[\"UNWIND_CACHE\"] = function() { abort(\"'UNWIND_CACHE' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"readAsmConstArgsArray\")) Module[\"readAsmConstArgsArray\"] = function() { abort(\"'readAsmConstArgsArray' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"readAsmConstArgs\")) Module[\"readAsmConstArgs\"] = function() { abort(\"'readAsmConstArgs' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"mainThreadEM_ASM\")) Module[\"mainThreadEM_ASM\"] = function() { abort(\"'mainThreadEM_ASM' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"jstoi_q\")) Module[\"jstoi_q\"] = function() { abort(\"'jstoi_q' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"jstoi_s\")) Module[\"jstoi_s\"] = function() { abort(\"'jstoi_s' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"getExecutableName\")) Module[\"getExecutableName\"] = function() { abort(\"'getExecutableName' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"listenOnce\")) Module[\"listenOnce\"] = function() { abort(\"'listenOnce' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"autoResumeAudioContext\")) Module[\"autoResumeAudioContext\"] = function() { abort(\"'autoResumeAudioContext' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"dynCallLegacy\")) Module[\"dynCallLegacy\"] = function() { abort(\"'dynCallLegacy' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"getDynCaller\")) Module[\"getDynCaller\"] = function() { abort(\"'getDynCaller' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"dynCall\")) Module[\"dynCall\"] = function() { abort(\"'dynCall' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"callRuntimeCallbacks\")) Module[\"callRuntimeCallbacks\"] = function() { abort(\"'callRuntimeCallbacks' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"wasmTableMirror\")) Module[\"wasmTableMirror\"] = function() { abort(\"'wasmTableMirror' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"setWasmTableEntry\")) Module[\"setWasmTableEntry\"] = function() { abort(\"'setWasmTableEntry' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"getWasmTableEntry\")) Module[\"getWasmTableEntry\"] = function() { abort(\"'getWasmTableEntry' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"handleException\")) Module[\"handleException\"] = function() { abort(\"'handleException' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"runtimeKeepalivePush\")) Module[\"runtimeKeepalivePush\"] = function() { abort(\"'runtimeKeepalivePush' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"runtimeKeepalivePop\")) Module[\"runtimeKeepalivePop\"] = function() { abort(\"'runtimeKeepalivePop' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"callUserCallback\")) Module[\"callUserCallback\"] = function() { abort(\"'callUserCallback' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"maybeExit\")) Module[\"maybeExit\"] = function() { abort(\"'maybeExit' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"safeSetTimeout\")) Module[\"safeSetTimeout\"] = function() { abort(\"'safeSetTimeout' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"asmjsMangle\")) Module[\"asmjsMangle\"] = function() { abort(\"'asmjsMangle' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"asyncLoad\")) Module[\"asyncLoad\"] = function() { abort(\"'asyncLoad' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"alignMemory\")) Module[\"alignMemory\"] = function() { abort(\"'alignMemory' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"mmapAlloc\")) Module[\"mmapAlloc\"] = function() { abort(\"'mmapAlloc' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"reallyNegative\")) Module[\"reallyNegative\"] = function() { abort(\"'reallyNegative' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"unSign\")) Module[\"unSign\"] = function() { abort(\"'unSign' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"reSign\")) Module[\"reSign\"] = function() { abort(\"'reSign' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"formatString\")) Module[\"formatString\"] = function() { abort(\"'formatString' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"PATH\")) Module[\"PATH\"] = function() { abort(\"'PATH' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"PATH_FS\")) Module[\"PATH_FS\"] = function() { abort(\"'PATH_FS' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"SYSCALLS\")) Module[\"SYSCALLS\"] = function() { abort(\"'SYSCALLS' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"syscallMmap2\")) Module[\"syscallMmap2\"] = function() { abort(\"'syscallMmap2' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"syscallMunmap\")) Module[\"syscallMunmap\"] = function() { abort(\"'syscallMunmap' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"getSocketFromFD\")) Module[\"getSocketFromFD\"] = function() { abort(\"'getSocketFromFD' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"getSocketAddress\")) Module[\"getSocketAddress\"] = function() { abort(\"'getSocketAddress' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"JSEvents\")) Module[\"JSEvents\"] = function() { abort(\"'JSEvents' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"registerKeyEventCallback\")) Module[\"registerKeyEventCallback\"] = function() { abort(\"'registerKeyEventCallback' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"specialHTMLTargets\")) Module[\"specialHTMLTargets\"] = function() { abort(\"'specialHTMLTargets' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"maybeCStringToJsString\")) Module[\"maybeCStringToJsString\"] = function() { abort(\"'maybeCStringToJsString' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"findEventTarget\")) Module[\"findEventTarget\"] = function() { abort(\"'findEventTarget' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"findCanvasEventTarget\")) Module[\"findCanvasEventTarget\"] = function() { abort(\"'findCanvasEventTarget' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"getBoundingClientRect\")) Module[\"getBoundingClientRect\"] = function() { abort(\"'getBoundingClientRect' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"fillMouseEventData\")) Module[\"fillMouseEventData\"] = function() { abort(\"'fillMouseEventData' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"registerMouseEventCallback\")) Module[\"registerMouseEventCallback\"] = function() { abort(\"'registerMouseEventCallback' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"registerWheelEventCallback\")) Module[\"registerWheelEventCallback\"] = function() { abort(\"'registerWheelEventCallback' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"registerUiEventCallback\")) Module[\"registerUiEventCallback\"] = function() { abort(\"'registerUiEventCallback' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"registerFocusEventCallback\")) Module[\"registerFocusEventCallback\"] = function() { abort(\"'registerFocusEventCallback' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"fillDeviceOrientationEventData\")) Module[\"fillDeviceOrientationEventData\"] = function() { abort(\"'fillDeviceOrientationEventData' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"registerDeviceOrientationEventCallback\")) Module[\"registerDeviceOrientationEventCallback\"] = function() { abort(\"'registerDeviceOrientationEventCallback' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"fillDeviceMotionEventData\")) Module[\"fillDeviceMotionEventData\"] = function() { abort(\"'fillDeviceMotionEventData' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"registerDeviceMotionEventCallback\")) Module[\"registerDeviceMotionEventCallback\"] = function() { abort(\"'registerDeviceMotionEventCallback' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"screenOrientation\")) Module[\"screenOrientation\"] = function() { abort(\"'screenOrientation' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"fillOrientationChangeEventData\")) Module[\"fillOrientationChangeEventData\"] = function() { abort(\"'fillOrientationChangeEventData' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"registerOrientationChangeEventCallback\")) Module[\"registerOrientationChangeEventCallback\"] = function() { abort(\"'registerOrientationChangeEventCallback' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"fillFullscreenChangeEventData\")) Module[\"fillFullscreenChangeEventData\"] = function() { abort(\"'fillFullscreenChangeEventData' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"registerFullscreenChangeEventCallback\")) Module[\"registerFullscreenChangeEventCallback\"] = function() { abort(\"'registerFullscreenChangeEventCallback' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"registerRestoreOldStyle\")) Module[\"registerRestoreOldStyle\"] = function() { abort(\"'registerRestoreOldStyle' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"hideEverythingExceptGivenElement\")) Module[\"hideEverythingExceptGivenElement\"] = function() { abort(\"'hideEverythingExceptGivenElement' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"restoreHiddenElements\")) Module[\"restoreHiddenElements\"] = function() { abort(\"'restoreHiddenElements' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"setLetterbox\")) Module[\"setLetterbox\"] = function() { abort(\"'setLetterbox' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"currentFullscreenStrategy\")) Module[\"currentFullscreenStrategy\"] = function() { abort(\"'currentFullscreenStrategy' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"restoreOldWindowedStyle\")) Module[\"restoreOldWindowedStyle\"] = function() { abort(\"'restoreOldWindowedStyle' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"softFullscreenResizeWebGLRenderTarget\")) Module[\"softFullscreenResizeWebGLRenderTarget\"] = function() { abort(\"'softFullscreenResizeWebGLRenderTarget' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"doRequestFullscreen\")) Module[\"doRequestFullscreen\"] = function() { abort(\"'doRequestFullscreen' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"fillPointerlockChangeEventData\")) Module[\"fillPointerlockChangeEventData\"] = function() { abort(\"'fillPointerlockChangeEventData' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"registerPointerlockChangeEventCallback\")) Module[\"registerPointerlockChangeEventCallback\"] = function() { abort(\"'registerPointerlockChangeEventCallback' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"registerPointerlockErrorEventCallback\")) Module[\"registerPointerlockErrorEventCallback\"] = function() { abort(\"'registerPointerlockErrorEventCallback' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"requestPointerLock\")) Module[\"requestPointerLock\"] = function() { abort(\"'requestPointerLock' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"fillVisibilityChangeEventData\")) Module[\"fillVisibilityChangeEventData\"] = function() { abort(\"'fillVisibilityChangeEventData' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"registerVisibilityChangeEventCallback\")) Module[\"registerVisibilityChangeEventCallback\"] = function() { abort(\"'registerVisibilityChangeEventCallback' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"registerTouchEventCallback\")) Module[\"registerTouchEventCallback\"] = function() { abort(\"'registerTouchEventCallback' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"fillGamepadEventData\")) Module[\"fillGamepadEventData\"] = function() { abort(\"'fillGamepadEventData' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"registerGamepadEventCallback\")) Module[\"registerGamepadEventCallback\"] = function() { abort(\"'registerGamepadEventCallback' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"registerBeforeUnloadEventCallback\")) Module[\"registerBeforeUnloadEventCallback\"] = function() { abort(\"'registerBeforeUnloadEventCallback' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"fillBatteryEventData\")) Module[\"fillBatteryEventData\"] = function() { abort(\"'fillBatteryEventData' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"battery\")) Module[\"battery\"] = function() { abort(\"'battery' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"registerBatteryEventCallback\")) Module[\"registerBatteryEventCallback\"] = function() { abort(\"'registerBatteryEventCallback' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"setCanvasElementSize\")) Module[\"setCanvasElementSize\"] = function() { abort(\"'setCanvasElementSize' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"getCanvasElementSize\")) Module[\"getCanvasElementSize\"] = function() { abort(\"'getCanvasElementSize' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"demangle\")) Module[\"demangle\"] = function() { abort(\"'demangle' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"demangleAll\")) Module[\"demangleAll\"] = function() { abort(\"'demangleAll' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"jsStackTrace\")) Module[\"jsStackTrace\"] = function() { abort(\"'jsStackTrace' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"stackTrace\")) Module[\"stackTrace\"] = function() { abort(\"'stackTrace' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"getEnvStrings\")) Module[\"getEnvStrings\"] = function() { abort(\"'getEnvStrings' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"checkWasiClock\")) Module[\"checkWasiClock\"] = function() { abort(\"'checkWasiClock' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"flush_NO_FILESYSTEM\")) Module[\"flush_NO_FILESYSTEM\"] = function() { abort(\"'flush_NO_FILESYSTEM' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"writeI53ToI64\")) Module[\"writeI53ToI64\"] = function() { abort(\"'writeI53ToI64' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"writeI53ToI64Clamped\")) Module[\"writeI53ToI64Clamped\"] = function() { abort(\"'writeI53ToI64Clamped' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"writeI53ToI64Signaling\")) Module[\"writeI53ToI64Signaling\"] = function() { abort(\"'writeI53ToI64Signaling' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"writeI53ToU64Clamped\")) Module[\"writeI53ToU64Clamped\"] = function() { abort(\"'writeI53ToU64Clamped' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"writeI53ToU64Signaling\")) Module[\"writeI53ToU64Signaling\"] = function() { abort(\"'writeI53ToU64Signaling' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"readI53FromI64\")) Module[\"readI53FromI64\"] = function() { abort(\"'readI53FromI64' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"readI53FromU64\")) Module[\"readI53FromU64\"] = function() { abort(\"'readI53FromU64' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"convertI32PairToI53\")) Module[\"convertI32PairToI53\"] = function() { abort(\"'convertI32PairToI53' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"convertU32PairToI53\")) Module[\"convertU32PairToI53\"] = function() { abort(\"'convertU32PairToI53' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"setImmediateWrapped\")) Module[\"setImmediateWrapped\"] = function() { abort(\"'setImmediateWrapped' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"clearImmediateWrapped\")) Module[\"clearImmediateWrapped\"] = function() { abort(\"'clearImmediateWrapped' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"polyfillSetImmediate\")) Module[\"polyfillSetImmediate\"] = function() { abort(\"'polyfillSetImmediate' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"uncaughtExceptionCount\")) Module[\"uncaughtExceptionCount\"] = function() { abort(\"'uncaughtExceptionCount' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"exceptionLast\")) Module[\"exceptionLast\"] = function() { abort(\"'exceptionLast' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"exceptionCaught\")) Module[\"exceptionCaught\"] = function() { abort(\"'exceptionCaught' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"ExceptionInfo\")) Module[\"ExceptionInfo\"] = function() { abort(\"'ExceptionInfo' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"CatchInfo\")) Module[\"CatchInfo\"] = function() { abort(\"'CatchInfo' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"exception_addRef\")) Module[\"exception_addRef\"] = function() { abort(\"'exception_addRef' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"exception_decRef\")) Module[\"exception_decRef\"] = function() { abort(\"'exception_decRef' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"Browser\")) Module[\"Browser\"] = function() { abort(\"'Browser' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"funcWrappers\")) Module[\"funcWrappers\"] = function() { abort(\"'funcWrappers' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"getFuncWrapper\")) Module[\"getFuncWrapper\"] = function() { abort(\"'getFuncWrapper' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"setMainLoop\")) Module[\"setMainLoop\"] = function() { abort(\"'setMainLoop' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"wget\")) Module[\"wget\"] = function() { abort(\"'wget' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"tempFixedLengthArray\")) Module[\"tempFixedLengthArray\"] = function() { abort(\"'tempFixedLengthArray' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"miniTempWebGLFloatBuffers\")) Module[\"miniTempWebGLFloatBuffers\"] = function() { abort(\"'miniTempWebGLFloatBuffers' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"heapObjectForWebGLType\")) Module[\"heapObjectForWebGLType\"] = function() { abort(\"'heapObjectForWebGLType' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"heapAccessShiftForWebGLHeap\")) Module[\"heapAccessShiftForWebGLHeap\"] = function() { abort(\"'heapAccessShiftForWebGLHeap' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"GL\")) Module[\"GL\"] = function() { abort(\"'GL' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"emscriptenWebGLGet\")) Module[\"emscriptenWebGLGet\"] = function() { abort(\"'emscriptenWebGLGet' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"computeUnpackAlignedImageSize\")) Module[\"computeUnpackAlignedImageSize\"] = function() { abort(\"'computeUnpackAlignedImageSize' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"emscriptenWebGLGetTexPixelData\")) Module[\"emscriptenWebGLGetTexPixelData\"] = function() { abort(\"'emscriptenWebGLGetTexPixelData' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"emscriptenWebGLGetUniform\")) Module[\"emscriptenWebGLGetUniform\"] = function() { abort(\"'emscriptenWebGLGetUniform' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"webglGetUniformLocation\")) Module[\"webglGetUniformLocation\"] = function() { abort(\"'webglGetUniformLocation' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"webglPrepareUniformLocationsBeforeFirstUse\")) Module[\"webglPrepareUniformLocationsBeforeFirstUse\"] = function() { abort(\"'webglPrepareUniformLocationsBeforeFirstUse' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"webglGetLeftBracePos\")) Module[\"webglGetLeftBracePos\"] = function() { abort(\"'webglGetLeftBracePos' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"emscriptenWebGLGetVertexAttrib\")) Module[\"emscriptenWebGLGetVertexAttrib\"] = function() { abort(\"'emscriptenWebGLGetVertexAttrib' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"writeGLArray\")) Module[\"writeGLArray\"] = function() { abort(\"'writeGLArray' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"AL\")) Module[\"AL\"] = function() { abort(\"'AL' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"SDL_unicode\")) Module[\"SDL_unicode\"] = function() { abort(\"'SDL_unicode' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"SDL_ttfContext\")) Module[\"SDL_ttfContext\"] = function() { abort(\"'SDL_ttfContext' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"SDL_audio\")) Module[\"SDL_audio\"] = function() { abort(\"'SDL_audio' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"SDL\")) Module[\"SDL\"] = function() { abort(\"'SDL' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"SDL_gfx\")) Module[\"SDL_gfx\"] = function() { abort(\"'SDL_gfx' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"GLUT\")) Module[\"GLUT\"] = function() { abort(\"'GLUT' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"EGL\")) Module[\"EGL\"] = function() { abort(\"'EGL' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"GLFW_Window\")) Module[\"GLFW_Window\"] = function() { abort(\"'GLFW_Window' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"GLFW\")) Module[\"GLFW\"] = function() { abort(\"'GLFW' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"GLEW\")) Module[\"GLEW\"] = function() { abort(\"'GLEW' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"IDBStore\")) Module[\"IDBStore\"] = function() { abort(\"'IDBStore' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"runAndAbortIfError\")) Module[\"runAndAbortIfError\"] = function() { abort(\"'runAndAbortIfError' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"warnOnce\")) Module[\"warnOnce\"] = function() { abort(\"'warnOnce' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"stackSave\")) Module[\"stackSave\"] = function() { abort(\"'stackSave' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"stackRestore\")) Module[\"stackRestore\"] = function() { abort(\"'stackRestore' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"stackAlloc\")) Module[\"stackAlloc\"] = function() { abort(\"'stackAlloc' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"AsciiToString\")) Module[\"AsciiToString\"] = function() { abort(\"'AsciiToString' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"stringToAscii\")) Module[\"stringToAscii\"] = function() { abort(\"'stringToAscii' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"UTF16ToString\")) Module[\"UTF16ToString\"] = function() { abort(\"'UTF16ToString' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"stringToUTF16\")) Module[\"stringToUTF16\"] = function() { abort(\"'stringToUTF16' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"lengthBytesUTF16\")) Module[\"lengthBytesUTF16\"] = function() { abort(\"'lengthBytesUTF16' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"UTF32ToString\")) Module[\"UTF32ToString\"] = function() { abort(\"'UTF32ToString' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"stringToUTF32\")) Module[\"stringToUTF32\"] = function() { abort(\"'stringToUTF32' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"lengthBytesUTF32\")) Module[\"lengthBytesUTF32\"] = function() { abort(\"'lengthBytesUTF32' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"allocateUTF8\")) Module[\"allocateUTF8\"] = function() { abort(\"'allocateUTF8' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nif (!Object.getOwnPropertyDescriptor(Module, \"allocateUTF8OnStack\")) Module[\"allocateUTF8OnStack\"] = function() { abort(\"'allocateUTF8OnStack' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") };\r\nModule[\"writeStackCookie\"] = writeStackCookie;\r\nModule[\"checkStackCookie\"] = checkStackCookie;\r\nif (!Object.getOwnPropertyDescriptor(Module, \"ALLOC_NORMAL\")) Object.defineProperty(Module, \"ALLOC_NORMAL\", { configurable: true, get: function() { abort(\"'ALLOC_NORMAL' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") } });\r\nif (!Object.getOwnPropertyDescriptor(Module, \"ALLOC_STACK\")) Object.defineProperty(Module, \"ALLOC_STACK\", { configurable: true, get: function() { abort(\"'ALLOC_STACK' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)\") } });\r\n\r\nvar calledRun;\r\n\r\n/**\r\n * @constructor\r\n * @this {ExitStatus}\r\n */\r\nfunction ExitStatus(status) {\r\n  this.name = \"ExitStatus\";\r\n  this.message = \"Program terminated with exit(\" + status + \")\";\r\n  this.status = status;\r\n}\r\n\r\nvar calledMain = false;\r\n\r\ndependenciesFulfilled = function runCaller() {\r\n  // If run has never been called, and we should call run (INVOKE_RUN is true, and Module.noInitialRun is not false)\r\n  if (!calledRun) run();\r\n  if (!calledRun) dependenciesFulfilled = runCaller; // try this again later, after new deps are fulfilled\r\n};\r\n\r\nfunction stackCheckInit() {\r\n  // This is normally called automatically during __wasm_call_ctors but need to\r\n  // get these values before even running any of the ctors so we call it redundantly\r\n  // here.\r\n  // TODO(sbc): Move writeStackCookie to native to to avoid this.\r\n  _emscripten_stack_init();\r\n  writeStackCookie();\r\n}\r\n\r\n/** @type {function(Array=)} */\r\nfunction run(args) {\r\n  args = args || arguments_;\r\n\r\n  if (runDependencies > 0) {\r\n    return;\r\n  }\r\n\r\n  stackCheckInit();\r\n\r\n  preRun();\r\n\r\n  // a preRun added a dependency, run will be called later\r\n  if (runDependencies > 0) {\r\n    return;\r\n  }\r\n\r\n  function doRun() {\r\n    // run may have just been called through dependencies being fulfilled just in this very frame,\r\n    // or while the async setStatus time below was happening\r\n    if (calledRun) return;\r\n    calledRun = true;\r\n    Module['calledRun'] = true;\r\n\r\n    if (ABORT) return;\r\n\r\n    initRuntime();\r\n\r\n    readyPromiseResolve(Module);\r\n\r\n    assert(!Module['_main'], 'compiled without a main, but one is present. if you added it from JS, use Module[\"onRuntimeInitialized\"]');\r\n\r\n    postRun();\r\n  }\r\n\r\n  {\r\n    doRun();\r\n  }\r\n  checkStackCookie();\r\n}\r\nModule['run'] = run;\r\n\r\nfunction checkUnflushedContent() {\r\n  // Compiler settings do not allow exiting the runtime, so flushing\r\n  // the streams is not possible. but in ASSERTIONS mode we check\r\n  // if there was something to flush, and if so tell the user they\r\n  // should request that the runtime be exitable.\r\n  // Normally we would not even include flush() at all, but in ASSERTIONS\r\n  // builds we do so just for this check, and here we see if there is any\r\n  // content to flush, that is, we check if there would have been\r\n  // something a non-ASSERTIONS build would have not seen.\r\n  // How we flush the streams depends on whether we are in SYSCALLS_REQUIRE_FILESYSTEM=0\r\n  // mode (which has its own special function for this; otherwise, all\r\n  // the code is inside libc)\r\n  var oldOut = out;\r\n  var oldErr = err;\r\n  var has = false;\r\n  out = err = function(x) {\r\n    has = true;\r\n  }\r\n  try { // it doesn't matter if it fails\r\n    var flush = flush_NO_FILESYSTEM;\r\n    if (flush) flush();\r\n  } catch(e) {}\r\n  out = oldOut;\r\n  err = oldErr;\r\n  if (has) {\r\n    warnOnce('stdio streams had content in them that was not flushed. you should set EXIT_RUNTIME to 1 (see the FAQ), or make sure to emit a newline when you printf etc.');\r\n    warnOnce('(this may also be due to not including full filesystem support - try building with -s FORCE_FILESYSTEM=1)');\r\n  }\r\n}\r\n\r\n/** @param {boolean|number=} implicit */\r\nfunction exit(status, implicit) {\r\n  EXITSTATUS = status;\r\n\r\n  checkUnflushedContent();\r\n\r\n  if (keepRuntimeAlive()) {\r\n    // if exit() was called, we may warn the user if the runtime isn't actually being shut down\r\n    if (!implicit) {\r\n      var msg = 'program exited (with status: ' + status + '), but EXIT_RUNTIME is not set, so halting execution but not exiting the runtime or preventing further async execution (build with EXIT_RUNTIME=1, if you want a true shutdown)';\r\n      readyPromiseReject(msg);\r\n      err(msg);\r\n    }\r\n  } else {\r\n    exitRuntime();\r\n  }\r\n\r\n  procExit(status);\r\n}\r\n\r\nfunction procExit(code) {\r\n  EXITSTATUS = code;\r\n  if (!keepRuntimeAlive()) {\r\n    ABORT = true;\r\n  }\r\n  quit_(code, new ExitStatus(code));\r\n}\r\n\r\nrun();\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n  return Module.ready\r\n}\r\n);\r\n})();\r\nexport default Module;","import { canvas } from \"./canvas.js\";\r\n\r\n/**\r\n * A global JavaScript object \"sock\".\r\n * Provides utils for globally executing code, e.g. from the Wren `JavaScript` class.\r\n * @type {any}\r\n */\r\nexport let sockJsGlobal = Object.assign(self[\"sock\"] || (self[\"sock\"] = {}), {\r\n\t\r\n\tcanvas: canvas,\r\n\t\r\n\tasync toggleFullscreen() {\r\n\t\tif (document.fullscreenEnabled) {\r\n\t\t\tif (document.fullscreenElement) {\r\n\t\t\t\tawait document.exitFullscreen();\r\n\t\t\t\treturn true;\r\n\t\t\t} else {\r\n\t\t\t\ttry {\r\n\t\t\t\t\tawait document.body.requestFullscreen();\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t} catch (error) {\r\n\t\t\t\t\tconsole.warn(error);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tconsole.warn(\"fullscreen is blocked by the browser\");\r\n\t\t}\r\n\t\treturn false;\r\n\t},\r\n\r\n\ttogglePointerLock() {\r\n\t\tif (document.pointerLockElement) {\r\n\t\t\tdocument.exitPointerLock();\r\n\t\t} else {\r\n\t\t\tcanvas.requestPointerLock();\r\n\t\t}\r\n\t},\r\n\r\n});\r\n","import { resolveForeignMethod, resolveForeignClass } from \"./foreign.js\";\r\nimport { httpGET } from \"./network/http.js\";\r\nimport sockEmscriptenFactory from \"../js-generated/sock_c.js\";\r\nimport { messagingEnabled, sendMessage } from \"./messaging.js\";\r\n\r\n/**\r\n * The Emscripten module. Loaded asyncronusly.\r\n * @type {import(\"../js-generated/sock_c.js\").SockEmscriptenModule}\r\n */\r\nexport let Module;\r\n\r\nexport function HEAP() {\r\n\treturn Module.HEAPU8.buffer;\r\n}\r\n\r\nexport function HEAPU8() {\r\n\treturn Module.HEAPU8;\r\n}\r\n\r\nexport function HEAPF64() {\r\n\treturn Module.HEAPF64;\r\n}\r\n\r\n/**\r\n * Used to accumlate Wren writes.\r\n */\r\nlet writeBuffer = \"\";\r\n\r\n/**\r\n * Holds a setTimeout() ID. Used for automatic `writeBuffer` flushing.\r\n * @type {number}\r\n */\r\nlet writeBufferTimeoutID;\r\n\r\n/**\r\n * Pointer to Wren VM.\r\n * @type {number}\r\n */\r\nexport let vm;\r\n\r\nexport async function loadEmscripten() {\r\n\t// Load the Emscripten module.\r\n\tModule = await sockEmscriptenFactory();\r\n\r\n\t// Setup [Module.sock] object.\r\n\t// This is used by [src/js-esm/library.js] to enable C->JS communication.\r\n\tModule.sock = {\r\n\t\t/**\r\n\t\t * @param {string} line\r\n\t\t */\r\n\t\twrite(line) {\r\n\t\t\tconsole.log(line);\r\n\r\n\t\t\tif (messagingEnabled) {\r\n\t\t\t\tsendMessage(\"print\", line);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * @param {number} type\r\n\t\t * @param {string} moduleName\r\n\t\t * @param {number} lineNumber\r\n\t\t * @param {string} message\r\n\t\t */\r\n\t\terror(type, moduleName, lineNumber, message) {\r\n\t\t\twrenHasError = true;\r\n\r\n\t\t\tlet s;\r\n\t\t\tif (type === 0) {\r\n\t\t\t\t// Compile error.\r\n\t\t\t\twrenErrorMessage = message;\r\n\r\n\t\t\t\ts = `[WREN COMPILE ERROR]\\n${message}\\n  at ${formatModuleLineTrace(moduleName, lineNumber)}`;\r\n\r\n\t\t\t\twrenErrorStack = [];\r\n\t\t\t\twrenErrorStack.push([ moduleName, lineNumber, null ]);\r\n\t\t\t} else if (type === 1) {\r\n\t\t\t\t// Runtime error.\r\n\t\t\t\twrenErrorMessage = message;\r\n\r\n\t\t\t\ts = \"[WREN RUNTIME ERROR]\\n\" + message;\r\n\r\n\t\t\t\twrenErrorStack = [];\r\n\t\t\t} else if (type === 2) {\r\n\t\t\t\t// Stack trace\r\n\t\t\t\ts = `  at ${message} ${formatModuleLineTrace(moduleName, lineNumber)}`;\r\n\r\n\t\t\t\twrenErrorStack.push([ moduleName, lineNumber, message ]);\r\n\t\t\t}\r\n\r\n\t\t\t// Always log errors to console.\r\n\t\t\tconsole.error(s);\r\n\t\t\t\r\n\t\t\t// Join with newlines.\r\n\t\t\twrenErrorString = wrenErrorString ? wrenErrorString + \"\\n\" + s : s;\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * @param {string} moduleName\r\n\t\t */\r\n\t\tloadModule(moduleName) {\r\n\t\t\t// Use fiber hack to do async load.\r\n\t\t\thttpGET(\"assets\" + moduleName + \".wren\", \"arraybuffer\").then(\r\n\t\t\t\t(buffer) => {\r\n\t\t\t\t\tlet result = wrenInterpret(moduleName, buffer);\r\n\r\n\t\t\t\t\tif (result === 0) {\r\n\t\t\t\t\t\twrenInterpret(moduleName, \"self__.transfer()\");\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\t(error) => {\r\n\t\t\t\t\tconsole.warn(`Error loading module source \"${moduleName}\"`, error);\r\n\r\n\t\t\t\t\twrenInterpret(moduleName, \"self__.transferError(\" + stringToWrenString(String(error)) + \")\");\r\n\t\t\t\t}\r\n\t\t\t);\r\n\r\n\t\t\treturn \"var self__=Fiber.current\\nFiber.suspend()\\nself__=null\";\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * @param {string} module\r\n\t\t * @param {string} className\r\n\t\t * @param {boolean} isStatic\r\n\t\t * @param {string} signature\r\n\t\t * @returns {(vm: number) => void}\r\n\t\t */\r\n\t\tbindMethod(module, className, isStatic, signature) {\r\n\t\t\treturn resolveForeignMethod(module, className, isStatic, signature)\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * @param {string} module\r\n\t\t * @param {string} className\r\n\t\t * @returns {[(vm: number) => void, (vm: number) => void]}\r\n\t\t */\r\n\t\tbindClass(module, className) {\r\n\t\t\treturn resolveForeignClass(module, className);\r\n\t\t},\r\n\t};\r\n\r\n\t// Init C sock.\r\n\tvm = Module.ccall(\"sock_init\", \"number\");\r\n\tif (vm === 0) throw Error(\"error loading VM\");\r\n}\r\n\r\n/**\r\n * Interpret a Wren script in the given module.\r\n * @param {string} moduleName\r\n * @param {CStringSource} moduleSource \r\n * @returns {WrenInterpretResult}\r\n */\r\nexport function wrenInterpret(moduleName, moduleSource) {\r\n\tlet stack = 0;\r\n\r\n\tlet src, srcType;\r\n\tif (typeof moduleSource === \"string\") {\r\n\t\tsrc = moduleSource;\r\n\t\tsrcType = \"string\";\r\n\t} else {\r\n\t\tstack = Module.stackSave();\r\n\t\tsrc = stackAllocUTF8ArrayAsCString(moduleSource);\r\n\t\tsrcType = \"number\";\r\n\t}\r\n\r\n\tlet result = Module.ccall(\"wrenInterpret\",\r\n\t\t\"number\",\r\n\t\t[\"number\", \"string\", srcType],\r\n\t\t[vm, moduleName, src]\r\n\t);\r\n\r\n\tif (stack) {\r\n\t\tModule.stackRestore(stack);\r\n\t}\r\n\r\n\treturn result;\r\n}\r\n\r\n/**\r\n * Check if a module has a variable of the given name.\r\n * @param {string} moduleName\r\n * @param {string} name \r\n * @returns {boolean}\r\n */\r\nexport function wrenHasVariable(moduleName, name) {\r\n\treturn Module.ccall(\"wrenHasVariable\",\r\n\t\t\"boolean\",\r\n\t\t[\"number\", \"string\", \"string\"],\r\n\t\t[vm, moduleName, name]\r\n\t);\r\n}\r\n\r\n/**\r\n * Check if a module has a variable of the given name.\r\n * @param {number} numSlots\r\n */\r\nexport function wrenEnsureSlots(numSlots) {\r\n\tModule.ccall(\"wrenEnsureSlots\",\r\n\t\tnull,\r\n\t\t[\"number\", \"number\"],\r\n\t\t[vm, numSlots]\r\n\t);\r\n}\r\n\r\n/**\r\n * @param {number} slot\r\n * @returns {number}\r\n */\r\nexport function wrenGetSlotType(slot) {\r\n\treturn Module.ccall(\"wrenGetSlotType\",\r\n\t\t\"number\",\r\n\t\t[\"number\", \"number\"],\r\n\t\t[vm, slot]\r\n\t);\r\n}\r\n\r\n/**\r\n * @param {number} slot\r\n * @returns {boolean}\r\n */\r\nexport function wrenGetSlotBool(slot) {\r\n\treturn Module.ccall(\"wrenGetSlotBool\",\r\n\t\t\"boolean\",\r\n\t\t[\"number\", \"number\"],\r\n\t\t[vm, slot]\r\n\t);\r\n}\r\n\r\n/**\r\n * @param {number} slot\r\n * @returns {string}\r\n */\r\nexport function wrenGetSlotString(slot) {\r\n\treturn Module.ccall(\"wrenGetSlotString\",\r\n\t\t\"string\",\r\n\t\t[\"number\", \"number\"],\r\n\t\t[vm, slot]\r\n\t);\r\n}\r\n\r\n/**\r\n * @param {number} slot\r\n * @returns {Uint8Array}\r\n */\r\nexport function getSlotBytes(slot) {\r\n\tlet stack = Module.stackSave();\r\n\r\n\tlet lenPtr = Module.stackAlloc(4);\r\n\r\n\tlet ptr = Module.ccall(\"wrenGetSlotBytes\",\r\n\t\t\"number\",\r\n\t\t[\"number\", \"number\", \"number\"],\r\n\t\t[vm, slot, lenPtr]\r\n\t);\r\n\r\n\tlet heap = HEAP();\r\n\r\n\tlet length = new Int32Array(heap, lenPtr)[0];\r\n\r\n\tModule.stackRestore(stack);\r\n\r\n\treturn new Uint8Array(heap, ptr, length);\r\n}\r\n\r\n/**\r\n * @param {number} slot\r\n * @returns {number}\r\n */\r\nexport function wrenGetSlotDouble(slot) {\r\n\treturn Module.ccall(\"wrenGetSlotDouble\",\r\n\t\t\"number\",\r\n\t\t[\"number\", \"number\"],\r\n\t\t[vm, slot]\r\n\t);\r\n}\r\n\r\n/**\r\n * @param {number} slot\r\n * @returns {number}\r\n */\r\nexport function wrenGetListCount(slot) {\r\n\treturn Module.ccall(\"wrenGetListCount\",\r\n\t\t\"number\",\r\n\t\t[\"number\", \"number\"],\r\n\t\t[vm, slot]\r\n\t);\r\n}\r\n\r\n/**\r\n * @param {number} listSlot\r\n * @param {number} index\r\n * @param {number} elementSlot\r\n */\r\nexport function wrenGetListElement(listSlot, index, elementSlot) {\r\n\tModule.ccall(\"wrenGetListElement\",\r\n\t\tnull,\r\n\t\t[\"number\", \"number\", \"number\", \"number\"],\r\n\t\t[vm, listSlot, index, elementSlot]\r\n\t);\r\n}\r\n\r\n/**\r\n * @param {number} listSlot\r\n * @param {number} index\r\n * @param {number} elementSlot\r\n */\r\nexport function wrenSetListElement(listSlot, index, elementSlot) {\r\n\tModule.ccall(\"wrenSetListElement\",\r\n\t\tnull,\r\n\t\t[\"number\", \"number\", \"number\", \"number\"],\r\n\t\t[vm, listSlot, index, elementSlot]\r\n\t);\r\n}\r\n\r\n/**\r\n * @param {number} listSlot\r\n * @param {number} index\r\n * @param {number} elementSlot\r\n */\r\nexport function wrenInsertInList(listSlot, index, elementSlot) {\r\n\tModule.ccall(\"wrenInsertInList\",\r\n\t\tnull,\r\n\t\t[\"number\", \"number\", \"number\", \"number\"],\r\n\t\t[vm, listSlot, index, elementSlot]\r\n\t);\r\n}\r\n\r\n/**\r\n * @param {number} slot\r\n * @returns {number}\r\n */\r\nexport function wrenGetSlotForeign(slot) {\r\n\treturn Module.ccall(\"wrenGetSlotForeign\",\r\n\t\t\"number\",\r\n\t\t[\"number\", \"number\"],\r\n\t\t[vm, slot]\r\n\t);\r\n}\r\n\r\n/**\r\n * @param {number} slot\r\n * @param {number} classSlot\r\n * @returns {boolean}\r\n */\r\nexport function wrenGetSlotIsInstanceOf(slot, classSlot) {\r\n\treturn Module.ccall(\"wrenGetSlotIsInstanceOf\",\r\n\t\t\"boolean\",\r\n\t\t[\"number\", \"number\", \"number\"],\r\n\t\t[vm, slot, classSlot]\r\n\t);\r\n}\r\n\r\n/**\r\n * @param {number} slot\r\n * @returns {number}\r\n */\r\nexport function wrenGetSlotHandle(slot) {\r\n\treturn Module.ccall(\"wrenGetSlotHandle\",\r\n\t\t\"number\",\r\n\t\t[\"number\", \"number\"],\r\n\t\t[vm, slot]\r\n\t);\r\n}\r\n\r\n/**\r\n * @param {string} moduleName\r\n * @param {string} name\r\n * @param {number} slot\r\n */\r\nexport function wrenGetVariable(moduleName, name, slot) {\r\n\tModule.ccall(\"wrenGetVariable\",\r\n\t\tnull,\r\n\t\t[\"number\", \"string\", \"string\", \"number\"],\r\n\t\t[vm, moduleName, name, slot]\r\n\t);\r\n}\r\n\r\n/**\r\n * @param {number} slot\r\n */\r\nexport function wrenSetSlotNull(slot) {\r\n\tModule.ccall(\"wrenSetSlotNull\",\r\n\t\tnull,\r\n\t\t[\"number\", \"number\"],\r\n\t\t[vm, slot]\r\n\t);\r\n}\r\n\r\n/**\r\n * @param {number} slot\r\n * @param {boolean} value\r\n */\r\nexport function wrenSetSlotBool(slot, value) {\r\n\tModule.ccall(\"wrenSetSlotBool\",\r\n\t\tnull,\r\n\t\t[\"number\", \"number\", \"boolean\"],\r\n\t\t[vm, slot, value]\r\n\t);\r\n}\r\n\r\n/**\r\n * @param {number} slot\r\n * @param {number} value\r\n */\r\nexport function wrenSetSlotDouble(slot, value) {\r\n\tModule.ccall(\"wrenSetSlotDouble\",\r\n\t\tnull,\r\n\t\t[\"number\", \"number\", \"number\"],\r\n\t\t[vm, slot, value]\r\n\t);\r\n}\r\n\r\n/**\r\n * @param {number} slot\r\n * @param {number} from\r\n * @param {number} to\r\n * @param {number} step\r\n * @param {boolean} isInclusive\r\n */\r\nexport function wrenSetSlotRange(slot, from, to, step, isInclusive) {\r\n\tModule.ccall(\"wrenSetSlotRange\",\r\n\t\tnull,\r\n\t\t[\"number\", \"number\", \"number\", \"number\", \"number\", \"boolean\"],\r\n\t\t[vm, slot, from, to, step, isInclusive]\r\n\t);\r\n}\r\n\r\n/**\r\n * @param {number} slot\r\n * @param {CStringSource} text\r\n */\r\nexport function wrenSetSlotString(slot, text) {\r\n\tlet stack = 0;\r\n\r\n\tlet textRaw, textType;\r\n\tif (typeof text === \"string\") {\r\n\t\ttextRaw = text;\r\n\t\ttextType = \"string\";\r\n\t} else {\r\n\t\tstack = Module.stackSave();\r\n\t\ttextRaw = stackAllocUTF8ArrayAsCString(text);\r\n\t\ttextType = \"number\";\r\n\t}\r\n\r\n\tModule.ccall('wrenSetSlotString',\r\n\t\tnull,\r\n\t\t['number', 'number', textType],\r\n\t\t[vm, slot, textRaw]\r\n\t);\r\n\r\n\tif (stack) {\r\n\t\tModule.stackRestore(stack);\r\n\t}\r\n}\r\n\r\n/**\r\n * @param {number} slot\r\n * @param {number} handle\r\n */\r\nexport function wrenSetSlotHandle(slot, handle) {\r\n\tModule.ccall(\"wrenSetSlotHandle\",\r\n\t\tnull,\r\n\t\t[\"number\", \"number\", \"number\"],\r\n\t\t[vm, slot, handle]\r\n\t);\r\n}\r\n\r\n/**\r\n * @param {number} slot\r\n * @param {number} classSlot\r\n * @param {number} size\r\n * @returns {number}\r\n */\r\nexport function wrenSetSlotNewForeign(slot, classSlot, size) {\r\n\treturn Module.ccall(\"wrenSetSlotNewForeign\",\r\n\t\t\"number\",\r\n\t\t[\"number\", \"number\", \"number\", \"number\"],\r\n\t\t[vm, slot, classSlot, size]\r\n\t);\r\n}\r\n\r\n/**\r\n * @param {number} slot\r\n */\r\nexport function wrenSetSlotNewList(slot) {\r\n\tModule.ccall(\"wrenSetSlotNewList\",\r\n\t\t\"number\",\r\n\t\t[\"number\", \"number\"],\r\n\t\t[vm, slot]\r\n\t);\r\n}\r\n\r\n/**\r\n * @param {number} callHandle\r\n * @returns {WrenInterpretResult}\r\n */\r\nexport function wrenCall(callHandle) {\r\n\treturn Module.ccall(\"wrenCall\",\r\n\t\t\"number\",\r\n\t\t[\"number\", \"number\"],\r\n\t\t[vm, callHandle]\r\n\t);\r\n}\r\n\r\n/**\r\n * @param {string} moduleName\r\n */\r\nexport function wrenAddImplicitImportModule(moduleName) {\r\n\tModule.ccall(\"wrenAddImplicitImportModule\",\r\n\t\tnull,\r\n\t\t[\"number\", \"string\"],\r\n\t\t[vm, moduleName]\r\n\t);\r\n}\r\n\r\n/**\r\n * @param {number} handle\r\n */\r\nexport function wrenReleaseHandle(handle) {\r\n\tModule.ccall(\"wrenReleaseHandle\",\r\n\t\tnull,\r\n\t\t[\"number\", \"number\"],\r\n\t\t[vm, handle]\r\n\t);\r\n}\r\n\r\n/**\r\n * @param {number} slot\r\n */\r\nexport function wrenAbortFiber(slot) {\r\n\tModule.ccall(\"wrenAbortFiber\",\r\n\t\tnull,\r\n\t\t[\"number\", \"number\"],\r\n\t\t[vm, slot]\r\n\t);\r\n}\r\n\r\n/**\r\n * @param {string} message\r\n */\r\nexport function wrenAbort(message) {\r\n\twrenEnsureSlots(1);\r\n\twrenSetSlotString(0, message);\r\n\twrenAbortFiber(0);\r\n}\r\n\r\n/**\r\n * Format a JS string as a Wren string literal.\r\n * @param {string} s\r\n * @returns {string}\r\n */\r\nfunction stringToWrenString(s) {\r\n\tlet r = '\"';\r\n\r\n\tfor (let i = 0; i < s.length; i++) {\r\n\t\tlet c = s[i];\r\n\t\tif (c === \"\\\\\") {\r\n\t\t\tr += \"\\\\\\\\\";\r\n\t\t} else if (c === \"%\" || c === '\"') {\r\n\t\t\tr += \"\\\\\" + c;\r\n\t\t} else {\r\n\t\t\tr += c;\r\n\t\t}\r\n\t}\r\n\r\n\treturn r + '\"';\r\n}\r\n\r\nexport let wrenHasError = false;\r\n\r\n/**\r\n * null if no error.\r\n * @type {string|null}\r\n */\r\nexport let wrenErrorMessage = null;\r\n\r\n/**\r\n * A string that accumulates Wren error information.\r\n * \r\n * null if no error.\r\n * @type {string|null}\r\n */\r\nexport let wrenErrorString = null;\r\n\r\n/**\r\n * Provides the module name, line number, location to the wren file at the top of the error stack.\r\n * @type {[string, number, string|null][]}\r\n */\r\nexport let wrenErrorStack;\r\n\r\n/**\r\n * @param {string} name\r\n * @param {number} lineNumber\r\n * @returns {string}\r\n */\r\nfunction formatModuleLineTrace(name, lineNumber) {\r\n\tif (name[0] === \"/\") {\r\n\t\tname = name.slice(1);\r\n\t}\r\n\r\n\treturn name + \":\" + lineNumber;\r\n}\r\n\r\n/**\r\n * @param {number} type\r\n * @returns {string}\r\n */\r\nexport function wrenTypeToName(type) {\r\n\tswitch (type) {\r\n\t\tcase 0: return \"Bool\";\r\n\t\tcase 1: return \"Num\";\r\n\t\tcase 2: return \"foreign\";\r\n\t\tcase 3: return \"List\";\r\n\t\tcase 4: return \"Map\";\r\n\t\tcase 5: return \"Null\";\r\n\t\tcase 6: return \"String\";\r\n\t\tcase 7: return \"Unknown\";\r\n\t}\r\n\treturn \"?\";\r\n}\r\n\r\n/**\r\n * @param {ArrayBuffer | Uint8Array | Uint8ClampedArray} arraySource \r\n * @returns {number}\r\n */\r\nfunction stackAllocUTF8ArrayAsCString(arraySource) {\r\n\tlet src = arraySource instanceof ArrayBuffer ? new Uint8Array(arraySource) : arraySource;\r\n\r\n\tlet nullTerminated = src[src.length - 1] === 0;\r\n\tlet len = nullTerminated ? src.length : src.length + 1;\r\n\t\r\n\tlet ptr = Module.stackAlloc(len);\r\n\r\n\tlet u8 = HEAPU8();\r\n\r\n\tu8.set(src, ptr);\r\n\r\n\tif (!nullTerminated) {\r\n\t\tu8[ptr + len - 1] = 0;\r\n\t}\r\n\r\n\treturn ptr;\r\n}\r\n\r\n/**\r\n * @param {number} slot\r\n * @returns {number}\r\n */\r\nexport function wren_sock_get_transform(slot) {\r\n\treturn Module.ccall(\"sock_get_transform\", \"number\", [ \"number\" ], [ slot ]);\r\n}\r\n\r\n/**\r\n * A string that is passed to C/Wasm.\r\n * \r\n * If provided as an array, it is interpreted as a UTF-8 byte array, which is copied directly into Wasm memory.\r\n * This avoids the overhead of converting a JavaScript string to UTF-8.\r\n * @typedef {string | ArrayBuffer | Uint8Array | Uint8ClampedArray} CStringSource\r\n */\r\n\r\n/**\r\n * The result of a VM interpreting wren source.\r\n * - 0: The VM interpreted the source without error.\r\n * - 1: The VM experienced a compile error.\r\n * - 2: The VM experienced a runtime error.\r\n * @typedef {0 | 1 | 2} WrenInterpretResult\r\n */\r\n\r\n\r\n","import { sockJsGlobal } from \"./globals.js\";\r\n\r\n/**\r\n * If messaging was flagged via HTML page.\r\n */\r\nexport let messagingEnabled = !!sockJsGlobal.messaging;\r\n\r\n/** @type {(((arg: any) => void) & { type: string })[]} */\r\nlet waitingMessages  = [];\r\n\r\n/**\r\n * @param {string} type\r\n * @returns {Promise<any>}\r\n */\r\nexport function waitForMessage(type) {\r\n\treturn new Promise(/** @param {((arg: any) => void) & { type: string }} resolve */(resolve) => {\r\n\t\tresolve.type = type;\r\n\t\twaitingMessages.push(resolve);\r\n\t});\r\n}\r\n\r\n/**\r\n * @param {string} type\r\n * @param {string} [data]\r\n */\r\nexport function sendMessage(type, data) {\r\n\tif (parent !== window) parent.postMessage({ type: type, data: data });\r\n}\r\n\r\nif (messagingEnabled) {\r\n\taddEventListener(\"message\", (event) => {\r\n\t\tlet data = event.data;\r\n\t\tif (data && typeof data === \"object\") {\r\n\t\t\tlet msgType = data.type;\r\n\t\t\tif (msgType) {\r\n\t\t\t\tlet arg = data.data;\r\n\r\n\t\t\t\t// Pull out functions with the corresponding type.\r\n\t\t\t\tlet stillWaiting = [];\r\n\t\t\t\tlet callNow = [];\r\n\t\t\t\tfor (let f of waitingMessages) {\r\n\t\t\t\t\tif (f.type === msgType) {\r\n\t\t\t\t\t\tcallNow.push(f);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tstillWaiting.push(f);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\twaitingMessages = stillWaiting;\r\n\r\n\t\t\t\t// Call matching functions.\r\n\t\t\t\tfor (let f of callNow) {\r\n\t\t\t\t\tf(arg);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t});\r\n}\r\n","import { Module, vm } from \"./vm.js\";\r\n\r\n// Single repository for Wren call-handles.\r\n// Help's us re-use common call-handles.\r\n\r\nexport let callHandle_call_0 = 0;\r\nexport let callHandle_transfer_1 = 0;\r\nexport let callHandle_path_get = 0;\r\nexport let callHandle_init_0 = 0;\r\nexport let callHandle_init_2 = 0;\r\nexport let callHandle_load_0 = 0;\r\nexport let callHandle_load_1 = 0;\r\nexport let callHandle_loaded_3 = 0;\r\nexport let callHandle_update_0 = 0;\r\nexport let callHandle_update_1 = 0;\r\nexport let callHandle_update_2 = 0;\r\nexport let callHandle_update_3 = 0;\r\nexport let callHandle_resolve_2 = 0;\r\nexport let callHandle_toString = 0;\r\nexport let callHandle_updateMouse_3 = 0;\r\nexport let callHandle_updateTouch_5 = 0;\r\n\r\n\r\nexport function makeCallHandles() {\r\n\tcallHandle_call_0 = wrenMakeCallHandle(\"call()\");\r\n\tcallHandle_transfer_1 = wrenMakeCallHandle(\"transfer(_)\");\r\n\tcallHandle_path_get = wrenMakeCallHandle(\"path\");\r\n\tcallHandle_init_0 = wrenMakeCallHandle(\"init_()\");\r\n\tcallHandle_init_2 = wrenMakeCallHandle(\"init_(_,_)\");\r\n\tcallHandle_load_0 = wrenMakeCallHandle(\"load_()\");\r\n\tcallHandle_load_1 = wrenMakeCallHandle(\"load_(_)\");\r\n\tcallHandle_loaded_3 = wrenMakeCallHandle(\"loaded_(_,_,_)\");\r\n\tcallHandle_update_0 = wrenMakeCallHandle(\"update_()\");\r\n\tcallHandle_update_1 = wrenMakeCallHandle(\"update_(_)\");\r\n\tcallHandle_update_2 = wrenMakeCallHandle(\"update_(_,_)\");\r\n\tcallHandle_update_3 = wrenMakeCallHandle(\"update_(_,_,_)\");\r\n\tcallHandle_resolve_2 = wrenMakeCallHandle(\"resolve_(_,_)\");\r\n\tcallHandle_toString = wrenMakeCallHandle(\"toString\");\r\n\tcallHandle_updateMouse_3 = wrenMakeCallHandle(\"updateMouse_(_,_,_)\")\r\n\tcallHandle_updateTouch_5 = wrenMakeCallHandle(\"updateTouch_(_,_,_,_,_)\")\r\n}\r\n\r\n/**\r\n * @param {string} signature\r\n * @returns {number}\r\n */\r\nfunction wrenMakeCallHandle(signature) {\r\n\treturn Module.ccall(\"wrenMakeCallHandle\",\r\n\t\t\"number\",\r\n\t\t[\"number\", \"string\"],\r\n\t\t[vm, signature]\r\n\t);\r\n}\r\n","import { wrenCall, wrenEnsureSlots, wrenGetSlotHandle, wrenGetVariable, wrenSetSlotDouble, wrenSetSlotHandle } from \"../vm.js\";\r\nimport { callHandle_update_2 } from \"../vm-call-handles.js\";\r\nimport { addClassForeignStaticMethods } from \"../foreign.js\";\r\n\r\nlet handle_Time = 0;\r\n\r\nexport function initTimeModule() {\r\n\twrenEnsureSlots(1);\r\n\twrenGetVariable(\"sock\", \"Time\", 0);\r\n\thandle_Time = wrenGetSlotHandle(0);\r\n}\r\n\r\naddClassForeignStaticMethods(\"sock\", \"Time\", {\r\n\t\"epoch\"() {\r\n\t\twrenSetSlotDouble(0, Date.now() / 1000);\r\n\t},\r\n});\r\n\r\n/**\r\n * @param {number} time\r\n * @param {number} deltaTime\r\n */\r\nexport function updateTimeModule(time, deltaTime) {\r\n\twrenEnsureSlots(3);\r\n\twrenSetSlotHandle(0, handle_Time);\r\n\twrenSetSlotDouble(1, time);\r\n\twrenSetSlotDouble(2, deltaTime);\r\n\twrenCall(callHandle_update_2);\r\n}\r\n","import { callHandle_resolve_2 } from \"../vm-call-handles.js\";\r\nimport { wrenCall, wrenEnsureSlots, wrenGetSlotHandle, wrenGetSlotType, wrenGetVariable, wrenReleaseHandle, wrenSetSlotBool, wrenSetSlotDouble, wrenSetSlotHandle, wrenSetSlotNull, wrenSetSlotString } from \"../vm.js\";\r\n\r\nexport let handle_Promise = 0;\r\n\r\nexport function initPromiseModule() {\r\n\twrenEnsureSlots(1);\r\n\twrenGetVariable(\"sock\", \"Promise\", 0);\r\n\thandle_Promise = wrenGetSlotHandle(0);\r\n}\r\n\r\n/**\r\n * @param {number} promiseHandle\r\n * @param {Promise<WrenPromiseResult>} pvalue\r\n */\r\nexport function resolveWrenPromise(promiseHandle, pvalue) {\r\n\tpvalue.then(result => {\r\n\t\tresolve(promiseHandle, true, result);\r\n\t}, error => {\r\n\t\tresolve(promiseHandle, false, String(error));\r\n\t});\r\n}\r\n\r\n/**\r\n * \r\n * @param {number} promiseHandle \r\n * @param {boolean} success \r\n * @param {WrenPromiseResult} result \r\n */\r\nfunction resolve(promiseHandle, success, result) {\r\n\twrenEnsureSlots(3);\r\n\twrenSetSlotHandle(0, promiseHandle);\r\n\twrenSetSlotBool(1, success);\r\n\r\n\tif (result instanceof ArrayBuffer || typeof result === \"string\") {\r\n\t\twrenSetSlotString(2, result);\r\n\t} else if (result instanceof WrenHandle) {\r\n\t\twrenSetSlotHandle(2, result.handle);\r\n\t\twrenReleaseHandle(result.handle);\r\n\t} else if (typeof result === \"number\") {\r\n\t\twrenSetSlotDouble(2, result);\r\n\t} else if (typeof result === \"boolean\") {\r\n\t\twrenSetSlotBool(2, result);\r\n\t} else {\r\n\t\twrenSetSlotNull(2);\r\n\t}\r\n\r\n\twhile (true) {\r\n\t\tif (wrenCall(callHandle_resolve_2) !== 0) {\r\n\t\t\tbreak;\r\n\t\t}\r\n\t\t\r\n\t\twrenEnsureSlots(3);\r\n\t\t\r\n\t\tif (wrenGetSlotType(0) === 0) {\r\n\t\t\tbreak;\r\n\t\t}\r\n\r\n\t\twrenSetSlotHandle(0, promiseHandle);\r\n\t\twrenSetSlotNull(1);\r\n\t\twrenSetSlotNull(2);\r\n\t}\r\n\r\n\twrenReleaseHandle(promiseHandle);\r\n}\r\n\r\nexport class WrenHandle {\r\n\t/**\r\n\t * @param {number} handle \r\n\t */\r\n\tconstructor(handle) {\r\n\t\tthis.handle = handle;\r\n\t}\r\n}\r\n\r\n/**\r\n * To provide a value that is already in VM slot 2, pass the `IN_SLOT_2` object.\r\n * @typedef {string | number | boolean | ArrayBuffer | WrenHandle} WrenPromiseResult\r\n */\r\n","import { addClassForeignStaticMethods } from \"../foreign.js\";\r\nimport { httpExists, httpGET } from \"../network/http.js\";\r\nimport { resolveAbsoluteAssetPath } from \"../path.js\";\r\nimport { wrenAbort, wrenEnsureSlots, wrenGetSlotHandle, wrenGetSlotIsInstanceOf, wrenGetSlotString, wrenGetSlotType, wrenGetVariable, wrenSetSlotHandle } from \"../vm.js\";\r\nimport { handle_Promise, resolveWrenPromise } from \"./promise.js\";\r\n\r\nlet handle_Asset = 0;\r\n\r\nexport function initAssetModule() {\r\n\twrenEnsureSlots(1);\r\n\twrenGetVariable(\"sock\", \"Asset\", 0);\r\n\thandle_Asset = wrenGetSlotHandle(0);\r\n}\r\n\r\naddClassForeignStaticMethods(\"sock\", \"Asset\", {\r\n\t\"loadString_(_,_)\"() {\r\n\t\tloadAsset(url => httpGET(url, \"arraybuffer\"));\r\n\t},\r\n\t\"exists_(_,_)\"() {\r\n\t\tloadAsset(url => httpExists(url));\r\n\t},\r\n});\r\n\r\n/**\r\n * Loads asset from (path, promise) call.\r\n * @param {(url: string, path: string) => Promise<import(\"./promise.js\").WrenPromiseResult>} loader\r\n */\r\nexport function loadAsset(loader) {\r\n\twrenEnsureSlots(4);\r\n\twrenSetSlotHandle(3, handle_Promise);\r\n\r\n\tif (wrenGetSlotType(1) !== 6 || !wrenGetSlotIsInstanceOf(2, 3)) {\r\n\t\twrenAbort(\"args must be (string, Promise)\");\r\n\t\treturn;\r\n\t}\r\n\r\n\tlet path = wrenGetSlotString(1);\r\n\tlet url = resolveAbsoluteAssetPath(path);\r\n\tlet promise = wrenGetSlotHandle(2);\r\n\r\n\twrenSetSlotHandle(0, promise);\r\n\r\n\tresolveWrenPromise(promise, loader(url, path));\r\n}\r\n","\r\n/**\r\n * @param {string} path\r\n */\r\nexport function getExtension(path) {\r\n\tlet dot = path.lastIndexOf(\".\");\r\n\treturn dot < 0 ? \"\" : path.slice(dot + 1).toLowerCase();\r\n}\r\n\r\n/**\r\n * @param {string} path\r\n * @returns {string}\r\n */\r\nexport function resolveAbsoluteAssetPath(path) {\r\n\tif (path[0] !== \"/\") {\r\n\t\tpath = \"/\" + path;\r\n\t}\r\n\treturn \"assets\" + path;\r\n}\r\n","import { addForeignClass } from \"../foreign.js\";\r\nimport { sockJsGlobal } from \"../globals.js\";\r\nimport { httpGET } from \"../network/http.js\";\r\nimport * as Path from \"../path.js\";\r\nimport { wrenAbort, wrenEnsureSlots, wrenGetSlotBool, wrenGetSlotDouble, wrenGetSlotForeign, wrenGetSlotHandle, wrenGetSlotIsInstanceOf, wrenGetSlotString, wrenGetSlotType, wrenGetVariable, wrenReleaseHandle, wrenSetSlotBool, wrenSetSlotDouble, wrenSetSlotHandle, wrenSetSlotNewForeign } from \"../vm.js\";\r\nimport { loadAsset } from \"./asset.js\";\r\nimport { WrenHandle } from \"./promise.js\";\r\n\r\nconst MAX_EFFECT_PER_AUDIO = 8;\r\n\r\nconst EFFECT_TYPE_NONE = 0;\r\nconst EFFECT_TYPE_FILTER = 1;\r\nconst EFFECT_TYPE_ECHO = 2;\r\nconst EFFECT_TYPE_REVERB = 3;\r\nconst EFFECT_TYPE_DISTORTION = 4;\r\nconst EFFECT_TYPE_MIN = 1;\r\nconst EFFECT_TYPE_MAX = 4;\r\n\r\nconst EFFECT_TYPE_NAMES = [\r\n\t\"none\",\r\n\t\"filter\",\r\n\t\"echo\",\r\n\t\"reverb\",\r\n\t\"distortion\",\r\n];\r\n\r\nconst PARAM_FILTER_TYPE = 0;\r\nconst PARAM_FILTER_FREQUENCY = 1;\r\nconst PARAM_FILTER_RESONANCE = 2;\r\n\r\nconst PARAM_ECHO_DELAY = 0;\r\nconst PARAM_ECHO_DECAY = 1;\r\nconst PARAM_ECHO_VOLUME = 2;\r\n\r\nconst PARAM_REVERB_VOLUME = 0;\r\n\r\nconst FILTER_TYPE_LOWPASS = 0;\r\nconst FILTER_TYPE_HIGHPASS = 1;\r\nconst FILTER_TYPE_BANDPASS = 2;\r\nconst FILTER_TYPE_MIN = 0;\r\nconst FILTER_TYPE_MAX = 2;\r\n\r\nconst BASE_MASTER_GAIN = 0.5;\r\n\r\n/**\r\n * Used to decode audio if `audioctx` is not created yet.\r\n * @type {OfflineAudioContext}\r\n */\r\nlet offlineContext = null;\r\n\r\n/**\r\n * @type {AudioContext}\r\n */\r\nlet audioctx;\r\n\r\n/**\r\n * @type {GainNode}\r\n */\r\nlet masterGain;\r\n\r\n/**\r\n * @type {number}\r\n */\r\nlet handle_Audio = 0;\r\n\r\n/**\r\n * @type {number}\r\n */\r\nlet handle_AudioBus = 0;\r\n\r\n/**\r\n * @type {number}\r\n */\r\nlet handle_Voice = 0;\r\n\r\n/**\r\n * @param {number} duration\r\n * @returns {AudioBuffer}\r\n */\r\nfunction generateImpulse(duration) {\r\n\tlet frameCount = Math.floor(duration * audioctx.sampleRate);\r\n\tlet buffer = new AudioBuffer({\r\n\t\tlength: frameCount,\r\n\t\tsampleRate: audioctx.sampleRate,\r\n\t\tnumberOfChannels: 2,\r\n\t});\r\n\r\n\tlet ch1 = buffer.getChannelData(0);\r\n\tlet ch2 = buffer.getChannelData(1);\r\n\tlet baseVolume = 0.022;\r\n\r\n\tfor (let i = 0; i < frameCount; i++) {\r\n\t\tlet volume = baseVolume * Math.exp(-5 * (i / frameCount));\r\n\t\tch1[i] = (Math.random() * 2 - 1) * volume;\r\n\t\tch2[i] = (Math.random() * 2 - 1) * volume;\r\n\t}\r\n\r\n\treturn buffer;\r\n}\r\n\r\n/**\r\n * @type {AudioBuffer}\r\n */\r\nlet implulseChurch;\r\n\r\nexport function initAudioModule() {\r\n\twrenEnsureSlots(1);\r\n\r\n\twrenGetVariable(\"sock\", \"Audio\", 0);\r\n\thandle_Audio = wrenGetSlotHandle(0);\r\n\r\n\twrenGetVariable(\"sock\", \"Voice\", 0);\r\n\thandle_Voice = wrenGetSlotHandle(0);\r\n\t\r\n\twrenGetVariable(\"sock\", \"AudioBus\", 0);\r\n\thandle_AudioBus = wrenGetSlotHandle(0);\r\n}\r\n\r\nexport function createAudioContext() {\r\n\taudioctx = new AudioContext();\r\n\tsockJsGlobal.audio = audioctx;\r\n\t\r\n\t// Create main audio graph.\r\n\tmasterGain = new GainNode(audioctx, {\r\n\t\tgain: BASE_MASTER_GAIN,\r\n\t});\r\n\tmasterGain.connect(audioctx.destination);\r\n}\r\n\r\nexport function loadAudioModule() {\r\n\timplulseChurch = generateImpulse(3);\r\n}\r\n\r\nexport function stopAllAudio() {\r\n\tif (audioctx) {\r\n\t\taudioctx.close();\r\n\t\taudioctx = null;\r\n\t\tmasterGain = null;\r\n\t}\r\n}\r\n\r\n/**\r\n * @param {GainNode} gainNode\r\n * @param {number} volume\r\n * @param {number} fade\r\n */\r\nfunction fadeVolume(gainNode, volume, fade) {\r\n\tvolume = Math.max(0, volume);\r\n\tfade = Math.max(0.002, fade);\r\n\r\n\tlet gain = gainNode.gain;\r\n\tgain.cancelScheduledValues(audioctx.currentTime);\r\n\tgain.value = gain.value;\r\n\tgain.linearRampToValueAtTime(volume, audioctx.currentTime + fade);\r\n}\r\n\r\nclass AudioControls {\r\n\t/**\r\n\t * @param {AudioControls|null} [destination] \r\n\t */\r\n\tconstructor(destination) {\r\n\t\t/**\r\n\t\t * @type {Effect[]}\r\n\t\t */\r\n\t\tthis.effects = Array(MAX_EFFECT_PER_AUDIO).fill(null);\r\n\r\n\t\tthis.gain = audioctx.createGain();\r\n\r\n\t\t/**\r\n\t\t * Used to pipe this graph into another graph.\r\n\t\t * @type {AudioControls|null|undefined}\r\n\t\t */\r\n\t\tthis.destination = destination;\r\n\r\n\t\tthis.updateGraph();\r\n\t}\r\n\r\n\t/**\r\n\t * @returns {AudioNode}\r\n\t */\r\n\tgetInput() {\r\n\t\tfor (let i = 0; i < MAX_EFFECT_PER_AUDIO; i++) {\r\n\t\t\tlet effect = this.effects[i];\r\n\r\n\t\t\tif (effect) {\r\n\t\t\t\treturn effect.input;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn this.gain;\r\n\t}\r\n\r\n\t/**\r\n\t * @param {number} index\r\n\t * @returns {number}\r\n\t */\r\n\tgetEffectType(index) {\r\n\t\tlet effect = this.effects[index];\r\n\t\treturn effect ? effect.type : EFFECT_TYPE_NONE;\r\n\t}\r\n\r\n\tupdateGraph() {\r\n\t\t/** @type {AudioNode[]} */\r\n\t\tlet nodes = [];\r\n\r\n\t\tfor (let i = 0; i < MAX_EFFECT_PER_AUDIO; i++) {\r\n\t\t\tlet effect = this.effects[i];\r\n\t\t\tif (effect) {\r\n\t\t\t\t// Connect from prev into this effect input.\r\n\t\t\t\tfor (let node of nodes) {\r\n\t\t\t\t\tnode.connect(effect.input);\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t// Setup current effect outputs.\r\n\t\t\t\tnodes = effect.outputs;\r\n\t\t\t\t\r\n\t\t\t\t// Disconnect this effect's old output connections.\r\n\t\t\t\t// This may break this effect's internal connections, so call\r\n\t\t\t\t// [setupGraph] on effect to return these to normal.\r\n\t\t\t\tfor (let node of nodes) {\r\n\t\t\t\t\tnode.disconnect();\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (effect.setupGraph) {\r\n\t\t\t\t\teffect.setupGraph();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tfor (let node of nodes) {\r\n\t\t\tnode.connect(this.gain);\r\n\t\t}\r\n\r\n\t\tthis.gain.disconnect();\r\n\r\n\t\tthis.gain.connect(this.destination ? this.destination.getInput() : masterGain);\r\n\t}\r\n}\r\n\r\nclass AudioBus extends AudioControls {\r\n\t/**\r\n\t * @param {number} ptr\r\n\t */\r\n\tconstructor(ptr) {\r\n\t\tsuper();\r\n\r\n\t\tthis.ptr = ptr;\r\n\t}\r\n}\r\n\r\nclass Audio {\r\n\t/**\r\n\t * @param {number} ptr\r\n\t */\r\n\tconstructor(ptr) {\r\n\t\tthis.ptr = ptr;\r\n\t}\r\n\r\n\t/**\r\n\t * @param {AudioBuffer} buffer\r\n\t */\r\n\tsetBuffer(buffer) {\r\n\t\tthis.buffer = buffer;\r\n\t}\r\n}\r\n\r\n/**\r\n * @param {AudioParam} param\r\n * @param {number} value\r\n * @param {number} [fade]\r\n */\r\nfunction effectSetAudioParam(param, value, fade) {\r\n\tvalue = Math.max(param.minValue, Math.min(param.maxValue, value));\r\n\r\n\tif (fade) {\r\n\t\tparam.linearRampToValueAtTime(value, audioctx.currentTime + fade);\r\n\t} else {\r\n\t\tparam.value = value;\r\n\t}\r\n}\r\n\r\n\r\n// === EFFECTS ===\r\n\r\nclass FilterEffect {\r\n\tconstructor() {\r\n\t\tthis.filter = audioctx.createBiquadFilter();\r\n\t}\r\n\r\n\t/**\r\n\t * @param {number} index\r\n\t * @returns {number}\r\n\t */\r\n\tgetParam(index) {\r\n\t\tif (index === PARAM_FILTER_TYPE) {\r\n\t\t\tswitch (this.filter.type) {\r\n\t\t\t\tcase \"lowpass\": return FILTER_TYPE_LOWPASS;\r\n\t\t\t\tcase \"highpass\": return FILTER_TYPE_HIGHPASS;\r\n\t\t\t\tcase \"bandpass\": return FILTER_TYPE_BANDPASS;\r\n\t\t\t}\r\n\t\t} else if (index === PARAM_FILTER_FREQUENCY) {\r\n\t\t\treturn this.filter.frequency.value;\r\n\t\t} else if (index === PARAM_FILTER_RESONANCE) {\r\n\t\t\treturn this.filter.Q.value;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @param {number} index\r\n\t * @param {number} value\r\n\t */\r\n\tcheckParam(index, value) {\r\n\t\tif (index === PARAM_FILTER_TYPE) {\r\n\t\t\tvalue = Math.floor(value);\r\n\t\t\tif (value < FILTER_TYPE_MIN || value > FILTER_TYPE_MAX) {\r\n\t\t\t\treturn \"invalid filter type\";\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * @param {number} index\r\n\t * @param {number} value\r\n\t * @param {number} [fade]\r\n\t */\r\n\tsetParam(index, value, fade) {\r\n\t\tif (index === PARAM_FILTER_TYPE) {\r\n\t\t\tvalue = Math.floor(value);\r\n\t\t\tswitch (value) {\r\n\t\t\t\tcase FILTER_TYPE_LOWPASS:\r\n\t\t\t\t\tthis.filter.type = \"lowpass\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase FILTER_TYPE_HIGHPASS:\r\n\t\t\t\t\tthis.filter.type = \"highpass\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase FILTER_TYPE_BANDPASS:\r\n\t\t\t\t\tthis.filter.type = \"bandpass\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t} else if (index === PARAM_FILTER_FREQUENCY) {\r\n\t\t\teffectSetAudioParam(this.filter.frequency, value, fade);\r\n\t\t} else if (index === PARAM_FILTER_RESONANCE) {\r\n\t\t\teffectSetAudioParam(this.filter.Q, value, fade);\r\n\t\t}\r\n\t}\r\n\r\n\tget type() { return EFFECT_TYPE_FILTER }\r\n\tget input() { return this.filter }\r\n\tget outputs() { return [ this.filter ] }\r\n}\r\n\r\nclass EchoEffect {\r\n\tconstructor() {\r\n\t\tthis.maxDelay = -1;\r\n\t\tthis.node = new GainNode(audioctx);\r\n\t\tthis.decay = new GainNode(audioctx);\r\n\t\tthis.mix = new GainNode(audioctx);\r\n\t}\r\n\r\n\tcreate() {\r\n\t\tthis.delay = new DelayNode(audioctx, {\r\n\t\t\tdelayTime: this.maxDelay,\r\n\t\t\tmaxDelayTime: this.maxDelay,\r\n\t\t});\r\n\t\tthis.delay.connect(this.mix);\r\n\t\tthis.delay.connect(this.decay);\r\n\t\tthis.decay.connect(this.delay);\r\n\t}\r\n\r\n\tsetupGraph() {\r\n\t\tthis.node.connect(this.delay);\r\n\t}\r\n\r\n\t/**\r\n\t * @param {number} index\r\n\t * @returns {number}\r\n\t */\r\n\tgetParam(index) {\r\n\t\tif (index === PARAM_ECHO_DELAY) {\r\n\t\t\treturn this.delay ? this.delay.delayTime.value : this.maxDelay;\r\n\t\t} else if (index === PARAM_ECHO_DECAY) {\r\n\t\t\treturn this.decay.gain.value;\r\n\t\t} else if (index === PARAM_ECHO_VOLUME) {\r\n\t\t\treturn this.mix.gain.value;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @param {number} index\r\n\t * @param {number} value\r\n\t */\r\n\tcheckParam(index, value) {\r\n\t\tif (index === PARAM_ECHO_DELAY) {\r\n\t\t\tif (value < 0.001) {\r\n\t\t\t\treturn \"decay not be less than 1ms\";\r\n\t\t\t}\r\n\t\t} else if (index === PARAM_ECHO_DECAY) {\r\n\t\t\tif (value < 0) {\r\n\t\t\t\treturn \"decay must not be negative\";\r\n\t\t\t}\r\n\t\t\tif (value >= 1) {\r\n\t\t\t\treturn \"decay must less than 1\";\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * @param {number} index\r\n\t * @param {number} value\r\n\t * @param {number} [fade]\r\n\t */\r\n\tsetParam(index, value, fade) {\r\n\t\tif (index === PARAM_ECHO_VOLUME) {\r\n\t\t\teffectSetAudioParam(this.mix.gain, value, fade);\r\n\t\t} else if (index === PARAM_ECHO_DELAY) {\r\n\t\t\tif (this.maxDelay < 0) {\r\n\t\t\t\tthis.maxDelay = value;\r\n\t\t\t}\r\n\t\t\tif (this.delay) {\r\n\t\t\t\teffectSetAudioParam(this.delay.delayTime, value, fade);\r\n\t\t\t}\r\n\t\t} else if (index === PARAM_ECHO_DECAY) {\r\n\t\t\teffectSetAudioParam(this.decay.gain, value, fade);\r\n\t\t}\r\n\t}\r\n\r\n\tfree() {\r\n\t\tthis.delay.disconnect();\r\n\t\tthis.decay.disconnect();\r\n\t\tthis.delay = null;\r\n\t\tthis.decay = null;\r\n\t}\r\n\r\n\tget type() { return EFFECT_TYPE_ECHO }\r\n\tget input() { return this.node }\r\n\tget outputs() { return [ this.node, this.mix ] }\r\n}\r\n\r\nclass ReverbEffect {\r\n\tconstructor() {\r\n\t\tthis.gain = new GainNode(audioctx);\r\n\t\tthis.wetGain = new GainNode(audioctx, { gain: 1 });\r\n\t}\r\n\r\n\tcreate() {\r\n\t\tthis.convolver = new ConvolverNode(audioctx, {\r\n\t\t\tbuffer: implulseChurch,\r\n\t\t\tdisableNormalization: true,\r\n\t\t});\r\n\r\n\t\tthis.convolver.connect(this.wetGain);\r\n\t}\r\n\r\n\tsetupGraph() {\r\n\t\tthis.gain.connect(this.convolver);\r\n\t}\r\n\r\n\t/**\r\n\t * @param {number} index\r\n\t * @returns {number}\r\n\t */\r\n\tgetParam(index) {\r\n\t\tif (index == PARAM_REVERB_VOLUME) {\r\n\t\t\treturn this.wetGain.gain.value;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @param {number} index\r\n\t * @param {number} value\r\n\t */\r\n\tcheckParam(index, value) {\r\n\t}\r\n\t\r\n\t/**\r\n\t * @param {number} index\r\n\t * @param {number} value\r\n\t * @param {number} [fade]\r\n\t */\r\n\tsetParam(index, value, fade) {\r\n\t\tif (index === PARAM_REVERB_VOLUME) {\r\n\t\t\teffectSetAudioParam(this.wetGain.gain, value, fade);\r\n\t\t}\r\n\t}\r\n\r\n\tget type() { return EFFECT_TYPE_REVERB }\r\n\tget input() { return this.gain }\r\n\tget outputs() { return [ this.gain, this.wetGain ] }\r\n}\r\n\r\n// === VOICE ===\r\n\r\nclass Voice extends AudioControls {\r\n\t/**\r\n\t * @param {number} ptr\r\n\t * @param {Audio} audio\r\n\t * @param {number} audioHandle\r\n\t * @param {AudioControls} [destination]\r\n\t */\r\n\tconstructor(ptr, audio, audioHandle, destination) {\r\n\t\tsuper(destination);\r\n\r\n\t\tthis.ptr = ptr;\r\n\t\tthis.audio = audio;\r\n\t\tthis.audioHandle = audioHandle;\r\n\r\n\t\tthis._initSource();\r\n\r\n\t\t/**\r\n\t\t * 0: not yet started  \r\n\t\t * 1: playing  \r\n\t\t * 2: paused  \r\n\t\t * 3: stopped  \r\n\t\t */\r\n\t\tthis.state = 0;\r\n\t\tthis.time = 0;\r\n\t}\r\n\r\n\t/**\r\n\t * @private\r\n\t */\r\n\t_initSource() {\r\n\t\tthis.source = audioctx.createBufferSource();\r\n\t\tthis.source.buffer = this.audio.buffer;\r\n\t\tthis.source.onended = () => {\r\n\t\t\tthis.state = 3;\r\n\t\t\tthis.time = this.audio.buffer.duration;\r\n\t\t};\r\n\t}\r\n\t\r\n\tplay() {\r\n\t\tif (this.state === 0 || this.state === 2) {\r\n\t\t\tif (this.state === 2) {\r\n\t\t\t\tlet old = this.source;\r\n\r\n\t\t\t\tthis._initSource();\r\n\r\n\t\t\t\tthis.source.loop = old.loop;\r\n\t\t\t\tthis.source.loopStart = old.loopStart;\r\n\t\t\t\tthis.source.playbackRate.value = old.playbackRate.value;\r\n\t\t\t}\r\n\r\n\t\t\tthis.source.connect(this.getInput());\r\n\t\t\tthis.source.start(0, this.time);\r\n\t\t\tthis.startTime = audioctx.currentTime;\r\n\t\t\tthis.state = 1;\r\n\t\t}\r\n\t}\r\n\r\n\tsaveTime() {\r\n\t\tthis.time += (audioctx.currentTime - this.startTime) * this.source.playbackRate.value;\r\n\t\tthis.startTime = audioctx.currentTime;\r\n\t}\r\n\r\n\tpause() {\r\n\t\tif (this.state === 1) {\r\n\t\t\tthis.saveTime();\r\n\t\t\tthis.stopSource();\r\n\t\t\tthis.state = 2;\r\n\t\t}\r\n\t}\r\n \r\n\tstopSource() { \r\n\t\tthis.source.onended = null;\r\n\t\tthis.source.stop();\r\n\t\tthis.source.disconnect();\r\n\t}\r\n\r\n\tupdateGraph() {\r\n\t\tsuper.updateGraph();\r\n\r\n\t\tif (this.source) {\r\n\t\t\tthis.source.disconnect();\r\n\t\t\tthis.source.connect(this.getInput());\r\n\t\t}\r\n\t}\r\n}\r\n\r\n/**\r\n * @type {Map<number, AudioBus>}\r\n */\r\nlet buses = new Map();\r\n\r\n/**\r\n * @type {Map<number, Audio>}\r\n */\r\nlet audios = new Map();\r\n\r\n/**\r\n * @type {Map<number, Voice>}\r\n */\r\nlet voices = new Map();\r\n\r\n/**\r\n * Gets the current Audio in slot 0.\r\n * @returns {AudioBus}\r\n */\r\nfunction getAudioBus() {\r\n\treturn buses.get(wrenGetSlotForeign(0));\r\n}\r\n\r\n/**\r\n * Gets the current Audio in slot 0.\r\n * @returns {Audio}\r\n */\r\nfunction getAudio() {\r\n\treturn audios.get(wrenGetSlotForeign(0));\r\n}\r\n\r\n/**\r\n * Gets the current Voice in slot 0.\r\n * @returns {Voice}\r\n */\r\nfunction getVoice() {\r\n\treturn voices.get(wrenGetSlotForeign(0));\r\n}\r\n\r\nlet canDecodeOGG = true;\r\n\r\n/**\r\n * @param {string} url\r\n * @param {(progress: number) => void} [onprogress]\r\n * @returns {Promise<AudioBuffer>}\r\n */\r\nasync function loadAudioBuffer(url, onprogress) {\r\n\tlet buffer = await httpGET(url, \"arraybuffer\", onprogress);\r\n\r\n\tlet ext = Path.getExtension(url);\r\n\tlet isOGG = ext === \"ogg\";\r\n\r\n\ttry {\r\n\t\tif (isOGG && !canDecodeOGG) {\r\n\t\t\treturn await decodeOGG(buffer);\r\n\t\t} else {\r\n\t\t\tif (offlineContext == null) {\r\n\t\t\t\tofflineContext = new OfflineAudioContext(1, 1, 44100);\r\n\t\t\t}\r\n\t\t\r\n\t\t\ttry {\r\n\t\t\t\treturn await offlineContext.decodeAudioData(buffer);\r\n\t\t\t} catch (error) {\r\n\t\t\t\t// Handle OGG failure.\r\n\t\t\t\tif (isOGG) {\r\n\t\t\t\t\tconsole.info(`Failed to natively decode ${url}, switching to JavaScript OGG decoder`, error);\r\n\t\t\t\t\tcanDecodeOGG = false;\r\n\t\t\t\t\treturn await decodeOGG(buffer);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthrow error;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t} catch (error) {\r\n\t\tconsole.error(error);\r\n\t\tthrow Error(`failed to decode audio ${url}`);\r\n\t}\r\n}\r\n\r\n/** @type {Promise<STBVorbis>} */\r\nlet stbvorbisPromise;\r\n\r\n/**\r\n * Decode an OGG using stbvorbis.\r\n * (Only needed on Safari.)\r\n * @param {ArrayBuffer} buffer\r\n * @returns {Promise<AudioBuffer>}\r\n */\r\nasync function decodeOGG(buffer) {\r\n\tif (stbvorbisPromise == null) {\r\n\t\tstbvorbisPromise = new Promise((resolve) => {\r\n\t\t\tlet callback = () => {\r\n\t\t\t\tremoveEventListener(\"stbvorbis\", callback);\r\n\t\t\t\tresolve(self[\"stbvorbis\"]);\r\n\t\t\t}\r\n\t\t\taddEventListener(\"stbvorbis\", callback);\r\n\t\t});\r\n\r\n\t\tlet script = document.createElement(\"script\");\r\n\t\tscript.src = \"stbvorbis.js\";\r\n\t\tdocument.head.append(script);\r\n\t}\r\n\r\n\tlet stbvorbis = await stbvorbisPromise;\r\n\r\n\treturn new Promise((resolve, reject) => {\r\n\t\t/** @type {Float32Array[][]} */\r\n\t\tlet data = [];\r\n\t\tlet sampleRate;\r\n\r\n\t\tstbvorbis.decode(buffer, (result) => {\r\n\t\t\tif (result.error) {\r\n\t\t\t\treject(result.error);\r\n\t\t\t} else if (result.eof) {\r\n\t\t\t\tlet totalLength = data.reduce((acc, chunk) => acc + chunk[0].length, 0);\r\n\t\t\t\tlet channelCount = data[0].length;\r\n\r\n\t\t\t\tlet audio = new AudioBuffer({\r\n\t\t\t\t\tsampleRate: sampleRate,\r\n\t\t\t\t\tnumberOfChannels: channelCount,\r\n\t\t\t\t\tlength: totalLength,\r\n\t\t\t\t});\r\n\t\t\t\t\r\n\t\t\t\tlet writeOffset = 0;\r\n\t\t\t\tfor (let chunk of data) {\r\n\t\t\t\t\tfor (let channelIndex = 0; channelIndex < channelCount; channelIndex++) {\r\n\t\t\t\t\t\taudio.copyToChannel(chunk[channelIndex], channelIndex, writeOffset);\r\n\t\t\t\t\t\twriteOffset += chunk[channelIndex].length;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tresolve(audio);\r\n\t\t\t} else {\r\n\t\t\t\tdata.push(result.data);\r\n\t\t\t\tsampleRate = result.sampleRate;\r\n\t\t\t}\r\n\t\t});\r\n\t});\r\n}\r\n\r\n/**\r\n * @param {AudioControls} audio\r\n */\r\nfunction wrenAudioSetEffect(audio) {\r\n\tfor (let i = 1; i <= 6; i++) {\r\n\t\tif (wrenGetSlotType(i) !== 1) {\r\n\t\t\twrenAbort(\"args must be Nums\");\r\n\t\t\treturn;\r\n\t\t}\r\n\t}\r\n\r\n\tlet index = wrenGetSlotDouble(1);\r\n\tlet type = wrenGetSlotDouble(2);\r\n\r\n\t/** @type {number[]} */\r\n\tlet params = Array(4);\r\n\tparams[0] = wrenGetSlotDouble(3);\r\n\tparams[1] = wrenGetSlotDouble(4);\r\n\tparams[2] = wrenGetSlotDouble(5);\r\n\tparams[3] = wrenGetSlotDouble(6);\r\n\r\n\t// Validate type/index indices.\r\n\tif (index < 0 || index >= MAX_EFFECT_PER_AUDIO) {\r\n\t\twrenAbort(\"invalid effect index\");\r\n\t\treturn;\r\n\t}\r\n\t\r\n\tif (type < EFFECT_TYPE_MIN || type > EFFECT_TYPE_MAX) {\r\n\t\twrenAbort(\"invalid effect type\");\r\n\t\treturn;\r\n\t}\r\n\r\n\t/** @type {Effect} */\r\n\tlet effect;\r\n\tif (type === EFFECT_TYPE_FILTER) {\r\n\t\teffect = new FilterEffect();\r\n\t} else if (type === EFFECT_TYPE_ECHO) {\r\n\t\teffect = new EchoEffect();\r\n\t} else if (type === EFFECT_TYPE_REVERB) {\r\n\t\teffect = new ReverbEffect();\r\n\t} else {\r\n\t\teffect = null;\r\n\t}\r\n\r\n\tif (effect) {\r\n\t\tif (effect.checkParam) {\r\n\t\t\tfor (let i = 0; i < 4; i++) {\r\n\t\t\t\tlet error = effect.checkParam(i, params[i]);\r\n\t\t\t\tif (error) {\r\n\t\t\t\t\tif (effect.free) {\r\n\t\t\t\t\t\teffect.free();\r\n\t\t\t\t\t}\r\n\t\t\t\t\twrenAbort(error);\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tfor (let i = 0; i < 4; i++) {\r\n\t\t\teffect.setParam(i, params[i]);\r\n\t\t}\r\n\t}\r\n\r\n\tif (effect.create) {\r\n\t\teffect.create();\r\n\t}\r\n\r\n\tlet oldEffect = audio.effects[index];\r\n\tif (oldEffect) {\r\n\t\tfor (let output of oldEffect.outputs) {\r\n\t\t\toutput.disconnect();\r\n\t\t}\r\n\t\tif (oldEffect.free) {\r\n\t\t\toldEffect.free();\r\n\t\t}\r\n\t}\r\n\r\n\taudio.effects[index] = effect;\r\n\r\n\taudio.updateGraph();\r\n}\r\n\r\n/**\r\n * @param {AudioControls} audio\r\n */\r\nfunction wrenAudioGetEffect(audio) {\r\n\tif (wrenGetSlotType(1) !== 1) {\r\n\t\twrenAbort(\"index must be a Num\");\r\n\t\treturn;\r\n\t}\r\n\t\r\n\tlet index = Math.trunc(wrenGetSlotDouble(1));\r\n\tif (index < 0 || index >= MAX_EFFECT_PER_AUDIO) {\r\n\t\twrenAbort(\"invalid effect index\");\r\n\t\treturn;\r\n\t}\r\n\r\n\twrenSetSlotDouble(0, audio.getEffectType(index));\r\n}\r\n\r\n/**\r\n * @param {AudioControls} audio\r\n */\r\nfunction wrenAudioGetParam(audio) {\r\n\tfor (let i = 1; i <= 3; i++) {\r\n\t\tif (wrenGetSlotType(i) !== 1) {\r\n\t\t\twrenAbort(\"args must be Nums\");\r\n\t\t\treturn;\r\n\t\t}\r\n\t}\r\n\r\n\tlet index = Math.trunc(wrenGetSlotDouble(1));\r\n\tlet type = Math.trunc(wrenGetSlotDouble(2));\r\n\tlet paramIndex = Math.trunc(wrenGetSlotDouble(3));\r\n\r\n\tif (index < 0 || index >= MAX_EFFECT_PER_AUDIO) {\r\n\t\twrenAbort(\"invalid effect index\");\r\n\t\treturn;\r\n\t}\r\n\r\n\tif (type < EFFECT_TYPE_MIN || type > EFFECT_TYPE_MAX) {\r\n\t\twrenAbort(\"invalid effect type\");\r\n\t\treturn;\r\n\t}\r\n\r\n\tif (audio.getEffectType(index) != type) {\r\n\t\twrenAbort(`effect at ${index} is not a ${EFFECT_TYPE_NAMES[type]}`);\r\n\t\treturn;\r\n\t}\r\n\r\n\tif (paramIndex < 0 || paramIndex >= 4) {\r\n\t\twrenAbort(\"invalid param index\");\r\n\t\treturn;\r\n\t}\r\n\r\n\twrenSetSlotDouble(0, audio.effects[index].getParam(paramIndex) ?? 0);\r\n}\r\n\r\n/**\r\n * @param {AudioControls} audio\r\n */\r\nfunction wrenAudioSetParam(audio) {\r\n\tfor (let i = 1; i <= 5; i++) {\r\n\t\tif (wrenGetSlotType(i) !== 1) {\r\n\t\t\twrenAbort(\"args must be Nums\");\r\n\t\t\treturn;\r\n\t\t}\r\n\t}\r\n\r\n\tlet index = Math.trunc(wrenGetSlotDouble(1));\r\n\tlet type = Math.trunc(wrenGetSlotDouble(2));\r\n\tlet paramIndex = Math.trunc(wrenGetSlotDouble(3));\r\n\tlet paramValue = wrenGetSlotDouble(4);\r\n\tlet fadeTime = wrenGetSlotDouble(5);\r\n\r\n\t// Validate type/index indices.\r\n\tif (index < 0 || index >= MAX_EFFECT_PER_AUDIO) {\r\n\t\twrenAbort(\"invalid effect index\");\r\n\t\treturn;\r\n\t}\r\n\r\n\tif (type < EFFECT_TYPE_MIN || type > EFFECT_TYPE_MAX) {\r\n\t\twrenAbort(\"invalid effect type\");\r\n\t\treturn;\r\n\t}\r\n\r\n\tif (audio.getEffectType(index) != type) {\r\n\t\twrenAbort(`effect at ${index} is not a ${EFFECT_TYPE_NAMES[type]}`);\r\n\t\treturn;\r\n\t}\r\n\r\n\tif (paramIndex < 0 || paramIndex >= 4) {\r\n\t\twrenAbort(\"invalid param index\");\r\n\t\treturn;\r\n\t}\r\n\t\r\n\tif (fadeTime < 0) {\r\n\t\twrenAbort(\"fade time must be positive\");\r\n\t\treturn;\r\n\t}\r\n\r\n\tlet effect = audio.effects[index];\r\n\r\n\tif (effect.checkParam) {\r\n\t\tlet error = effect.checkParam(paramIndex, paramValue);\r\n\t\tif (error) {\r\n\t\t\twrenAbort(error);\r\n\t\t\treturn;\r\n\t\t}\r\n\t}\r\n\r\n\teffect.setParam(paramIndex, paramValue, fadeTime);\r\n}\r\n\r\n/**\r\n * @param {GainNode} gainNode\r\n */\r\nfunction wrenFadeVolume(gainNode) {\r\n\tfor (let i = 1; i <= 2; i++) {\r\n\t\tif (wrenGetSlotType(i) !== 1) {\r\n\t\t\twrenAbort(\"volume and fade must be Nums\");\r\n\t\t\treturn;\r\n\t\t}\r\n\t}\r\n\r\n\tlet volume = wrenGetSlotDouble(1);\r\n\tlet fade = wrenGetSlotDouble(2);\r\n\r\n\tfadeVolume(gainNode, volume, fade);\r\n}\r\n\r\n\r\naddForeignClass(\"sock\", \"AudioBus\", [\r\n\t() => {\r\n\t\tlet ptr = wrenSetSlotNewForeign(0, 0, 0);\r\n\r\n\t\tlet bus = new AudioBus(ptr);\r\n\r\n\t\tbuses.set(ptr, bus);\r\n\t},\r\n\t(ptr) => {\r\n\t\tbuses.delete(ptr);\r\n\t},\r\n], {\r\n\t\"volume\"() {\r\n\t\tlet bus = getAudioBus();\r\n\t\twrenSetSlotDouble(0, bus.gain.gain.value);\r\n\t},\r\n\t\"fadeVolume(_,_)\"() {\r\n\t\twrenFadeVolume(getAudioBus().gain);\r\n\t},\r\n\t\"setEffect_(_,_,_,_,_,_)\"() {\r\n\t\twrenAudioSetEffect(getAudioBus());\r\n\t},\r\n\t\"getEffect_(_)\"() {\r\n\t\twrenAudioGetEffect(getAudioBus());\r\n\t},\r\n\t\"getParam_(_,_,_)\"() {\r\n\t\twrenAudioGetParam(getAudioBus());\r\n\t},\r\n\t\"setParam_(_,_,_,_,_)\"() {\r\n\t\twrenAudioSetParam(getAudioBus());\r\n\t},\r\n});\r\n\r\naddForeignClass(\"sock\", \"Audio\", [\r\n\t() => {\r\n\t\tlet ptr = wrenSetSlotNewForeign(0, 0, 0);\r\n\r\n\t\tlet audio = new Audio(ptr);\r\n\r\n\t\taudios.set(ptr, audio);\r\n\t},\r\n\t(ptr) => {\r\n\t\taudios.delete(ptr);\r\n\t},\r\n], {\r\n\t\"duration\"() {\r\n\t\tlet audio = getAudio();\r\n\t\twrenSetSlotDouble(0, audio.buffer ? audio.buffer.duration : 0);\r\n\t},\r\n\t\"voice()\"() {\r\n\t\tlet audioHandle = wrenGetSlotHandle(0);\r\n\r\n\t\tlet audio = getAudio();\r\n\t\tif (!audio.buffer) {\r\n\t\t\twrenAbort(\"audio not loaded\");\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\twrenEnsureSlots(2);\r\n\t\twrenSetSlotHandle(1, handle_Voice);\r\n\t\tlet ptr = wrenSetSlotNewForeign(0, 1, 0);\r\n\r\n\t\tlet voice = new Voice(ptr, audio, audioHandle);\r\n\t\tvoices.set(ptr, voice);\r\n\t},\r\n\t\"voice(_)\"() {\r\n\t\tlet audioHandle = wrenGetSlotHandle(0);\r\n\r\n\t\tlet audio = getAudio();\r\n\t\tif (!audio.buffer) {\r\n\t\t\twrenAbort(\"audio not loaded\");\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t// Check slot 1 is an AudioBus.\r\n\t\twrenSetSlotHandle(0, handle_AudioBus);\r\n\t\tif (!wrenGetSlotIsInstanceOf(1, 0)) {\r\n\t\t\twrenAbort(\"bus must be an AudioBus\");\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tlet bus = buses.get(wrenGetSlotForeign(1));\r\n\r\n\t\twrenSetSlotHandle(1, handle_Voice);\r\n\t\tlet ptr = wrenSetSlotNewForeign(0, 1, 0);\r\n\r\n\t\tlet voice = new Voice(ptr, audio, audioHandle, bus);\r\n\t\tvoices.set(ptr, voice);\r\n\t},\r\n}, {\r\n\t\"load_(_,_)\"() {\r\n\t\tloadAsset(async (url) => {\r\n\t\t\tlet buffer = await loadAudioBuffer(url);\r\n\r\n\t\t\twrenEnsureSlots(1);\r\n\t\t\twrenSetSlotHandle(0, handle_Audio);\r\n\t\t\tlet ptr = wrenSetSlotNewForeign(0, 0, 0);\r\n\r\n\t\t\tlet audio = new Audio(ptr);\r\n\t\t\taudios.set(ptr, audio);\r\n\r\n\t\t\taudio.setBuffer(buffer);\r\n\r\n\t\t\treturn new WrenHandle(wrenGetSlotHandle(0));\r\n\t\t});\r\n\t},\r\n\t\"volume\"() {\r\n\t\twrenSetSlotDouble(0, masterGain.gain.value / BASE_MASTER_GAIN);\r\n\t},\r\n\t\"fadeVolume(_,_)\"() {\r\n\t\tfor (let i = 1; i <= 2; i++) {\r\n\t\t\tif (wrenGetSlotType(i) !== 1) {\r\n\t\t\t\twrenAbort(\"args must be Nums\");\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tlet volume = wrenGetSlotDouble(1) * BASE_MASTER_GAIN;\r\n\t\tlet fade = wrenGetSlotDouble(2);\r\n\r\n\t\tfadeVolume(masterGain, volume, fade);\r\n\t},\r\n});\r\n\r\naddForeignClass(\"sock\", \"Voice\", [\r\n\t() => {\r\n\t\t// abortFiber(\"voice should not be constructed directly\");\r\n\t},\r\n\t(ptr) => {\r\n\t\tlet voice = voices.get(ptr);\r\n\t\twrenReleaseHandle(voice.audioHandle);\r\n\t\tvoices.delete(ptr);\r\n\t},\r\n], {\r\n\t\"play()\"() {\r\n\t\tlet voice = getVoice();\r\n\t\t\r\n\t\tvoice.play();\r\n\t},\r\n\t\"pause()\"() {\r\n\t\tlet voice = getVoice();\r\n\r\n\t\tvoice.pause();\r\n\t},\r\n\t\"isPaused\"() {\r\n\t\tlet voice = getVoice();\r\n\t\twrenSetSlotBool(0, voice.state !== 1);\r\n\t},\r\n\t\"stop()\"() {\r\n\t\tlet voice = getVoice();\r\n\t\tvoice.stopSource();\r\n\t\tvoice.state = 3;\r\n\t},\r\n\t\"time\"() {\r\n\t\tlet voice = getVoice();\r\n\t\tif (voice.state === 1) {\r\n\t\t\tvoice.saveTime();\r\n\t\t}\r\n\t\twrenSetSlotDouble(0, voice.time);\r\n\t},\r\n\t\"time=(_)\"() {\r\n\t\tif (wrenGetSlotType(1) !== 1) {\r\n\t\t\twrenAbort(\"time must be Num\");\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tlet time = wrenGetSlotDouble(1);\r\n\r\n\t\tlet voice = getVoice();\r\n\t\tvoice.pause();\r\n\t\tvoice.time = time;\r\n\t\tvoice.play();\r\n\t},\r\n\t\"volume\"() {\r\n\t\tlet voice = getVoice();\r\n\t\twrenSetSlotDouble(0, voice.gain.gain.value);\r\n\t},\r\n\t\"fadeVolume(_,_)\"() {\r\n\t\twrenFadeVolume(getVoice().gain);\r\n\t},\r\n\t\"rate\"() {\r\n\t\tlet voice = getVoice();\r\n\t\twrenSetSlotDouble(0, voice.source.playbackRate.value);\r\n\t},\r\n\t\"fadeRate(_,_)\"() {\r\n\t\tfor (let i = 1; i <= 2; i++) {\r\n\t\t\tif (wrenGetSlotType(i) !== 1) {\r\n\t\t\t\twrenAbort(\"args must be Nums\");\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tlet rate = wrenGetSlotDouble(1);\r\n\t\tlet fade = wrenGetSlotDouble(2);\r\n\r\n\t\tlet voice = getVoice();\r\n\r\n\t\teffectSetAudioParam(voice.source.playbackRate, rate, fade);\r\n\t},\r\n\t\"loop\"() {\r\n\t\tlet voice = getVoice();\r\n\t\twrenSetSlotBool(0, voice.source.loop);\r\n\t},\r\n\t\"loop=(_)\"() {\r\n\t\tif (wrenGetSlotType(1) !== 0) {\r\n\t\t\twrenAbort(\"loop must be a Bool\");\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tlet voice = getVoice();\r\n\t\tlet loop = wrenGetSlotBool(1);\r\n\r\n\t\tvoice.source.loop = loop;\r\n\t\t\r\n\t\t// Ensure we have a loop end point set (needed for loop start).\r\n\t\tif (loop) {\r\n\t\t\tvoice.source.loopEnd = voice.audio.buffer.duration;\r\n\t\t}\r\n\t},\r\n\t\"loopStart\"() {\r\n\t\tlet voice = getVoice();\r\n\t\twrenSetSlotDouble(0, voice.source.loopStart);\r\n\t},\r\n\t\"loopStart=(_)\"() {\r\n\t\tif (wrenGetSlotType(1) !== 1) {\r\n\t\t\twrenAbort(\"loopStart must be a Num\");\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tlet voice = getVoice();\r\n\t\tlet loopStart = wrenGetSlotDouble(1);\r\n\r\n\t\tvoice.source.loopStart = loopStart;\r\n\t},\r\n\t\"setEffect_(_,_,_,_,_,_)\"() {\r\n\t\twrenAudioSetEffect(getVoice());\r\n\t},\r\n\t\"getEffect_(_)\"() {\r\n\t\twrenAudioGetEffect(getVoice());\r\n\t},\r\n\t\"getParam_(_,_,_)\"() {\r\n\t\twrenAudioGetParam(getVoice());\r\n\t},\r\n\t\"setParam_(_,_,_,_,_)\"() {\r\n\t\twrenAudioSetParam(getVoice());\r\n\t},\r\n});\r\n\r\n/**\r\n * @typedef {object} Effect\r\n * @property {number} type\r\n * @property {AudioNode} input\r\n * @property {AudioNode[]} outputs if null, then \r\n * @property {() => void} [create]\r\n * @property {() => void} [setupGraph]\r\n * @property {(index: number) => number} getParam\r\n * @property {(index: number, value: number, fade?: number) => void} setParam\r\n * @property {(index: number, value: number) => (string|null|undefined|void)} [checkParam]\r\n * @property {() => void} [free]\r\n */\r\n\r\n/**\r\n * @typedef {object} STBVorbis\r\n * @property {(buffer: ArrayBuffer|Uint8Array, callback: (event: { data: Float32Array[], sampleRate: number, eof: boolean, error: string | null }) => void) => void} decode\r\n */\r\n","import { addClassForeignStaticMethods } from \"../foreign.js\";\r\nimport { httpGET } from \"../network/http.js\";\r\nimport { Module, wrenGetSlotHandle } from \"../vm.js\";\r\nimport { loadAsset } from \"./asset.js\";\r\nimport { WrenHandle } from \"./promise.js\";\r\n\r\naddClassForeignStaticMethods(\"sock\", \"Buffer\", {\r\n\t\"load_(_,_)\"() {\r\n\t\tloadAsset(async (url) => {\r\n\t\t\tlet buffer = await httpGET(url, \"arraybuffer\");\r\n\r\n\t\t\t// Copy ArrayBuffer to C.\r\n\t\t\tlet len = buffer.byteLength;\r\n\r\n\t\t\tlet ptr = 0;\r\n\t\t\tif (len > 0) {\r\n\t\t\t\tptr = Module._malloc(len);\r\n\t\t\t\tif (!ptr) throw `could not allocate ${len} bytes`;\r\n\r\n\t\t\t\tModule.HEAPU8.set(new Uint8Array(buffer), ptr);\r\n\t\t\t}\r\n\t\r\n\t\t\t// Load bytes in C memory into new Buffer.\r\n\t\t\tModule.ccall(\"sock_new_buffer\", null, [ \"number\", \"number\" ], [ ptr, len ]);\r\n\r\n\t\t\treturn new WrenHandle(wrenGetSlotHandle(0));\r\n\t\t});\r\n\t}\r\n});\r\n","import { addClassForeignStaticMethods } from \"../foreign.js\";\r\nimport { wrenAbort, wrenEnsureSlots, wrenGetSlotString, wrenGetSlotType, wrenInsertInList, wrenSetSlotBool, wrenSetSlotNewList, wrenSetSlotNull, wrenSetSlotString } from \"../vm.js\";\r\n\r\n/**\r\n * @type {string}\r\n */\r\nlet storageID = null;\r\n\r\n/**\r\n * @param {number} slot\r\n */\r\nfunction validateKey(slot) {\r\n\tif (storageID == null) {\r\n\t\twrenAbort(\"id must be set before using other Storage methods\");\r\n\t\treturn null;\r\n\t}\r\n\r\n\tif (wrenGetSlotType(slot) !== 6) {\r\n\t\twrenAbort(\"key must be a string\");\r\n\t\treturn null;\r\n\t}\r\n\r\n\tlet key = wrenGetSlotString(slot);\r\n\tif (!validateKeyIdentifier(key)) {\r\n\t\twrenAbort(\"key may only contain letters, numbers, underscores and dashes\");\r\n\t\treturn;\r\n\t}\r\n\r\n\treturn storageID + \"/\" + key;\r\n}\r\n\r\n/**\r\n * @param {string} s\r\n */\r\nfunction validateKeyIdentifier(s) {\r\n\treturn /^[a-zA-Z0-9_\\-]+$/.test(s);\r\n}\r\n\r\n\r\naddClassForeignStaticMethods(\"sock\", \"Storage\", {\r\n\t\"id\"() {\r\n\t\tif (storageID) {\r\n\t\t\twrenSetSlotString(0, storageID);\r\n\t\t} else {\r\n\t\t\twrenSetSlotNull(0);\r\n\t\t}\r\n\t},\r\n\t\"id=(_)\"() {\r\n\t\tif (wrenGetSlotType(1) !== 6) {\r\n\t\t\twrenAbort(\"id must be a String\");\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tlet s = wrenGetSlotString(1);\r\n\r\n\t\tif (validateKeyIdentifier(s)) {\r\n\t\t\tstorageID = s;\r\n\t\t} else {\r\n\t\t\twrenAbort(\"id may only contain letters, numbers, underscores and dashes\");\r\n\t\t}\r\n\t},\r\n\t\"contains(_)\"() {\r\n\t\tlet key = validateKey(1);\r\n\t\tif (key) {\r\n\t\t\twrenSetSlotBool(0, localStorage.getItem(key) !== null);\r\n\t\t}\r\n\t},\r\n\t\"load_(_)\"() {\r\n\t\tlet key = validateKey(1);\r\n\t\tif (key) {\r\n\t\t\tlet item = localStorage.getItem(key);\r\n\t\r\n\t\t\tif (item == null) {\r\n\t\t\t\twrenSetSlotNull(0);\r\n\t\t\t} else {\r\n\t\t\t\twrenSetSlotString(0, item);\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\t\"save_(_,_)\"() {\r\n\t\tif (wrenGetSlotType(2) !== 6) {\r\n\t\t\twrenAbort(\"value must be a String\");\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t\r\n\t\tlet key = validateKey(1);\r\n\t\tif (key) {\r\n\t\t\tlet value = wrenGetSlotString(2);\r\n\t\r\n\t\t\tlocalStorage.setItem(key, value);\r\n\t\t}\r\n\t},\r\n\t\"delete(_)\"() {\r\n\t\tlet key = validateKey(1);\r\n\t\tif (key) {\r\n\t\t\tlocalStorage.removeItem(key);\r\n\t\t\twrenSetSlotNull(0);\r\n\t\t}\r\n\t},\r\n// \t\"keys\"() {\r\n// \t\twrenEnsureSlots(2);\r\n// \t\twrenSetSlotNewList(0);\r\n// \r\n// \t\tfor (let i = 0; i < localStorage.length; i++) {\r\n// \t\t\tlet key = localStorage.key(i);\r\n// \t\t\tif (key.startsWith(keyPrefix)) {\r\n// \t\t\t\twrenSetSlotString(1, key.slice(keyPrefix.length));\r\n// \t\t\t\twrenInsertInList(0, -1, 1);\r\n// \t\t\t}\r\n// \t\t}\r\n// \t}\r\n});\r\n","\r\n/**\r\n * @param {K} tag \r\n * @param {Record<string, any>} [attributes] \r\n * @param {any} [nodes]\r\n * @returns {HTMLElementTagNameMap[K]}\r\n * @template {keyof HTMLElementTagNameMap} K\r\n */\r\nexport function createElement(tag, attributes, nodes) {\r\n\tlet element = document.createElement(tag);\r\n\r\n\tif (attributes) {\r\n\t\tfor (let name in attributes) {\r\n\t\t\tlet value = attributes[name];\r\n\t\r\n\t\t\tif (name.startsWith(\"on\")) {\r\n\t\t\t\telement[name] = value;\r\n\t\t\t} else {\r\n\t\t\t\tif (value === true) {\r\n\t\t\t\t\telement.setAttribute(name, \"\");\r\n\t\t\t\t} else if (value == null || value === false) {\r\n\t\t\t\t\t// Ignore.\r\n\t\t\t\t} else {\r\n\t\t\t\t\telement.setAttribute(name, value);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tif (nodes) {\r\n\t\tif (Array.isArray(nodes)) {\r\n\t\t\tfor (let node of nodes) {\r\n\t\t\t\telement.append(node);\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\telement.append(nodes);\r\n\t\t}\r\n\t}\r\n\r\n\treturn element;\r\n}\r\n","import { canvas } from \"./canvas.js\";\r\nimport { createElement } from \"./html.js\";\r\n\r\n/**\r\n * Total window/screen width.\r\n */\r\nexport let screenWidth = 0;\r\n\r\n/**\r\n * Total window/screen height.\r\n */\r\nexport let screenHeight = 0;\r\n\r\n/**\r\n * The game's internal resolution width, may be smaller than screen width.\r\n */\r\nexport let internalResolutionWidth = 0;\r\n\r\n/**\r\n * The game's internal resolution height, may be smaller than screen height.\r\n */\r\nexport let internalResolutionHeight = 0;\r\n\r\n/**\r\n * Left offset of viewport, in logical pixels.  \r\n * May be non-zero due to fixed resolution.\r\n */\r\nexport let viewportOffsetX = 0;\r\n\r\n/**\r\n * Top offset of viewport, in logical pixels.  \r\n * May be non-zero due to fixed resolution.\r\n */\r\nexport let viewportOffsetY = 0;\r\n\r\n/**\r\n * Width of viewport in screen pixels, in logical pixels.  \r\n * May be smaller than screen size due to fixed resolution.  \r\n * May be larger than internal resolution to fixed resolution scaling.\r\n */\r\nexport let viewportWidth = 1;\r\n\r\n/**\r\n * Height of viewport in screen pixels, in logical pixels.  \r\n * May be smaller than screen size due to fixed resolution.  \r\n * May be larger than internal resolution to fixed resolution scaling.\r\n */\r\nexport let viewportHeight = 1;\r\n\r\n/**\r\n * Scale factor of viewport (0, Infinite), using logical pixels.\r\n */\r\nexport let viewportScale = 1;\r\n\r\n/**\r\n * Used by client to configure internal resolution and computed layout.\r\n */\r\nexport let layoutOptions = {\r\n\tpixelScaling: false,\r\n\t/**\r\n\t * @type {null|[number, number]}\r\n\t */\r\n\tresolution: null,\r\n\tmaxScale: Infinity,\r\n};\r\n\r\nlet layoutContainer = createElement(\"div\", { style: \"position: fixed; pointer-events: none;\" });\r\nlet layoutContainerRefCount = 0;\r\n\r\nexport function useLayoutContainer() {\r\n\tif (layoutContainerRefCount === 0) {\r\n\t\tdocument.body.append(layoutContainer);\r\n\t}\r\n\r\n\tlayoutContainerRefCount++\r\n\r\n\treturn layoutContainer;\r\n}\r\n\r\nexport function releaseLayoutContainer() {\r\n\tlayoutContainerRefCount--;\r\n\r\n\tif (layoutContainerRefCount === 0) {\r\n\t\tlayoutContainer.remove();\r\n\t}\r\n}\r\n\r\n\r\nlet isLayoutQueued = false;\r\n\r\nexport function queueLayout() {\r\n\tisLayoutQueued = true;\r\n}\r\n\r\nexport function finalizeLayout() {\r\n\tif (isLayoutQueued) {\r\n\t\tisLayoutQueued = false;\r\n\t\tredoLayout();\r\n\t\treturn true;\r\n\t}\r\n}\r\n\r\nexport function redoLayout() {\r\n\tscreenWidth = innerWidth;\r\n\tscreenHeight = innerHeight;\r\n\r\n\tlet pixeRatio = devicePixelRatio;\r\n\tcanvas.width = screenWidth * pixeRatio;\r\n\tcanvas.height = screenHeight * pixeRatio;\r\n\r\n\tcanvas.style.width = screenWidth + \"px\";\r\n\tcanvas.style.height = screenHeight + \"px\";\r\n\t\r\n\tlet resx, resy, scale;\r\n\tlet res = layoutOptions.resolution;\r\n\tif (res) {\r\n\t\tresx = res[0];\r\n\t\tresy = res[1];\r\n\r\n\t\t// Determine scale factor.\r\n\t\tlet scaleX = screenWidth / resx;\r\n\t\tlet scaleY = screenHeight / resy;\r\n\r\n\t\tscale = Math.min(scaleX, scaleY, layoutOptions.maxScale);\r\n\r\n\t\tif (layoutOptions.pixelScaling && scale > 1) {\r\n\t\t\tscale = Math.floor(scale);\r\n\t\t}\r\n\t} else {\r\n\t\tresx = screenWidth;\r\n\t\tresy = screenHeight;\r\n\t\tscale = 1;\r\n\t}\r\n\r\n\tinternalResolutionWidth = resx;\r\n\tinternalResolutionHeight = resy;\r\n\tviewportScale = scale;\r\n\t\r\n\tviewportWidth = Math.floor(scale * resx);\r\n\tviewportHeight = Math.floor(scale * resy);\r\n\tviewportOffsetX = Math.floor((screenWidth - viewportWidth) / 2);\r\n\tviewportOffsetY = Math.floor((screenHeight - viewportHeight) / 2);\r\n\r\n\tlet style = layoutContainer.style;\r\n\tstyle.left = viewportOffsetX + \"px\"\r\n\tstyle.top = viewportOffsetY + \"px\";\r\n\tstyle.width = viewportWidth + \"px\";\r\n\tstyle.height = viewportHeight + \"px\";\r\n}\r\n\r\naddEventListener(\"resize\", () => {\r\n\tqueueLayout();\r\n});\r\n","import { addClassForeignStaticMethods, addForeignMethod } from \"../foreign.js\";\r\nimport { internalResolutionHeight, internalResolutionWidth } from \"../layout.js\";\r\nimport { HEAP, wrenAbort, wrenGetSlotDouble, wrenGetSlotType, wren_sock_get_transform } from \"../vm.js\";\r\n\r\n/**\r\n * @type {Float32Array|null}\r\n */\r\nlet cameraMatrix = null;\r\n\r\n/**\r\n * Returns the 3x3 camera matrix.\r\n */\r\nexport function getCameraMatrix() {\r\n\tif (!cameraMatrix) {\r\n\t\tsetCameraOrigin(0, 0);\r\n\t}\r\n\treturn cameraMatrix;\r\n}\r\n\r\n/**\r\n * @returns {Float32Array}\r\n */\r\nexport function saveCameraMatrix() {\r\n\treturn getCameraMatrix().slice();\r\n}\r\n\r\n/**\r\n * @param {Float32Array} camera \r\n */\r\nexport function loadCameraMatrix(camera) {\r\n\tgetCameraMatrix().set(camera);\r\n}\r\n\r\n/**\r\n * @param {number} x\r\n * @param {number} y\r\n * @param {Float32Array|null} [tf] a 3x2 transform, will not be modified\r\n */\r\nexport function setCameraOrigin(x, y, tf) {\r\n\tif (!cameraMatrix) {\r\n\t\tcameraMatrix = new Float32Array(9);\r\n\t}\r\n\r\n\tlet sx =  2 / internalResolutionWidth;\r\n\tlet sy = -2 / internalResolutionHeight;\r\n\r\n\tif (tf) {\r\n\t\tcameraMatrix[0] = sx * tf[0];\r\n\t\tcameraMatrix[1] = sy * tf[1];\r\n\t\tcameraMatrix[2] = 0;\r\n\t\t\r\n\t\tcameraMatrix[3] = sx * tf[2];\r\n\t\tcameraMatrix[4] = sy * tf[3];\r\n\t\tcameraMatrix[5] = 0;\r\n\t\r\n\t\tcameraMatrix[6] = x * sx - 1 + sx * tf[4];\r\n\t\tcameraMatrix[7] = y * sy + 1 + sy * tf[5];\r\n\t\tcameraMatrix[8] = 1;\r\n\t} else {\r\n\t\tcameraMatrix[0] = sx;\r\n\t\tcameraMatrix[1] = 0;\r\n\t\tcameraMatrix[2] = 0;\r\n\t\t\r\n\t\tcameraMatrix[3] = 0;\r\n\t\tcameraMatrix[4] = sy;\r\n\t\tcameraMatrix[5] = 0;\r\n\t\r\n\t\tcameraMatrix[6] = x * sx - 1;\r\n\t\tcameraMatrix[7] = y * sy + 1;\r\n\t\tcameraMatrix[8] = 1;\r\n\t}\r\n}\r\n\r\n\r\n/**\r\n * @param {number} x\r\n * @param {number} y\r\n * @param {Float32Array|null} [tf] a 3x2 transform, will not be modified\r\n */\r\nexport function cameraLookAt(x, y, tf) {\r\n\tif (!cameraMatrix) {\r\n\t\tcameraMatrix = new Float32Array(9);\r\n\t}\r\n\r\n\tlet sx =  2 / internalResolutionWidth;\r\n\tlet sy = -2 / internalResolutionHeight;\r\n\r\n\t// If dimensions are not even, need shift origin by half a pixel.\r\n\tlet dx = internalResolutionWidth  % 2 == 0 ? 0 : 0.5;\r\n\tlet dy = internalResolutionHeight % 2 == 0 ? 0 : 0.5;\r\n\r\n\tif (tf) {\r\n\t\tcameraMatrix[0] = sx * tf[0];\r\n\t\tcameraMatrix[1] = sy * tf[1];\r\n\t\tcameraMatrix[2] = 0;\r\n\t\t\r\n\t\tcameraMatrix[3] = sx * tf[2];\r\n\t\tcameraMatrix[4] = sy * tf[3];\r\n\t\tcameraMatrix[5] = 0;\r\n\r\n\t\tcameraMatrix[6] = sx * (tf[4] - tf[0] * x - tf[2] * y + dx);\r\n\t\tcameraMatrix[7] = sy * (tf[5] - tf[1] * x - tf[3] * y + dy);\r\n\t\tcameraMatrix[8] = 1;\r\n\t} else {\r\n\t\tcameraMatrix[0] = sx;\r\n\t\tcameraMatrix[1] = 0;\r\n\t\tcameraMatrix[2] = 0;\r\n\t\t\r\n\t\tcameraMatrix[3] = 0;\r\n\t\tcameraMatrix[4] = sy;\r\n\t\tcameraMatrix[5] = 0;\r\n\r\n\t\tcameraMatrix[6] = (dx - x) * sx;\r\n\t\tcameraMatrix[7] = (dy - y) * sy;\r\n\t\tcameraMatrix[8] = 1;\r\n\t}\r\n}\r\n\r\n\r\n// Wren -> JS\r\n\r\naddClassForeignStaticMethods(\"sock\", \"Camera\", {\r\n\t\"setOrigin(_,_,_)\"() {\r\n\t\twrenSetCamera(setCameraOrigin);\r\n\t},\r\n\t\"lookAt(_,_,_)\"() {\r\n\t\twrenSetCamera(cameraLookAt);\r\n\t},\r\n\t\"reset()\"() {\r\n\t\tsetCameraOrigin(0, 0);\r\n\t},\r\n// \t\"project(_,_)\"() {\r\n// \t\tfor (let i = 1; i <= 2; i++) {\r\n// \t\t\tif (wrenGetSlotType(i) !== 1) {\r\n// \t\t\t\twrenAbort(\"x/y must be Num\");\r\n// \t\t\t\treturn;\r\n// \t\t\t}\r\n// \t\t}\r\n// \t\r\n// \t\tlet x = wrenGetSlotDouble(1);\r\n// \t\tlet y = wrenGetSlotDouble(2);\r\n// \t\tlet m = getCameraMatrix();\r\n// \r\n// \t\tlet px = m[0] * x + m[3] * y + m[6];\r\n// \t\tlet py = m[1] * x + m[4] * y + m[7];\r\n// \t\t// let pw = m[2] * x + m[5] * y + m[8];\r\n// \t}\r\n});\r\n\r\n/**\r\n * @param {(x: number, y: number, t: Float32Array | null) => void} setter \r\n */\r\nfunction wrenSetCamera(setter) {\r\n\tfor (let i = 1; i <= 2; i++) {\r\n\t\tif (wrenGetSlotType(i) !== 1) {\r\n\t\t\twrenAbort(\"x/y must be Num\");\r\n\t\t\treturn;\r\n\t\t}\r\n\t}\r\n\r\n\tlet x = wrenGetSlotDouble(1);\r\n\tlet y = wrenGetSlotDouble(2);\r\n\tlet tf = null;\r\n\tif (wrenGetSlotType(3) !== 5) {\r\n\t\tlet tp = wren_sock_get_transform(3);\r\n\t\tif (!tp) return;\r\n\t\ttf = new Float32Array(HEAP(), tp, 6);\r\n\t}\r\n\r\n\tif (!tf) {\r\n\t\tx = Math.floor(x);\r\n\t\ty = Math.floor(y);\r\n\t}\r\n\r\n\tsetter(x, y, tf);\r\n}\r\n","import { canvas } from \"../canvas.js\";\r\nimport { sockJsGlobal } from \"../globals.js\";\r\n\r\n/**\r\n * The main WebGL 1.0 context.\r\n */\r\nexport let gl = canvas.getContext(\"webgl\", {\r\n\tantialias: false,\r\n});\r\n\r\ngl.enable(gl.BLEND);\r\ngl.blendFuncSeparate(gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA, gl.ONE, gl.ONE_MINUS_SRC_ALPHA);\r\n\r\nsockJsGlobal.gl = gl;\r\n","import { wrenAbort, wrenGetSlotString, wrenGetSlotType, wrenSetSlotString } from \"../vm.js\";\r\nimport { gl } from \"./gl.js\";\r\n\r\n\r\n/** @type {Record<string, number>} */\r\nexport const GL_FILTER_MAP = {\r\n\tlinear: gl.LINEAR,\r\n\tnearest: gl.NEAREST,\r\n};\r\n\r\n/** @type {Record<string, number>} */\r\nexport const GL_WRAP_MAP = {\r\n\tclamp: gl.CLAMP_TO_EDGE,\r\n\trepeat: gl.REPEAT,\r\n\tmirror: gl.MIRRORED_REPEAT,\r\n};\r\n\r\n/**\r\n * @param {number} slot\r\n * @returns {number|null}\r\n */\r\nexport function wrenGlFilterStringToNumber(slot) {\r\n\tif (wrenGetSlotType(slot) !== 6) {\r\n\t\twrenAbort(\"filter must be a String\");\r\n\t\treturn;\r\n\t}\r\n\r\n\tlet name = wrenGetSlotString(slot);\r\n\r\n\tif (GL_FILTER_MAP.hasOwnProperty(name)) {\r\n\t\treturn GL_FILTER_MAP[name];\r\n\t} else {\r\n\t\twrenAbort(`invalid filter \"${name}\"`);\r\n\t\treturn null;\r\n\t}\r\n}\r\n\r\n/**\r\n * @param {number} slot\r\n * @returns {number|null}\r\n */\r\nexport function wrenGlWrapModeStringToNumber(slot) {\r\n\tif (wrenGetSlotType(slot) !== 6) {\r\n\t\twrenAbort(\"wrap mode must be a String\");\r\n\t\treturn;\r\n\t}\r\n\r\n\tlet name = wrenGetSlotString(slot);\r\n\r\n\tif (GL_WRAP_MAP.hasOwnProperty(name)) {\r\n\t\treturn GL_WRAP_MAP[name];\r\n\t} else {\r\n\t\twrenAbort(`invalid wrap mode \"${name}\"`);\r\n\t\treturn null;\r\n\t}\r\n}\r\n\r\n/**\r\n * @param {string} s\r\n */\r\nexport function glFilterStringToNumber(s) {\r\n\tif (GL_FILTER_MAP.hasOwnProperty(s)) {\r\n\t\treturn GL_FILTER_MAP[s];\r\n\t} else {\r\n\t\tthrow Error(`Invalid scale filter \"${s}\"`);\r\n\t}\r\n}\r\n\r\n/**\r\n * @param {string} s\r\n */\r\nexport function glWrapModeStringToNumber(s) {\r\n\tif (GL_WRAP_MAP.hasOwnProperty(s)) {\r\n\t\treturn GL_WRAP_MAP[s];\r\n\t} else {\r\n\t\tthrow Error(`Invalid wrap mode \"${s}\"`);\r\n\t}\r\n}\r\n\r\n/**\r\n * @param {number} n\r\n */\r\nexport function glFilterNumberToString(n) {\r\n\tfor (let name in GL_FILTER_MAP) {\r\n\t\tif (GL_FILTER_MAP[name] === n) {\r\n\t\t\treturn name;\r\n\t\t}\r\n\t}\r\n\r\n\treturn \"???\";\r\n}\r\n\r\n/**\r\n * @param {number} n\r\n */\r\nexport function glWrapModeNumberToString(n) {\r\n\tfor (let name in GL_WRAP_MAP) {\r\n\t\tif (GL_WRAP_MAP[name] === n) {\r\n\t\t\treturn name;\r\n\t\t}\r\n\t}\r\n\r\n\treturn \"???\";\r\n}\r\n","import { sockJsGlobal } from \"../globals.js\";\r\nimport { gl } from \"./gl.js\";\r\n\r\n/**\r\n * @type {Uint16Array|null}\r\n */\r\nlet indices = null;\r\n\r\nlet populatedIndices = 0;\r\n\r\n/**\r\n * The underlying WebGL buffer for quad indices.\r\n */\r\nexport let quadIndexBuffer = gl.createBuffer();\r\n\r\n/**\r\n * Binds the quad index buffer, and also ensures it is big for the given number of indices.\r\n * @param {number} indexCount The number of indices needed. Should be a multiple of 6 (each quad used 2 triangles = 6 indices). e.g. `vertexCount * 1.5`\r\n */\r\nexport function bindQuadIndexBuffer(indexCount) {\r\n\tgl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, quadIndexBuffer);\r\n\r\n\tif (indices == null || indices.length < indexCount) {\r\n\t\tlet capacity = indices ? indices.length : 256;\r\n\r\n\t\twhile (capacity < indexCount) {\r\n\t\t\tcapacity *= 2;\r\n\t\t}\r\n\r\n\t\tlet newIndices = new Uint16Array(capacity);\r\n\t\t\r\n\t\t// Copy across old indices.\r\n\t\tif (indices != null) {\r\n\t\t\tnewIndices.set(indices);\r\n\t\t}\r\n\t\t\r\n\t\t// Set new indices.\r\n\t\tlet vi = populatedIndices / 1.5;\r\n\r\n\t\tfor ( ; populatedIndices + 5 < capacity; populatedIndices += 6) {\r\n\t\t\tnewIndices[populatedIndices    ] = vi;\r\n\t\t\tnewIndices[populatedIndices + 1] = vi + 1;\r\n\t\t\tnewIndices[populatedIndices + 2] = vi + 2;\r\n\t\t\tnewIndices[populatedIndices + 3] = vi + 1;\r\n\t\t\tnewIndices[populatedIndices + 4] = vi + 3;\r\n\t\t\tnewIndices[populatedIndices + 5] = vi + 2;\r\n\t\t\tvi += 4;\r\n\t\t}\r\n\r\n\t\tgl.bufferData(gl.ELEMENT_ARRAY_BUFFER, newIndices, gl.DYNAMIC_DRAW);\r\n\r\n\t\tindices = newIndices;\r\n\r\n\t\tsockJsGlobal.quadSize = capacity;\r\n\t}\r\n}\r\n","import { gl } from \"./gl.js\";\r\n\r\n/** @type {Shader[]} */\r\nlet shadersAwaitingCompilation = [];\r\n\r\n/**\r\n * A complete WebGL shader (vertex + fragment + program).\r\n */\r\nexport class Shader {\r\n\t/**\r\n\t * @param {ShaderOptions} opt\r\n\t */\r\n\tconstructor(opt) {\r\n\t\t/**\r\n\t\t * Attribute locations.\r\n\t\t * @type {Record<string, number>}\r\n\t\t */\r\n\t\tthis.attributes = {};\r\n\r\n\t\t/**\r\n\t\t * Uniform locations.\r\n\t\t * @type {Record<string, WebGLUniformLocation | null>}\r\n\t\t */\r\n\t\tthis.uniforms = {};\r\n\r\n\t\tlet attributesSource = initShaderVariables(\"attribute\", opt.attributes, this.attributes, -1);\r\n\t\tlet varyingsSource = initShaderVariables(\"varying\", opt.varyings, null, null);\r\n\t\tlet vertUniforms = initShaderVariables(\"uniform\", opt.vertUniforms, this.uniforms, null);\r\n\t\tlet fragUniforms = initShaderVariables(\"uniform\", opt.fragUniforms, this.uniforms, null);\r\n\r\n\t\t// Create shader source code.\r\n\t\t/**\r\n\t\t * WebGL Vertex Shader source code.\r\n\t\t * @type {string}\r\n\t\t */\r\n\t\tthis.vertSource = attributesSource + varyingsSource + vertUniforms + createShaderSourceMain(opt.vert ?? \"\");\r\n\r\n\t\t/**\r\n\t\t * WebGL Fragment Shader source code.\r\n\t\t * @type {string}\r\n\t\t */\r\n\t\tthis.fragSource = varyingsSource + fragUniforms + createShaderSourceMain(opt.frag ?? \"gl_FragColor=vec4(1.0,0.0,1.0,1.0);\");\r\n\r\n\t\t// Create shaders + program.\r\n\t\t/**\r\n\t\t * WebGL Vertex Shader.\r\n\t\t * @type {WebGLShader}\r\n\t\t * @private\r\n\t\t */\r\n\t\tthis._vert = gl.createShader(gl.VERTEX_SHADER);\r\n\t\tgl.shaderSource(this._vert, this.vertSource);\r\n\r\n\t\t/**\r\n\t\t * WebGL Vertex Shader.\r\n\t\t * @type {WebGLShader}\r\n\t\t * @private\r\n\t\t */\r\n\t\tthis._frag = gl.createShader(gl.FRAGMENT_SHADER);\r\n\t\tgl.shaderSource(this._frag, this.fragSource);\r\n\r\n\t\t/**\r\n\t\t * WebGL Shader Program.\r\n\t\t * @type {WebGLProgram}\r\n\t\t */\r\n\t\tthis.prog = gl.createProgram();\r\n\r\n\t\tgl.attachShader(this.prog, this._vert);\r\n\t\tgl.attachShader(this.prog, this._frag);\r\n\r\n\t\t/**\r\n\t\t * If this the shader has been compiled yet.\r\n\t\t * @type {boolean}\r\n\t\t */\r\n\t\tthis.compiled = false;\r\n\t}\r\n\r\n\t/**\r\n\t * When compiling multiple shaders at once, use {@link Shader.compile()} for better performance.\r\n\t * @see {@link needsCompilation()}.\r\n\t */\r\n\tcompile() {\r\n\t\tShader.compile(this);\r\n\t}\r\n\r\n\t/**\r\n\t * Compiles the shader during game load.\r\n\t * \r\n\t * This method is preferred over {@link compile()} since multiple shaders can be compiled in parallel.\r\n\t * \r\n\t * See also {@link Shader.compile()}.\r\n\t */\r\n\tneedsCompilation() {\r\n\t\tshadersAwaitingCompilation.push(this);\r\n\t}\r\n\r\n\tfree() {\r\n\t\tgl.deleteProgram(this.prog);\r\n\t\tgl.deleteShader(this._frag);\r\n\t\tgl.deleteShader(this._vert);\r\n\t\tthis.prog = -1;\r\n\t\tthis.compiled = false;\r\n\t}\r\n\r\n\tuse() {\r\n\t\tif (!this.compiled) throw Error(\"shader not compiled\");\r\n\t\tgl.useProgram(this.prog);\r\n\t}\r\n\r\n\t/**\r\n\t * @param {string} name\r\n\t * @returns {WebGLUniformLocation}\r\n\t * @throws If name is not one of the program's uniform names.\r\n\t * @protected\r\n\t */\r\n\tgetUniformLocation(name) {\r\n\t\tlet location = this.uniforms[name];\r\n\t\tif (location == null) throw Error(`Shader does not contain a uniform named \"${name}\"`);\r\n\t\treturn location;\r\n\t}\r\n\r\n\t/**\r\n\t * Sets a uniform texture in the shader.\r\n\t * @param {string} name The name of the uniform variable.\r\n\t * @param {WebGLTexture} tex The texture to set.\r\n\t * @param {number} unit The texture unit. Either [0..31] or [`gl.TEXTURE0`..`gl.TEXTURE31`]\r\n\t */\r\n\tsetUniformTexture(name, tex, unit) {\r\n\t\tlet location = this.getUniformLocation(name);\r\n\t\t\r\n\t\t// Convert from `gl.TEXTURE##` constants.\r\n\t\tif (unit >= gl.TEXTURE0) {\r\n\t\t\tunit -= gl.TEXTURE0;\r\n\t\t}\r\n\t\t\r\n\t\t// Set the uniform!\r\n\t\tgl.activeTexture(gl.TEXTURE0 + unit);\r\n\t\tgl.bindTexture(gl.TEXTURE_2D, tex);\r\n\t\tgl.uniform1i(location, unit);\r\n\t}\r\n\r\n\t/**\r\n\t * @param {string} name\r\n\t * @param {number} x \r\n\t * @param {number} y \r\n\t */\r\n\tsetUniformFloat2(name, x, y) {\r\n\t\tlet location = this.getUniformLocation(name);\r\n\r\n\t\tgl.uniform2f(location, x, y);\r\n\t}\r\n\r\n\t/**\r\n\t * @param {string} name\r\n\t * @param {number[]|Float32Array} matrix \r\n\t */\r\n\tsetUniformMatrix3(name, matrix) {\r\n\t\tlet location = this.getUniformLocation(name);\r\n\r\n\t\tgl.uniformMatrix3fv(location, false, matrix);\r\n\t}\r\n\t\r\n\t/**\r\n\t * @param {string} name\r\n\t * @param {number[]} matrix \r\n\t */\r\n\tsetUniformMatrix4(name, matrix) {\r\n\t\tlet location = this.getUniformLocation(name);\r\n\r\n\t\tgl.uniformMatrix4fv(location, false, matrix);\r\n\t}\r\n\r\n\t/**\r\n\t * Compiles all shaders that are yet to be compiled.\r\n\t */\r\n\tstatic compileAll() {\r\n\t\tthis.compile(shadersAwaitingCompilation);\r\n\r\n\t\tshadersAwaitingCompilation.length = 0;\r\n\t}\r\n\r\n\t/**\r\n\t * Compile a set of shaders in parallel.\r\n\t * @param {Shader|Shader[]} shaders\r\n\t */\r\n\tstatic compile(shaders) {\r\n\t\tif (shaders instanceof Shader) shaders = [ shaders ];\r\n\r\n\t\t// Frag/Vert\r\n\t\tfor (let sh of shaders) {\r\n\t\t\tgl.compileShader(sh._vert);\r\n\t\t\tgl.compileShader(sh._frag);\r\n\t\t}\r\n\r\n\t\t// Link\r\n\t\tfor (let sh of shaders) {\r\n\t\t\tgl.linkProgram(sh.prog);\r\n\t\t}\r\n\r\n\t\t// Check status\r\n\t\tlet errors = [];\r\n\t\tfor (let sh of shaders) {\r\n\t\t\tif (gl.getProgramParameter(sh.prog, gl.LINK_STATUS)) {\r\n\t\t\t\tsh.compiled = true;\r\n\t\t\t} else {\r\n\t\t\t\tlet sProg = gl.getProgramInfoLog(sh.prog);\r\n\t\t\t\tlet sVert = gl.getShaderInfoLog(sh._vert);\r\n\t\t\t\tlet sFrag = gl.getShaderInfoLog(sh._frag);\r\n\r\n\t\t\t\tlet error = \"Shader Compilation Error:\";\r\n\r\n\t\t\t\tif (sProg) error += \"\\n\\n===   PROGRAM   ===\\n\" + sProg;\r\n\t\t\t\tif (sVert) error += \"\\n\\n=== VERT SHADER ===\\n\" + sVert;\r\n\t\t\t\tif (sFrag) error += \"\\n\\n=== FRAG SHADER ===\\n\" + sFrag;\r\n\r\n\t\t\t\terrors.push(error);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (errors.length > 0) {\r\n\t\t\tthrow Error(errors.join(\"\\n\\n\"));\r\n\t\t}\r\n\r\n\t\t// Get locations.\r\n\t\tfor (let sh of shaders) {\r\n\t\t\tfor (let name in sh.attributes) {\r\n\t\t\t\tsh.attributes[name] = gl.getAttribLocation(sh.prog, name);\r\n\t\t\t}\r\n\t\t\tfor (let name in sh.uniforms) {\r\n\t\t\t\tlet location = gl.getUniformLocation(sh.prog, name);\r\n\t\t\t\tif (location == null) throw Error(`Failed to find uniform \"${name}\" in Shader.`);\r\n\t\t\t\tsh.uniforms[name] = location;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n\r\n/**\r\n * @param {string} keyword\r\n * @param {Record<string, string>} src\r\n * @param {Record<string, T>|null} dst\r\n * @param {T} init\r\n * @returns {string}\r\n * @template T\r\n */\r\nfunction initShaderVariables(keyword, src, dst, init) {\r\n\tlet s = \"\";\r\n\tif (src) {\r\n\t\tfor (let name in src) {\r\n\t\t\tif (dst) dst[name] = init;\r\n\t\t\ts += keyword +  \" \" + src[name] + \" \" + name + \";\\n\";\r\n\t\t}\r\n\t}\r\n\treturn s;\r\n}\r\n\r\n/**\r\n * @param {string|string[]} a\r\n * @returns {string}\r\n */\r\nfunction createShaderSourceMain(a) {\r\n\tif (Array.isArray(a)) {\r\n\t\ta = a.join(\"\");\r\n\t}\r\n\r\n\treturn \"void main(){\" + a + \"}\";\r\n}\r\n\r\n/**\r\n * @typedef {object} ShaderOptions\r\n * @property {Record<string, string> | null} [attributes] Vertex shader attributes, as name-type pairs.\r\n * @property {Record<string, string> | null} [varyings] Vertex/fragment shader varyings, as name-type pairs.\r\n * @property {Record<string, string> | null} [vertUniforms] Vertex shader uniforms, as name-type pairs.\r\n * @property {Record<string, string> | null} [fragUniforms] Fragment shader uniforms, as name-type pairs.\r\n * @property {string|string[]|null} [vert] Vertex shader code, just the contents of the `main()` function.\r\n * @property {string|string[]|null} [frag] Fragment shader code, just the contents of the `main()` function.\r\n */\r\n","\r\nexport class Vec2 {\r\n\t/**\r\n\t * @param {number} x\r\n\t * @param {number} y\r\n\t */\r\n\tconstructor(x, y) {\r\n\t\tthis.x = x;\r\n\t\tthis.y = y;\r\n\t}\r\n}","import { Vec2 } from \"../math.js\";\r\nimport { gl } from \"./gl.js\";\r\n\r\n/**\r\n * A 2D WebGL texture.\r\n */\r\nexport class Texture {\r\n\t/**\r\n\t * @param {number} filter\r\n\t * @param {number} wrap\r\n\t */\r\n\tconstructor(filter, wrap) {\r\n\t\tthis.width = 0;\r\n\t\tthis.height = 0;\r\n\t\t// this.mipmaps = false;\r\n\t\tthis.filter = filter;\r\n\t\tthis.wrap = wrap;\r\n\t\tthis.size = 1;\r\n\t\t/**\r\n\t\t * The WebGL texture.\r\n\t\t * @type {WebGLTexture}\r\n\t\t */\r\n\t\tthis.texture = null;\r\n\t}\r\n\r\n\tname() {\r\n\t\treturn \"Texture\";\r\n\t}\r\n\r\n\t/**\r\n\t * @param {number} n\r\n\t */\r\n\tsetFilter(n) {\r\n\t\tif (this.filter !== n) {\r\n\t\t\tthis.filter = n;\r\n\t\t\t\r\n\t\t\tif (this.texture) {\r\n\t\t\t\tgl.bindTexture(gl.TEXTURE_2D, this.texture);\r\n\t\t\t\tgl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, this.filter);\r\n\t\t\t\tgl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, this.filter);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * @param {number} n\r\n\t */\r\n\tsetWrap(n) {\r\n\t\tif (this.wrap !== n) {\r\n\t\t\tthis.wrap = n;\r\n\r\n\t\t\tif (this.texture) {\r\n\t\t\t\tgl.bindTexture(gl.TEXTURE_2D, this.texture);\r\n\t\t\t\tgl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, this.wrap);\r\n\t\t\t\tgl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, this.wrap);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * @param {TexImageSource} source \r\n\t */\r\n\tload(source) {\r\n\t\tlet res = getResolution(source);\r\n\t\tthis.width = res.x;\r\n\t\tthis.height = res.y;\r\n\t\tthis.size = imageSize(source, res);\r\n\t\tthis.texture = gl.createTexture();\r\n\r\n\t\tgl.bindTexture(gl.TEXTURE_2D, this.texture);\r\n\r\n\t\tgl.texImage2D(\r\n\t\t\tgl.TEXTURE_2D,\r\n\t\t\t0,\r\n\t\t\tgl.RGBA,\r\n\t\t\tgl.RGBA,\r\n\t\t\tgl.UNSIGNED_BYTE,\r\n\t\t\tsource\r\n\t\t);\r\n\r\n\t\t// if (this.mipmaps) {\r\n\t\t// \tgl.generateMipmap(gl.TEXTURE_2D);\r\n\t\t// }\r\n\r\n\t\t// Handle issues with non-power-of-two textures.\r\n\t\tlet texIsPowerOf2 = isPowerOf2(this.width) && isPowerOf2(this.height);\r\n\r\n\t\tif (!texIsPowerOf2) {\r\n\t\t\t// Non-power-of-two textures in WebGL 1.0 will be read as a black texture unless we set:\r\n\t\t\t// * Minification filter to NEAREST or LINEAR (i.e. not one of the mip-map options).\r\n\t\t\t// * Wrap mode to CLAMP_TO_EDGE.\r\n\t\t\t// https://www.khronos.org/webgl/wiki/WebGL_and_OpenGL_Differences#Non-Power_of_Two_Texture_Support\r\n\t\t\tlet warn = [];\r\n\r\n\t\t\t// if (isMipMapFilter(this.filter)) {\r\n\t\t\t// \tthis.filter = gl.LINEAR;\r\n\t\t\t// \twarn.push(\"minification filter to LINEAR\");\r\n\t\t\t// }\r\n\r\n\t\t\tif (this.wrap !== gl.CLAMP_TO_EDGE) {\r\n\t\t\t\tthis.wrap = gl.CLAMP_TO_EDGE;\r\n\t\t\t\twarn.push(\"wrap mode to CLAMP_TO_EDGE\");\r\n\t\t\t}\r\n\r\n\t\t\tif (warn.length > 0) {\r\n\t\t\t\tconsole.warn(`Forced settings on non power-of-two texture \"${this.name()}\": ${warn.join(\", \")}.\\nThe texture would not function properly otherwise, see https://www.khronos.org/webgl/wiki/WebGL_and_OpenGL_Differences#Non-Power_of_Two_Texture_Support`);\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tgl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, this.filter);\r\n\t\tgl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, this.filter);\r\n\t\t\r\n\t\tif (this.wrap != null && this.wrap !== gl.REPEAT) {\r\n\t\t\tgl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, this.wrap);\r\n\t\t\tgl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, this.wrap);\r\n\t\t}\r\n\t}\r\n\r\n\tfree() {\r\n\t\tgl.deleteTexture(this.texture);\r\n\t\tthis.texture = null;\r\n\t}\r\n}\r\n\r\n/**\r\n * @param {TexImageSource} source\r\n * @returns {Vec2}\r\n */\r\nfunction getResolution(source) {\r\n\tif (source instanceof HTMLImageElement) {\r\n\t\treturn new Vec2(source.naturalWidth, source.naturalHeight);\r\n\t} else if (source instanceof HTMLVideoElement) {\r\n\t\treturn new Vec2(source.videoWidth, source.videoHeight);\r\n\t} else {\r\n\t\treturn new Vec2(source.width, source.height);\r\n\t}\r\n}\r\n\r\n/**\r\n * @param {TexImageSource} img\r\n * @param {Vec2} resolution\r\n * @returns {number}\r\n */\r\nfunction imageSize(img, resolution) {\r\n\tif (img instanceof HTMLImageElement) {\r\n\t\tlet entry = performance.getEntriesByName(img.src)[0];\r\n\t\r\n\t\tif (entry instanceof PerformanceResourceTiming) {\r\n\t\t\treturn entry.decodedBodySize || entry.transferSize;\r\n\t\t}\r\n\t} else if (img instanceof ImageData) {\r\n\t\treturn img.data.byteLength;\r\n\t}\r\n\t\r\n\t// Just guess based on dimensions.\r\n\treturn 1 + Math.floor(resolution.x * resolution.y * 0.25);\r\n}\r\n\r\n/**\r\n * @param {number} n\r\n * @returns {boolean}\r\n */\r\nfunction isPowerOf2(n) {\r\n\treturn (n & (n - 1)) === 0;\r\n}\r\n\r\n/**\r\n * @param {number | null | undefined} n\r\n */\r\nfunction isMipMapFilter(n) {\r\n\treturn n == null || (n >= 0x2700 && n <= 0x2703);\r\n}\r\n","import { getCameraMatrix } from \"../api/camera.js\";\r\nimport { gl } from \"./gl.js\";\r\nimport { bindQuadIndexBuffer } from \"./quad-index-buffer.js\";\r\nimport { Shader } from \"./shader.js\";\r\nimport { Texture } from \"./texture.js\";\r\n\r\nlet shader = new Shader({\r\n\tattributes: {\r\n\t\t\"vertex\": \"vec3\",\r\n\t\t\"color\": \"vec4\",\r\n\t\t\"uv\": \"vec2\",\r\n\t},\r\n\tvaryings: {\r\n\t\t\"v_color\": \"lowp vec4\",\r\n\t\t\"v_uv\": \"highp vec2\",\r\n\t},\r\n\tvertUniforms: {\r\n\t\t\"mat\": \"mat3\",\r\n\t},\r\n\tvert: [\r\n\t\t\"v_uv = uv;\",\r\n\t\t\"v_color = color;\",\r\n\t\t// \"gl_Position = vec4(vertex, 1.0);\",\r\n\t\t\"vec3 tv = mat * vec3(vertex.x, vertex.y, 1.0);\",\r\n\t\t\"gl_Position = vec4(tv.x, tv.y, vertex.z, 1.0);\",\r\n\t],\r\n\tfragUniforms: {\r\n\t\t\"tex\": \"sampler2D\",\r\n\t},\r\n\tfrag: \"gl_FragColor = texture2D(tex, v_uv) * v_color;\",\r\n});\r\n\r\nshader.needsCompilation();\r\n\r\n\r\n/**\r\n * Helper for drawing sprites (textured quads) in an efficient manner.\r\n * \r\n * Each `SpriteBatcher` contains growing buffers for geometry data, so it's best to re-use instances where possible.\r\n * \r\n * `SpriteBatcher` should be destroyed explicitly using {@link free()}.\r\n */\r\nexport class SpriteBatcher {\r\n\tconstructor() {\r\n\t\t/**\r\n\t\t * Number of vertices we can fit.\r\n\t\t * @protected\r\n\t\t */\r\n\t\tthis._capacity = 128;\r\n\t\t/**\r\n\t\t * Vertex data array.\r\n\t\t * ```\r\n\t\t *  x     y     z     rgba  u     v\r\n\t\t * [----][----][----][----][----][----]\r\n\t\t * ```\r\n\t\t * @protected\r\n\t\t */\r\n\t\tthis._array = new ArrayBuffer(this._capacity * 24);\r\n\t\t/**\r\n\t\t * @protected\r\n\t\t */\r\n\t\tthis._floats = new Float32Array(this._array);\r\n\t\t/**\r\n\t\t * @protected\r\n\t\t */\r\n\t\tthis._bytes = new Uint8Array(this._array);\r\n\t\t/**\r\n\t\t * @protected\r\n\t\t */\r\n\t\tthis._ints = new Uint32Array(this._array);\r\n\t\t/**\r\n\t\t * @protected\r\n\t\t */\r\n\t\tthis._vertexCount = -1;\r\n\t\t/**\r\n\t\t * @protected\r\n\t\t */\r\n\t\tthis._vertexBuffer = gl.createBuffer();\r\n\t\t/**\r\n\t\t * The number of vertices we can fit in the vertex buffer.\r\n\t\t * @protected\r\n\t\t */\r\n\t\tthis._vertexBufferCapacity = 0;\r\n\t}\r\n\r\n\t/**\r\n\t * Begin a batch.\r\n\t * \r\n\t * Each batch can only use one texture, and you can only provide it here.\r\n\t * \r\n\t * Use {@link end()} to end a batch.\r\n\t * @param {Texture} texture\r\n\t */\r\n\tbegin(texture) {\r\n\t\tif (this._vertexCount >= 0) throw Error(\"already called begin()\");\r\n\r\n\t\t/**\r\n\t\t * @protected\r\n\t\t */\r\n\t\tthis._texture = texture;\r\n\t\tthis._vertexCount = 0;\r\n\r\n\t\treturn this;\r\n\t}\r\n\r\n\t// /**\r\n\t//  * @param {number} x1\r\n\t//  * @param {number} y1\r\n\t//  * @param {number} x2\r\n\t//  * @param {number} y2\r\n\t//  * @param {number} z\r\n\t//  * @param {number} c\r\n\t//  */\r\n\t// draw(x1, y1, x2, y2, z, c) {\r\n\t// \tthis.draw2(x1, y1, x2, y2, z, 0, 0, 1, 1, c, tf, tfo);\r\n\t// }\r\n\t\r\n\t/**\r\n\t * @param {number} x1\r\n\t * @param {number} y1\r\n\t * @param {number} x2\r\n\t * @param {number} y2\r\n\t * @param {number} z\r\n\t * @param {number} u1\r\n\t * @param {number} v1\r\n\t * @param {number} u2\r\n\t * @param {number} v2\r\n\t * @param {number} c\r\n\t * @param {number[]|null} [tf] A 2x3 transform matrix\r\n\t * @param {number[]|null} [tfo] A 2d transform origin\r\n\t */\r\n\tdrawQuad(x1, y1, x2, y2, z, u1, v1, u2, v2, c, tf, tfo) {\r\n\t\tthis.checkResize(4);\r\n\t\t\r\n\t\tif (tf) {\r\n\t\t\tlet tx1 = x1 * tf[0] + y1 * tf[2] + tf[4];\r\n\t\t\tlet ty1 = x1 * tf[1] + y1 * tf[3] + tf[5];\r\n\t\t\tlet tx2 = x1 * tf[0] + y2 * tf[2] + tf[4];\r\n\t\t\tlet ty2 = x1 * tf[1] + y2 * tf[3] + tf[5];\r\n\t\t\tlet tx3 = x2 * tf[0] + y1 * tf[2] + tf[4];\r\n\t\t\tlet ty3 = x2 * tf[1] + y1 * tf[3] + tf[5];\r\n\t\t\tlet tx4 = x2 * tf[0] + y2 * tf[2] + tf[4];\r\n\t\t\tlet ty4 = x2 * tf[1] + y2 * tf[3] + tf[5];\r\n\r\n\t\t\tlet tfox = tfo ? (x1 + tfo[0]) : ((x1 + x2) / 2);\r\n\t\t\tlet tfoy = tfo ? (y1 + tfo[1]) : ((y1 + y2) / 2);\r\n\t\t\tlet dx = tfox - tf[0] * tfox - tf[2] * tfoy;\r\n\t\t\tlet dy = tfoy - tf[1] * tfox - tf[3] * tfoy;\r\n\r\n\t\t\tthis.addVertex(tx1 + dx, ty1 + dy, z, c, u1, v1);\r\n\t\t\tthis.addVertex(tx2 + dx, ty2 + dy, z, c, u1, v2);\r\n\t\t\tthis.addVertex(tx3 + dx, ty3 + dy, z, c, u2, v1);\r\n\t\t\tthis.addVertex(tx4 + dx, ty4 + dy, z, c, u2, v2);\r\n\t\t} else {\r\n\t\t\tthis.addVertex(x1, y1, z, c, u1, v1);\r\n\t\t\tthis.addVertex(x1, y2, z, c, u1, v2);\r\n\t\t\tthis.addVertex(x2, y1, z, c, u2, v1);\r\n\t\t\tthis.addVertex(x2, y2, z, c, u2, v2);\r\n\t\t}\r\n\t\t\r\n\t}\r\n\r\n\t/**\r\n\t * Add a single vertex.\r\n\t * Should be preceded by a call to {@link checkResize()}.\r\n\t * @param {number} x\r\n\t * @param {number} y\r\n\t * @param {number} z\r\n\t * @param {number} color\r\n\t * @param {number} u\r\n\t * @param {number} v\r\n\t * @protected\r\n\t */\r\n\taddVertex(x, y, z, color, u, v) {\r\n\t\tlet i4 = this._vertexCount * 6;\r\n\r\n\t\tthis._floats[i4    ] = x;\r\n\t\tthis._floats[i4 + 1] = y;\r\n\t\tthis._floats[i4 + 2] = z;\r\n\r\n\t\tthis._ints[i4 + 3] = color;\r\n\r\n\t\tthis._floats[i4 + 4] = u;\r\n\t\tthis._floats[i4 + 5] = v;\r\n\r\n\t\tthis._vertexCount++;\r\n\t}\r\n\r\n\t/**\r\n\t * @param {number} vertexCount\r\n\t * @protected\r\n\t */\r\n\tcheckResize(vertexCount) {\r\n\t\tif (this._vertexCount + vertexCount > this._capacity) {\r\n\t\t\t// Grow capacity.\r\n\t\t\tthis._capacity *= 2;\r\n\r\n\t\t\tif (this._capacity >= 0xfffff) throw Error(`exceeded max batch capacity of ${0xfffff}, did you forget to call end()?`);\r\n\r\n\t\t\t// Create new buffer.\r\n\t\t\tthis._array = new ArrayBuffer(this._capacity * 24);\r\n\r\n\t\t\t// Copy data from old buffer.\r\n\t\t\tlet newInts = new Uint32Array(this._array);\r\n\t\t\tnewInts.set(this._ints);\r\n\r\n\t\t\t// Create new views.\r\n\t\t\tthis._floats = new Float32Array(this._array);\r\n\t\t\tthis._bytes = new Uint8Array(this._array);\r\n\t\t\tthis._ints = newInts;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Ends a batch.\r\n\t * Has no effect if no sprites have been queued up.\r\n\t */\r\n\tend() {\r\n\t\tif (this._vertexCount < 0) throw Error(\"have not called begin()\");\r\n\r\n\t\tif (this._vertexCount > 0) {\r\n\t\t\t// Draw!\r\n\t\t\tshader.use();\r\n\t\r\n\t\t\t// Put vertex data.\r\n\t\t\tgl.bindBuffer(gl.ARRAY_BUFFER, this._vertexBuffer);\r\n\r\n\t\t\tif (this._vertexCount > this._vertexBufferCapacity) {\r\n\t\t\t\t// Re-allocate vertex data.\r\n\t\t\t\tthis._vertexBufferCapacity = this._capacity;\r\n\t\t\t\tgl.bufferData(gl.ARRAY_BUFFER, this._array, gl.DYNAMIC_DRAW);\r\n\t\t\t} else {\r\n\t\t\t\t// Put in sub-data.\r\n\t\t\t\tgl.bufferSubData(gl.ARRAY_BUFFER, 0, this._ints.subarray(0, this._vertexCount * 6));\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// Configure/enable attributes.\r\n\t\t\tlet vertLocation = shader.attributes.vertex;\r\n\t\t\tlet colorlocation = shader.attributes.color;\r\n\t\t\tlet uvLocation = shader.attributes.uv;\r\n\r\n\t\t\tgl.vertexAttribPointer(\r\n\t\t\t\tvertLocation,\r\n\t\t\t\t3,\r\n\t\t\t\tgl.FLOAT,\r\n\t\t\t\tfalse,\r\n\t\t\t\t24,\r\n\t\t\t\t0,\r\n\t\t\t);\r\n\t\t\tgl.enableVertexAttribArray(vertLocation);\r\n\t\t\t\r\n\t\t\tgl.vertexAttribPointer(\r\n\t\t\t\tcolorlocation,\r\n\t\t\t\t4,\r\n\t\t\t\tgl.UNSIGNED_BYTE,\r\n\t\t\t\ttrue,\r\n\t\t\t\t24,\r\n\t\t\t\t12,\r\n\t\t\t);\r\n\t\t\tgl.enableVertexAttribArray(colorlocation);\r\n\r\n\t\t\tgl.vertexAttribPointer(\r\n\t\t\t\tuvLocation,\r\n\t\t\t\t2,\r\n\t\t\t\tgl.FLOAT,\r\n\t\t\t\tfalse,\r\n\t\t\t\t24,\r\n\t\t\t\t16,\r\n\t\t\t);\r\n\t\t\tgl.enableVertexAttribArray(uvLocation);\r\n\r\n\t\t\t// Set shader texture.\r\n\t\t\tshader.setUniformTexture(\"tex\", this._texture.texture, 0);\r\n\r\n\t\t\t// Set shader matrix.\r\n\t\t\tshader.setUniformMatrix3(\"mat\", getCameraMatrix());\r\n\t\t\r\n\t\t\t// Setup index buffer.\r\n\t\t\tlet indexCount = this._vertexCount * 1.5;\r\n\t\t\t\r\n\t\t\tbindQuadIndexBuffer(indexCount);\r\n\r\n\t\t\t// Draw!\r\n\t\t\tgl.drawElements(gl.TRIANGLES, indexCount, gl.UNSIGNED_SHORT, 0);\r\n\r\n\t\t\t// Clean up.\r\n\t\t\tgl.disableVertexAttribArray(vertLocation);\r\n\t\t\tgl.disableVertexAttribArray(colorlocation);\r\n\t\t\tgl.disableVertexAttribArray(uvLocation);\r\n\t\t}\r\n\r\n\t\t// Reset state.\r\n\t\tthis._vertexCount = -1;\r\n\t}\r\n\r\n\t/**\r\n\t * Free all WebGL buffers and internal buffers.\r\n\t */\r\n\tfree() {\r\n\t\tgl.deleteBuffer(this._vertexBuffer);\r\n\t\tthis._array = this._bytes = this._floats = this._ints = null;\r\n\t}\r\n}\r\n","import { addForeignClass } from \"../foreign.js\";\r\nimport { glFilterNumberToString, glFilterStringToNumber, glWrapModeNumberToString, glWrapModeStringToNumber, GL_FILTER_MAP, GL_WRAP_MAP, wrenGlFilterStringToNumber, wrenGlWrapModeStringToNumber } from \"../gl/api.js\";\r\nimport { gl } from \"../gl/gl.js\";\r\nimport { SpriteBatcher } from \"../gl/sprite-batcher.js\";\r\nimport { Texture } from \"../gl/texture.js\";\r\nimport { httpGETImage } from \"../network/http.js\";\r\nimport { wrenAbort, vm, wrenEnsureSlots, wrenGetSlotDouble, wrenGetSlotForeign, wrenGetSlotHandle, wrenGetSlotString, wrenGetSlotType, wrenInsertInList, wrenReleaseHandle, wrenSetListElement, wrenSetSlotDouble, wrenSetSlotHandle, wrenSetSlotNewForeign, wrenSetSlotNewList, wrenSetSlotNull, wrenSetSlotString, wrenGetVariable, Module, HEAP, wren_sock_get_transform } from \"../vm.js\";\r\nimport { loadAsset } from \"./asset.js\";\r\nimport { WrenHandle } from \"./promise.js\";\r\n\r\n\r\nlet handle_Sprite = 0;\r\n\r\nexport function initSpriteModule() {\r\n\twrenEnsureSlots(1);\r\n\twrenGetVariable(\"sock\", \"Sprite\", 0);\r\n\thandle_Sprite = wrenGetSlotHandle(0);\r\n}\r\n\r\nlet defaultFilter = gl.NEAREST;\r\nlet defaultWrap = gl.CLAMP_TO_EDGE;\r\n\r\nclass Sprite extends Texture {\r\n\t/**\r\n\t * @param {number} ptr\r\n\t */\r\n\tconstructor(ptr) {\r\n\t\tsuper(defaultFilter, defaultWrap);\r\n\r\n\t\t/**\r\n\t\t * Foreign slot pointer.\r\n\t\t */\r\n\t\tthis.ptr = ptr;\r\n\r\n\t\t/** @type {string} */\r\n\t\tthis.path = null;\r\n\r\n\t\t/** @type {SpriteBatcher|null} */\r\n\t\tthis.batcher = null;\r\n\r\n\t\tthis.color = 0xffffffff;\r\n\r\n\t\t/**\r\n\t\t * Transform origin.\r\n\t\t * @type {number[]|null}\r\n\t\t */\r\n\t\tthis.tfo = null;\r\n\r\n\t\t/**\r\n\t\t * Transform matrix.\r\n\t\t * @type {number[]}\r\n\t\t */\r\n\t\tthis.tf = null;\r\n\t}\r\n\r\n\tname() {\r\n\t\treturn this.path || \"Sprite#\" + this.ptr;\r\n\t}\r\n\r\n\tbeginBatch() {\r\n\t\tthis.batcher = getBatcher();\r\n\t\tthis.batcher.begin(this);\r\n\t}\r\n\r\n\tendBatch() {\r\n\t\tthis.batcher.end();\r\n\t\tfreeSpriteBatchers.push(this.batcher);\r\n\t\tthis.batcher = null;\r\n\t}\r\n}\r\n\r\n\r\n/** @type {SpriteBatcher[]} */\r\nlet freeSpriteBatchers = [];\r\n\r\nfunction getBatcher() {\r\n\tif (freeSpriteBatchers.length > 0) {\r\n\t\treturn freeSpriteBatchers.pop();\r\n\t} else {\r\n\t\tconsole.log(\"allocate new sprite batcher\");\r\n\t\treturn new SpriteBatcher();\r\n\t}\r\n}\r\n\r\nfunction getTempBatcher() {\r\n\tif (freeSpriteBatchers.length > 0) {\r\n\t\treturn freeSpriteBatchers[0];\r\n\t} else {\r\n\t\tconsole.log(\"allocate new sprite batcher\");\r\n\t\tlet bat = new SpriteBatcher();\r\n\t\tfreeSpriteBatchers.push(bat);\r\n\t\treturn bat;\r\n\t}\r\n}\r\n\r\n\r\n/**\r\n * Maps foreign C pointer to Sprite object.\r\n * @type {Map<number, Sprite>}\r\n */\r\nlet sprites = new Map();\r\n\r\n/**\r\n * Gets the current Sprite in slot 0.\r\n * @returns {Sprite}\r\n */\r\nfunction getSprite() {\r\n\treturn sprites.get(wrenGetSlotForeign(0));\r\n}\r\n\r\n\r\naddForeignClass(\"sock\", \"Sprite\", [\r\n\t() => {\r\n\t\tlet ptr = wrenSetSlotNewForeign(0, 0, 0);\r\n\r\n\t\tlet spr = new Sprite(ptr);\r\n\r\n\t\tsprites.set(ptr, spr);\r\n\t},\r\n\t(ptr) => {\r\n\t\tlet tex = sprites.get(ptr);\r\n\t\ttex.free();\r\n\t\tsprites.delete(ptr);\r\n\t},\r\n], {\r\n\t\"width\"() {\r\n\t\twrenSetSlotDouble(0, getSprite().width);\r\n\t},\r\n\t\"height\"() {\r\n\t\twrenSetSlotDouble(0, getSprite().height);\r\n\t},\r\n\t\"scaleFilter\"() {\r\n\t\twrenSetSlotString(0, glFilterNumberToString(getSprite().filter));\r\n\t},\r\n\t\"scaleFilter=(_)\"() {\r\n\t\tlet filter = wrenGlFilterStringToNumber(1);\r\n\r\n\t\tif (filter != null) {\r\n\t\t\tgetSprite().setFilter(filter);\r\n\t\t}\r\n\t},\r\n\t\"wrapMode\"() {\r\n\t\twrenSetSlotString(0, glWrapModeNumberToString(getSprite().wrap));\r\n\t},\r\n\t\"wrapMode=(_)\"() {\r\n\t\tlet wrapMode = wrenGlWrapModeStringToNumber(1);\r\n\r\n\t\tif (wrapMode != null) {\r\n\t\t\tgetSprite().setWrap(wrapMode);\r\n\t\t}\r\n\t},\r\n\t\"color\"() {\r\n\t\twrenSetSlotDouble(0, getSprite().color);\r\n\t},\r\n\t\"color=(_)\"() {\r\n\t\tif (wrenGetSlotType(1) === 1) {\r\n\t\t\tgetSprite().color = wrenGetSlotDouble(1);\r\n\t\t} else {\r\n\t\t\twrenAbort(\"color must be Num\");\r\n\t\t}\r\n\t},\r\n\t\"beginBatch()\"() {\r\n\t\tlet spr = getSprite();\r\n\t\tif (spr.batcher) {\r\n\t\t\twrenAbort(\"batch already started\");\r\n\t\t} else {\r\n\t\t\tspr.beginBatch();\r\n\t\t}\r\n\t},\r\n\t\"endBatch()\"() {\r\n\t\tlet spr = getSprite();\r\n\t\tif (spr.batcher) {\r\n\t\t\tspr.endBatch();\r\n\t\t} else {\r\n\t\t\twrenAbort(\"batch no yet started\");\r\n\t\t}\r\n\t},\r\n\t\"transform\"() {\r\n\t\tlet spr = getSprite();\r\n\r\n\t\tif (spr.tf == null) {\r\n\t\t\twrenSetSlotNull(0);\r\n\t\t} else {\r\n\t\t\tModule.ccall(\"sock_new_transform\", null, [ \"number\", \"number\", \"number\", \"number\", \"number\", \"number\" ], spr.tf);\r\n\t\t}\r\n\t},\r\n\t\"transform=(_)\"() {\r\n\t\tlet spr = getSprite();\r\n\t\tlet ptr = /** @type {number} */( Module.ccall(\"sock_get_transform\", \"number\", [ \"number\" ], [ 1 ]) );\r\n\t\tif (ptr) {\r\n\t\t\tspr.tfo = null;\r\n\t\t\tspr.tf = Array.from(new Float32Array(HEAP(), ptr, 6));\r\n\t\t}\r\n\t},\r\n\t\"setTransform(_,_,_)\"() {\r\n\t\tlet spr = getSprite();\r\n\r\n\t\tif (wrenGetSlotType(1) !== 1 || wrenGetSlotType(2) !== 1) {\r\n\t\t\twrenAbort(\"x/y must be Nums\");\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tlet x = wrenGetSlotDouble(1);\r\n\t\tlet y = wrenGetSlotDouble(2);\r\n\t\tlet ptr = wren_sock_get_transform(3);\r\n\r\n\t\tif (ptr) {\r\n\t\t\tspr.tfo = [ x, y ];\r\n\t\t\tspr.tf = Array.from(new Float32Array(HEAP(), ptr, 6));\r\n\t\t}\r\n\t},\r\n\t\"draw(_,_,_,_)\"() {\r\n\t\tlet spr = getSprite();\r\n\t\tlet x1 = wrenGetSlotDouble(1);\r\n\t\tlet y1 = wrenGetSlotDouble(2);\r\n\t\tlet x2 = x1 + wrenGetSlotDouble(3);\r\n\t\tlet y2 = y1 + wrenGetSlotDouble(4);\r\n\r\n\t\tlet bat = spr.batcher || getTempBatcher().begin(spr);\r\n\r\n\t\tbat.drawQuad(x1, y1, x2, y2, 0, 0, 0, 1, 1, spr.color, spr.tf, spr.tfo);\r\n\r\n\t\tif (!spr.batcher) bat.end();\r\n\t},\r\n\t\"draw(_,_,_,_,_,_,_,_)\"() {\r\n\t\tlet spr = getSprite();\r\n\t\tlet x1 = wrenGetSlotDouble(1);\r\n\t\tlet y1 = wrenGetSlotDouble(2);\r\n\t\tlet x2 = x1 + wrenGetSlotDouble(3);\r\n\t\tlet y2 = y1 + wrenGetSlotDouble(4);\r\n\t\tlet u1 = wrenGetSlotDouble(5) / spr.width;\r\n\t\tlet v1 = wrenGetSlotDouble(6) / spr.height;\r\n\t\tlet u2 = u1 + wrenGetSlotDouble(7) / spr.width;\r\n\t\tlet v2 = v1 + wrenGetSlotDouble(8) / spr.height;\r\n\r\n\t\tlet bat = spr.batcher || getTempBatcher().begin(spr);\r\n\r\n\t\tbat.drawQuad(x1, y1, x2, y2, 0, u1, v1, u2, v2, spr.color, spr.tf, spr.tfo);\r\n\r\n\t\tif (!spr.batcher) bat.end();\r\n\t},\r\n\t\"toString\"() {\r\n\t\twrenSetSlotString(0, getSprite().name());\r\n\t}\r\n}, {\r\n\t\"load_(_,_)\"() {\r\n\t\tloadAsset(async (url, path) => {\r\n\t\t\tlet img = await httpGETImage(url);\r\n\r\n\t\t\twrenEnsureSlots(2);\r\n\t\t\twrenSetSlotHandle(0, handle_Sprite);\r\n\t\t\tlet ptr = wrenSetSlotNewForeign(0, 0, 0);\r\n\r\n\t\t\tlet spr = new Sprite(ptr);\r\n\t\t\tspr.path = path;\r\n\r\n\t\t\tsprites.set(ptr, spr);\r\n\r\n\t\t\tspr.load(img);\r\n\r\n\t\t\treturn new WrenHandle(wrenGetSlotHandle(0));\r\n\t\t});\r\n\t},\r\n\t\"defaultScaleFilter\"() {\r\n\t\twrenSetSlotString(0, glFilterNumberToString(defaultFilter));\r\n\t},\r\n\t\"defaultScaleFilter=(_)\"() {\r\n\t\tlet filter = wrenGlFilterStringToNumber(1);\r\n\r\n\t\tif (filter != null) {\r\n\t\t\tdefaultFilter = filter;\r\n\t\t}\r\n\t},\r\n\t\"defaultWrapMode\"() {\r\n\t\twrenSetSlotString(0, glWrapModeNumberToString(defaultWrap));\r\n\t},\r\n\t\"defaultWrapMode=(_)\"() {\r\n\t\tlet wrapMode = wrenGlWrapModeStringToNumber(1);\r\n\r\n\t\tif (wrapMode != null) {\r\n\t\t\tdefaultWrap = wrapMode;\r\n\t\t}\r\n\t},\r\n});\r\n","import { sockJsGlobal } from \"./globals.js\";\r\n\r\n/** @type {\"windows\"|\"mac\"|\"ios\"|\"linux\"|\"android\"} */\r\nexport let deviceOS;\r\n/** @type {\"unknown\"|\"chrome\"|\"edge\"|\"firefox\"|\"safari\"} */\r\nexport let deviceBrowser;\r\nexport let deviceIsMobile = false;\r\n\r\nlet platform = navigator.platform;\r\nlet userAgent = navigator.userAgent;\r\n\r\nif (platform === \"iPhone\" || platform === \"iPad\" || userAgent.includes(\"iPhone\")) {\r\n\tdeviceOS = \"ios\";\r\n\tdeviceIsMobile = true;\r\n} else if (platform === \"Win32\") {\r\n\tdeviceOS = \"windows\";\r\n} else if (platform.includes(\"Mac\")) {\r\n\tdeviceOS = \"mac\";\r\n} else if (userAgent.includes(\"Android\")) {\r\n\tdeviceOS = \"android\";\r\n\tdeviceIsMobile = true;\r\n} else {\r\n\tdeviceOS = \"linux\";\r\n}\r\n\r\nif (userAgent.includes(\"Edg/\")) {\r\n\tdeviceBrowser = \"edge\";\r\n} else if (userAgent.includes(\"Chrome/\")) {\r\n\tdeviceBrowser = \"chrome\";\r\n} else if (userAgent.includes(\"Safari/\")) {\r\n\tdeviceBrowser = \"safari\";\r\n} else if (userAgent.includes(\"Firefox/\")) {\r\n\tdeviceBrowser = \"firefox\";\r\n} else {\r\n\tdeviceBrowser = \"unknown\";\r\n}\r\n\r\nsockJsGlobal.device = {\r\n\tos: deviceOS,\r\n\tisMobile: deviceIsMobile,\r\n\tbrowser: deviceBrowser,\r\n};\r\n","import { internalResolutionHeight, internalResolutionWidth, viewportHeight, viewportOffsetX, viewportOffsetY, viewportWidth } from \"../layout.js\";\r\nimport { gl } from \"./gl.js\";\r\nimport { Shader } from \"./shader.js\";\r\n\r\nlet shader = new Shader({\r\n\tattributes: {\r\n\t\t\"vertex\": \"vec2\",\r\n\t},\r\n\tvaryings: {\r\n\t\t\"v_uv\": \"highp vec2\",\r\n\t},\r\n\tvert: [\r\n\t\t\"v_uv = 0.5 + vertex.xy * 0.5;\",\r\n\t\t\"gl_Position = vec4(vertex, 0.0, 1.0);\",\r\n\t],\r\n\tfragUniforms: {\r\n\t\t\"tex\": \"sampler2D\",\r\n\t},\r\n\tfrag: \"gl_FragColor = texture2D(tex, v_uv);\",\r\n});\r\n\r\nshader.needsCompilation();\r\n\r\nexport class Framebuffer {\r\n\t/**\r\n\t * @param {number} [filter]\r\n\t */\r\n\tconstructor(filter) {\r\n\t\tthis.filter = filter ?? gl.LINEAR;\r\n\r\n\t\tthis.texture = gl.createTexture();\r\n\t\tthis.depthBuffer = gl.createRenderbuffer();\r\n\t\tthis.framebuffer = gl.createFramebuffer();\r\n\t\tthis.quadBuffer = gl.createBuffer();\r\n\r\n\t\tgl.bindBuffer(gl.ARRAY_BUFFER, this.quadBuffer);\r\n\t\tgl.bufferData(\r\n\t\t\tgl.ARRAY_BUFFER,\r\n\t\t\tnew Float32Array([\r\n\t\t\t\t-1, -1,\r\n\t\t\t\t+1, -1,\r\n\t\t\t\t-1, +1,\r\n\t\t\t\t-1, +1,\r\n\t\t\t\t+1, -1,\r\n\t\t\t\t+1, +1,\r\n\t\t\t]),\r\n\t\t\tgl.STATIC_DRAW\r\n\t\t);\r\n\r\n\t\tgl.bindTexture(gl.TEXTURE_2D, this.texture);\r\n\t\tgl.texImage2D(\r\n\t\t\tgl.TEXTURE_2D,\r\n\t\t\t0,\r\n\t\t\tgl.RGBA,\r\n\t\t\t8,\r\n\t\t\t8,\r\n\t\t\t0,\r\n\t\t\tgl.RGBA,\r\n\t\t\tgl.UNSIGNED_BYTE,\r\n\t\t\tnull,\r\n\t\t);\r\n\t}\r\n\r\n\tupdateResolution() {\r\n\t\tgl.bindTexture(gl.TEXTURE_2D, this.texture);\r\n\t\tgl.texImage2D(\r\n\t\t\tgl.TEXTURE_2D,\r\n\t\t\t0,\r\n\t\t\tgl.RGBA,\r\n\t\t\tinternalResolutionWidth,\r\n\t\t\tinternalResolutionHeight,\r\n\t\t\t0,\r\n\t\t\tgl.RGBA,\r\n\t\t\tgl.UNSIGNED_BYTE,\r\n\t\t\tnull,\r\n\t\t);\r\n\r\n\t\tgl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, this.filter);\r\n\t\tgl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, this.filter);\r\n\t\t\r\n\t\tgl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\r\n\t\tgl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\r\n\r\n\t\tgl.bindRenderbuffer(gl.RENDERBUFFER, this.depthBuffer);\r\n\t\tgl.renderbufferStorage(gl.RENDERBUFFER, gl.DEPTH_COMPONENT16, internalResolutionWidth, internalResolutionHeight);\r\n\r\n\t\tgl.bindFramebuffer(gl.FRAMEBUFFER, this.framebuffer);\r\n\t\tgl.framebufferTexture2D(\r\n\t\t\tgl.FRAMEBUFFER,\r\n\t\t\tgl.COLOR_ATTACHMENT0,\r\n\t\t\tgl.TEXTURE_2D,\r\n\t\t\tthis.texture,\r\n\t\t\t0,\r\n\t\t);\r\n\r\n\t\tgl.framebufferRenderbuffer(gl.FRAMEBUFFER, gl.DEPTH_ATTACHMENT, gl.RENDERBUFFER, this.depthBuffer);\r\n\t}\r\n\r\n\t/**\r\n\t * @param {number} filter\r\n\t */\r\n\tsetFilter(filter) {\r\n\t\tthis.filter = filter;\r\n\r\n\t\tgl.bindTexture(gl.TEXTURE_2D, this.texture);\r\n\r\n\t\tgl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, this.filter);\r\n\t\tgl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, this.filter);\r\n\t}\r\n\r\n\t/**\r\n\t * Binds the framebuffer as the target for subsequent draw calls.\r\n\t */\r\n\tbind() {\r\n\t\tgl.bindFramebuffer(gl.FRAMEBUFFER, this.framebuffer);\r\n\r\n\t\tgl.viewport(0, 0, internalResolutionWidth, internalResolutionHeight);\r\n\t}\r\n\r\n\tunbind() {\r\n\t\tgl.bindFramebuffer(gl.FRAMEBUFFER, null);\r\n\r\n\t\tlet scale = devicePixelRatio;\r\n\r\n\t\tgl.viewport(\r\n\t\t\tviewportOffsetX * scale,\r\n\t\t\tviewportOffsetY * scale,\r\n\t\t\tviewportWidth * scale,\r\n\t\t\tviewportHeight * scale,\r\n\t\t);\r\n\t}\r\n\r\n\t/**\r\n\t * Draws the framebuffer to the canvas.\r\n\t */\r\n\tdraw() {\r\n\t\tthis.unbind();\r\n\r\n\t\tshader.use();\r\n\r\n\t\tshader.setUniformTexture(\"tex\", this.texture, 0);\r\n\r\n\t\tlet vertAttr = shader.attributes.vertex;\r\n\r\n\t\tgl.bindBuffer(gl.ARRAY_BUFFER, this.quadBuffer);\r\n\t\tgl.vertexAttribPointer(\r\n\t\t\tvertAttr,\r\n\t\t\t2,\r\n\t\t\tgl.FLOAT,\r\n\t\t\tfalse,\r\n\t\t\t0,\r\n\t\t\t0,\r\n\t\t);\r\n\t\tgl.enableVertexAttribArray(vertAttr);\r\n\r\n\t\tgl.drawArrays(gl.TRIANGLES, 0, 6);\r\n\r\n\t\tgl.disableVertexAttribArray(vertAttr);\r\n\t}\r\n\r\n\tfree() {\r\n\t\tgl.deleteFramebuffer(this.framebuffer);\r\n\t\tgl.deleteBuffer(this.quadBuffer);\r\n\t\tgl.deleteTexture(this.texture);\r\n\t\tgl.deleteRenderbuffer(this.depthBuffer);\r\n\t}\r\n}\r\n\r\nexport let mainFramebuffer = new Framebuffer(gl.NEAREST);\r\n","import { gl } from \"./gl/gl.js\";\r\nimport { Texture } from \"./gl/texture.js\";\r\nimport { HEAPU8, Module } from \"./vm.js\";\r\nimport { SpriteBatcher } from \"./gl/sprite-batcher.js\";\r\nimport { httpGETImage } from \"./network/http.js\";\r\nimport { Color } from \"./color.js\";\r\nimport { internalResolutionWidth } from \"./layout.js\";\r\n\r\n// TODO: most of this file will end up in C eventually.\r\n\r\nlet FONT_BYTE_SIZE = 750;\r\nlet BITMAP_WIDTH = 96;\r\nlet BITMAP_HEIGHT = 72;\r\n\r\n/**\r\n * @type {Texture}\r\n */\r\nexport let SYSTEM_FONT;\r\n\r\n/**\r\n * @type {SpriteBatcher}\r\n */\r\nlet systemFontSpriteBatcher;\r\n\r\nexport async function initSystemFont() {\r\n\tlet ptr = Module.ccall(\"sock_font\", \"number\");\r\n\tlet url = URL.createObjectURL(new Blob([ HEAPU8().subarray(ptr, ptr + FONT_BYTE_SIZE) ], { type: \"image/gif\" }));\r\n\r\n\ttry {\r\n\t\tlet img = await httpGETImage(url);\r\n\r\n\t\tSYSTEM_FONT = new Texture(gl.NEAREST, gl.CLAMP_TO_EDGE);\r\n\t\tSYSTEM_FONT.load(img);\r\n\t} finally {\r\n\t\tURL.revokeObjectURL(url);\r\n\t}\r\n}\r\n\r\n/**\r\n * @param {Uint8Array|string} s\r\n * @param {number} cornerX\r\n * @param {number} cornerY\r\n * @param {Color|number} [color]\r\n */\r\nexport function systemFontDraw(s, cornerX, cornerY, color) {\r\n\tif (typeof s === \"string\") {\r\n\t\ts = new TextEncoder().encode(s);\r\n\t}\r\n\r\n\tlet colorInt = color == null ? 0xffffffff : (typeof color === \"number\" ? color : color.int);\r\n\r\n\tif (!systemFontSpriteBatcher) systemFontSpriteBatcher = new SpriteBatcher();\r\n\r\n\tsystemFontSpriteBatcher.begin(SYSTEM_FONT);\r\n\r\n\tlet dx = cornerX;\r\n\tlet dy = cornerY;\r\n\r\n\tfor (let i = 0; i < s.length; i++) {\r\n\t\tlet c = s[i];\r\n\r\n\t\tif (c == 9) {\r\n\t\t\t// Tab\r\n\t\t\tdx += 24;\r\n\t\t} else if (c === 10) {\r\n\t\t\t// Newline\r\n\t\t\tdx = cornerX;\r\n\t\t\tdy += 14;\r\n\t\t} else if (c == 13) {\r\n\t\t\t// Carriage return\r\n\t\t} else if (c == 32) {\r\n\t\t\t// Space\r\n\t\t\tdx += 6;\r\n\t\t} else {\r\n\t\t\t// Convert out of range characters to heart glyph\r\n\t\t\tif (c < 32 || c > 127) c = 127;\r\n\r\n\t\t\t// Draw the character!\r\n\t\t\tlet idx = c - 32;\r\n\t\t\tlet spx = (idx % 16) * 6;\r\n\t\t\tlet spy = Math.trunc(idx / 16) * 12;\r\n\t\r\n\t\t\tsystemFontSpriteBatcher.drawQuad(\r\n\t\t\t\tdx,     dy,\r\n\t\t\t\tdx + 6, dy + 12,\r\n\t\t\t\t0,\r\n\t\t\t\tspx / BITMAP_WIDTH, spy / BITMAP_HEIGHT,\r\n\t\t\t\t(spx + 6) / BITMAP_WIDTH, (spy + 12) / BITMAP_HEIGHT,\r\n\t\t\t\tcolorInt\r\n\t\t\t);\r\n\t\r\n\t\t\tdx += 6;\r\n\t\t}\r\n\t}\r\n\r\n\tsystemFontSpriteBatcher.end();\r\n\r\n\treturn dy;\r\n}\r\n","import { canvas } from \"../canvas.js\";\r\nimport { deviceIsMobile } from \"../device.js\";\r\nimport { addClassForeignStaticMethods } from \"../foreign.js\";\r\nimport { wrenGlFilterStringToNumber } from \"../gl/api.js\";\r\nimport { mainFramebuffer } from \"../gl/framebuffer.js\";\r\nimport { gl } from \"../gl/gl.js\";\r\nimport { createElement } from \"../html.js\";\r\nimport { layoutOptions, queueLayout, screenHeight, screenWidth } from \"../layout.js\";\r\nimport { systemFontDraw } from \"../system-font.js\";\r\nimport { callHandle_init_2, callHandle_update_0, callHandle_update_2 } from \"../vm-call-handles.js\";\r\nimport { getSlotBytes, wrenAbort, wrenCall, wrenEnsureSlots, wrenGetSlotBool, wrenGetSlotDouble, wrenGetSlotHandle, wrenGetSlotString, wrenGetSlotType, wrenGetVariable, wrenSetSlotBool, wrenSetSlotDouble, wrenSetSlotHandle, wrenSetSlotNull, wrenSetSlotString } from \"../vm.js\";\r\n\r\n// Wren -> JS\r\n\r\nlet title = document.title;\r\n\r\nexport let fps = 60;\r\nexport let quitFromAPI = false;\r\nexport let gameIsReady = false;\r\n/** @type {Promise<any>} */\r\nexport let updatePromise = null;\r\n/** @type {(value: any) => void} */\r\nlet updatePromiseFunction = null;\r\nlet cursor = \"default\";\r\nlet printColor = 0xffffffff;\r\nlet wantFullscreen = false;\r\nlet gettingDOMFullscreen = false;\r\n\r\nexport function prepareUpdatePromise() {\r\n\treturn updatePromise = new Promise((resolve) => {\r\n\t\tupdatePromiseFunction = resolve;\r\n\t});\r\n}\r\n\r\nexport function gameBusyWithDOMFallback() {\r\n\treturn gettingDOMFullscreen;\r\n}\r\n\r\naddClassForeignStaticMethods(\"sock\", \"Game\", {\r\n\t\"title\"() {\r\n\t\twrenSetSlotString(0, title);\r\n\t},\r\n\t\"title=(_)\"() {\r\n\t\tif (wrenGetSlotType(1) !== 6) {\r\n\t\t\twrenAbort(\"title must be a String\");\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tdocument.title = title = wrenGetSlotString(1);\r\n\t},\r\n\t\"layoutChanged_(_,_,_,_,_)\"() {\r\n\t\tif (\r\n\t\t\twrenGetSlotType(1) !== 1\r\n\t\t\t||\r\n\t\t\twrenGetSlotType(2) !== 1\r\n\t\t\t||\r\n\t\t\twrenGetSlotType(3) !== 0\r\n\t\t\t||\r\n\t\t\twrenGetSlotType(4) !== 0\r\n\t\t\t||\r\n\t\t\twrenGetSlotType(5) !== 1\r\n\t\t) {\r\n\t\t\twrenAbort(\"invalid args\");\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tlet width = wrenGetSlotDouble(1);\r\n\t\tlet height = wrenGetSlotDouble(2);\r\n\t\tlet isFixed = wrenGetSlotBool(3);\r\n\t\tlet isPixelPerfect = wrenGetSlotBool(4);\r\n\t\tlet maxScale = wrenGetSlotDouble(5);\r\n\r\n\t\tif (width < 1 || height < 1 || maxScale < 1) {\r\n\t\t\twrenAbort(\"resolution/scale must be positive\");\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tlayoutOptions.pixelScaling = isPixelPerfect;\r\n\t\tlayoutOptions.resolution = isFixed ? [ Math.trunc(width), Math.trunc(height) ] : null;\r\n\t\tlayoutOptions.maxScale = Math.trunc(maxScale);\r\n\r\n\t\tqueueLayout();\r\n\t},\r\n\t\"scaleFilter\"() {\r\n\t\treturn mainFramebuffer.filter ? \"nearest\" : \"linear\";\r\n\t},\r\n\t\"scaleFilter=(_)\"() {\r\n\t\tlet filter = wrenGlFilterStringToNumber(1);\r\n\r\n\t\tif (filter != null) {\r\n\t\t\tmainFramebuffer.setFilter(filter);\r\n\t\t}\r\n\t},\r\n\t\"fullscreenAllowed\"() {\r\n\t\twrenSetSlotBool(0, document.fullscreenEnabled);\r\n\t},\r\n\t\"fullscreen\"() {\r\n\t\twrenSetSlotBool(0, wantFullscreen || document.fullscreenElement != null);\r\n\t},\r\n\t\"setFullscreen_(_)\"() {\r\n\t\tif (wrenGetSlotType(1) !== 0) {\r\n\t\t\twrenAbort(\"fullscreen must be a Bool\");\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tlet fullscreen = wrenGetSlotBool(1);\r\n\r\n\t\tif (fullscreen) {\r\n\t\t\tif (!wantFullscreen && !document.fullscreenElement) {\r\n\t\t\t\t// Check if the browser will even let us use fullscreen at all.\r\n\t\t\t\tif (!document.fullscreenEnabled) {\r\n\t\t\t\t\tconsole.warn(\"fullscreen is blocked by the browser, see Game.fullscreenAllowed\");\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Since fullscreen request may be async, track that we're going to trigger request.\r\n\t\t\t\twantFullscreen = true;\r\n\t\t\t\t\r\n\t\t\t\t// Request fullscreen.\r\n\t\t\t\t// Note that this may fail if the browser doesn't think this was triggered by a user interaction.\r\n\t\t\t\t// (e.g. Safari almost always thinks this, since we don't handle inputs directly within input callbacks)\r\n\t\t\t\tdocument.body.requestFullscreen().then(() => {\r\n\t\t\t\t\twantFullscreen = false;\r\n\t\t\t\t}, () => {\r\n\t\t\t\t\tgettingDOMFullscreen = true;\r\n\r\n\t\t\t\t\t// TODO this message needs to be localised.\r\n\t\t\t\t\tlet input = deviceIsMobile ? \"tap\" : \"press any mouse or keyboard button\";\r\n\t\t\t\t\tlet message = `Please ${input} to enter fullscreen.`;\r\n\r\n\t\t\t\t\tlet dialog = createElement(\"div\", { class: \"overlay\" }, [\r\n\t\t\t\t\t\tcreateElement(\"img\", { style: \"width: 185px; margin-bottom: 14px;\", class: \"pixel\", alt: \"icons of a mouse, keyboard, and fullscreen warning\", src: \"data:image/gif;base64,R0lGODdhJQAJAJAAAAAAAP///yH5BAkKAAAALAAAAAAlAAkAAAIzjB+ge2zrEFIJVHgxpJvW311Z6H2g1Wkph5rSuMFqY43ySrZenKOsGrP1gJGXMfQoIY0FADs=\" }),\r\n\t\t\t\t\t\tmessage,\r\n\t\t\t\t\t]);\r\n\r\n\t\t\t\t\t\r\n\t\t\t\t\tlet triggerFullscreen = () => {\r\n\t\t\t\t\t\tdocument.body.requestFullscreen().catch((error) => {\r\n\t\t\t\t\t\t\tconsole.warn(\"DOM fullscreen fallback failed\", error);\r\n\t\t\t\t\t\t}).then(() => {\r\n\t\t\t\t\t\t\twantFullscreen = false;\r\n\t\t\t\t\t\t\tgettingDOMFullscreen = false;\r\n\r\n\t\t\t\t\t\t\tdialog.remove();\r\n\r\n\t\t\t\t\t\t\tremoveEventListener(\"keydown\", triggerFullscreen);\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t\tdialog.onclick = triggerFullscreen;\r\n\t\t\t\t\taddEventListener(\"keydown\", triggerFullscreen);\r\n\r\n\t\t\t\t\tdocument.body.append(dialog);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\twantFullscreen = false;\r\n\t\t\tif (document.fullscreenElement) {\r\n\t\t\t\tdocument.exitFullscreen();\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\t\"fps\"() {\r\n\t\tif (fps < 0) {\r\n\t\t\twrenSetSlotNull(0);\r\n\t\t} else {\r\n\t\t\twrenSetSlotDouble(0, fps);\r\n\t\t}\r\n\t},\r\n\t\"fps=(_)\"() {\r\n\t\tlet type = wrenGetSlotType(1);\r\n\t\tif (type === 5) {\r\n\t\t\tfps = -1;\r\n\t\t} else if (type === 1) {\r\n\t\t\tlet value = wrenGetSlotDouble(1);\r\n\t\t\tif (fps <= 0) {\r\n\t\t\t\twrenAbort(\"fps must be positive\");\r\n\t\t\t} else {\r\n\t\t\t\tfps = value;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\twrenAbort(\"fps must be Num or null\");\r\n\t\t}\r\n\t},\r\n\t\"cursor\"() {\r\n\t\twrenSetSlotString(0, cursor);\r\n\t},\r\n\t\"cursor=(_)\"() {\r\n\t\tlet type = wrenGetSlotType(1);\r\n\t\tif (type === 5) {\r\n\t\t\tcursor = \"default\";\r\n\t\t} else if (type === 6) {\r\n\t\t\tlet name = wrenGetSlotString(1);\r\n\t\t\t\r\n\t\t\tif (!cursorSockToCSS.hasOwnProperty(name)) {\r\n\t\t\t\twrenAbort(`invalid cursor type \"${name}\"`);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tcursor = name;\r\n\t\t} else {\r\n\t\t\twrenAbort(\"cursor must be null or a string\");\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tcanvas.style.cursor = cursorSockToCSS[cursor] || cursor;\r\n\t},\r\n\t\"quit()\"() {\r\n\t\tquitFromAPI = true;\r\n\t},\r\n\t\"ready_()\"() {\r\n\t\tgameIsReady = true;\r\n\r\n\t\tif (updatePromiseFunction) {\r\n\t\t\tupdatePromiseFunction();\r\n\t\t\tupdatePromiseFunction = null;\r\n\t\t\tupdatePromise = null;\r\n\t\t}\r\n\t},\r\n\t\"print_(_,_,_)\"() {\r\n\t\tif (wrenGetSlotType(1) !== 6 || wrenGetSlotType(2) !== 1 || wrenGetSlotType(3) !== 1) {\r\n\t\t\twrenAbort(\"invalid args\");\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tlet bytes = getSlotBytes(1);\r\n\t\tlet x = Math.trunc(wrenGetSlotDouble(2));\r\n\t\tlet y = Math.trunc(wrenGetSlotDouble(3));\r\n\r\n\t\tlet resultY = systemFontDraw(bytes, x, y, printColor);\r\n\r\n\t\twrenSetSlotDouble(0, resultY);\r\n\t},\r\n\t\"setPrintColor_(_)\"() {\r\n\t\tif (wrenGetSlotType(1) !== 1) {\r\n\t\t\twrenAbort(\"color must be a Num\");\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tprintColor = wrenGetSlotDouble(1);\r\n\t},\r\n\t\"clear_(_,_,_)\"() {\r\n\t\tfor (let i = 1; i <= 3; i++) {\r\n\t\t\tif (wrenGetSlotType(i) !== 1) {\r\n\t\t\t\twrenAbort(\"colors must be numbers\");\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tlet r = wrenGetSlotDouble(1);\r\n\t\tlet g = wrenGetSlotDouble(2);\r\n\t\tlet b = wrenGetSlotDouble(3);\r\n\r\n\t\tgl.clearColor(r, g, b, 1);\r\n\t\tgl.clear(gl.COLOR_BUFFER_BIT);\r\n\t},\r\n\t\"openURL(_)\"() {\r\n\t\tif (wrenGetSlotType(1) !== 6) {\r\n\t\t\twrenAbort(\"url must be a string\");\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tlet url = wrenGetSlotString(1);\r\n\r\n\t\topen(url, \"_blank\", \"noreferrer\");\r\n\t},\r\n});\r\n\r\n/**\r\n * Mapping from Sock cursor name to CSS cursor name.\r\n * `\"\"` indicates a 1:1 mapping.\r\n * @type {Record<string, string>}\r\n */\r\nlet cursorSockToCSS = {\r\n\t\"default\": \"\",\r\n\t\"pointer\": \"\",\r\n\t\"wait\": \"progress\",\r\n\t\"hidden\": \"none\",\r\n};\r\n\r\n\r\n// JS -> Wren\r\n\r\nlet handle_Game = 0;\r\n\r\nexport function initGameModule() {\r\n\twrenEnsureSlots(1);\r\n\twrenGetVariable(\"sock\", \"Game\", 0);\r\n\thandle_Game = wrenGetSlotHandle(0);\r\n\r\n\tupdateGameModuleResolution(callHandle_init_2);\r\n}\r\n\r\n/**\r\n * @param {number} callHandle\r\n */\r\nfunction updateGameModuleResolution(callHandle) {\r\n\twrenEnsureSlots(3);\r\n\twrenSetSlotHandle(0, handle_Game);\r\n\twrenSetSlotDouble(1, screenWidth);\r\n\twrenSetSlotDouble(2, screenHeight);\r\n\twrenCall(callHandle || callHandle_update_2);\r\n}\r\n\r\nexport function gameUpdate() {\r\n\tgameIsReady = false;\r\n\t\r\n\twrenEnsureSlots(1);\r\n\twrenSetSlotHandle(0, handle_Game);\r\n\treturn wrenCall(callHandle_update_0);\r\n}\r\n","import { addClassForeignStaticMethods } from \"../foreign.js\";\r\nimport { wrenSetSlotDouble } from \"../vm.js\";\r\n\r\n\r\nlet refreshRate = 60;\r\n\r\n/**\r\n * @param {number} rate\r\n */\r\nexport function updateRefreshRate(rate) {\r\n\trefreshRate = rate;\r\n}\r\n\r\naddClassForeignStaticMethods(\"sock\", \"Screen\", {\r\n\t\"width\"() {\r\n\t\twrenSetSlotDouble(0, screen.width);\r\n\t},\r\n\t\"height\"() {\r\n\t\twrenSetSlotDouble(0, screen.height);\r\n\t},\r\n\t\"availableWidth\"() {\r\n\t\twrenSetSlotDouble(0, screen.availWidth);\r\n\t},\r\n\t\"availableHeight\"() {\r\n\t\twrenSetSlotDouble(0, screen.availHeight);\r\n\t},\r\n\t\"refreshRate\"() {\r\n\t\twrenSetSlotDouble(0, refreshRate);\r\n\t},\r\n});\r\n","import { getCameraMatrix } from \"../api/camera.js\";\r\nimport { sockJsGlobal } from \"../globals.js\";\r\nimport { gl } from \"./gl.js\";\r\nimport { PrimitiveBatcher } from \"./primitive-batcher.js\";\r\nimport { bindQuadIndexBuffer } from \"./quad-index-buffer.js\";\r\nimport { Shader } from \"./shader.js\";\r\n\r\nlet shader = new Shader({\r\n\tattributes: {\r\n\t\t\"vertex\": \"vec3\",\r\n\t\t\"color\": \"vec4\",\r\n\t},\r\n\tvaryings: {\r\n\t\t\"v_color\": \"lowp vec4\",\r\n\t},\r\n\tvertUniforms: {\r\n\t\t\"mat\": \"mat3\",\r\n\t},\r\n\tvert: [\r\n\t\t\"v_color = color;\",\r\n\t\t\"vec3 tv = mat * vec3(vertex.x, vertex.y, 1.0);\",\r\n\t\t\"gl_Position = vec4(tv.x, tv.y, vertex.z, 1.0);\",\r\n\t],\r\n\tfrag: \"gl_FragColor = v_color;\",\r\n});\r\n\r\nshader.needsCompilation();\r\n\r\n/**\r\n * Helper for quads in an efficient manner.\r\n */\r\nexport class QuadBatcher extends PrimitiveBatcher {\r\n\t/**\r\n\t * @param {number} x1\r\n\t * @param {number} y1\r\n\t * @param {number} x2\r\n\t * @param {number} y2\r\n\t * @param {number} z\r\n\t * @param {number} c\r\n\t * @param {number[]|null} [tf] A 2x3 transform matrix\r\n\t * @param {number[]|null} [tfo] A 2d transform origin\r\n\t */\r\n\tdrawRect(x1, y1, x2, y2, z, c, tf, tfo) {\r\n\t\tthis.drawQuad(\r\n\t\t\tx1, y1,\r\n\t\t\tx1, y2,\r\n\t\t\tx2, y1,\r\n\t\t\tx2, y2,\r\n\t\t\tz,\r\n\t\t\tc,\r\n\t\t\ttf, tfo\r\n\t\t);\r\n\t}\r\n\r\n\t/**\r\n\t * @param {number} x1\r\n\t * @param {number} y1\r\n\t * @param {number} x2\r\n\t * @param {number} y2\r\n\t * @param {number} x3\r\n\t * @param {number} y3\r\n\t * @param {number} x4\r\n\t * @param {number} y4\r\n\t * @param {number} z\r\n\t * @param {number} c\r\n\t * @param {number[]|null} [tf] A 2x3 transform matrix\r\n\t * @param {number[]|null} [tfo] A 2d transform origin\r\n\t */\r\n\tdrawQuad(x1, y1, x2, y2, x3, y3, x4, y4, z, c, tf, tfo) {\r\n\t\tthis.checkResize(4);\r\n\t\t\r\n\t\tif (tf) {\r\n\t\t\tlet tx1 = x1 * tf[0] + y1 * tf[2] + tf[4];\r\n\t\t\tlet ty1 = x1 * tf[1] + y1 * tf[3] + tf[5];\r\n\t\t\tlet tx2 = x2 * tf[0] + y2 * tf[2] + tf[4];\r\n\t\t\tlet ty2 = x2 * tf[1] + y2 * tf[3] + tf[5];\r\n\t\t\tlet tx3 = x3 * tf[0] + y3 * tf[2] + tf[4];\r\n\t\t\tlet ty3 = x3 * tf[1] + y3 * tf[3] + tf[5];\r\n\t\t\tlet tx4 = x4 * tf[0] + y4 * tf[2] + tf[4];\r\n\t\t\tlet ty4 = x4 * tf[1] + y4 * tf[3] + tf[5];\r\n\r\n\t\t\tlet tfox = tfo ? (x1 + tfo[0]) : ((x1 + x2) / 2);\r\n\t\t\tlet tfoy = tfo ? (y1 + tfo[1]) : ((y1 + y2) / 2);\r\n\t\t\tlet dx = tfox - tf[0] * tfox - tf[2] * tfoy;\r\n\t\t\tlet dy = tfoy - tf[1] * tfox - tf[3] * tfoy;\r\n\r\n\t\t\tthis.addVertex(tx1 + dx, ty1 + dy, z, c);\r\n\t\t\tthis.addVertex(tx2 + dx, ty2 + dy, z, c);\r\n\t\t\tthis.addVertex(tx3 + dx, ty3 + dy, z, c);\r\n\t\t\tthis.addVertex(tx4 + dx, ty4 + dy, z, c);\r\n\t\t} else {\r\n\t\t\tthis.addVertex(x1, y1, z, c);\r\n\t\t\tthis.addVertex(x2, y2, z, c);\r\n\t\t\tthis.addVertex(x3, y3, z, c);\r\n\t\t\tthis.addVertex(x4, y4, z, c);\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * @protected\r\n\t */\r\n\tdrawBatch() {\r\n\t\tif (this._vertexCount < 0) throw Error(\"have not called begin()\");\r\n\r\n\t\tif (this._vertexCount > 0) {\r\n\t\t\t// Draw!\r\n\t\t\tshader.use();\r\n\t\r\n\t\t\t// Put vertex data.\r\n\t\t\tgl.bindBuffer(gl.ARRAY_BUFFER, this._vertexBuffer);\r\n\r\n\t\t\tif (this._vertexCount > this._vertexBufferCapacity) {\r\n\t\t\t\t// Re-allocate vertex data.\r\n\t\t\t\tthis._vertexBufferCapacity = this._capacity;\r\n\t\t\t\tgl.bufferData(gl.ARRAY_BUFFER, this._array, gl.DYNAMIC_DRAW);\r\n\t\t\t} else {\r\n\t\t\t\t// Put in sub-data.\r\n\t\t\t\tgl.bufferSubData(gl.ARRAY_BUFFER, 0, this._ints.subarray(0, this._vertexCount * 6));\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// Configure/enable attributes.\r\n\t\t\tlet vertLocation = shader.attributes.vertex;\r\n\t\t\tlet colorlocation = shader.attributes.color;\r\n\r\n\t\t\tgl.vertexAttribPointer(\r\n\t\t\t\tvertLocation,\r\n\t\t\t\t3,\r\n\t\t\t\tgl.FLOAT,\r\n\t\t\t\tfalse,\r\n\t\t\t\t16,\r\n\t\t\t\t0,\r\n\t\t\t);\r\n\t\t\tgl.enableVertexAttribArray(vertLocation);\r\n\t\t\t\r\n\t\t\tgl.vertexAttribPointer(\r\n\t\t\t\tcolorlocation,\r\n\t\t\t\t4,\r\n\t\t\t\tgl.UNSIGNED_BYTE,\r\n\t\t\t\ttrue,\r\n\t\t\t\t16,\r\n\t\t\t\t12,\r\n\t\t\t);\r\n\t\t\tgl.enableVertexAttribArray(colorlocation);\r\n\r\n\t\t\t// Set shader matrix.\r\n\t\t\tshader.setUniformMatrix3(\"mat\", getCameraMatrix());\r\n\t\t\r\n\t\t\t// Setup index buffer.\r\n\t\t\tlet indexCount = this._vertexCount * 1.5;\r\n\t\t\t\r\n\t\t\tbindQuadIndexBuffer(indexCount);\r\n\r\n\t\t\tsockJsGlobal.quadInfo = `vertexCount=${this._vertexCount} indexCount=${indexCount}`\r\n\r\n\t\t\t// Draw!\r\n\t\t\tgl.drawElements(gl.TRIANGLES, indexCount, gl.UNSIGNED_SHORT, 0);\r\n\r\n\t\t\t// Clean up.\r\n\t\t\tgl.disableVertexAttribArray(vertLocation);\r\n\t\t\tgl.disableVertexAttribArray(colorlocation);\r\n\t\t}\r\n\r\n\t\t// Reset state.\r\n\t\tthis._vertexCount = -1;\r\n\t}\r\n}\r\n","import { Color } from \"../color.js\";\r\nimport { gl } from \"./gl.js\";\r\n\r\n/**\r\n * Batches primitive vertices (position + color) into a single growing `ArrayBuffer`.\r\n * @abstract\r\n */\r\nexport class PrimitiveBatcher {\r\n\tconstructor() {\r\n\t\t/**\r\n\t\t * Number of vertices we can fit.\r\n\t\t * @protected\r\n\t\t */\r\n\t\tthis._capacity = 128;\r\n\t\t/**\r\n\t\t * Vertex data array.\r\n\t\t * ```\r\n\t\t *  x     y     z     rgba  u     v\r\n\t\t * [----][----][----][----][----][----]\r\n\t\t * ```\r\n\t\t * @protected\r\n\t\t */\r\n\t\tthis._array = new ArrayBuffer(this._capacity * 16);\r\n\t\t/**\r\n\t\t * @protected\r\n\t\t */\r\n\t\tthis._floats = new Float32Array(this._array);\r\n\t\t/**\r\n\t\t * @protected\r\n\t\t */\r\n\t\tthis._bytes = new Uint8Array(this._array);\r\n\t\t/**\r\n\t\t * @protected\r\n\t\t */\r\n\t\tthis._ints = new Uint32Array(this._array);\r\n\t\t/**\r\n\t\t * @protected\r\n\t\t */\r\n\t\tthis._vertexCount = -1;\r\n\t\t/**\r\n\t\t * @protected\r\n\t\t */\r\n\t\tthis._vertexBuffer = gl.createBuffer();\r\n\t\t/**\r\n\t\t * The number of vertices we can fit in the vertex buffer.\r\n\t\t * @protected\r\n\t\t */\r\n\t\tthis._vertexBufferCapacity = 0;\r\n\t}\r\n\r\n\tfree() {\r\n\t\tgl.deleteBuffer(this._vertexBuffer);\r\n\t\tthis._array = this._bytes = this._floats = this._ints = null;\r\n\t}\r\n\t\r\n\t/**\r\n\t * @protected\r\n\t */\r\n\tdrawBatch() {\r\n\t}\r\n\r\n\t/**\r\n\t * @param {number} vertexCount\r\n\t * @protected\r\n\t */\r\n\tcheckResize(vertexCount) {\r\n\t\tif (this._vertexCount + vertexCount > this._capacity) {\r\n\t\t\tconsole.log(\"expand vertex buffer\");\r\n\r\n\t\t\t// Grow capacity.\r\n\t\t\tthis._capacity *= 2;\r\n\r\n\t\t\tif (this._capacity >= 0xfffff) throw Error(`exceeded max batch capacity of ${0xfffff}, did you forget to call end()?`);\r\n\r\n\t\t\t// Create new buffer.\r\n\t\t\tthis._array = new ArrayBuffer(this._capacity * 16);\r\n\r\n\t\t\t// Copy data from old buffer.\r\n\t\t\tlet newInts = new Uint32Array(this._array);\r\n\t\t\tnewInts.set(this._ints);\r\n\r\n\t\t\t// Create new views.\r\n\t\t\tthis._floats = new Float32Array(this._array);\r\n\t\t\tthis._bytes = new Uint8Array(this._array);\r\n\t\t\tthis._ints = newInts;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Add a single vertex.\r\n\t * @param {number} x\r\n\t * @param {number} y\r\n\t * @param {number} z\r\n\t * @param {number} color\r\n\t * @protected\r\n\t */\r\n\taddVertex(x, y, z, color) {\r\n\t\tlet i4 = this._vertexCount * 4;\r\n\r\n\t\tthis._floats[i4    ] = x;\r\n\t\tthis._floats[i4 + 1] = y;\r\n\t\tthis._floats[i4 + 2] = z;\r\n\r\n\t\tthis._ints[i4 + 3] = color;\r\n\r\n\t\tthis._vertexCount++;\r\n\t}\r\n\r\n\tinBatch() {\r\n\t\treturn this._vertexCount >= 0;\r\n\t}\r\n\r\n\tbegin() {\r\n\t\tif (this.inBatch()) throw Error(\"already called begin()\");\r\n\t\tthis._vertexCount = 0;\r\n\t}\r\n\r\n\tend() {\r\n\t\tif (!this.inBatch()) throw Error(\"not yet called begin()\");\r\n\r\n\t\tif (this._vertexCount > 0) {\r\n\t\t\tthis.drawBatch();\r\n\t\t}\r\n\r\n\t\tthis._vertexCount = -1;\r\n\t}\r\n}\r\n","import { addClassForeignStaticMethods } from \"../foreign.js\";\r\nimport { QuadBatcher } from \"../gl/quad-batcher.js\";\r\nimport { wrenAbort, wrenGetSlotDouble, wrenGetSlotType } from \"../vm.js\";\r\n\r\n/**\r\n * @type {QuadBatcher}\r\n */\r\nlet batcher = null;\r\n\r\naddClassForeignStaticMethods(\"sock\", \"Quad\", {\r\n\t\"beginBatch()\"() {\r\n\t\tif (!batcher) batcher = new QuadBatcher();\r\n\t\tif (batcher.inBatch()) {\r\n\t\t\twrenAbort(\"batch already started\");\r\n\t\t} else {\r\n\t\t\tbatcher.begin();\r\n\t\t}\r\n\t},\r\n\t\"endBatch()\"() {\r\n\t\tif (!batcher) batcher = new QuadBatcher();\r\n\t\tif (batcher.inBatch()) {\r\n\t\t\tbatcher.end();\r\n\t\t} else {\r\n\t\t\twrenAbort(\"batch not yet started\");\r\n\t\t}\r\n\t},\r\n\t\"draw(_,_,_,_,_)\"() {\r\n\t\tfor (let i = 1; i <= 5; i++) {\r\n\t\t\tif (wrenGetSlotType(i) !== 1) {\r\n\t\t\t\twrenAbort(\"args must be Nums\");\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tlet x = wrenGetSlotDouble(1);\r\n\t\tlet y = wrenGetSlotDouble(2);\r\n\t\tlet w = wrenGetSlotDouble(3);\r\n\t\tlet h = wrenGetSlotDouble(4);\r\n\t\tlet color = wrenGetSlotDouble(5);\r\n\r\n\t\tif (!batcher) batcher = new QuadBatcher();\r\n\r\n\t\tlet singleBatch = !batcher.inBatch();\r\n\r\n\t\tif (singleBatch) batcher.begin();\r\n\r\n\t\tbatcher.drawRect(x, y, x + w, y + h, 0, color);\r\n\r\n\t\tif (singleBatch) batcher.end();\r\n\t},\r\n\t\"draw(_,_,_,_,_,_,_,_,_)\"() {\r\n\t\tfor (let i = 1; i <= 9; i++) {\r\n\t\t\tif (wrenGetSlotType(i) !== 1) {\r\n\t\t\t\twrenAbort(\"args must be Nums\");\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tlet x1 = wrenGetSlotDouble(1);\r\n\t\tlet y1 = wrenGetSlotDouble(2);\r\n\t\tlet x2 = wrenGetSlotDouble(3);\r\n\t\tlet y2 = wrenGetSlotDouble(4);\r\n\t\tlet x3 = wrenGetSlotDouble(5);\r\n\t\tlet y3 = wrenGetSlotDouble(6);\r\n\t\tlet x4 = wrenGetSlotDouble(7);\r\n\t\tlet y4 = wrenGetSlotDouble(8);\r\n\t\tlet color = wrenGetSlotDouble(9);\r\n\r\n\t\tif (!batcher) batcher = new QuadBatcher();\r\n\r\n\t\tlet singleBatch = !batcher.inBatch();\r\n\r\n\t\tif (singleBatch) batcher.begin();\r\n\r\n\t\tbatcher.drawQuad(x1, y1, x2, y2, x4, y4, x3, y3, 0, color);\r\n\r\n\t\tif (singleBatch) batcher.end();\r\n\t},\r\n});\r\n","\r\n// The actual solution would be to use the KeyBoard API.\r\n// But this will never be supported by Firefox, and is not currently by Safari.\r\n//  https://mozilla.github.io/standards-positions/#keyboard-map\r\n\r\n// Out solution is to make guesses of common layouts based on\r\n// keyboard event code vs key differences.\r\n\r\nconst QWERTY = \"QWERTY\";\r\nconst QWERTZ = \"QWERTZ\";\r\nconst AZERTY = \"AZERTY\";\r\n\r\n/**\r\n * @type {\"QWERTY\" | \"QWERTZ\" | \"AZERTY\"}\r\n */\r\nexport let keyboardLayout = QWERTY;\r\n\r\n// Make a first guess on the layout based on language.\r\nlet lang = navigator.language || \"en-US\";\r\nif (lang.includes(\"fr\")) {\r\n\tkeyboardLayout = AZERTY;\r\n}\r\n\r\n// Update layout as we get more information from key presses.\r\nlet layoutChecks = 0;\r\n/**\r\n * @param {KeyboardEvent} event\r\n */\r\nlet onKeydown = (event) => {\r\n\tlet code = event.code;\r\n\tlet key = event.key.toLowerCase();\r\n\r\n\tif (code === \"KeyQ\") {\r\n\t\tlayoutChecks++;\r\n\r\n\t\tif (key === \"a\") {\r\n\t\t\tkeyboardLayout = AZERTY;\r\n\t\t\tconsole.log(\"layout is \" + keyboardLayout + \"?\");\r\n\t\t}\r\n\t} else if (code === \"KeyA\") {\r\n\t\tlayoutChecks++;\r\n\r\n\t\tif (key === \"q\") {\r\n\t\t\tkeyboardLayout = AZERTY;\r\n\t\t\tconsole.log(\"layout is \" + keyboardLayout + \"?\");\r\n\t\t}\r\n\t} else if (code === \"KeyW\") {\r\n\t\tlayoutChecks++;\r\n\r\n\t\tif (key === \"z\") {\r\n\t\t\tkeyboardLayout = AZERTY;\r\n\t\t\tconsole.log(\"layout is \" + keyboardLayout + \"?\");\r\n\t\t}\r\n\t} else if (code === \"KeyZ\") {\r\n\t\tlayoutChecks++;\r\n\r\n\t\tif (key === \"w\") {\r\n\t\t\tkeyboardLayout = AZERTY;\r\n\t\t\tconsole.log(\"layout is \" + keyboardLayout + \"?\");\r\n\t\t}\r\n\t} else if (code === \"KeyY\") {\r\n\t\tlayoutChecks++;\r\n\r\n\t\tif (key === \"z\") {\r\n\t\t\tkeyboardLayout = QWERTZ;\r\n\t\t\tconsole.log(\"layout is \" + keyboardLayout + \"?\");\r\n\t\t}\r\n\t} else if (code === \"KeyZ\") {\r\n\t\tlayoutChecks++;\r\n\r\n\t\tif (key === \"y\") {\r\n\t\t\tkeyboardLayout = QWERTZ;\r\n\t\t\tconsole.log(\"layout is \" + keyboardLayout + \"?\");\r\n\t\t}\r\n\t}\r\n\r\n\tif (layoutChecks >= 3) {\r\n\t\tremoveEventListener(\"keydown\", onKeydown);\r\n\t}\r\n};\r\n\r\naddEventListener(\"keydown\", onKeydown, { passive: true });\r\n","import { canvas } from \"../canvas.js\";\r\nimport { deviceIsMobile } from \"../device.js\";\r\nimport { addClassForeignStaticMethods } from \"../foreign.js\";\r\nimport { createElement } from \"../html.js\";\r\nimport { keyboardLayout } from \"../keyboard-layout.js\";\r\nimport { releaseLayoutContainer, useLayoutContainer, viewportOffsetX, viewportOffsetY, viewportScale } from \"../layout.js\";\r\nimport { callHandle_updateMouse_3, callHandle_updateTouch_5, callHandle_update_2 } from \"../vm-call-handles.js\";\r\nimport { wrenAbort, wrenCall, wrenEnsureSlots, wrenGetSlotHandle, wrenGetSlotString, wrenGetSlotType, wrenGetVariable, wrenSetSlotBool, wrenSetSlotDouble, wrenSetSlotHandle, wrenSetSlotNull, wrenSetSlotRange, wrenSetSlotString } from \"../vm.js\";\r\n\r\nlet textInput = createElement(\"input\");\r\nlet textForm = createElement(\"form\", {}, [\r\n\ttextInput,\r\n\t// createElement(\"button\", { type: \"button\" }, \"Submit\"),\r\n]);\r\ntextInput.placeholder = \"Text\";\r\n\r\nfunction removeTextInput() {\r\n\tif (textForm.parentNode) {\r\n\t\ttextForm.remove();\r\n\t\treleaseLayoutContainer();\r\n\t}\r\n}\r\n\r\n// Stop text input when user presses \"enter\".\r\n// The form submission method is preffered over listening for \"enter\" key,\r\n// as IMEs may fire \"enter\" when composition ends.\r\n/**\r\n * @param {Event} event \r\n */\r\ntextForm.onsubmit = (event) => {\r\n\tevent.preventDefault();\r\n\t\r\n\tremoveTextInput();\r\n};\r\n\r\n// Stop text input when unfocussed.\r\ntextInput.onblur = () => {\r\n\t// Need to use setTimeout() to prevent weird timing issues\r\n\t// related to removing elements during onblur.\r\n\tsetTimeout(() => {\r\n\t\tif (document.activeElement !== textInput) {\r\n\t\t\tremoveTextInput();\r\n\t\t}\r\n\t}, 1);\r\n};\r\n\r\n// Stop text input when user presses escape.\r\n/**\r\n * @param {KeyboardEvent} event \r\n */\r\ntextInput.onkeydown = (event) => {\r\n\tif (event.code === \"Escape\") {\r\n\t\tremoveTextInput();\r\n\t}\r\n};\r\n\r\naddClassForeignStaticMethods(\"sock\", \"Input\", {\r\n\t\"localize(_)\"() {\r\n\t\tlet idType = wrenGetSlotType(1);\r\n\t\tif (idType === 5) {\r\n\t\t\twrenSetSlotNull(0);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (idType !== 6) {\r\n\t\t\twrenAbort(\"input ID must be a String\");\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tlet id = wrenGetSlotString(1);\r\n\r\n\t\tif (keyboardLayout === \"AZERTY\") {\r\n\t\t\tif (id === \"Q\") {\r\n\t\t\t\tid = \"A\";\r\n\t\t\t} else if (id === \"A\") {\r\n\t\t\t\tid = \"Q\";\r\n\t\t\t} else if (id === \"Z\") {\r\n\t\t\t\tid = \"W\";\r\n\t\t\t} else if (id === \"W\") {\r\n\t\t\t\tid = \"Z\";\r\n\t\t\t} else if (id === \"M\") {\r\n\t\t\t\tid = \",\";\r\n\t\t\t} else if (id === \",\") {\r\n\t\t\t\tid = \";\";\r\n\t\t\t} else if (id === \";\") {\r\n\t\t\t\tid = \"M\";\r\n\t\t\t}\r\n\t\t} else if (keyboardLayout === \"QWERTZ\") {\r\n\t\t\tif (id === \"Z\") {\r\n\t\t\t\tid = \"Y\";\r\n\t\t\t} else if (id === \"Y\") {\r\n\t\t\t\tid = \"Z\";\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\twrenSetSlotString(0, id);\r\n\t},\r\n\t\"textBegin(_)\"() {\r\n\t\tlet argType = wrenGetSlotType(1);\r\n\t\tif (argType === 5) {\r\n\t\t\ttextInput.type = \"text\";\r\n\t\t} else if (argType === 6) {\r\n\t\t\tlet type = wrenGetSlotString(1);\r\n\r\n\t\t\tif (type === \"text\" || type === \"number\" || type === \"password\") {\r\n\t\t\t\ttextInput.type = type;\r\n\t\t\t} else {\r\n\t\t\t\twrenAbort(`invalid text type '${type}'`);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\twrenAbort(\"type must be a String\");\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\ttextForm.className = \"text-form invisible\";\r\n\r\n\t\ttextInput.className = \"text\";\r\n\t\ttextInput.value = \"\";\r\n\r\n\t\tif (!textForm.parentNode) {\r\n\t\t\tuseLayoutContainer().append(textForm);\r\n\t\t}\r\n\r\n\t\tif (!deviceIsMobile) {\r\n\t\t\ttextInput.focus();\r\n\r\n\t\t\tif (document.activeElement === textInput) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// Visible text input fallback. Used for:\r\n\t\t// * Mobile\r\n\t\t// * if browser blocks .focus() (due to being outside event handler)\r\n\t\ttextForm.className = \"text-form\";\r\n\t\ttextForm.onclick = (event) => {\r\n\t\t\tif (event.target === textForm) {\r\n\t\t\t\tremoveTextInput();\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\ttextInput.className = \"text\";\r\n\t},\r\n\t\"textDescription\"() {\r\n\t\twrenSetSlotString(0, textInput.placeholder);\r\n\t},\r\n\t\"textDescription=(_)\"() {\r\n\t\tif (wrenGetSlotType(1) !== 6) {\r\n\t\t\twrenAbort(\"description must be String\");\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\ttextInput.placeholder = wrenGetSlotString(1);\r\n\t},\r\n\t\"textIsActive\"() {\r\n\t\twrenSetSlotBool(0, document.activeElement === textInput);\r\n\t},\r\n\t\"textSelection\"() {\r\n\t\tif (document.activeElement === textInput) {\r\n\t\t\tlet start = textInput.selectionStart;\r\n\t\t\tlet end = textInput.selectionEnd;\r\n\r\n\t\t\tif (textInput.selectionDirection === \"backward\") {\r\n\t\t\t\tlet tmp = start;\r\n\t\t\t\tstart = end;\r\n\t\t\t\tend = tmp;\r\n\t\t\t}\r\n\r\n\t\t\twrenSetSlotRange(0, start, end, 1, true);\r\n\t\t} else {\r\n\t\t\twrenSetSlotRange(0, 0, 0, 1, true);\r\n\t\t}\r\n\t},\r\n\t\"textString\"() {\r\n\t\twrenSetSlotString(0, textInput.value);\r\n\t},\r\n})\r\n\r\nlet handle_Input = 0;\r\n\r\n/**\r\n * @type {Set<string>}\r\n */\r\nlet queuedInputs = new Set();\r\n\r\n/**\r\n * Record the current and previous value for each input: `[curr, prev, frame]`.\r\n * @type {Record<string, number>}\r\n */\r\nlet inputTable = Object.create(null);\r\n\r\nlet mouseX = 0, mouseY = 0, mouseExactX = 0, mouseExactY = 0, mouseRawX = 0, mouseRawY = 0, mouseWheel = 0;\r\n\r\nexport function initInputModule() {\r\n\twrenEnsureSlots(1);\r\n\twrenGetVariable(\"sock\", \"Input\", 0);\r\n\thandle_Input = wrenGetSlotHandle(0);\r\n\r\n\t// Pass in initial mouse state.\r\n\trecalculateAndUpdateMousePosition();\r\n}\r\n\r\nexport function recalculateAndUpdateMousePosition() {\r\n\trecalculateMousePosition();\r\n\ttransferCurrentMousePosition();\r\n}\r\n\r\nfunction transferCurrentMousePosition() {\r\n\twrenEnsureSlots(4);\r\n\twrenSetSlotHandle(0, handle_Input);\r\n\twrenSetSlotDouble(1, mouseX);\r\n\twrenSetSlotDouble(2, mouseY);\r\n\twrenSetSlotDouble(3, mouseWheel);\r\n\twrenCall(callHandle_updateMouse_3);\r\n}\r\n\r\nexport function updateInputModule() {\r\n\t// Read gamepads.\r\n\t// May not be available, requires HTTPS.\r\n\tif (navigator.getGamepads) {\r\n\t\tfor (let gp of navigator.getGamepads()) {\r\n\t\t\tif (gp != null) {\r\n\t\t\t\tlet buttons = gp.buttons;\r\n\t\t\t\tlet axes = gp.axes;\r\n\t\r\n\t\t\t\tupdateInputValue(\"FaceDown\", buttons[0].value);\r\n\t\t\t\tupdateInputValue(\"FaceRight\", buttons[1].value);\r\n\t\t\t\tupdateInputValue(\"FaceLeft\", buttons[2].value);\r\n\t\t\t\tupdateInputValue(\"FaceUp\", buttons[3].value);\r\n\t\t\t\tupdateInputValue(\"LeftBumper\", buttons[4].value);\r\n\t\t\t\tupdateInputValue(\"RightBumper\", buttons[5].value);\r\n\t\t\t\tupdateInputValue(\"LeftTrigger\", buttons[6].value);\r\n\t\t\t\tupdateInputValue(\"RightTrigger\", buttons[7].value);\r\n\t\t\t\tupdateInputValue(\"Select\", buttons[8].value);\r\n\t\t\t\tupdateInputValue(\"Start\", buttons[9].value);\r\n\t\t\t\tupdateInputValue(\"LeftStick\", buttons[10].value);\r\n\t\t\t\tupdateInputValue(\"RightStick\", buttons[11].value);\r\n\t\t\t\tupdateInputValue(\"DPadUp\", buttons[12].value);\r\n\t\t\t\tupdateInputValue(\"DPadDown\", buttons[13].value);\r\n\t\t\t\tupdateInputValue(\"DPadLeft\", buttons[14].value);\r\n\t\t\t\tupdateInputValue(\"DPadRight\", buttons[15].value);\r\n\t\t\t\tupdateInputValue(\"Guide\", buttons[16].value);\r\n\t\r\n\t\t\t\tupdateInputValue1D(\"LeftStickLeft\", \"LeftStickRight\", axes[0]);\r\n\t\t\t\tupdateInputValue1D(\"LeftStickUp\", \"LeftStickDown\", axes[1]);\r\n\t\t\t\tupdateInputValue1D(\"RightStickLeft\", \"RightStickRight\", axes[2]);\r\n\t\t\t\tupdateInputValue1D(\"RightStickUp\", \"RightStickDown\", axes[3]);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t// Pass state changes to Wren.\r\n\t// Mouse\r\n\ttransferCurrentMousePosition();\r\n\r\n\t// Inputs\r\n\tfor (let inputID of queuedInputs) {\r\n\t\twrenEnsureSlots(3);\r\n\t\twrenSetSlotHandle(0, handle_Input);\r\n\t\twrenSetSlotString(1, inputID);\r\n\t\twrenSetSlotDouble(2, inputTable[inputID]);\r\n\t\twrenCall(callHandle_update_2);\r\n\t}\r\n\r\n\tqueuedInputs.clear();\r\n\tmouseWheel = 0;\r\n}\r\n\r\n/**\r\n * @param {string} name\r\n * @param {number} value 0..1\r\n */\r\nfunction updateInputValue(name, value) {\r\n\tif (value !== inputTable[name]) {\r\n\t\tinputTable[name] = value;\r\n\t\tqueuedInputs.add(name);\r\n\t}\r\n}\r\n\r\n/**\r\n * @param {string} nameNegative\r\n * @param {string} namePositive\r\n * @param {number} value -1..1\r\n */\r\nfunction updateInputValue1D(nameNegative, namePositive, value) {\r\n\tupdateInputValue(nameNegative, value < 0 ? -value : 0);\r\n\tupdateInputValue(namePositive, value > 0 ?  value : 0);\r\n}\r\n\r\n/**\r\n * @param {string} name\r\n * @param {number} value 0..1\r\n */\r\nfunction updateInputValueWithNativeName(name, value) {\r\n\tupdateInputValue(INPUT_NAME_MAP[name] || name, value);\r\n}\r\n\r\n\r\n/**\r\n * One-to-one mapping from InputID to native input name.\r\n * @type {Record<string, string>}\r\n */\r\nconst INPUT_NAME_MAP = Object.assign(Object.create(null), {\r\n\t\"Backquote\": \"`\",\r\n\t\"Minus\": \"-\",\r\n\t\"Equal\": \"=\",\r\n\t\"Comma\": \",\",\r\n\t\"Period\": \".\",\r\n\t\"Slash\": \"/\",\r\n\t\"Semicolon\": \";\",\r\n\t\"Quote\": \"'\",\r\n\t\"BracketLeft\": \"[\",\r\n\t\"BracketRight\": \"]\",\r\n\t\"Backslash\": \"\\\\\",\r\n});\r\n\r\nfor (let i = 0; i <= 25; i++) {\r\n\tlet letter = String.fromCharCode(65 + i);\r\n\tINPUT_NAME_MAP[\"Key\" + letter] = letter;\r\n}\r\n\r\nfor (let i = 0; i <= 9; i++) {\r\n\tINPUT_NAME_MAP[\"Digit\" + i] = String(i);\r\n}\r\n\r\n\r\n// === GLOBAL EVENT LISTENERS ===\r\n\r\naddEventListener(\"keydown\", (event) => {\r\n\tif (event.repeat) return;\r\n\tupdateInputValueWithNativeName(event.code, 1);\r\n}, { passive: true });\r\n\r\naddEventListener(\"keyup\", (event) => {\r\n\tupdateInputValueWithNativeName(event.code, 0);\r\n}, { passive: true });\r\n\r\naddEventListener(\"mousemove\", (event) => {\r\n\tupdateMousePosition(event.x, event.y);\r\n});\r\n\r\naddEventListener(\"wheel\", (event) => {\r\n\tevent.preventDefault();\r\n\tevent.stopPropagation();\r\n\tmouseWheel += event.deltaY;\r\n\tupdateInputValue1D(\"MouseWheelUp\", \"MouseWheelDown\", Math.sign(event.deltaY));\r\n}, { passive: false });\r\n\r\naddEventListener(\"mousedown\", (event) => {\r\n\tupdateMouseButton(event.button, 1);\r\n});\r\n\r\naddEventListener(\"mouseup\", (event) => {\r\n\tupdateMouseButton(event.button, 0);\r\n});\r\n\r\ncanvas.addEventListener(\"contextmenu\", (event) => {\r\n\tevent.preventDefault();\r\n});\r\n\r\ncanvas.addEventListener(\"touchstart\", (event) => {\r\n\tevent.preventDefault();\r\n\r\n\tupdateTouches(event.changedTouches, true);\r\n\r\n\t// Emulate mouse with touch.\r\n\tif (event.changedTouches.length === event.touches.length) {\r\n\t\tlet touch = event.changedTouches[0];\r\n\t\tupdateInputValue(\"MouseLeft\", 1);\r\n\t\tupdateMousePosition(touch.clientX, touch.clientY);\r\n\t}\r\n}, { passive: false });\r\n\r\ncanvas.addEventListener(\"touchmove\", (event) => {\r\n\tevent.preventDefault();\r\n\r\n\tupdateTouches(event.changedTouches, true);\r\n\r\n\t// Emulate mouse with touch.\r\n\tlet touch = event.changedTouches[0];\r\n\tupdateMousePosition(touch.clientX, touch.clientY);\r\n}, { passive: false });\r\n\r\ncanvas.addEventListener(\"touchend\", (event) => {\r\n\tevent.preventDefault();\r\n\r\n\tupdateTouches(event.changedTouches, false);\r\n\r\n\t// Emulate mouse with touch.\r\n\tif (event.touches.length === 0) {\r\n\t\tupdateInputValue(\"MouseLeft\", 0);\r\n\t}\r\n}, { passive: false });\r\n\r\n/**\r\n * \r\n * @param {TouchList} touches\r\n * @param {boolean} isDown\r\n */\r\nfunction updateTouches(touches, isDown) {\r\n\tfor (let i = 0; i < touches.length; i++) {\r\n\t\tlet touch = touches[i];\r\n\r\n\t\tlet id = touch.identifier;\r\n\t\tlet x = (touch.clientX - viewportOffsetX) / viewportScale;\r\n\t\tlet y = (touch.clientY - viewportOffsetY) / viewportScale;\r\n\t\tlet force = touch.force;\r\n\t\tif (force === 0) force = (isDown ? 1 : 0);\r\n\r\n\t\twrenEnsureSlots(6);\r\n\t\twrenSetSlotHandle(0, handle_Input);\r\n\t\twrenSetSlotDouble(1, id);\r\n\t\twrenSetSlotBool(2, isDown);\r\n\t\twrenSetSlotDouble(3, force);\r\n\t\twrenSetSlotDouble(4, x);\r\n\t\twrenSetSlotDouble(5, y);\r\n\t\twrenCall(callHandle_updateTouch_5);\r\n\t}\r\n}\r\n\r\n/**\r\n * @param {number} x\r\n * @param {number} y\r\n */\r\nfunction updateMousePosition(x, y) {\r\n\tmouseRawX = x;\r\n\tmouseRawY = y;\r\n\trecalculateMousePosition();\r\n}\r\n\r\nfunction recalculateMousePosition() {\r\n\tmouseExactX = (mouseRawX - viewportOffsetX) / viewportScale;\r\n\tmouseExactY = (mouseRawY - viewportOffsetY) / viewportScale;\r\n\tmouseX = Math.floor(mouseExactX);\r\n\tmouseY = Math.floor(mouseExactY);\r\n}\r\n\r\n/**\r\n * @param {number} button\r\n * @param {number} value\r\n */\r\nfunction updateMouseButton(button, value) {\r\n\tlet name;\r\n\tif (button === 0) { name = \"Left\"; }\r\n\telse if (button === 1) { name = \"Middle\"; }\r\n\telse if (button === 2) { name = \"Right\"; }\r\n\tupdateInputValue(\"Mouse\" + (name || button), value);\r\n}\r\n\r\naddEventListener(\"gamepadconnected\", (event) => {\r\n\t// Need to add this event listener for `navigator.getGamepads()` to work.\r\n\tconsole.info(\"Gamepad: \" + event.gamepad.id);\r\n});\r\n\r\n","\r\n/**\r\n * @param {string} s\r\n * @returns {any}\r\n */\r\nexport function wrenJSONToJS(s) {\r\n\treturn JSON.parse(s, (key, value) => {\r\n\t\tif (Array.isArray(value) && value.length === 2 && typeof value[0] === \"string\" && value[0][0] === \"\") {\r\n\t\t\tlet type = value[0].slice(1);\r\n\t\t\tvalue = value[1];\r\n\r\n\t\t\tif (type === \"Num\") {\r\n\t\t\t\tif (value === \"infinity\") return Infinity;\r\n\t\t\t\tif (value === \"nan\") return NaN;\r\n\t\t\t\treturn Number(value);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif (type === \"Range\") {\r\n\t\t\t\treturn {\r\n\t\t\t\t\tfrom: value[0],\r\n\t\t\t\t\tto: value[1],\r\n\t\t\t\t\tstep: value[2],\r\n\t\t\t\t\tisInclusive: value[3],\r\n\t\t\t\t};\r\n\t\t\t}\r\n\r\n\t\t\tif (type === \"Map\") {\r\n\t\t\t\tlet map = new Map();\r\n\t\t\t\tfor (let i = 1; i < value.length; i += 2) {\r\n\t\t\t\t\tmap.set(value[i - 1], value[i]);\r\n\t\t\t\t}\r\n\t\t\t\treturn map;\r\n\t\t\t}\r\n\r\n\t\t\tif (type === \"Vec\") {\r\n\t\t\t\treturn { x: value[0], y: value[1] };\r\n\t\t\t}\r\n\r\n\t\t\tif (type === \"Color\") {\r\n\t\t\t\tlet u8 = new Uint8Array(new Uint32Array([ value ]).buffer);\r\n\t\t\t\treturn { r: u8[0], g: u8[1], b: u8[2], a: u8[3] };\r\n\t\t\t}\r\n\r\n\t\t\tif (type === \"Buffer\") {\r\n\t\t\t\tlet b = atob(value);\r\n\t\t\t\tlet array = new Uint8Array(b.length);\r\n\t\t\t\tfor (let i = 0; i < b.length; i++) array[i] = b.charCodeAt(i);\r\n\t\t\t\treturn array;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// console.warn(`unhandled type \"${type}\"`);\r\n\t\t}\r\n\r\n\t\treturn value;\r\n\t});\r\n}\r\n\r\n/**\r\n * Converts Sock Wren JSON object to JavaScript, in place.\r\n * @param {any} obj\r\n * @returns {any}\r\n */\r\nfunction wrenObjectToJS(obj) {\r\n\tif (Array.isArray(obj)) {\r\n\t\t// Handle custom serialization.\r\n\t\tif (obj.length === 2 && typeof obj[0] === \"string\" && obj[0][0] === \"\") {\r\n\t\t\tlet type = obj[0].slice(1);\r\n\t\t\tobj = obj[1];\r\n\r\n\t\t\tif (type === \"Vec\") {\r\n\t\t\t\treturn { x: obj[0], y: obj[1] };\r\n\t\t\t}\r\n\t\t\tif (type === \"Color\") {\r\n\t\t\t\tlet u8 = new Uint8Array(new Uint32Array([ obj ]).buffer);\r\n\t\t\t\treturn { r: u8[0] / 255, g: u8[1] / 255, b: u8[2] / 255, a: u8[3] / 255 };\r\n\t\t\t}\r\n\t\t\tif (type === \"Buffer\") {\r\n\t\t\t\tlet s = atob(obj);\r\n\t\t\t\tlet array = new Uint8Array(s.length);\r\n\t\t\t\tfor (let i = 0; i < s.length; i++) array[i] = s.charCodeAt(i);\r\n\t\t\t\treturn array;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tfor (let i = 0; i < obj.length; i++) {\r\n\t\t\t\tobj[i] = wrenObjectToJS(obj[i]);\r\n\t\t\t}\r\n\t\t}\r\n\t} else if (Object.getPrototypeOf(obj) === Object.prototype) {\r\n\t\tfor (let k in obj) {\r\n\t\t\tobj[k] = wrenObjectToJS(obj[k]);\r\n\t\t}\r\n\t}\r\n\r\n\treturn obj;\r\n}\r\n\r\n\r\n/**\r\n * Create copy of JS object that matches Sock Wren JSON spec.\r\n * @param {any} obj\r\n * @returns {string}\r\n */\r\nexport function jsToWrenJSON(obj) {\r\n\treturn JSON.stringify(jsToWrenObject(obj));\r\n}\r\n\r\n/**\r\n * @param {any} obj\r\n * @returns {any}\r\n */\r\nfunction jsToWrenObject(obj) {\r\n\tif (obj == null) {\r\n\t\treturn null;\r\n\t}\r\n\r\n\tif (typeof obj === \"number\" || typeof obj === \"string\" || typeof obj === \"boolean\") {\r\n\t\treturn obj;\r\n\t}\r\n\r\n\tif (Array.isArray(obj)) {\r\n\t\treturn obj.map(child => jsToWrenObject(child));\r\n\t}\r\n\r\n\tif (Object.getPrototypeOf(obj) === Object.prototype) {\r\n\t\tlet result = {};\r\n\t\tfor (let k in obj) {\r\n\t\t\tresult[k] = jsToWrenObject(obj[k]);\r\n\t\t}\r\n\t\treturn result;\r\n\t}\r\n\r\n\tif (obj instanceof Uint8Array || obj instanceof Uint8ClampedArray) {\r\n\t\tlet s = \"\";\r\n\t\tfor (let i = 0; i < obj.length; i++) {\r\n\t\t\ts += String.fromCharCode(obj[i]);\r\n\t\t}\r\n\t\treturn [ \"Array\", btoa(s) ];\r\n\t}\r\n\r\n\treturn null;\r\n}\r\n","import { addClassForeignStaticMethods } from \"../foreign.js\";\r\nimport { jsToWrenJSON, wrenJSONToJS } from \"../json.js\";\r\nimport { wrenAbort, wrenGetSlotHandle, wrenGetSlotIsInstanceOf, wrenGetSlotString, wrenGetSlotType, wrenSetSlotHandle, wrenSetSlotString } from \"../vm.js\";\r\nimport { handle_Promise, resolveWrenPromise } from \"./promise.js\";\r\n\r\naddClassForeignStaticMethods(\"sock\", \"JavaScript_\", {\r\n\t// eval_(promise, argValuesJSON, argNamesJSON, jsScript)\r\n\t\"eval_(_,_,_,_)\"() {\r\n\t\t// Get JavaScript source.\r\n\t\tif (wrenGetSlotType(4) !== 6) {\r\n\t\t\twrenAbort(\"script must be a string\");\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tlet source = wrenGetSlotString(4);\r\n\r\n\t\t// Get arg names and values.\r\n\t\tlet argValues = getJSONFromSlot(2);\r\n\t\tif (!argValues) return;\r\n\r\n\t\tlet argNames = getJSONFromSlot(3);\r\n\t\tif (!argNames) return;\r\n\r\n\t\tif (!isStringArray(argNames) || !Array.isArray(argValues)) {\r\n\t\t\twrenAbort(\"arg values and names must be Lists, arg names must be a String List\");\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (argNames.length !== argValues.length) {\r\n\t\t\twrenAbort(\"arg names and values must have same length\");\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t// Get promise.\r\n\t\tlet arg1Type = wrenGetSlotType(1);\r\n\t\tlet promise;\r\n\t\tif (arg1Type === 5) {\r\n\t\t\tpromise = null;\r\n\t\t} else {\r\n\t\t\twrenSetSlotHandle(2, handle_Promise);\r\n\r\n\t\t\tif (!wrenGetSlotIsInstanceOf(1, 2)) {\r\n\t\t\t\twrenAbort(\"first arg must be null or Promise\");\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tpromise = wrenGetSlotHandle(1);\r\n\t\t}\r\n\r\n\t\tlet isSync = promise == null;\r\n\r\n\t\t// Compile and execute function.\r\n\t\tlet fnArgs = argNames.concat(source);\r\n\r\n\t\tlet result;\r\n\t\ttry {\r\n\t\t\tlet fn = isSync ? new Function(...fnArgs) : new AsyncFunction(...fnArgs);\r\n\r\n\t\t\tresult = fn.apply(null, argValues);\r\n\t\t} catch (error) {\r\n\t\t\twrenAbort(\"JavaScript error: \" + error);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t// Return result.\r\n\t\tif (isSync) {\r\n\t\t\twrenSetSlotString(0, jsToWrenJSON(result));\r\n\t\t} else {\r\n\t\t\tresolveWrenPromise(promise, result.then(value => jsToWrenJSON(value)));\r\n\r\n\t\t\twrenSetSlotHandle(0, promise);\r\n\t\t}\r\n\t}\r\n});\r\n\r\n/**\r\n * @param {number} slot\r\n */\r\nfunction getJSONFromSlot(slot) {\r\n\tlet type = wrenGetSlotType(slot);\r\n\tif (type === 5) {\r\n\t\treturn [];\r\n\t} else if (type === 6) {\r\n\t\treturn wrenJSONToJS(wrenGetSlotString(slot));\r\n\t} else {\r\n\t\twrenAbort(\"expected string or null for JS args\");\r\n\t\treturn false;\r\n\t}\r\n}\r\n\r\n/**\r\n * @param {any} xs\r\n * @returns {xs is string[]}\r\n */\r\nfunction isStringArray(xs) {\r\n\treturn Array.isArray(xs) && xs.every(x => typeof x === \"string\");\r\n}\r\n\r\nlet AsyncFunction = Object.getPrototypeOf(async function(){}).constructor;\r\n","import { deviceBrowser, deviceOS } from \"../device.js\";\r\nimport { addClassForeignStaticMethods } from \"../foreign.js\";\r\nimport { wrenSetSlotString } from \"../vm.js\";\r\n\r\naddClassForeignStaticMethods(\"sock\", \"Platform\", {\r\n\t\"os\"() {\r\n\t\twrenSetSlotString(0, deviceOS);\r\n\t},\r\n\t\"browser\"() {\r\n\t\twrenSetSlotString(0, deviceBrowser);\r\n\t},\r\n});\r\n","import { createElement } from \"./html.js\";\r\nimport { wrenErrorMessage, wrenErrorStack, wrenErrorString } from \"./vm.js\";\r\n\r\n/**\r\n * @param {any} error\r\n */\r\nexport function showError(error) {\r\n\tconsole.error(error);\r\n\r\n\tdocument.body.append(\r\n\t\tcreateElement(\"div\", { class: \"error\" }, [\r\n\t\t\tcreateElement(\"pre\", { class: \"message\" }, error),\r\n\t\t\t// createElement(\"pre\", { style: \"padding:.6em\" }, \"[no stack trace]\"),\r\n\t\t])\r\n\t);\r\n}\r\n\r\n\r\nexport function showWrenError() {\r\n\tif (wrenErrorStack.length === 0) {\r\n\t\tdocument.body.append(\r\n\t\t\tcreateElement(\"div\", { class: \"error\" }, [\r\n\t\t\t\tcreateElement(\"pre\", { class: \"message\" }, wrenErrorString),\r\n\t\t\t\tcreateElement(\"pre\", { style: \"padding:.6em\" }, \"[no stack trace]\"),\r\n\t\t\t])\r\n\t\t);\r\n\t\treturn;\r\n\t}\r\n\r\n\t// Create popup with message and show immediately.\r\n\tlet messageElement = createElement(\"pre\", { class: \"message\" }, \r\n\t\tcreateElement(\"div\", {}, wrenErrorMessage)\r\n\t);\r\n\r\n\r\n\tfor (let i = 0; i < wrenErrorStack.length; i++) {\r\n\t\tlet [moduleName, lineNumber, location] = wrenErrorStack[i];\r\n\r\n\t\tlet name = moduleName[0] === \"/\" ? moduleName.slice(1) : moduleName;\r\n\r\n\t\tlet stackEl = createElement(\"div\", {}, [\r\n\t\t\tlocation ? `  ${location} at ` : `  at `,\r\n\t\t\tcreateElement(\"a\", { href: getModulePath(moduleName), onclick: onclick }, name + \":\" + lineNumber),\r\n\t\t]);\r\n\r\n\t\t/**\r\n\t\t * @param {MouseEvent} event\r\n\t\t */\r\n\t\tfunction onclick(event) {\r\n\t\t\tevent.preventDefault();\r\n\t\t\tshowScript(i);\r\n\t\t}\r\n\r\n\t\tmessageElement.append(stackEl);\r\n\t}\r\n\r\n\r\n\tlet outerElement = createElement(\"div\", { class: \"error\" }, messageElement);\r\n\r\n\tdocument.body.append(outerElement);\r\n\r\n\tlet shownScript, scriptElement, scriptTitleElement, lineNumbers, lines, targetLine, targetLineNum;\r\n\r\n\tshowScript(0);\r\n\t\r\n\t/**\r\n\t * @param {number} stackIndex\r\n\t */\r\n\tasync function showScript(stackIndex) {\r\n\t\tlet [ moduleName, lineNumber  ] = wrenErrorStack[stackIndex];\r\n\t\t\r\n\t\tif (shownScript !== moduleName) {\r\n\t\t\tif (scriptElement) {\r\n\t\t\t\tscriptElement.remove();\r\n\t\t\t}\r\n\t\t\tif (scriptTitleElement) {\r\n\t\t\t\tscriptTitleElement.remove();\r\n\t\t\t}\r\n\r\n\t\t\tlet url = getModulePath(moduleName);\r\n\t\t\r\n\t\t\tlet source = await (await fetch(url)).text();\r\n\t\r\n\t\t\tshownScript = moduleName;\r\n\t\r\n\t\t\tlet sourceLines = source.split(/\\r\\n|\\n/);\r\n\t\t\t\r\n\t\t\t// Re-format sock script.\r\n\t\t\tif (moduleName === \"sock\") {\r\n\t\t\t\tlet indent = 0;\r\n\t\t\t\tsourceLines = sourceLines.map(line => {\r\n\t\t\t\t\tif (line[0] === \"}\") indent--;\r\n\t\r\n\t\t\t\t\tlet newLine = \"\\t\".repeat(indent) + line;\r\n\t\r\n\t\t\t\t\tif (line[0] !== \"}\" && line.endsWith(\"}\")) indent--;\r\n\t\t\t\t\tif (line.includes(\"{\")) indent++;\r\n\t\r\n\t\t\t\t\treturn newLine;\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\r\n\t\t\tlineNumbers = [];\r\n\t\t\tlines = [];\r\n\t\t\r\n\t\t\tfor (let i = 0; i < sourceLines.length; i++) {\r\n\t\t\t\tlineNumbers.push(createElement(\"div\", {}, 1 + i));\r\n\t\t\t\tlines.push(createElement(\"div\", {}, sourceLines[i] || \"\\u00A0\"));\r\n\t\t\t}\r\n\t\t\r\n\t\t\touterElement.append(\r\n\t\t\t\tscriptTitleElement = createElement(\"div\", { class: \"code-name\" }, moduleName + \".wren\"),\r\n\t\t\t\tscriptElement = createElement(\"div\", { class: \"code\" }, [\r\n\t\t\t\t\tcreateElement(\"pre\", { class: \"code-lines\" }, lineNumbers),\r\n\t\t\t\t\tcreateElement(\"pre\", { class: \"code-source\" }, lines),\r\n\t\t\t\t])\r\n\t\t\t);\r\n\t\t}\r\n\r\n\t\t// Highlight line and scroll to.\r\n\t\tif (targetLine) {\r\n\t\t\ttargetLine.className = targetLineNum.className = \"\";\r\n\t\t}\r\n\r\n\t\ttargetLine = lines[lineNumber - 1];\r\n\t\ttargetLineNum = lineNumbers[lineNumber - 1];\r\n\r\n\t\tif (targetLine) {\r\n\t\t\ttargetLine.className = targetLineNum.className = \"code-target\";\r\n\t\t\ttargetLineNum.scrollIntoView({ block: \"center\" });\r\n\t\t}\r\n\t}\r\n}\r\n\r\n/**\r\n * @param {string} name\r\n */\r\nfunction getModulePath(name) {\r\n\tif (name === \"sock\") {\r\n\t\tname = \"sock_web\";\r\n\t}\r\n\r\n\tif (name[0] === \"/\") {\r\n\t\tname = \"assets\" + name;\r\n\t}\r\n\r\n\treturn name + \".wren\"\r\n}\r\n","import { wrenJSONToJS } from \"../json.js\";\r\nimport { callHandle_toString } from \"../vm-call-handles.js\";\r\nimport { wrenCall, wrenEnsureSlots, wrenGetSlotString, wrenGetVariable, wrenHasVariable, wrenInterpret } from \"../vm.js\";\r\n\r\nlet init = false;\r\nlet terminalModule = \"_terminal\";\r\n\r\n/**\r\n * @param {any} args\r\n * @returns {any} result\r\n */\r\nexport function terminalInterpret(...args) {\r\n\tlet a = args[0];\r\n\r\n\tif (typeof a === \"string\") {\r\n\t\treturn interpret(a);\r\n\t} else if (a.raw && a.map) {\r\n\t\tlet raw = a.raw;\r\n\t\tlet script = \"\";\r\n\r\n\t\tfor (let i = 0; i < raw.length; i++) {\r\n\t\t\tif (i > 0) {\r\n\t\t\t\tscript += a[i];\r\n\t\t\t}\r\n\r\n\t\t\tscript += raw[i];\r\n\t\t}\r\n\r\n\t\treturn interpret(script);\r\n\t} else {\r\n\t\tconsole.error(a);\r\n\t\tthrow TypeError(\"call like this: wren`script`\");\r\n\t}\r\n}\r\n\r\n/**\r\n * @param {string} s\r\n * @returns {any} result\r\n */\r\nfunction interpret(s) {\r\n\tif (!init) {\r\n\t\tinit = true;\r\n\t\twrenInterpret(terminalModule, \"var r__\");\r\n\t}\r\n\r\n\ts = s.trim();\r\n\r\n\tlet maybeExpression = false;\r\n\r\n\tif (!s.includes(\"\\n\")) {\r\n\t\t// Single line\r\n\t\tif (s.startsWith(\"var \")) {\r\n\t\t\t// Var initialization\r\n\t\t\tlet r = /var\\s+([_a-zA-Z][_a-zA-Z0-9]*)/.exec(s);\r\n\t\t\tif (r) {\r\n\t\t\t\tlet varName = r[1];\r\n\r\n\t\t\t\t// Allow repeated variable declaration\r\n\t\t\t\tif (wrenHasVariable(terminalModule, varName)) {\r\n\t\t\t\t\tif (s.includes(\"=\")) {\r\n\t\t\t\t\t\t// Remove [var ] from start if already declared.\r\n\t\t\t\t\t\ts = s.slice(4);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t// Ignore repeated initialization.\r\n\t\t\t\t\t\treturn\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tlet result = wrenInterpret(terminalModule, s);\r\n\r\n\t\t\t\tif (result === 0) {\r\n\t\t\t\t\treturn getVariableAsJavaScript(varName);\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t} else if (!startsWithStatement(s)) {\r\n\t\t\t// This should be an expression of some kind!\r\n\t\t\tmaybeExpression = true;\r\n\r\n\t\t\t// For simple assignments, decare base as variable if it doesn't look like a class.\r\n\t\t\tlet r = /^([_a-zA-Z][_a-zA-Z0-9]*)\\s*=/.exec(s) || /^([_a-zA-Z][_a-zA-Z0-9]*)$/.exec(s);\r\n\t\t\tif (r) {\r\n\t\t\t\tlet baseVarName = r[1];\r\n\r\n\t\t\t\tif (!wrenHasVariable(terminalModule, baseVarName)) {\r\n\t\t\t\t\tif (baseVarName[0] === baseVarName[0].toLowerCase()) {\r\n\t\t\t\t\t\twrenInterpret(terminalModule, \"var \" + baseVarName);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t} else {\r\n\t\tmaybeExpression = !startsWithStatement(s);\r\n\t}\r\n\r\n\tif (maybeExpression) {\r\n\t\t// Try as expression!\r\n\t\tlet result = wrenInterpret(terminalModule, `r__=JSON.toString(${s})`);\r\n\t\r\n\t\tif (result === 0) {\r\n\t\t\treturn getVariableAsJavaScript(\"r__\", true);\r\n\t\t} else if (result === 2) {\r\n\t\t\treturn \"[error]\";\r\n\t\t}\r\n\t}\r\n\t\t\r\n\t// Try just interpreting.\r\n\tlet result = wrenInterpret(terminalModule, s);\r\n\tif (result === 0) {\r\n\t\treturn \"[success]\";\r\n\t} else {\r\n\t\treturn \"[error]\";\r\n\t}\r\n}\r\n\r\n/**\r\n * @param {string} s\r\n */\r\nfunction startsWithStatement(s) {\r\n\treturn s.startsWith(\"var \") || s.startsWith(\"if \") || s.startsWith(\"if(\") || s.startsWith(\"for \") || s.startsWith(\"for(\") || s.startsWith(\"while \") || s.startsWith(\"while(\") || s.startsWith(\"import \") || s.startsWith(\"class \") || s.startsWith(\"#!\") || s.startsWith(\"#?\");\r\n}\r\n\r\n/**\r\n * @param {string} varName\r\n */\r\nfunction getVariableAsJavaScript(varName, json=false) {\r\n\twrenEnsureSlots(1);\r\n\twrenGetVariable(terminalModule, varName, 0);\r\n\r\n\tlet result = wrenCall(callHandle_toString);\r\n\tif (result === 0) {\r\n\t\tlet toStr = wrenGetSlotString(0);\r\n\r\n\t\tif (json) {\r\n\t\t\treturn wrenJSONToJS(toStr);\r\n\t\t} else {\r\n\t\t\treturn toStr;\r\n\t\t}\r\n\t}\r\n\r\n\treturn \"[error]\";\r\n}\r\n\r\n/**\r\n * @param {string} s\r\n */\r\nfunction fromBase64(s) {\r\n\ts = atob(s);\r\n\tlet array = new Uint8Array(s.length);\r\n\tfor (let i = 0; i < s.length; i++) array[i] = s.charCodeAt(i);\r\n\treturn array;\r\n}\r\n","import \"./polyfill.js\";\r\nimport \"./api/add-all-api.js\";\r\nimport { initTimeModule, updateTimeModule } from \"./api/time.js\";\r\nimport { fps, gameBusyWithDOMFallback, gameIsReady, gameUpdate, initGameModule, prepareUpdatePromise, quitFromAPI } from \"./api/game.js\";\r\nimport { initAssetModule } from \"./api/asset.js\";\r\nimport { initInputModule, recalculateAndUpdateMousePosition, updateInputModule } from \"./api/input.js\";\r\nimport { httpGET } from \"./network/http.js\";\r\nimport { finalizeLayout, redoLayout } from \"./layout.js\";\r\nimport { Shader } from \"./gl/shader.js\";\r\nimport { mainFramebuffer } from \"./gl/framebuffer.js\";\r\nimport { canvas } from \"./canvas.js\";\r\nimport { showError, showWrenError } from \"./error.js\";\r\nimport { until } from \"./async.js\";\r\nimport { terminalInterpret } from \"./debug/terminal.js\";\r\nimport { loadEmscripten, wrenAddImplicitImportModule, wrenHasError, wrenInterpret } from \"./vm.js\";\r\nimport { makeCallHandles } from \"./vm-call-handles.js\";\r\nimport { initSystemFont } from \"./system-font.js\";\r\nimport { createAudioContext, initAudioModule, loadAudioModule, stopAllAudio } from \"./api/audio.js\";\r\nimport { initPromiseModule } from \"./api/promise.js\";\r\nimport { initSpriteModule } from \"./api/sprite.js\";\r\nimport { sockJsGlobal } from \"./globals.js\";\r\nimport { updateRefreshRate } from \"./api/screen.js\";\r\nimport { messagingEnabled, sendMessage, waitForMessage } from \"./messaging.js\";\r\n\r\n/** @type {number} */\r\nlet prevTime = null;\r\n/** @type {number} */\r\nlet startTime = null;\r\nlet time = 0;\r\nlet refreshrateCounter = 0;\r\nlet refreshrateInterval = 0;\r\nlet remainingTime = 0;\r\nlet quit = false;\r\n/** @type {Promise<string|ArrayBuffer>} */\r\nlet promGameMainScript;\r\n\r\nlet playButton = document.getElementById(\"play-button\");\r\nplayButton.tabIndex = 0;\r\n\r\n\r\n\r\nif (messagingEnabled) {\r\n\tplayButton.remove();\r\n\t\r\n\tpromGameMainScript = waitForMessage(\"script\");\r\n\r\n\tsendMessage(\"ready\");\r\n} else {\r\n\tpromGameMainScript = httpGET(\"assets/main.wren\", \"arraybuffer\");\r\n}\r\n\r\nasync function init() {\r\n\t// Get scripts in parallel.\r\n\tlet promSockScript = httpGET(\"sock_web.wren\", \"arraybuffer\");\r\n\t\r\n\t// Load Wren VM.\r\n\tawait loadEmscripten();\r\n\t\r\n\tlet promSystemFont = initSystemFont();\r\n\tmakeCallHandles();\r\n\r\n\t// Prepare preview / core init.\r\n\tredoLayout();\r\n\r\n\t// Load in the \"sock\" script.\r\n\tawait promSystemFont;\r\n\tlet sockScript = await promSockScript;\r\n\t\r\n\tlet result = wrenInterpret(\"sock\", sockScript);\r\n\t\r\n\tif (result !== 0) {\r\n\t\tfinalize();\r\n\t\treturn;\r\n\t}\r\n\r\n\t// Make the \"sock\" module part of the implicit import API.\r\n\twrenAddImplicitImportModule(\"sock\");\r\n\r\n\t// Init sock modules.\r\n\tinitTimeModule();\r\n\tinitPromiseModule();\r\n\tinitAssetModule();\r\n\tinitGameModule();\r\n\tinitInputModule();\r\n\tinitSpriteModule();\r\n\tinitAudioModule();\r\n\r\n\t// Wait for user click.\r\n\tawait playClicked();\r\n\r\n\tplayButton.remove();\r\n\r\n\t// Init WebGL.\r\n\tmainFramebuffer.updateResolution();\r\n\r\n\tShader.compileAll();\r\n\r\n\t// Load modules.\r\n\tloadAudioModule();\r\n\r\n\t// Load main game module\r\n\tlet gameMainScript = await promGameMainScript;\r\n\r\n// \twrenEnsureSlots(1);\r\n// \twrenGetVariable(\"sock\", \"Game\", 0);\r\n// \twrenCall(callHandle_call_0);\r\n// \r\n// \tconsole.log(\"TODO early exit\")\r\n// \treturn;\r\n\r\n\tresult = wrenInterpret(\"/main\", gameMainScript);\r\n\tif (result !== 0) {\r\n\t\tfinalize();\r\n\t\treturn;\r\n\t}\r\n\r\n\t// Now we wait for Game.ready_() to be called! Or for an error to occurr.\r\n\tif (!await until(100, 60000, () => gameIsReady || wrenHasError)) {\r\n\t\tfinalize(\"took to long for Game.begin() to be called...\");\r\n\t\treturn;\r\n\t}\r\n\r\n\tif (wrenHasError) {\r\n\t\tfinalize();\r\n\t\treturn;\r\n\t}\r\n\r\n\t// Begin!\r\n\trequestAnimationFrame(update);\r\n}\r\n\r\n/**\r\n * @returns {Promise<void>}\r\n */\r\nfunction playClicked() {\r\n\t// Wait for user input (button click).\r\n\tif (messagingEnabled) {\r\n\t\tinitModules();\r\n\r\n\t\treturn Promise.resolve();\r\n\t} else {\r\n\t\treturn new Promise((resolve) => {\r\n\t\t\tplayButton.onclick = oninput;\r\n\t\t\t\r\n\t\t\tfunction oninput() {\r\n\t\t\t\tinitModules();\r\n\t\t\t\tresolve();\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\t// We also initialize some systems here that require a user event.\r\n\tfunction initModules() {\r\n\t\tcreateAudioContext()\r\n\t}\r\n}\r\n\r\nfunction update() {\r\n\tlet now = performance.now() / 1000;\r\n\tif (startTime == null) startTime = now;\r\n\tnow -= startTime;\r\n\r\n\tlet tickDelta = prevTime == null ? 0 : Math.min(4 / 60, now - prevTime);\r\n\tprevTime = now;\r\n\r\n\trefreshrateInterval += tickDelta;\r\n\trefreshrateCounter++;\r\n\tif (refreshrateCounter === 60) {\r\n\t\tupdateRefreshRate(Math.round(refreshrateCounter / refreshrateInterval));\r\n\t\trefreshrateCounter = refreshrateInterval = 0;\r\n\t}\r\n\r\n\tlet isBusy = gameBusyWithDOMFallback();\r\n\t\r\n\tif (gameIsReady && !isBusy) {\r\n\t\tif (fps) {\r\n\t\t\tremainingTime -= tickDelta;\r\n\t\t} else {\r\n\t\t\tremainingTime = 0;\r\n\t\t}\r\n\t\r\n\t\tif (!fps || remainingTime <= 0) {\r\n\t\t\t// Increment frame timer.\r\n\t\t\tif (fps) {\r\n\t\t\t\tremainingTime += 1 / fps;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// Update module state.\r\n\t\t\tupdateTimeModule(now, now - time);\r\n\t\t\ttime = now;\r\n\t\t\t\r\n\t\t\tupdateInputModule();\r\n\r\n\t\t\t// Prepare WebGL.\r\n\t\t\tlet layoutChanged = finalizeLayout();\r\n\t\t\t\r\n\t\t\tif (layoutChanged) {\r\n\t\t\t\trecalculateAndUpdateMousePosition();\r\n\t\t\t\tmainFramebuffer.updateResolution();\r\n\t\t\t}\r\n\t\r\n\t\t\tmainFramebuffer.bind();\r\n\t\r\n\t\t\t// Do game update.\r\n\t\t\tlet result = gameUpdate();\r\n\t\t\t\t\r\n\t\t\t// Check result of call.\r\n\t\t\tif (result !== 0) {\r\n\t\t\t\tquit = true;\r\n\t\t\t}\r\n\r\n\t\t\t// Await update promise.\r\n\t\t\tif (!gameIsReady && !quit && !quitFromAPI) {\r\n\t\t\t\tconsole.log(\"awaiting update completion...\")\r\n\t\t\t\tprepareUpdatePromise().then(() => {\r\n\t\t\t\t\tfinalizeUpdateInner();\r\n\t\t\t\t\tfinalizeUpdateOuter();\r\n\t\t\t\t});\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\t// ...otherwise finalize synchronusly.\r\n\t\t\tfinalizeUpdateInner();\r\n\t\t}\r\n\t}\r\n\r\n\tfinalizeUpdateOuter();\r\n}\r\n\r\nfunction finalizeUpdateInner() {\r\n\t// Finalize WebGL.\r\n\tmainFramebuffer.draw();\r\n}\r\n\r\nfunction finalizeUpdateOuter() {\r\n\tif (quit || quitFromAPI) {\r\n\t\t// End the loop.\r\n\t\tcanvas.classList.add(\"quit\");\r\n\t\tfinalize();\r\n\t} else {\r\n\t\trequestAnimationFrame(update);\r\n\t}\r\n}\r\n\r\n/**\r\n * @param {string|null} [error]\r\n */\r\nfunction finalize(error) {\r\n\tstopAllAudio();\r\n\t\r\n\tif (error) {\r\n\t\tshowError(error);\r\n\t} else if (wrenHasError) {\r\n\t\tshowWrenError();\r\n\t}\r\n}\r\n\r\ninit();\r\n\r\nself[\"wren\"] = terminalInterpret;\r\n","\r\n/**\r\n * @param {number} delay\r\n * @param {number} timeout\r\n * @param {() => boolean} f\r\n * @returns {Promise<boolean>} resolves to false if timedout\r\n */\r\nexport function until(delay, timeout, f) {\r\n\tlet time = 0;\r\n\treturn new Promise((resolve) => {\r\n\t\tlet id = setInterval(() => {\r\n\t\t\ttime += delay;\r\n\t\t\tif (f()) {\r\n\t\t\t\tclearInterval(id);\r\n\t\t\t\tresolve(true);\r\n\t\t\t}\r\n\t\t\tif (time >= timeout) {\r\n\t\t\t\tclearInterval(id);\r\n\t\t\t\tresolve(false);\r\n\t\t\t}\r\n\t\t}, delay);\r\n\t});\r\n}\r\n"],"names":["documentProto","Document","prototype","elementProto","Element","addForeignMethod","moduleName","className","isStatic","signature","callback","foreignMethods","methodID","addClassForeignStaticMethods","methods","addForeignClass","classMethods","staticMethods","foreignClasses","classID","addClassForeignMethods","requestFullscreen","Object","defineProperty","get","this","Promise","resolve","reject","fullscreenChange","finalize","fullscreenError","TypeError","removeEventListener","addEventListener","httpGET","url","type","progressCallback","xhr","XMLHttpRequest","responseType","open","onprogress","event","lengthComputable","loaded","total","onerror","onload","status","response","statusText","send","httpGETImage","el","Image","src","_scriptDir","Module","document","currentScript","URL","baseURI","href","readyPromiseResolve","readyPromiseReject","getOwnPropertyDescriptor","configurable","abort","set","key","moduleOverrides","hasOwnProperty","arguments_","Error","scriptDirectory","indexOf","substr","replace","lastIndexOf","window","importScripts","out","console","log","bind","err","warn","warnOnce","text","shown","assert","functionsInTableMap","wasmMemory","freeTableIndexes","WebAssembly","ABORT","condition","buffer","HEAP8","HEAPU8","HEAP32","HEAPU32","UTF8Decoder","TextDecoder","undefined","UTF8ArrayToString","maxBytesToRead","endIdx","idx","endPtr","heap","subarray","decode","str","u0","u1","u2","toString","String","fromCharCode","ch","UTF8ToString","ptr","stringToUTF8","outPtr","maxBytesToWrite","outIdx","startIdx","i","length","u","charCodeAt","stringToUTF8Array","updateGlobalBufferAndViews","buf","Int8Array","Int16Array","Int32Array","Uint8Array","Uint16Array","Uint32Array","Float32Array","Float64Array","wasmTable","TOTAL_STACK","writeStackCookie","max","_emscripten_stack_get_end","checkStackCookie","cookie1","cookie2","INITIAL_MEMORY","h16","h8","__ATPRERUN__","__ATINIT__","__ATPOSTRUN__","runtimeInitialized","Math","imul","fround","clz32","trunc","runDependencies","runDependencyWatcher","dependenciesFulfilled","runDependencyTracking","what","e","RuntimeError","wasmBinaryFile","FS","error","init","createDataFile","createPreloadedFile","createLazyFile","mkdev","registerDevice","analyzePath","loadFilesFromDB","ErrnoError","isDataURI","filename","startsWith","createExportWrapper","name","fixedasm","displayName","asm","apply","arguments","getBinary","file","callbacks","shift","func","arg","getWasmTableEntry","wasmTableMirror","funcPtr","emscripten_realloc_buffer","size","grow","byteLength","SYSCALLS","mappings","buffers","printChar","stream","curr","varargs","getStr","get64","low","high","asmLibraryArg","clock","_clock","start","Date","now","emscripten_memcpy_big","dest","num","copyWithin","emscripten_resize_heap","requestedSize","oldSize","x","multiple","maxHeapSize","cutDown","overGrownHeapSize","min","newSize","fd_close","fd","fd_seek","offset_low","offset_high","whence","newOffset","fd_write","iov","iovcnt","pnum","len","j","js_bindClass","vm","module","bindClass","allocate","fns","u32","addFunction","js_bindMethod","fn","sock","bindMethod","js_error","line","message","js_loadModule","lengthBytesUTF8","heapString","_malloc","ArrayBuffer","nullTerminated","mallocString","loadModule","js_write","write","setTempRet0","val","id","info","env","wasi_snapshot_preview1","receiveInstance","instance","cb","exports","unshift","clearInterval","removeRunDependency","setInterval","dep","trueModule","receiveInstantiationResult","result","instantiateArrayBuffer","receiver","fetch","credentials","then","catch","binary","instantiate","reason","instantiateStreaming","createWasm","stackSave","stackRestore","stackAlloc","_emscripten_stack_init","calledRun","run","args","callRuntimeCallbacks","ident","returnType","argTypes","opts","toC","string","ret","array","arr","writeArrayToMemory","getCFunc","cArgs","stack","converter","Boolean","convertReturnValue","onDone","sig","offset","count","item","updateTableMap","has","pop","RangeError","getEmptyTableSlot","setWasmTableEntry","Function","typeNames","f","d","parameters","results","push","typeSection","sigRet","slice","sigParam","typeCodes","concat","bytes","Instance","wrapped","runCaller","ready","canvas","querySelector","sockJsGlobal","assign","self","async","fullscreenEnabled","fullscreenElement","exitFullscreen","body","togglePointerLock","pointerLockElement","exitPointerLock","requestPointerLock","messagingEnabled","messaging","waitingMessages","sendMessage","data","parent","postMessage","HEAP","sockEmscriptenFactory","Module$1","lineNumber","s","wrenHasError","wrenErrorMessage","formatModuleLineTrace","wrenErrorStack","wrenErrorString","wrenInterpret","r","c","stringToWrenString","resolveForeignMethod","resolveForeignClass","ccall","moduleSource","srcType","stackAllocUTF8ArrayAsCString","wrenHasVariable","wrenEnsureSlots","numSlots","wrenGetSlotType","slot","wrenGetSlotBool","wrenGetSlotString","wrenGetSlotDouble","wrenGetSlotForeign","wrenGetSlotIsInstanceOf","classSlot","wrenGetSlotHandle","wrenGetVariable","wrenSetSlotNull","wrenSetSlotBool","value","wrenSetSlotDouble","wrenSetSlotRange","from","to","step","isInclusive","wrenSetSlotString","textRaw","textType","wrenSetSlotHandle","handle","wrenSetSlotNewForeign","wrenCall","callHandle","wrenReleaseHandle","msgType","stillWaiting","callNow","arraySource","u8","wren_sock_get_transform","callHandle_init_2","callHandle_update_0","callHandle_update_2","callHandle_resolve_2","callHandle_toString","callHandle_updateMouse_3","callHandle_updateTouch_5","wrenMakeCallHandle","handle_Time","epoch","handle_Promise","resolveWrenPromise","pvalue","promiseHandle","success","WrenHandle","constructor","loader","wrenAbort","path","resolveAbsoluteAssetPath","promise","loadAsset","method","ok","httpExists","EFFECT_TYPE_NAMES","audioctx","masterGain","implulseChurch","offlineContext","handle_Audio","handle_AudioBus","handle_Voice","loadAudioModule","frameCount","floor","duration","sampleRate","AudioBuffer","numberOfChannels","ch1","getChannelData","ch2","volume","exp","random","generateImpulse","fadeVolume","gainNode","fade","gain","cancelScheduledValues","currentTime","linearRampToValueAtTime","AudioControls","destination","effects","fill","createGain","updateGraph","getInput","effect","input","getEffectType","index","nodes","node","connect","outputs","disconnect","setupGraph","AudioBus","super","Audio","setBuffer","effectSetAudioParam","param","minValue","maxValue","FilterEffect","filter","createBiquadFilter","getParam","frequency","Q","checkParam","setParam","EchoEffect","maxDelay","GainNode","decay","mix","create","delay","DelayNode","delayTime","maxDelayTime","free","ReverbEffect","wetGain","convolver","ConvolverNode","disableNormalization","Voice","audio","audioHandle","_initSource","state","time","source","createBufferSource","onended","play","old","loop","loopStart","playbackRate","startTime","saveTime","pause","stopSource","stop","buses","Map","audios","voices","getAudioBus","getAudio","getVoice","stbvorbisPromise","canDecodeOGG","script","createElement","head","append","stbvorbis","eof","totalLength","reduce","acc","chunk","channelCount","writeOffset","channelIndex","copyToChannel","wrenAudioSetEffect","params","Array","oldEffect","output","wrenAudioGetEffect","wrenAudioGetParam","paramIndex","wrenAudioSetParam","paramValue","fadeTime","wrenFadeVolume","bus","delete","voice","isOGG","dot","toLowerCase","getExtension","decodeOGG","OfflineAudioContext","decodeAudioData","loadAudioBuffer","isPaused","rate","loopEnd","storageID","validateKey","validateKeyIdentifier","test","tag","attributes","element","setAttribute","isArray","localStorage","getItem","setItem","removeItem","screenWidth","screenHeight","internalResolutionWidth","internalResolutionHeight","viewportOffsetX","viewportOffsetY","viewportWidth","viewportHeight","viewportScale","layoutOptions","pixelScaling","resolution","maxScale","Infinity","layoutContainer","style","layoutContainerRefCount","isLayoutQueued","queueLayout","redoLayout","innerWidth","innerHeight","resx","resy","scale","devicePixelRatio","width","pixeRatio","height","res","scaleX","scaleY","left","top","cameraMatrix","setCameraOrigin","sx","sy","tf","y","dx","dy","wrenSetCamera","setter","tp","cameraLookAt","gl","getContext","antialias","enable","BLEND","blendFuncSeparate","SRC_ALPHA","ONE_MINUS_SRC_ALPHA","ONE","GL_FILTER_MAP","linear","LINEAR","nearest","NEAREST","GL_WRAP_MAP","clamp","CLAMP_TO_EDGE","repeat","REPEAT","mirror","MIRRORED_REPEAT","wrenGlFilterStringToNumber","wrenGlWrapModeStringToNumber","glFilterNumberToString","n","glWrapModeNumberToString","indices","populatedIndices","quadIndexBuffer","createBuffer","bindQuadIndexBuffer","indexCount","bindBuffer","ELEMENT_ARRAY_BUFFER","capacity","newIndices","vi","bufferData","DYNAMIC_DRAW","quadSize","shadersAwaitingCompilation","Shader","opt","uniforms","attributesSource","initShaderVariables","varyingsSource","varyings","vertUniforms","fragUniforms","vertSource","createShaderSourceMain","vert","fragSource","frag","_vert","createShader","VERTEX_SHADER","shaderSource","_frag","FRAGMENT_SHADER","prog","createProgram","attachShader","compiled","compile","needsCompilation","deleteProgram","deleteShader","use","useProgram","getUniformLocation","location","setUniformTexture","tex","unit","TEXTURE0","activeTexture","bindTexture","TEXTURE_2D","uniform1i","setUniformFloat2","uniform2f","setUniformMatrix3","matrix","uniformMatrix3fv","setUniformMatrix4","uniformMatrix4fv","static","shaders","sh","compileShader","linkProgram","errors","getProgramParameter","LINK_STATUS","sProg","getProgramInfoLog","sVert","getShaderInfoLog","sFrag","join","keyword","dst","a","Vec2","Texture","wrap","texture","setFilter","texParameteri","TEXTURE_MAG_FILTER","TEXTURE_MIN_FILTER","setWrap","TEXTURE_WRAP_S","TEXTURE_WRAP_T","load","HTMLImageElement","naturalWidth","naturalHeight","HTMLVideoElement","videoWidth","videoHeight","getResolution","img","entry","performance","getEntriesByName","PerformanceResourceTiming","decodedBodySize","transferSize","ImageData","imageSize","createTexture","texImage2D","RGBA","UNSIGNED_BYTE","isPowerOf2","deleteTexture","shader$2","vertex","color","v_color","SpriteBatcher","_capacity","_array","_floats","_bytes","_ints","_vertexCount","_vertexBuffer","_vertexBufferCapacity","begin","_texture","drawQuad","x1","y1","x2","y2","z","v1","v2","tfo","tx1","ty1","tx2","ty2","tx3","ty3","tx4","ty4","tfox","tfoy","addVertex","v","i4","checkResize","vertexCount","newInts","end","ARRAY_BUFFER","bufferSubData","vertLocation","shader","colorlocation","uvLocation","uv","vertexAttribPointer","FLOAT","enableVertexAttribArray","getCameraMatrix","drawElements","TRIANGLES","UNSIGNED_SHORT","disableVertexAttribArray","deleteBuffer","handle_Sprite","defaultFilter","defaultWrap","Sprite","batcher","beginBatch","freeSpriteBatchers","endBatch","getTempBatcher","bat","deviceOS","deviceBrowser","sprites","getSprite","spr","scaleFilter","wrapMode","transform","defaultScaleFilter","defaultWrapMode","deviceIsMobile","platform","navigator","userAgent","includes","device","os","isMobile","shader$1","SYSTEM_FONT","systemFontSpriteBatcher","mainFramebuffer","depthBuffer","createRenderbuffer","framebuffer","createFramebuffer","quadBuffer","STATIC_DRAW","updateResolution","bindRenderbuffer","RENDERBUFFER","renderbufferStorage","DEPTH_COMPONENT16","bindFramebuffer","FRAMEBUFFER","framebufferTexture2D","COLOR_ATTACHMENT0","framebufferRenderbuffer","DEPTH_ATTACHMENT","viewport","unbind","draw","vertAttr","drawArrays","deleteFramebuffer","deleteRenderbuffer","title","fps","quitFromAPI","gameIsReady","updatePromiseFunction","cursor","printColor","wantFullscreen","gettingDOMFullscreen","isFixed","isPixelPerfect","fullscreenAllowed","fullscreen","dialog","class","alt","triggerFullscreen","onclick","cursorSockToCSS","cornerX","cornerY","TextEncoder","encode","colorInt","int","spx","spy","lenPtr","getSlotBytes","g","b","clearColor","COLOR_BUFFER_BIT","default","pointer","wait","hidden","handle_Game","initGameModule","refreshRate","screen","availableWidth","availWidth","availableHeight","availHeight","QuadBatcher","drawBatch","inBatch","drawRect","x3","y3","x4","y4","quadInfo","w","h","singleBatch","QWERTZ","AZERTY","keyboardLayout","language","layoutChecks","onKeydown","code","passive","textInput","textForm","removeTextInput","parentNode","remove","onsubmit","preventDefault","onblur","setTimeout","activeElement","onkeydown","idType","argType","focus","target","textDescription","placeholder","textIsActive","textSelection","selectionStart","selectionEnd","selectionDirection","tmp","textString","handle_Input","queuedInputs","Set","inputTable","mouseX","mouseExactX","mouseExactY","mouseRawX","mouseRawY","mouseWheel","recalculateAndUpdateMousePosition","recalculateMousePosition","transferCurrentMousePosition","mouseY","add","updateInputValue1D","nameNegative","namePositive","updateInputValue","updateInputValueWithNativeName","INPUT_NAME_MAP","Backquote","Minus","Equal","Comma","Period","Slash","Semicolon","Quote","BracketLeft","BracketRight","Backslash","letter","updateTouches","touches","isDown","touch","identifier","clientX","clientY","force","updateMousePosition","updateMouseButton","button","wrenJSONToJS","JSON","parse","NaN","Number","map","atob","jsToWrenJSON","obj","stringify","jsToWrenObject","child","getPrototypeOf","k","Uint8ClampedArray","btoa","getJSONFromSlot","stopPropagation","deltaY","sign","changedTouches","argValues","argNames","xs","every","isSync","fnArgs","AsyncFunction","getModulePath","browser","init$1","terminalModule","interpret","maybeExpression","trim","startsWithStatement","exec","varName","getVariableAsJavaScript","baseVarName","json","toStr","promGameMainScript","prevTime","refreshrateCounter","refreshrateInterval","remainingTime","quit","playButton","getElementById","tickDelta","round","deltaTime","updateTimeModule","getGamepads","gp","buttons","axes","inputID","clear","updateInputModule","finalizeLayout","finalizeUpdateInner","finalizeUpdateOuter","classList","requestAnimationFrame","update","close","showError","messageElement","stackEl","showScript","shownScript","scriptElement","scriptTitleElement","lineNumbers","lines","targetLine","targetLineNum","outerElement","stackIndex","sourceLines","split","indent","newLine","endsWith","scrollIntoView","block","showWrenError","tabIndex","promSockScript","loadEmscripten","promSystemFont","createObjectURL","Blob","revokeObjectURL","initSystemFont","initModules","oninput","AudioContext","playClicked","compileAll","timeout","until","raw"],"mappings":"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"}