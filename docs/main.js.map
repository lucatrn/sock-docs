{"version":3,"file":"main.js","sources":["../src/html.js","../src/persistence.js","../src/theme.js","../src/messaging.js","../src/docs.js","../src/navigation.js","../src/main.js"],"sourcesContent":["\r\n/**\r\n * @param {string} id\r\n * @returns {HTMLElement}\r\n */\r\nexport function getElement(id) {\r\n\treturn document.getElementById(id);\r\n}\r\n\r\n/**\r\n * \r\n * @param {Element} element\r\n * @param {string} className\r\n * @param {boolean} enabled\r\n */\r\nexport function setElementClass(element, className, enabled) {\r\n\tif (enabled) {\r\n\t\telement.classList.add(className);\r\n\t} else {\r\n\t\telement.classList.remove(className);\r\n\t}\r\n}\r\n\r\n/**\r\n * @param {K} tag \r\n * @param {Record<string, any>} [attributes] \r\n * @param {any} [nodes]\r\n * @returns {HTMLElementTagNameMap[K]}\r\n * @template {keyof HTMLElementTagNameMap} K\r\n */\r\nexport function createElement(tag, attributes, nodes) {\r\n\tlet element = document.createElement(tag);\r\n\r\n\tif (attributes) {\r\n\t\twithAttributes(element, attributes);\r\n\t}\r\n\r\n\tappendNodes(element, nodes);\r\n\r\n\treturn element;\r\n}\r\n\r\n/**\r\n * @param {T} element\r\n * @param {Record<string, any>} attributes \r\n * @returns {T}\r\n * @template {Element} T\r\n */\r\nexport function withAttributes(element, attributes) {\r\n\tfor (let name in attributes) {\r\n\t\tlet value = attributes[name];\r\n\r\n\t\tif (name.startsWith(\"on\")) {\r\n\t\t\telement[name] = value;\r\n\t\t} else {\r\n\t\t\tif (value === true) {\r\n\t\t\t\telement.setAttribute(name, \"\");\r\n\t\t\t} else if (value == null || value === false) {\r\n\t\t\t\t// Ignore.\r\n\t\t\t} else {\r\n\t\t\t\telement.setAttribute(name, value);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\treturn element;\r\n}\r\n\r\n/**\r\n * @param {ParentNode} parent \r\n * @param {Node|Node[]} nodes \r\n */\r\nexport function appendNodes(parent, nodes) {\r\n\tif (nodes) {\r\n\t\tif (Array.isArray(nodes)) {\r\n\t\t\tfor (let node of nodes) {\r\n\t\t\t\tparent.append(node);\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tparent.append(nodes);\r\n\t\t}\r\n\t}\r\n}\r\n\r\n/**\r\n * @param {HTMLElement} el\r\n */\r\nexport function clearElement(el) {\r\n\tel.innerHTML = \"\";\r\n}\r\n","\r\nlet LOCAL_STORAGE_KEY = \"sock_docs\";\r\n\r\n/**\r\n * @type {Partial<Persistence>}\r\n */\r\nlet defaults = {\r\n};\r\n\r\n/** @type {Persistence} */\r\nlet curr;\r\n\r\nlet savedJSON = localStorage.getItem(LOCAL_STORAGE_KEY);\r\nif (savedJSON) {\r\n\ttry {\r\n\t\tcurr = JSON.parse(savedJSON);\r\n\t} catch (error) {\r\n\t\tconsole.error(error);\r\n\t}\r\n}\r\n\r\ncurr = Object.assign({}, defaults, curr);\r\n\r\n/**\r\n * @type {Readonly<Persistence>}\r\n */\r\nexport let persistence = curr;\r\n\r\n/**\r\n * @param {Partial<Persistence>} p \r\n */\r\nexport function updatePersistence(p) {\r\n\tfor (let key in p) {\r\n\t\tcurr[key] = p[key];\r\n\t}\r\n\r\n\tlocalStorage.setItem(LOCAL_STORAGE_KEY, JSON.stringify(curr));\r\n}\r\n\r\n/**\r\n * @typedef {object} Persistence\r\n * @property {boolean} isLight\r\n */\r\n","import { getElement, setElementClass } from \"./html.js\";\r\nimport { persistence, updatePersistence } from \"./persistence.js\";\r\n\r\nlet iconLight = getElement(\"theme-toggle-icon-light\");\r\nlet iconDark = getElement(\"theme-toggle-icon-dark\");\r\n\r\nlet isLightTheme = false;\r\n\r\ngetElement(\"theme-toggle\").onclick = () => {\r\n\tsetIsLightTheme(!isLightTheme);\r\n\r\n\tupdatePersistence({ isLight: isLightTheme });\r\n};\r\n\r\n/**\r\n * @param {boolean} isLight\r\n */\r\nfunction setIsLightTheme(isLight) {\r\n\tisLightTheme = isLight;\r\n\r\n\tsetElementClass(iconLight, \"hidden\", !isLight);\r\n\tsetElementClass(iconDark, \"hidden\", isLight);\r\n\t\r\n\tsetElementClass(document.documentElement, \"light\", isLight);\r\n\tsetElementClass(document.documentElement, \"dark\", !isLight);\r\n}\r\n\r\nsetIsLightTheme(persistence.isLight ?? document.documentElement.classList.contains(\"light\"));\r\n","\r\n/** @type {(((arg: any) => void) & { type: string, iframe: HTMLIFrameElement })[]} */\r\nlet waitingMessages  = [];\r\n\r\naddEventListener(\"message\", (event) => {\r\n\tlet data = event.data;\r\n\tif (data && typeof data === \"object\") {\r\n\t\tlet msgType = data.type;\r\n\t\tif (msgType) {\r\n\t\t\tlet arg = data.data;\r\n\r\n\t\t\t// Pull out functions with the corresponding type.\r\n\t\t\tlet stillWaiting = [];\r\n\t\t\tlet callNow = [];\r\n\t\t\tfor (let f of waitingMessages) {\r\n\t\t\t\tif (f.type === msgType && (!f.iframe || f.iframe.contentWindow === event.source)) {\r\n\t\t\t\t\tcallNow.push(f);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tstillWaiting.push(f);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\twaitingMessages = stillWaiting;\r\n\r\n\t\t\t// Call matching functions.\r\n\t\t\tfor (let f of callNow) {\r\n\t\t\t\tf(arg);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n});\r\n\r\n/**\r\n * @param {string} type\r\n * @param {HTMLIFrameElement} [iframe]\r\n * @returns {Promise<any>}\r\n */\r\nexport function waitForMessage(type, iframe) {\r\n\treturn new Promise(/** @param {((arg: any) => void) & { type: string, iframe: HTMLIFrameElement }} resolve */(resolve) => {\r\n\t\tresolve.type = type;\r\n\t\tresolve.iframe = iframe;\r\n\t\twaitingMessages.push(resolve);\r\n\t});\r\n}\r\n","import { createElement } from \"./html.js\";\r\nimport { waitForMessage } from \"./messaging.js\";\r\n\r\nasync function loadDocs() {\r\n\tlet response = await fetch(\"docs.html\");\r\n\tlet text = await response.text();\r\n\r\n\tlet tempDiv = createElement(\"div\");\r\n\ttempDiv.innerHTML = \"<template>\" + text + \"</template>\";\r\n\r\n\tlet template = /** @type {HTMLTemplateElement} */(tempDiv.firstChild);\r\n\r\n\tlet html = template.content;\r\n\r\n\tsections = /** @type {HTMLElement[]} */(Array.from(html.children)).map(e => new Section(e));\r\n\t\r\n\tconsole.log(sections);\r\n\r\n\treturn sections;\r\n}\r\n\r\nclass Section {\r\n\t/**\r\n\t * @param {HTMLElement} baseElement\r\n\t */\r\n\tconstructor(baseElement) {\r\n\t\tthis.summary = baseElement.dataset.summary;\r\n\r\n\t\tlet h2s = baseElement.querySelectorAll(\"h2\");\r\n\r\n\t\t/**\r\n\t\t * @type {Signature[]}\r\n\t\t */\r\n\t\tthis.signatures = Array.from(h2s).map((h2) => {\r\n\t\t\tlet title = h2.textContent;\r\n\t\t\tlet type = h2.dataset.type;\r\n\t\t\th2.remove();\r\n\r\n\t\t\tif (type) {\r\n\t\t\t\treturn new InfoSignature(title, type);\r\n\t\t\t} else {\r\n\t\t\t\treturn compileSignature(title);\r\n\t\t\t}\r\n\t\t});\r\n\t\t\r\n\r\n\t\tlet tag = baseElement.dataset.tag;\r\n\t\tif (tag) {\r\n\t\t\t/** @type {string[]} */\r\n\t\t\tthis.tags = tag.split(/\\s+/);\r\n\t\t} else {\r\n\t\t\tthis.tags = [];\r\n\t\t}\r\n\r\n\t\t/** @type {VirtualNode[]} */\r\n\t\tthis.nodes = [];\r\n\r\n\t\tthis.fromHtml(baseElement, this.nodes);\r\n\r\n\t\tif (!this.summary) {\r\n\t\t\tlet p = /** @type {HTMLParagraphElement} */(this.nodes.find(el => el instanceof HTMLParagraphElement));\r\n\t\t\tif (p) {\r\n\t\t\t\tthis.summary = p.textContent;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @private\r\n\t * @param {ParentNode} parentNode\r\n\t * @param {VirtualNode[]} parent\r\n\t */\r\n\tfromHtml(parentNode, parent) {\r\n\t\tfor (let child of /** @type {HTMLElement[]} */(Array.from(parentNode.children))) {\r\n\t\t\tif (child instanceof HTMLScriptElement) {\r\n\t\t\t\tlet example = Example.fromElement(child);\r\n\r\n\t\t\t\tparent.push(example);\r\n\t\t\t} else if (child instanceof HTMLDetailsElement) {\r\n\t\t\t\tlet detailNodes = [];\r\n\t\t\t\tthis.fromHtml(child, detailNodes);\r\n\t\t\t\tlet details = new VirtualElement(\"details\", {}, detailNodes);\r\n\t\t\t\t\r\n\t\t\t\tparent.push(details);\r\n\t\t\t} else {\r\n\t\t\t\tif (child instanceof HTMLPreElement) {\r\n\t\t\t\t\tchild.textContent = normalizeCode(child.textContent);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tparent.push(child);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @param {ParentNode} parent \r\n\t */\r\n\ttoHTML(parent) {\r\n\t\tlet section = createElement(\"section\");\r\n\r\n\t\tfor (let signature of this.signatures) {\r\n\t\t\tlet h2 = createElement(\"h2\");\r\n\t\t\tsignature.toHTML(h2);\r\n\t\t\tsection.append(h2);\r\n\t\t}\r\n\r\n\t\tinstantiateVirtualNodes(section, this.nodes);\r\n\r\n\t\tparent.append(section);\r\n\t}\r\n\r\n\t/**\r\n\t * @param {string} title\r\n\t */\r\n\tmatchesTitle(title) {\r\n\t\treturn this.signatures.some((signature) => signature && signature.matchesTitle(title));\r\n\t}\r\n\r\n\t/**\r\n\t * @param {string} search should be lowercase\r\n\t * @returns {number}\r\n\t */\r\n\tsearchScore(search) {\r\n\t\tfor (let signature of this.signatures) {\r\n\t\t\tif (signature.keywords.includes(search)) return 6;\r\n\r\n\t\t\tfor (let keyword of signature.keywords) {\r\n\t\t\t\tif (keyword.includes(search)) {\r\n\t\t\t\t\treturn 5;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (signature.signature.includes(search)) return 4;\r\n\t\t}\r\n\r\n\t\tfor (let tag of this.tags) {\r\n\t\t\tif (tag === search) return 3;\r\n\t\t\tif (tag.includes(search)) return 2;\r\n\t\t}\r\n\r\n\t\t// for (let element of this.htmlTemplateElements) {\r\n\t\t// \tif (element.textContent.includes(search)) return 1;\r\n\t\t// }\r\n\r\n\t\treturn 0;\r\n\t}\r\n}\r\n\r\nclass VirtualElement {\r\n\t/**\r\n\t * @param {keyof HTMLElementTagNameMap} tag\r\n\t * @param {Record<string, string>} [attributes] \r\n\t * @param {VirtualNode[]} [nodes]\r\n\t */\r\n\tconstructor(tag, attributes, nodes) {\r\n\t\tthis.tag = tag;\r\n\t\tthis.attributes = attributes || {};\r\n\t\tthis.nodes = nodes || [];\r\n\t}\r\n\r\n\t/**\r\n\t * @param {ParentNode} parent \r\n\t */\r\n\ttoHTML(parent) {\r\n\t\tlet element = createElement(this.tag, this.attributes);\r\n\r\n\t\tinstantiateVirtualNodes(element, this.nodes);\r\n\r\n\t\tparent.append(element);\r\n\t}\r\n}\r\n\r\nclass Example {\r\n\t/**\r\n\t * @param {string} code\r\n\t * @param {string} script\r\n\t */\r\n\tconstructor(code, script) {\r\n\t\tthis.code = code;\r\n\t\tthis.script = script;\r\n\t}\r\n\r\n\t/**\r\n\t * @param {ParentNode} parent \r\n\t */\r\n\ttoHTML(parent) {\r\n\t\tparent.append(\r\n\t\t\tcreateElement(\"pre\", {}, this.code)\r\n\t\t);\r\n\r\n\t\tlet runButton = createElement(\"button\", { class: \"accent-button\" });\r\n\t\trunButton.innerHTML = '<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"18\" height=\"18\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"accent-button-icon\"><polygon points=\"5 3 19 12 5 21 5 3\"></polygon></svg>Run Example';\r\n\r\n\t\tparent.append(runButton);\r\n\r\n\t\trunButton.onclick = () => {\r\n\t\t\tlet iframe = createElement(\"iframe\", { src: \"player\", width: \"100%\", height: \"100%\" });\r\n\t\t\t\r\n\t\t\tlet closeButton = createElement(\"button\", { class: \"player-stop hidden\" });\r\n\t\t\tcloseButton.innerHTML = '<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"#fff\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"player-stop-icon\"><line x1=\"18\" y1=\"6\" x2=\"6\" y2=\"18\"></line><line x1=\"6\" y1=\"6\" x2=\"18\" y2=\"18\"></line></svg>';\r\n\r\n\t\t\tlet player = createElement(\"div\", { class: \"player\"}, [\r\n\t\t\t\tiframe,\r\n\t\t\t\tcloseButton,\r\n\t\t\t]);\r\n\r\n\t\t\trunButton.replaceWith(player);\r\n\r\n\t\t\t// Send script once the iframe is ready.\r\n\t\t\twaitForMessage(\"ready\", iframe).then(() => {\r\n\t\t\t\tiframe.contentWindow.postMessage({ type: \"script\", data: this.script });\r\n\r\n\t\t\t\t// Handle stopping.\r\n\t\t\t\tcloseButton.classList.remove(\"hidden\");\r\n\t\t\t\tcloseButton.onclick = () => {\r\n\t\t\t\t\tiframe.src = \"about:blank\";\r\n\t\t\t\t\tiframe = null;\r\n\t\t\t\t\tplayer.replaceWith(runButton);\r\n\t\t\t\t};\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @param {HTMLScriptElement} e\r\n\t */\r\n\tstatic fromElement(e) {\r\n\t\tlet code = normalizeCode(e.text);\r\n\t\tlet tags = e.dataset.tag?.split(/\\s+/) ?? [];\r\n\r\n\t\tlet script = code;\r\n\t\tif (!code.includes(\"Game.begin\") && !tags.includes(\"noloop\")) {\r\n\t\t\tscript = \"Game.begin {\\n\";\r\n\t\t\tif (!tags.includes(\"noclear\")) script += \"Game.clear()\\n\";\r\n\t\t\tscript += code + \"\\n\";\r\n\t\t\tif (tags.includes(\"once\")) script += \"Game.quit()\\n\";\r\n\t\t\tscript += \"}\";\r\n\t\t}\r\n\r\n\t\treturn new Example(code, script);\r\n\t}\r\n}\r\n\r\n/**\r\n * @param {string} rawCode\r\n */\r\nfunction normalizeCode(rawCode) {\r\n\tlet result = /^\\s+/.exec(rawCode.slice(1));\r\n\t\r\n\tlet code;\r\n\tif (result) {\r\n\t\tcode = (\"\\n\" + rawCode).replaceAll(\"\\n\" + result[0], \"\\n\");\r\n\t} else {\r\n\t\tcode = rawCode;\r\n\t}\r\n\r\n\tcode = code.trim();\r\n\r\n\treturn code;\r\n}\r\n\r\n\r\nlet CLS_CLASS = \"sg-class\";\r\nlet CLS_PROPERTY = \"sg-property\";\r\nlet CLS_PARAMETER = \"sg-parameter\";\r\nlet CLS_TYPE = \"sg-type\";\r\n\r\nclass Signature {\r\n\t/**\r\n\t * @param {ParentNode} parent \r\n\t */\r\n\ttoHTML(parent) { throw Error(\"not implemented\") }\r\n\r\n\t/**\r\n\t * @param {string} title\r\n\t */\r\n\tmatchesTitle(title) {\r\n\t\treturn this.signature === title;\r\n\t}\r\n}\r\n\r\nSignature.prototype.signature = \"\";\r\n\r\n/** @type {string[]} */\r\nSignature.prototype.keywords = [];\r\n\r\n/**\r\n * @param {string} type\r\n */\r\nfunction compoundTypeToHTML(type) {\r\n\tlet r = type.split(/([a-zA-Z]+)/);\r\n\r\n\tlet parent = createElement(\"span\", { class: CLS_TYPE });\r\n\r\n\tr.forEach((part, i) => {\r\n\t\tif (i % 2 === 0) {\r\n\t\t\tparent.append(part);\r\n\t\t} else {\r\n\t\t\tparent.append(createAPILinkText(part, part));\r\n\t\t}\r\n\t});\r\n\r\n\treturn parent;\r\n}\r\n\r\n/**\r\n * @param {string} text\r\n * @param {string} title\r\n * @param {string} [className]\r\n */\r\nfunction createAPILinkText(text, title, className) {\r\n\tlet fullClass = \"no-underline\";\r\n\tif (className) {\r\n\t\tfullClass += \" \" + className;\r\n\t}\r\n\r\n\tif (title === \"null\") {\r\n\t\ttitle = \"Null\";\r\n\t}\r\n\r\n\tlet a = createElement(\"a\", { class: fullClass, href: \"#\" + title }, text);\r\n\r\n\tlet section = sections.find(section => section.matchesTitle(title));\r\n\tif (section && section.summary) {\r\n\t\ta.title = section.summary;\r\n\t}\r\n\r\n\treturn a;\r\n}\r\n\r\n\r\nclass InfoSignature extends Signature {\r\n\t/**\r\n\t * @param {string} name\r\n\t * @param {string} type\r\n\t */\r\n\tconstructor(name, type) {\r\n\t\tsuper();\r\n\r\n\t\tthis.name = name;\r\n\t\tthis.type = type;\r\n\t\tthis.signature = name;\r\n\t\tthis.keywords = [ name.toLowerCase() ];\r\n\t}\r\n\r\n\t/**\r\n\t * @param {ParentNode} parent \r\n\t */\r\n\ttoHTML(parent) {\r\n\t\tlet cls = \"\";\r\n\t\tif (this.type === \"type\") {\r\n\t\t\tcls = CLS_TYPE;\r\n\t\t}\r\n\r\n\t\tparent.append(\r\n\t\t\tcreateAPILinkText(this.name, this.name, cls)\r\n\t\t);\r\n\t}\r\n}\r\n\r\nclass ClassSignature extends Signature {\r\n\t/**\r\n\t * @param {string} className\r\n\t */\r\n\tconstructor(className) {\r\n\t\tsuper();\r\n\r\n\t\tthis.name = className;\r\n\t\tthis.signature = className;\r\n\t\tthis.keywords = [ className.toLowerCase() ];\r\n\t}\r\n\r\n\t/**\r\n\t * @param {ParentNode} parent \r\n\t */\r\n\ttoHTML(parent) {\r\n\t\tparent.append(\r\n\t\t\tcreateAPILinkText(this.name, this.name, CLS_CLASS)\r\n\t\t);\r\n\t}\r\n}\r\n\r\n/**\r\n * @param {string} className\r\n * @param {boolean} isStatic \r\n */\r\nfunction correctClassCase(className, isStatic) {\r\n\treturn isStatic ? className : (className[0].toLowerCase() + className.slice(1));\r\n}\r\n\r\n/**\r\n * @param {ParentNode} parent\r\n * @param {string} className\r\n * @param {boolean} isStatic\r\n * @param {string} methodName\r\n * @param {string} signature\r\n */\r\nfunction addClassAndMethodNameSignature(parent, className, isStatic, methodName, signature) {\r\n\tparent.append(\r\n\t\tcreateAPILinkText(correctClassCase(className, isStatic), className, CLS_CLASS),\r\n\t\t\".\",\r\n\t\tcreateAPILinkText(methodName, signature, CLS_PROPERTY),\r\n\t);\r\n}\r\n\r\n/**\r\n * @param {ParentNode} parent\r\n * @param {string|null} type\r\n */\r\nfunction addReturnType(parent, type) {\r\n\tif (type) {\r\n\t\tparent.append(\r\n\t\t\t\": \",\r\n\t\t\tcompoundTypeToHTML(type),\r\n\t\t);\r\n\t}\r\n}\r\n\r\nclass PropertySignature extends Signature {\r\n\t/**\r\n\t * @param {string} className\r\n\t * @param {boolean} isStatic\r\n\t * @param {string} propertyName\r\n\t * @param {string|null} type\r\n\t */\r\n\tconstructor(className, isStatic, propertyName, type) {\r\n\t\tsuper();\r\n\r\n\t\tthis.class = className;\r\n\t\tthis.isStatic = isStatic;\r\n\t\tthis.property = propertyName;\r\n\t\tthis.type = type;\r\n\t\tthis.signature = correctClassCase(className, isStatic) + \".\" + propertyName;\r\n\t\tthis.keywords = [ className.toLowerCase(), propertyName.toLowerCase() ];\r\n\t}\r\n\r\n\t/**\r\n\t * @param {string} title\r\n\t */\r\n\tmatchesTitle(title) {\r\n\t\treturn this.class === title || super.matchesTitle(title);\r\n\t}\r\n\r\n\t/**\r\n\t * @param {ParentNode} parent \r\n\t */\r\n\ttoHTML(parent) {\r\n\t\taddClassAndMethodNameSignature(parent, this.class, this.isStatic, this.property, this.signature);\r\n\t\taddReturnType(parent, this.type);\r\n\t}\r\n}\r\n\r\nclass MethodSignature extends Signature {\r\n\t/**\r\n\t * @param {string} className\r\n\t * @param {boolean} isStatic\r\n\t * @param {string} methodName\r\n\t * @param {Parameter[]} parameters\r\n\t * @param {string|null} returnType\r\n\t */\r\n\tconstructor(className, isStatic, methodName, parameters, returnType) {\r\n\t\tsuper();\r\n\r\n\t\tthis.class = className;\r\n\t\tthis.isStatic = isStatic;\r\n\t\tthis.method = methodName;\r\n\t\tthis.parameters = parameters;\r\n\t\tthis.returnType = returnType;\r\n\t\tthis.signature = correctClassCase(className, isStatic) + \".\" + methodName + \"(\" + parameters.map(() => \"_\").join(\",\") + \")\";\r\n\t\tthis.keywords = [ className.toLowerCase(), methodName.toLowerCase() ];\r\n\t\tfor (let param of parameters) {\r\n\t\t\tthis.keywords.push(param.name.toLowerCase());\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @param {string} title\r\n\t */\r\n\tmatchesTitle(title) {\r\n\t\treturn this.class === title || super.matchesTitle(title);\r\n\t}\r\n\r\n\t/**\r\n\t * @param {ParentNode} parent \r\n\t */\r\n\ttoHTML(parent) {\r\n\t\taddClassAndMethodNameSignature(parent, this.class, this.isStatic, this.method, this.signature);\r\n\r\n\t\tparent.append(\"(\");\r\n\r\n\t\tthis.parameters.forEach((param, i) => {\r\n\t\t\tif (i > 0) {\r\n\t\t\t\tparent.append(\", \");\r\n\t\t\t}\r\n\r\n\t\t\tparent.append(\r\n\t\t\t\tcreateElement(\"span\", { class: CLS_PARAMETER }, param.name),\r\n\t\t\t\t\": \",\r\n\t\t\t\tcompoundTypeToHTML(param.type),\r\n\t\t\t);\r\n\t\t});\r\n\r\n\t\tparent.append(\")\");\r\n\r\n\t\taddReturnType(parent, this.returnType);\r\n\t}\r\n}\r\n\r\nclass Parameter {\r\n\t/**\r\n\t * @param {string} name\r\n\t * @param {string} type\r\n\t */\r\n\tconstructor(name, type) {\r\n\t\tthis.name = name;\r\n\t\tthis.type = type;\r\n\t}\r\n}\r\n\r\n/**\r\n * @param {string} s\r\n * @returns {Signature}\r\n */\r\nfunction compileSignature(s) {\r\n\tif (/^[a-zA-Z0-9]+$/.test(s)) {\r\n\t\treturn new ClassSignature(s);\r\n\t}\r\n\r\n\tlet dot = s.indexOf(\".\");\r\n\r\n\tif (dot > 0) {\r\n\t\tlet className = s.slice(0, dot);\r\n\t\tlet isStatic = /^[A-Z]/.test(s);\r\n\r\n\t\tclassName = className[0].toUpperCase() + className.slice(1);\r\n\r\n\t\tlet rest = s.slice(dot + 1);\r\n\r\n\t\tlet openParen = rest.indexOf(\"(\");\r\n\t\tif (openParen > 0) {\r\n\t\t\tlet method = rest.slice(0, openParen);\r\n\r\n\t\t\tlet closeParen = rest.lastIndexOf(\")\");\r\n\t\t\tif (closeParen < 0) throw Error(\"missing closing paren\");\r\n\r\n\t\t\tlet params = [];\r\n\t\t\tlet paramParts = rest.slice(openParen + 1, closeParen).split(/,\\s*/);\r\n\t\t\tif (paramParts.length !== 1 || paramParts[0].length > 0) {\r\n\t\t\t\tfor (let part of paramParts) {\r\n\t\t\t\t\tlet colon = part.indexOf(\":\");\r\n\t\t\t\t\tlet name = colon < 0 ? part : part.slice(0, colon);\r\n\t\t\t\t\tlet type = colon < 0 ? null : part.slice(colon + 1).trim();\r\n\t\t\t\t\tparams.push(new Parameter(name, type));\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tlet colon = rest.indexOf(\":\", closeParen);\r\n\t\t\tlet returnType = colon < 0 ? null : rest.slice(colon + 1).trim();\r\n\r\n\t\t\treturn new MethodSignature(className, isStatic, method, params, returnType);\r\n\t\t}\r\n\r\n\t\tlet colon = rest.indexOf(\":\");\r\n\t\tlet property = colon < 0 ? rest : rest.slice(0, colon);\r\n\t\tlet type = colon < 0 ? null : rest.slice(colon + 1).trim();\r\n\r\n\t\treturn new PropertySignature(className, isStatic, property, type);\r\n\t}\r\n\r\n\tthrow Error(\"invalid signature: \" + s);\r\n}\r\n\r\n\r\n/** @type {Section[]} */\r\nexport let sections = [];\r\n\r\nexport let sectionsPromise = loadDocs();\r\n\r\n/**\r\n * @param {string} search\r\n * @returns {Section[]}\r\n */\r\nexport function searchSeactions(search) {\r\n\tsearch = search.trim().toLowerCase();\r\n\r\n\tif (search.length <= 1) return [];\r\n\r\n\t/** @type {{ score: number, section: Section }[]} */\r\n\tlet matches = [];\r\n\r\n\tfor (let section of sections) {\r\n\t\tlet score = section.searchScore(search);\r\n\r\n\t\tif (score > 0) {\r\n\t\t\tmatches.push({ score: score, section: section });\r\n\t\t}\r\n\t}\r\n\r\n\tmatches.sort((a, b) => b.score - a.score);\r\n\r\n\treturn matches.map(match => match.section);\r\n}\r\n\r\n/**\r\n * \r\n * @param {HTMLElement} parentNode\r\n * @param {VirtualNode[]} nodes\r\n */\r\nfunction instantiateVirtualNodes(parentNode, nodes) {\r\n\tfor (let node of nodes) {\r\n\t\tif (node instanceof HTMLElement) {\r\n\t\t\tparentNode.append(node);\r\n\t\t} else if (Array.isArray(node)) {\r\n\t\t\tinstantiateVirtualNodes(parentNode, nodes);\r\n\t\t} else {\r\n\t\t\tnode.toHTML(parentNode);\r\n\t\t}\r\n\t}\r\n}\r\n\r\n/**\r\n * @typedef {object} ToHTML\r\n * @property {(parent: HTMLElement) => void} toHTML\r\n */\r\n\r\n/**\r\n * @typedef {HTMLElement|ToHTML|VirtualNodes} VirtualNode\r\n */\r\n/**\r\n * @typedef {VirtualNode[]} VirtualNodes\r\n */\r\n","\r\n/**\r\n * @param {string} [title]\r\n */\r\nexport function navigateTo(title) {\r\n\tif (title) {\r\n\t\tlocation.hash = \"#\" + title;\r\n\t} else {\r\n\t\thistory.pushState(null, null, \" \");\r\n\r\n\t\tdispatchEvent(new Event(\"hashchange\"));\r\n\t}\r\n}\r\n","import \"./theme.js\";\r\nimport \"./docs.js\";\r\nimport { clearElement, createElement, getElement } from \"./html.js\";\r\nimport { searchSeactions, sections, sectionsPromise } from \"./docs.js\";\r\nimport { navigateTo } from \"./navigation.js\";\r\n\r\nlet searchForm = /** @type {HTMLFormElement} */(getElement(\"search-form\"));\r\nlet searchInput = /** @type {HTMLInputElement} */(getElement(\"search\"));\r\nlet mainContainer = document.querySelector(\"main\");\r\n\r\n/**\r\n * @param {SubmitEvent} event\r\n */\r\nsearchForm.onsubmit = (event) => {\r\n\tevent.preventDefault();\r\n\r\n\tlet searchValue = searchInput.value.trim();\r\n\r\n\tif (searchValue) {\r\n\t\tnavigateTo(\"~\" + searchValue);\r\n\t} else {\r\n\t\tnavigateTo();\r\n\t}\r\n};\r\n\r\nsectionsPromise.then(() => {\r\n\tnavigateFromURL();\r\n});\r\n\r\nfunction showHome() {\r\n\tclearElement(mainContainer);\r\n\r\n\tsections[0].toHTML(mainContainer);\r\n}\r\n\r\ngetElement(\"title-link\").onclick = (event) => {\r\n\tif (!event.ctrlKey && !event.metaKey && !event.shiftKey) {\r\n\t\tevent.preventDefault();\r\n\t\tnavigateTo();\r\n\t}\r\n};\r\n\r\naddEventListener(\"hashchange\", (ev) => {\r\n\tnavigateFromURL();\r\n});\r\n\r\nfunction navigateFromURL() {\r\n\tlet title = location.hash.slice(1);\r\n\r\n\tif (title) {\r\n\t\ttitle = decodeURIComponent(title);\r\n\r\n\t\tif (title[0] === \"~\") {\r\n\t\t\tsearch(title.slice(1));\r\n\t\t} else {\r\n\t\t\tlet matchingSections = sections.filter(section => section.matchesTitle(title));\r\n\t\t\r\n\t\t\tclearElement(mainContainer);\r\n\t\t\r\n\t\t\tif (matchingSections.length > 0) {\r\n\t\t\t\tfor (let section of matchingSections) {\r\n\t\t\t\t\tsection.toHTML(mainContainer);\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tmainContainer.append(\r\n\t\t\t\t\tcreateElement(\"p\", {}, `Could not find information about \"${title}\".`)\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t}\r\n\t} else {\r\n\t\tshowHome();\r\n\t}\r\n}\r\n\r\n/**\r\n * @param {string} search\r\n */\r\nfunction search(search) {\r\n\tsearchInput.value = search;\r\n\r\n\tclearElement(mainContainer);\r\n\r\n\tlet matches = searchSeactions(search);\r\n\r\n\tif (matches.length === 0) {\r\n\t\tmainContainer.append(`No items match search \"${search}\".`);\r\n\t} else {\r\n\t\tfor (let match of matches) {\r\n\t\t\tmatch.toHTML(mainContainer);\r\n\t\t}\r\n\t}\r\n}\r\n"],"names":["getElement","id","document","getElementById","setElementClass","element","className","enabled","classList","add","remove","createElement","tag","attributes","nodes","name","value","startsWith","setAttribute","withAttributes","parent","Array","isArray","node","append","appendNodes","clearElement","el","innerHTML","curr","LOCAL_STORAGE_KEY","savedJSON","localStorage","getItem","JSON","parse","error","console","Object","assign","persistence","iconLight","iconDark","isLightTheme","setIsLightTheme","isLight","documentElement","onclick","p","key","setItem","stringify","updatePersistence","contains","waitingMessages","addEventListener","event","data","msgType","type","arg","stillWaiting","callNow","f","iframe","contentWindow","source","push","Section","constructor","baseElement","this","summary","dataset","h2s","querySelectorAll","signatures","from","map","h2","title","textContent","InfoSignature","s","test","ClassSignature","dot","indexOf","slice","isStatic","toUpperCase","rest","openParen","method","closeParen","lastIndexOf","Error","params","paramParts","split","length","part","colon","trim","Parameter","returnType","MethodSignature","property","PropertySignature","compileSignature","tags","fromHtml","find","HTMLParagraphElement","parentNode","child","children","HTMLScriptElement","example","Example","fromElement","HTMLDetailsElement","detailNodes","details","VirtualElement","HTMLPreElement","normalizeCode","toHTML","section","signature","instantiateVirtualNodes","matchesTitle","some","searchScore","search","keywords","includes","keyword","code","script","runButton","class","src","width","height","closeButton","player","replaceWith","Promise","resolve","waitForMessage","then","postMessage","static","e","text","rawCode","result","exec","replaceAll","CLS_CLASS","CLS_TYPE","Signature","compoundTypeToHTML","r","forEach","i","createAPILinkText","fullClass","a","href","sections","prototype","super","toLowerCase","cls","correctClassCase","addClassAndMethodNameSignature","methodName","addReturnType","propertyName","parameters","join","param","sectionsPromise","async","response","fetch","tempDiv","html","content","log","loadDocs","HTMLElement","navigateTo","location","hash","history","pushState","dispatchEvent","Event","searchForm","searchInput","mainContainer","querySelector","navigateFromURL","decodeURIComponent","matches","score","sort","b","match","searchSeactions","matchingSections","filter","onsubmit","preventDefault","searchValue","ctrlKey","metaKey","shiftKey","ev"],"mappings":"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"}